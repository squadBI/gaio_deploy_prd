{"flowList":[{"flowId":"1808","appId":137,"flowName":"Dashboard - Menu","workflow":{"nodes":[{"id":"kYMnRb","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"2002","repoId":1,"created":false,"position":{"x":94.80071618143174,"y":-139.70631858316258}},{"id":"omsfzN","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"2201","repoId":1,"created":false,"position":{"x":183.53672428789824,"y":-140.1146212246638}},{"id":"bzJJuI","grid":{"h":100,"w":64,"x":0,"y":0,"hidden":false},"type":"report","appId":137,"label":"DUP -DUP -DUP -new menu","limit":100,"width":1321,"height":595,"layout":{"lg":{"h":100,"w":64,"x":0,"y":0,"height":595,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":0,"height":290,"hidden":false}},"tables":["tmp_men_venda","tmp_men_contratos","tmp_men_clientes","tmp_men_churn_fisico","tmp_men_perda_receita","tmp_men_migracoes_entrantes","tmp_men_migracoes_saintes","tmp_men_caixa","tmp_men_receita_liquida","tmp_men_opex","tmp_men_capex","tmp_ticket_medio","tmp_csl_dia","tbl_vnd_forecast_best","tmp_men_ebit","tmp_men_receita_liq","tmp_men_ebitda"],"content":" ","created":false,"project":{"html":"<!-- Frameworks e Ferramentas de customização-->\r\n<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\r\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css\">\r\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\r\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\r\n   <!-- CSS -->\r\n   <style>\r\n      .flex-row{\r\n      display:flex;\r\n      flex-direction:row;\r\n      } \r\n      .flex-wrap{\r\n      flex-wrap:wrap;\r\n      }\r\n      #filtrar{\r\n          display: inline-block;\r\n          color: black;\r\n          font-weight: 650;\r\n          text-decoration: underline;\r\n          cursor: pointer;\r\n          color:#363636;\r\n      }\r\n      #btn_exp_sgm:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_pdt:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_view_mensal:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_view_diaria:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #logo_analytics {\r\n      width: 70%;\r\n      }\r\n      #btn_menu {\r\n      font-size: 140%;\r\n      color: #FFFFFF;\r\n      }\r\n      .link_grafico {\r\n      cursor: pointer;\r\n      }\r\n      .link_grafico:hover {\r\n      cursor: pointer;\r\n      color: black;\r\n      }\r\n      #result_insights_csl_vnd {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_csl_prd {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_csl_cli {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #carregando {\r\n            animation: rodar 1s infinite;\r\n            border: 6px solid #ededed;\r\n            border-radius: 50%;\r\n            border-top-color: #51d4db;\r\n            height: 30px;\r\n            width: 30px;\r\n            position: fixed;\r\n            margin:  25% 50% 0%;\r\n            z-index: 1;\r\n        }\r\n        @keyframes rodar {\r\n            to {\r\n                transform: rotate(1turn);\r\n            }\r\n        }\r\n        .percentual {\r\n            font-weight: 600;\r\n            display: inline-block; \r\n        }\r\n        #aviso_confidencial{\r\n            /*font-weight: 600;\r\n            font-size: 15px;\r\n            color: white;\r\n            margin-top: 15px;\r\n            margin-bottom: 15px;\r\n            background-color: #c22c18;\r\n            text-align: center;*/\r\n            font-weight: 600;\r\n            font-size: 15px;\r\n            color: #090909;\r\n            margin-top: 15px;\r\n            margin-bottom: 15px;\r\n            /*background-color: #c22c18;*/\r\n            border: 2px solid #c22c18;\r\n            text-align: center;\r\n        }\r\n   </style>\r\n   <!-- CSS -->\r\n   <meta charset=\"utf-8\">\r\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n   <title>Portal Analytics</title>\r\n</head>\r\n<body>\r\n    <div id=\"carregando\" style=\"display: none\"></div>\r\n   <div id=\"wrapper\">\r\n      <!-- Ínicio menu -->\r\n      <nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a onclick=\"get_results()\">\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\"  class=\"active\">\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a onclick=\"get_results()\">\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li><!--\r\n                              <a  target=\"_blank\" href=\"http://spotfirehom.algartelecom.com.br/spotfire/wp/OpenAnalysis?file=200d4235-9a88-4887-8a6d-e69fb53583ff\" id=\"item_menu_venda_digital\">\r\n                              Digital\r\n                              </a>-->\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a onclick=\"get_results()\">Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a>Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a onclick=\"get_results()\">\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_atendimento_digital\">\r\n                        <a  style=\"color: #676a6c;\"   href=\"https://gaio.algartelecom.com.br/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                    </li>\r\n                     \r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a>Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     \r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\">\r\n                  <a>\r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                      \r\n                       <li id=\"item_menu_margem_contribuicao\">\r\n                        <a onclick=\"get_results()\">Margem Contribuição</a>\r\n                     </li>\r\n                     \r\n                      <li id=\"item_menu_ebit\">\r\n                        <a onclick=\"get_results()\">Ebit</a>\r\n                     </li>\r\n                      \r\n                      <li id=\"item_menu_ebitda\">\r\n                        <a onclick=\"get_results()\">Ebitda</a>\r\n                     </li> \r\n                      \r\n                      \r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Bruta\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a  onclick=\"get_results()\">\r\n                              Receita Líquida\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_caixa_livre\">\r\n                        <a>Caixa Livre (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex</a>\r\n                     </li>\r\n\r\n                     \r\n                  </ul>\r\n               </li>\r\n               \r\n               \r\n               <li id=\"side-bar-transformacao\">\r\n                  <a> \r\n                  <i class=\"fa fa-rocket\"></i>\r\n                  <span class=\"nav-label\" >\r\n                  Transformação (WIP)\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-transformacao-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_desempenho_projeto\">\r\n                        <a onclick=\"get_results()\">Desempenho de Projetos (WIP)</a>\r\n                     </li>\r\n                    \r\n                  </ul>\r\n               </li> \r\n  \r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               \r\n\r\n               <li id=\"side-bar-ed\">\r\n                <a>\r\n                <i class=\"fa fa-cloud-download\"></i>\r\n                <span class=\"nav-label\">Tecnologia (WIP)</span>\r\n                </a>\r\n                <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                   collapse\">\r\n                <li id=\"item_menu_evolucao_digital\">\r\n                    <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                \r\n                            \r\n                            <li id=\"item_menu_pulse_check\">\r\n                                <a>Data Driven (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Operações automatizadas (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Novos negócios digitais (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Mindset Digital (WIP)</a>\r\n                            </li>\r\n                        </ul>\r\n                </ul>\r\n            </li>\r\n             \r\n\r\n\r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>\r\n      <!-- Fim menu -->\r\n      <!-- Ínicio conteúdo -->\r\n      <div id=\"page-wrapper\" class=\"gray-bg\">\r\n         <!-- Ínicio cabeçalho -->\r\n         <div class=\"col-lg-12 \">\r\n            <div class=\"row \" style=\"height: 86px;\">\r\n               <nav class=\"navbar navbar-static-top\" role=\"navigation\"\r\n                  style=\"margin-bottom: 10px; background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n                  <div class=\"navbar-header\">\r\n                     <a id=\"btn_menu\" class=\"navbar-minimalize\r\n                        minimalize-styl-2\" href=\"#\">\r\n                     <i class=\"fa fa-bars\"></i>\r\n                     </a>\r\n                     <a class=\"navbar-minimalize minimalize-styl-2\"\r\n                        href=\"#\"\r\n                        style=\"cursor: default; margin-top: 5px;\">\r\n<img src=\"/api/content/read/137/analytics_logo.png\" width=\"240px\">\r\n                     </a>\r\n                  </div>\r\n                  <h2 class=\"m-r-sm text-white welcome-message\"\r\n                     style=\"font-size: 24px; font-weight: 500;\">\r\n                     <strong style=\"color:#363636;font-size: 30px\">Portal Analytics</strong>\r\n                  </h2>\r\n                  <ul class=\"nav navbar-top-links navbar-right\">\r\n                     <li>\r\n                        <span class=\"m-r-sm text-muted\r\n                           welcome-message\">\r\n                            <img src=\"/api/content/read/137/logo_algartelecom.png\" height=\"50px\">\r\n                            <!--\r\n                        <img\r\n                           src=\"/api/content/read/22/logo_algar.png\"\r\n                           height=\"34px\">-->\r\n                        </span>\r\n                     </li>\r\n                  </ul>\r\n               </nav>\r\n            </div>\r\n            <div id=\"aviso_confidencial\">&#60;&#60;&#60;\r\n               AS INFORMAÇÕES PUBLICADAS NESTE PORTAL SÃO CONFIDENCIAIS E NÃO PODEM SER DIVULGADAS NEM REPRODUZIDAS.\r\n               &#62;&#62;&#62;\r\n            </div>\r\n         </div>\r\n         <!-- Fim cabeçalho -->\r\n         <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n           \r\n            <!--Cockpit de indicadores-->\r\n            <div class=\"col-lg-13\">\r\n               <div class=\"ibox-title\" style=\"\r\n                  background-image:\r\n                  linear-gradient(#50E1BC, #50E1BC);\r\n                  border-radius: 10px 10px 0px 0px;\r\n                  \">\r\n                  <div class=\"row\">\r\n                     <div class=\"col-sm-6\">\r\n                         \r\n                        <h3 style=\"color:#363636\">\r\n                           <strong>\r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi\r\n                                 bi-graph-up\" viewBox=\"0 0 16 16\">\r\n                                 <path fill-rule=\"evenodd\" d=\"M0\r\n                                    0h1v15h15v1H0V0Zm14.817 3.113a.5.5 0 0 1\r\n                                    .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06\r\n                                    6.767l-3.656 5.027a.5.5 0 0\r\n                                    1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609\r\n                                    2.61 4.15-5.073a.5.5 0 0 1 .704-.07Z\" />\r\n                              </svg>\r\n                              &nbsp;\r\n                              Cockpit de Indicadores\r\n                           </strong>\r\n                        </h3>\r\n                        \r\n                     </div>\r\n                     \r\n                     <div class=\"col-sm-6\" style=\"text-align:right;\">\r\n                         <div id='filtrar'>Filtrar Segmento</div>\r\n                        <button class=\"btn btn-primary show\" type=\"button\" data-toggle=\"collapse\"\r\n                           data-target=\"#multiCollapseExample7\" aria-expanded=\"false\"\r\n                           aria-controls=\"multiCollapseExample7\" style=\"\r\n                           background-color:\r\n                           transparent;\r\n                           background-repeat:\r\n                           no-repeat;\r\n                           border: none;\r\n                           cursor: pointer;\r\n                           overflow: hidden;\r\n                           outline: none;\r\n                           \">\r\n                           <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\"\r\n                              class=\"bi bi-list\" viewBox=\"0 0 16 16\" style=\"color:#363636\">\r\n                              <path fill-rule=\"evenodd\" d=\"M2.5 12a.5.5 0\r\n                                 0\r\n                                 1\r\n                                 .5-.5h10a.5.5 0 0\r\n                                 1\r\n                                 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5zm0-4a.5.5\r\n                                 0\r\n                                 0 1\r\n                                 .5-.5h10a.5.5 0 0\r\n                                 1\r\n                                 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5zm0-4a.5.5\r\n                                 0\r\n                                 0 1\r\n                                 .5-.5h10a.5.5 0 0\r\n                                 1\r\n                                 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5z\" />\r\n                           </svg>\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class=\"collapse show\r\n                  multi-collapse\" id=\"multiCollapseExample7\">\r\n                  <div class=\"card card-body\">\r\n                     <div class=\"col-lg-13\">\r\n                        <div class=\"row\">\r\n                           <div class=\"col-lg-6\">\r\n                              <!--Gráfico venda-->\r\n                              <div>\r\n                                 <h3 class=\"link_grafico\" id=\"link_grafico_venda\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                    \r\n                                    {% if params.prm_segmento == 'all_' %}\r\n                                      Venda (R$ mil, D-1)\r\n                                    {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                      Venda Corporativo (R$ mil, D-1)\r\n                                    {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                      Venda MPE (R$ mil, D-1)\r\n                                    {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                      Venda Atacado (R$ mil, D-1)\r\n                                    {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                      Venda Varejo (R$ mil, D-1)\r\n                                    {% else %}\r\n                                    \r\n                                    {% endif %}\r\n                                    \r\n                                 </h3>\r\n                                 <div>\r\n                                       <div id=\"graficoVenda\"></div>\r\n                                 </div>\r\n                                 <h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                {% if params.prm_segmento == 'all_' %}\r\n                                  <ul id='result_insights_csl_vnd'></ul>\r\n                                {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                  <ul id='result_insights_crp_vnd'></ul>\r\n                                {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                  <ul id='result_insights_emp_vnd'></ul>\r\n                                {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                  <ul id='result_insights_ope_vnd'></ul>\r\n                                {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                  <ul id='result_insights_res_vnd'></ul>\r\n                                {% else %}\r\n                                  \r\n                                {% endif %}\r\n                               \r\n                                 \r\n                                 \r\n                              </div>\r\n                              \r\n                           </div>\r\n                           <div class=\"col-lg-6\">\r\n                               \r\n                              <!--Gráfico Perda Receita-->\r\n                              <div>\r\n                                 <h3  class=\"link_grafico\" id=\"link_perda_receita\"  style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                            {% if params.prm_segmento == 'all_' %}\r\n                                              Perda de Receita (R$ mil, D-1)\r\n                                            {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                              Perda de Receita Corporativo (R$ mil, D-1)\r\n                                            {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                              Perda de Receita MPE (R$ mil, D-1)\r\n                                            {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                              Perda de Receita Atacado (R$ mil, D-1)\r\n                                            {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                              Perda de Receita Varejo (R$ mil, D-1)\r\n                                            {% else %}\r\n                                            \r\n                                            {% endif %}\r\n                                           </h3>\r\n                                       <!--<h3 class=\"link_grafico\" id=\"link_perda_receita\" style=\"text-decoration: underline;\r\n                                          color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                          Perda Receita (R$ mil)\r\n                                       </h3>-->\r\n                                       <div>\r\n                                             <div id=\"graficoPerdaReceita\"></div>\r\n                                       </div>\r\n                                       <h5>\r\n                                          <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                          Insights\r\n                                       </h5>\r\n                                      \r\n                                       \r\n                                       {% if params.prm_segmento == 'all_' %}\r\n                                          <ul id='result_insights_csl_prd'></ul>\r\n                                        {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                          <ul id='result_insights_crp_prd'></ul>\r\n                                        {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                          <ul id='result_insights_emp_prd'></ul>\r\n                                        {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                          <ul id='result_insights_ope_prd'></ul>\r\n                                        {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                          <ul id='result_insights_res_prd'></ul>\r\n                                        {% else %}\r\n                                          \r\n                                        {% endif %}\r\n                                       \r\n                                       <h5>Nota:</h5>\r\n                                       <span> Outlier no dia 01 para o Corporativo devido cancelamentos por Aviso Prévio</span>\r\n\r\n                                    </div>\r\n                              \r\n                           </div>\r\n                              \r\n                           </div>\r\n                           \r\n                        </div>\r\n                        <hr>\r\n                        <div class=\"row\">\r\n                           <div class=\"col-lg-6\">\r\n                              <!--Gráfico Base Cliente-->\r\n                              <div>\r\n                                 <h3 class=\"link_grafico\" id=\"link_base_cliente\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                        \r\n                                       {% if params.prm_segmento == 'all_' %}\r\n                                         Base de Clientes (# mil, D-1)\r\n                                       {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                         Base de Clientes Corporativo (# mil, D-1)\r\n                                       {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                         Base de Clientes MPE (# mil, D-1)\r\n                                       {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                         Base de Clientes Atacado (# mil, D-1)\r\n                                       {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                         Base de Clientes Varejo (# mil, D-1)\r\n                                       {% else %}\r\n                                       \r\n                                       {% endif %} \r\n                                       \r\n                                    \r\n                                 </h3>\r\n                                 <div>\r\n                                       <div id=\"graficoClientes\"></div>\r\n                                 </div>\r\n                                 <h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                 {% if params.prm_segmento == 'all_' %}\r\n                                          <ul id='result_insights_csl_cli'></ul>\r\n                                        {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                          <ul id='result_insights_crp_cli'></ul>\r\n                                        {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                          <ul id='result_insights_emp_cli'></ul>\r\n                                        {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                          <ul id='result_insights_ope_cli'></ul>\r\n                                        {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                          <ul id='result_insights_res_cli'></ul>\r\n                                        {% else %}\r\n                                          \r\n                                        {% endif %}\r\n                                 \r\n                                     \r\n                                 \r\n                                 <h5>Nota:</h5>\r\n                                       <span> Métrica dependente dos ciclos de faturamento</span>\r\n                              </div>\r\n                              \r\n                           </div>\r\n                           \r\n                           \r\n                           \r\n                           <div class=\"col-lg-6\">\r\n   <!--Gráfico Arpu-->\r\n   <div>\r\n      <h3   class=\"link_grafico\" id=\"link_arpu\" style=\"text-decoration: underline;\r\n         color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n         Ticket Médio Base (R$, mês anterior)\r\n      </h3>\r\n      <br>\r\n      <div>\r\n         <div id=\"graficoARPU\" style=\"padding-top :110px;padding-bottom:75px\">\r\n            <table class=\"table\">\r\n               <thead>\r\n                  <tr>\r\n                     <th scope=\"col\">{{ tmp_ticket_medio[0].Mes_Ref_Visual }}</th>\r\n                     <th scope=\"col\">Real</th>\r\n                  </tr>\r\n               </thead>\r\n               <tbody>\r\n                  <tr>\r\n                                               <th scope=\"row\">{{ tmp_ticket_medio[0].SEGMENTO_TTD }} </th>\r\n                                               <td style=\"text-align: right\">{{ tmp_ticket_medio[0].REAL_TM.toLocaleString('pt-BR', {minimumFractionDigits: 0}) }}</td>\r\n                                              \r\n                                               \r\n                                             </tr>\r\n                 <tr>\r\n                                               <th scope=\"row\">{{ tmp_ticket_medio[1].SEGMENTO_TTD }}</th>\r\n                                               <td style=\"text-align: right\">{{ tmp_ticket_medio[1].REAL_TM.toLocaleString('pt-BR', {minimumFractionDigits: 0})  \r\n }}</td>\r\n                                               \r\n                                               \r\n                                             </tr>\r\n                 <tr>\r\n                                                <th scope=\"row\">{{ tmp_ticket_medio[2].SEGMENTO_TTD }}</th>\r\n                                                <td style=\"text-align: right\">{{ tmp_ticket_medio[2].REAL_TM.toLocaleString('pt-BR', {minimumFractionDigits: 0}) }}</td>\r\n                                               \r\n                 </tr>\r\n                                            \r\n                 <tr>\r\n                                                <th scope=\"row\">{{ tmp_ticket_medio[3].SEGMENTO_TTD }}</th>\r\n                                                <td style=\"text-align: right\">{{ tmp_ticket_medio[3].REAL_TM.toLocaleString('pt-BR', {minimumFractionDigits: 0}) }}</td>\r\n                                               \r\n                 </tr>\r\n                                             \r\n               </tbody>\r\n            </table>\r\n         </div>\r\n      </div>\r\n      <h5>\r\n         <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n         Insights\r\n      </h5>\r\n      <ul>\r\n         \r\n      </ul>\r\n      <h5>Nota:</h5>\r\n        <span> Métrica calculada como Faturamento (R$) / # Base de Clientes</span><br>\r\n        <span> Métrica cálculada para Atacado, em relação aos circuitos de conectividade.</span><br>\r\n        \r\n   </div>\r\n</div>\r\n                           \r\n                           \r\n                           \r\n                           \r\n                        </div>\r\n                        <hr>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-lg-6\">\r\n                              <!--Gráfico Ebit-->\r\n                              <div>\r\n                                \r\n                                  <h3 class=\"link_grafico\" id=\"link_ebit\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                        \r\n                                       {% if params.prm_segmento == 'all_' %}\r\n                                         Ebit (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                         Ebit Corporativo (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                        Ebit MPE (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                          Ebit Atacado (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                          Ebit Varejo (R$ MM, M-1)\r\n                                       {% else %}\r\n                                       \r\n                                       {% endif %} \r\n                                       \r\n                                    \r\n                                 </h3>\r\n                                 \r\n                                 <!-- <h3 class=\"link_grafico\" id=\"link_receita_liquida\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                    Receita Líquida (R$ MM, D-1)\r\n                                 </h3> -->\r\n                                 <div>\r\n                                       <div id=\"graficoEbit\"></div>\r\n                                 </div>\r\n                                 <!--<h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                 <ul>\r\n                                    <li>\r\n                                      <small> WIP </small>\r\n                                    </li>-->\r\n                                 </ul>\r\n                                 <h5>Nota:</h5>\r\n                                       <span> Indicador Não Automatizado</span>\r\n                              </div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t \r\n                            <div class=\"col-lg-6\">\r\n                              <!--Gráfico Ebitda-->\r\n                              <div>\r\n                                \r\n                                  <h3 class=\"link_grafico\" id=\"link_ebitda\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                        \r\n                                       {% if params.prm_segmento == 'all_' %}\r\n                                         Ebitda (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                         Ebitda Corporativo (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                        Ebitda MPE (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                          Ebitda Atacado (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                          Ebitda Varejo (R$ MM, M-1)\r\n                                       {% else %}\r\n                                       \r\n                                       {% endif %} \r\n                                       \r\n                                    \r\n                                 </h3>\r\n                                 \r\n                                 <div>\r\n                                       <div id=\"graficoEbitda\"></div>\r\n                                 </div>\r\n                                 <!--<h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                 <ul>\r\n                                    <li>\r\n                                      <small> WIP </small>\r\n                                    </li>\r\n                                 </ul>-->\r\n                                 <h5>Nota:</h5>\r\n                                       <span> Indicador Não Automatizado</span>\r\n                              </div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<hr>\r\n\t\t\t\t\t\t\t<div class=\"row\">\r\n                            <div class=\"col-lg-6\">\r\n                              <!--Gráfico Receita Líquida-->\r\n                              <div>\r\n                                <!--<h3 style=\"text-decoration: underline;\r\n                                     margin-bottom: -10px; text-align: center;\">\r\n                                  Receita Liquida (R$ MM, D-1)\r\n                                 </h3>  -->\r\n                                 <h3 class=\"link_grafico\" id=\"link_receita_liquida\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                   \r\n                                       \r\n                                       {% if params.prm_segmento == 'all_' %}\r\n                                         Receita Liquida (R$ MM, D-1)\r\n                                         {% elif params.prm_segmento == 'CORPORATIVO' %}\r\n                                        Receita Líquida Corporativo (R$ MM, D-1)\r\n                                       {% elif params.prm_segmento == 'EMPRESARIAL' %}\r\n                                        Receita Líquida MPE (R$ MM, M-1)\r\n                                       {% elif params.prm_segmento == 'OPERADORAS' %}\r\n                                          Receita Líquida Atacado (R$ MM, D-1)\r\n                                       {% elif params.prm_segmento == 'RESIDENCIAL' %}\r\n                                          Receita Líquida Varejo (R$ MM, D-1)\r\n                                       {% else %}\r\n                                       \r\n                                       {% endif %}\r\n                                    \r\n                                    \r\n                                 </h3> \r\n                                 <div>\r\n                                       <div id=\"graficoReceitaLiquida\"></div>\r\n                                 </div>\r\n                                 <!--<h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                 <ul>\r\n                                    \r\n                                 </ul>-->\r\n                              </div>\r\n\t\t\t\t\t\t\t</div>\r\n                           \r\n                           \r\n                        \r\n\r\n                        <hr>\r\n                       \r\n                            <div class=\"col-lg-6\">\r\n                              <!--Gráfico Caixa-->\r\n                              <div>\r\n                                 <!--<h3 class=\"link_grafico\" id=\"link_caixa\" style=\"text-decoration: underline;\r\n                                    color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                    Caixa (R$ MM)\r\n                                 </h3>-->\r\n                                 <h3 style=\"text-decoration: underline;\r\n                                     margin-bottom: -10px; text-align: center;\">\r\n                                    Caixa (R$ MM, D-1)\r\n                                 </h3>\r\n                                 <div>\r\n                                       <div id=\"graficoCaixa\"></div>\r\n                                 </div>\r\n                                 <!--<h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                 <ul>\r\n                                    <li>\r\n                                      <small> WIP </small>\r\n                                    </li>\r\n                                 </ul>-->\r\n                              </div>\r\n                              \r\n                           </div>\r\n                        </div>\r\n                           <hr> \r\n                           <div class=\"row\">\r\n                           <div class=\"col-lg-6\">\r\n                              <!--Gráfico Capex-->\r\n                              <div>\r\n                                 <h3 class=\"link_grafico\" id=\"link_capex\" style=\"text-decoration: underline;\r\n                                 color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                    Capex (R$ MM, D-1)\r\n                                 </h3>\r\n                                 <!--<h3  style=\"text-decoration: underline;\r\n                                 margin-bottom: -10px; text-align: center;\">\r\n                                    Capex (R$ MM, D-1)\r\n                                 </h3>-->\r\n                                 <div>\r\n                                       <div id=\"graficoCapex\"></div>\r\n                                 </div>\r\n                                 <!--<h5>\r\n                                    <span style=\"margin-right:5px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                    Insights\r\n                                 </h5>\r\n                                 <ul>\r\n                                    <li>\r\n                                      <small> WIP </small>\r\n                                    </li>\r\n                                 </ul>-->\r\n                              </div>\r\n                              \r\n                          \r\n                           \r\n                        </div>\r\n                        \r\n                            <div class=\"col-lg-6\">\r\n                              <!--Gráfico Opex-->\r\n                              <div>\r\n                                 <h3 style=\"text-decoration: underline;\r\n                                        text-align: center; margin-bottom: -10px;\">\r\n                                          Opex\r\n                                          (R$ MM, D-1)\r\n                                       </h3>\r\n                                       <!--<h3 class=\"link_grafico\" id=\"link_opex\" style=\"text-decoration: underline;\r\n                                       color:#357bb8; margin-bottom: -10px; text-align: center;\">\r\n                                          Opex (# M)\r\n                                       </h3>-->\r\n                                       <div>\r\n                                             <div id=\"graficoOpex\"></div>\r\n                                       </div>\r\n                                       <!--<h5 style=\"margin-top: 5px;\">\r\n                                          <span style=\"margin-right:3px;\" class=\"fa fa-lightbulb-o text-yellow\"></span>\r\n                                          Insights\r\n                                       </h5>\r\n                                       <ul>\r\n                                          <li>\r\n                                            <small> WIP </small>\r\n                                          </li>\r\n                                       </ul>-->\r\n                                    </div>\r\n                           </div>\r\n                        </div>\r\n                        \r\n\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n           \r\n            <!--Fim Cockpit de Indicadores-->\r\n             <!--Highlights-->\r\n             <div class=\"col-lg-13\" style=\"padding-top:\r\n             3%;\">\r\n               <div class=\"ibox-title\" style=\"\r\n                  background-image: linear-gradient(#50E1BC, #50E1BC);\r\n                  border-radius: 10px 10px 0px 0px;\r\n                  \">\r\n                  <div class=\"row\">\r\n                     <div class=\"col-sm-8\">\r\n                        <h3 style=\"color:#363636\">\r\n                           <strong>\r\n                           <i class=\"fa fa-television\" aria-hidden=\"true\"></i>\r\n                           &nbsp;Highlights\r\n                           </strong><small>- WIP</small>\r\n                        </h3>\r\n                     </div>\r\n                     <div class=\"col-sm-4\" style=\"text-align:right;\">\r\n                        <button\r\n                           class=\"btn btn-primary\"\r\n                           type=\"button\"\r\n                           data-toggle=\"collapse\"\r\n                           data-target=\"#multiCollapseExample0\"\r\n                           aria-expanded=\"false\"\r\n                           aria-controls=\"multiCollapseExample0\"\r\n                           style=\"\r\n                           background-color: transparent;\r\n                           background-repeat: no-repeat;\r\n                           border: none;\r\n                           cursor: pointer;\r\n                           overflow: hidden;\r\n                           outline: none;\r\n                           \"\r\n                           >\r\n                           <svg\r\n                              xmlns=\"http://www.w3.org/2000/svg\"\r\n                              width=\"26\"\r\n                              height=\"26\"\r\n                              fill=\"currentColor\"\r\n                              class=\"bi bi-list\"\r\n                              viewBox=\"0 0 16 16\"\r\n                              style=\"color:#363636\"\r\n                              >\r\n                              <path fill-rule=\"evenodd\" d=\"M2.5\r\n                                 12a.5.5\r\n                                 0\r\n                                 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5\r\n                                 0 0\r\n                                 1-.5-.5zm0-4a.5.5 0 0 1\r\n                                 .5-.5h10a.5.5\r\n                                 0 0\r\n                                 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5\r\n                                 0 0\r\n                                 1\r\n                                 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0\r\n                                 1-.5-.5z\"/>\r\n                           </svg>\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class=\"collapse multi-collapse\" id=\"multiCollapseExample0\">\r\n                  <div class=\"card card-body\" style=\"background-color:#dadadafe\">\r\n                     <!-- início carousel-->\r\n                     <div class=\"container text-center my-3\">\r\n                        <div class=\"row mx-auto my-auto\">\r\n                           <div id=\"recipeCarousel\" class=\"carousel slide w-100\" data-ride=\"carousel\">\r\n                              <div class=\"carousel-inner w-100\" role=\"listbox\">\r\n                                 <div class=\"carousel-item active\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_1.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_2.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_3.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_4.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Slot 5-->\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_5.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 \r\n                                 <!-- Slot 6-->\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_6.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                \r\n                                 <!-- Slot 7-->\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_7.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                               \r\n                                 <!-- Slot 8-->\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_8.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                               \r\n                                 <!-- Slot 9\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_9.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 -->\r\n                                 <!-- Slot 10\r\n                                 <div class=\"carousel-item\">\r\n                                    <div class=\"col-md-4\">\r\n                                       <div class=\"card card-body img-container\">\r\n                                          <img class=\"img-fluid\" src=\"/api/content/read/137/highlight_pov_10.png\">\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 -->\r\n                                \r\n                                 \r\n                              </div>\r\n                              <a\r\n                                 class=\"carousel-control-prev w-auto\"\r\n                                 href=\"#recipeCarousel\"\r\n                                 role=\"button\"\r\n                                 data-slide=\"prev\"\r\n                                 >\r\n                              <span class=\"carousel-control-prev-icon bg-dark border border-dark rounded-circle\" aria-hidden=\"true\"></span>\r\n                              <span class=\"sr-only\">Previous</span>\r\n                              </a>\r\n                              <a\r\n                                 class=\"carousel-control-next w-auto\"\r\n                                 href=\"#recipeCarousel\"\r\n                                 role=\"button\"\r\n                                 data-slide=\"next\"\r\n                                 >\r\n                              <span class=\"carousel-control-next-icon bg-dark border border-dark rounded-circle\" aria-hidden=\"true\"></span>\r\n                              <span class=\"sr-only\">Next</span>\r\n                              </a>\r\n                           </div>\r\n                        </div>\r\n                     </div>\r\n                     <!--fim carousel -->\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <!--Fim Highlights-->\r\n            <!--Suporte ao Negócio-->\r\n            <div class=\"col-lg-13\" style=\"padding-top:\r\n               3%;\">\r\n               <div class=\"ibox-title\" style=\"\r\n                  background-image: linear-gradient(#50E1BC, #50E1BC);\r\n                  border-radius: 10px 10px 0px 0px;\r\n                  \">\r\n                  <div class=\"row\">\r\n                     <div class=\"col-sm-6\">\r\n                        <h3 style=\"color:#363636\">\r\n                           <strong>\r\n                              <svg\r\n                                 xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"16\"\r\n                                 height=\"16\"\r\n                                 fill=\"currentColor\"\r\n                                 class=\"bi bi-lightbulb-fill\"\r\n                                 viewBox=\"0 0\r\n                                 16\r\n                                 16\"\r\n                                 >\r\n                                 <path d=\"M2 6a6 6 0 1 1 10.174\r\n                                    4.31c-.203.196-.359.4-.453.619l-.762\r\n                                    1.769A.5.5 0 0 1 10.5 13h-5a.5.5 0\r\n                                    0\r\n                                    1-.46-.302l-.761-1.77a1.964 1.964 0\r\n                                    0\r\n                                    0-.453-.618A5.984 5.984 0 0 1 2\r\n                                    6zm3\r\n                                    8.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0\r\n                                    1l-.224.447a1 1 0 0\r\n                                    1-.894.553H6.618a1\r\n                                    1\r\n                                    0 0 1-.894-.553L5.5 15a.5.5 0 0\r\n                                    1-.5-.5z\"/>\r\n                              </svg>\r\n                              &nbsp; Suporte\r\n                              ao negócio\r\n                           </strong>\r\n                        </h3>\r\n                     </div>\r\n                     <div class=\"col-sm-6\" style=\"text-align:right;\">\r\n                        <button\r\n                           class=\"btn btn-primary\"\r\n                           type=\"button\"\r\n                           data-toggle=\"collapse\"\r\n                           data-target=\"#multiCollapseExample3\"\r\n                           aria-expanded=\"false\"\r\n                           aria-controls=\"multiCollapseExample3\"\r\n                           style=\"\r\n                           background-color: transparent;\r\n                           background-repeat: no-repeat;\r\n                           border: none;\r\n                           cursor: pointer;\r\n                           overflow: hidden;\r\n                           outline: none;\r\n                           \"\r\n                           >\r\n                           <svg\r\n                              xmlns=\"http://www.w3.org/2000/svg\"\r\n                              width=\"26\"\r\n                              height=\"26\"\r\n                              fill=\"currentColor\"\r\n                              class=\"bi bi-list\"\r\n                              viewBox=\"0 0 16 16\"\r\n                              style=\"color:#363636\"\r\n                              >\r\n                              <path fill-rule=\"evenodd\" d=\"M2.5\r\n                                 12a.5.5\r\n                                 0\r\n                                 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5\r\n                                 0 0\r\n                                 1-.5-.5zm0-4a.5.5 0 0 1\r\n                                 .5-.5h10a.5.5\r\n                                 0 0\r\n                                 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5\r\n                                 0 0\r\n                                 1\r\n                                 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0\r\n                                 1-.5-.5z\"/>\r\n                           </svg>\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class=\"collapse multi-collapse\" id=\"multiCollapseExample3\">\r\n                  <div class=\"card card-body\">\r\n                     <ul>\r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa fa-bullhorn\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>\r\n                              Novas\r\n                              Demandas\r\n                              </strong>\r\n                           </h4>\r\n                        </li>\r\n                        <ul>\r\n                           <li>\r\n                              <h4>\r\n                                 link\r\n                                 <small>- WIP</small>\r\n                              </h4>\r\n                           </li>\r\n                        </ul>\r\n                        <br>\r\n                        <li>\r\n                           <h4>\r\n                              <svg\r\n                                 xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"16\"\r\n                                 height=\"16\"\r\n                                 fill=\"currentColor\"\r\n                                 class=\"bi bi-clipboard-plus-fill\"\r\n                                 viewBox=\"0 0 16 16\"\r\n                                 >\r\n                                 <path d=\"M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z\"/>\r\n                                 <path d=\"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm4.5 6V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5a.5.5 0 0 1 1 0Z\"/>\r\n                              </svg>\r\n                              &nbsp;&nbsp;\r\n                              <strong>Campanhas</strong>\r\n                           </h4>\r\n                           <ul>\r\n                              <li>\r\n                                 <h4>\r\n                                    <a href=\"https://contactmanager.algartelecom.com.br/algar-contact-manager/\" target=\"_blank\">\r\n                                    Geração de\r\n                                    Campanhas de Vendas\r\n                                    </a>\r\n                                 </h4>\r\n                              </li>\r\n                              <li>\r\n                                 <h4>\r\n                                    <a href=\"https://jira.algartelecom.com.br/secure/CreateIssue!default.jspa\" target=\"_blank\">\r\n                                    SGD\r\n                                    </a>\r\n                                 </h4>\r\n                              </li>\r\n                           </ul>\r\n                           <br>\r\n                        </li>\r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa fa-list-ol\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>\r\n                              Bibliotecas\r\n                              de Estudo\r\n                              </strong>\r\n                           </h4>\r\n                        </li>\r\n                        <ul>\r\n                           <li>\r\n                              <h4>\r\n                                 <a href=\"http://spotfire.algartelecom.com.br/spotfire/wp/analysis?file=/Menu%20Central\" target=\"_blank\">\r\n                                 Menu\r\n                                 Spotfire\r\n                                 </a>\r\n                              </h4>\r\n                           </li>\r\n                        </ul>\r\n                     </ul>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <!--Fim Suporte ao Negócio-->\r\n            <!--Governança de Dados-->\r\n            <div class=\"col-lg-13\" style=\"padding-top:\r\n               3%;\">\r\n               <div class=\"ibox-title\" style=\"\r\n                  background-image:\r\n                  linear-gradient(#50E1BC, #50E1BC);\r\n                  border-radius: 10px 10px 0px 0px;\r\n                  \">\r\n                  <div class=\"row\">\r\n                     <div class=\"col-sm-6\">\r\n                        <h3 style=\"color:#363636\">\r\n                           <strong>\r\n                              <svg\r\n                                 xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"16\"\r\n                                 height=\"16\"\r\n                                 fill=\"currentColor\"\r\n                                 class=\"bi bi-bank2\"\r\n                                 viewBox=\"0 0 16 16\"\r\n                                 >\r\n                                 <path d=\"M8.277.084a.5.5\r\n                                    0\r\n                                    0 0-.554 0l-7.5\r\n                                    5A.5.5\r\n                                    0 0 0 .5\r\n                                    6h1.875v7H1.5a.5.5\r\n                                    0\r\n                                    0\r\n                                    0 0 1h13a.5.5 0 1\r\n                                    0\r\n                                    0-1h-.875V6H15.5a.5.5\r\n                                    0\r\n                                    0 0\r\n                                    .277-.916l-7.5-5zM12.375\r\n                                    6v7h-1.25V6h1.25zm-2.5\r\n                                    0v7h-1.25V6h1.25zm-2.5\r\n                                    0v7h-1.25V6h1.25zm-2.5\r\n                                    0v7h-1.25V6h1.25zM8\r\n                                    4a1\r\n                                    1 0 1 1 0-2 1 1 0\r\n                                    0\r\n                                    1 0\r\n                                    2zM.5 15a.5.5 0 0\r\n                                    0\r\n                                    0\r\n                                    1h15a.5.5 0 1 0\r\n                                    0-1H.5z\"/>\r\n                              </svg>\r\n                              &nbsp;\r\n                              Governança\r\n                              de Dados\r\n                           </strong>\r\n                        </h3>\r\n                     </div>\r\n                     <div class=\"col-sm-6\" style=\"text-align:right;\">\r\n                        <button\r\n                           class=\"btn\r\n                           btn-primary\"\r\n                           type=\"button\"\r\n                           data-toggle=\"collapse\"\r\n                           data-target=\"#multiCollapseExample1\"\r\n                           aria-expanded=\"false\"\r\n                           aria-controls=\"multiCollapseExample1\"\r\n                           style=\"\r\n                           background-color:\r\n                           transparent;\r\n                           background-repeat:\r\n                           no-repeat;\r\n                           border: none;\r\n                           cursor: pointer;\r\n                           overflow: hidden;\r\n                           outline: none;\r\n                           \"\r\n                           >\r\n                           <svg\r\n                              xmlns=\"http://www.w3.org/2000/svg\"\r\n                              width=\"26\"\r\n                              height=\"26\"\r\n                              fill=\"currentColor\"\r\n                              class=\"bi bi-list\"\r\n                              viewBox=\"0 0 16 16\"\r\n                              style=\"color:#363636\"\r\n                              >\r\n                              <path fill-rule=\"evenodd\" d=\"M2.5 12a.5.5 0\r\n                                 0\r\n                                 1\r\n                                 .5-.5h10a.5.5 0 0\r\n                                 1\r\n                                 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5zm0-4a.5.5\r\n                                 0\r\n                                 0 1\r\n                                 .5-.5h10a.5.5 0 0\r\n                                 1\r\n                                 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5zm0-4a.5.5\r\n                                 0\r\n                                 0 1\r\n                                 .5-.5h10a.5.5 0 0\r\n                                 1\r\n                                 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5z\"/>\r\n                           </svg>\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class=\"collapse\r\n                  multi-collapse\" id=\"multiCollapseExample1\">\r\n                  <div class=\"card card-body\">\r\n                     <ul>\r\n                        \r\n                        \r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa\r\n                                 fa-unlock\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>\r\n                              Solicite\r\n                              Seu Acesso\r\n                              </strong>\r\n                           </h4>\r\n                           <ul>\r\n                              <li>\r\n                                 <h4>\r\n                                    <a href=\"https://acessos.algartelecom.com.br/pt/search/selfService/entitlement/e2318499-b573-45ce-bd26-9a566efa6641\" target=\"_blank\">Blazon</a>\r\n                                    </h5>\r\n                                 </h4>\r\n                              </li>\r\n                              <li>\r\n                                 <h4>\r\n                                    <a href=\"https://algarnet-my.sharepoint.com/:p:/r/personal/paulo_junior_algartelecom_com_br/_layouts/15/Doc.aspx?sourcedoc=%7B93FF8238-CE1E-4856-9830-C62FB99F650C%7D&file=Acessos%20Analytics.pptx&wdOrigin=TEAMS-ELECTRON.p2p.bim&_DSL=1&action=edit&mobileredirect=true\" target=\"_blank\">\r\n                                    Passo\r\n                                    a\r\n                                    Passo\r\n                                    </a>\r\n                                 </h4>\r\n                              </li>\r\n                           </ul>\r\n                           <br>\r\n                        </li>\r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa\r\n                                 fa-area-chart\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>\r\n                              Gestão\r\n                              de Plataformas\r\n                              </strong>\r\n                           </h4>\r\n                        </li>\r\n                        <ul>\r\n                           <li>\r\n                              <h4>\r\n                                Spotfire <small> - WIP</small>\r\n                                 <!--<a href=\"http://spotfire.algartelecom.com.br/spotfire/wp/analysis?file=/Menu%20Central\" target=\"_blank\">Spotfire</a>-->\r\n                              </h4>\r\n                           </li>\r\n                           <li>\r\n                              <h4>\r\n                                GAIO <small>- WIP</small>\r\n                                 <!--<a href=\"http://spotfire.algartelecom.com.br/spotfire/wp/analysis?file=/Menu%20Central\" target=\"_blank\">Gaio</a>-->\r\n                              </h4>\r\n                           </li>\r\n                        </ul>\r\n                     </ul>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <!--Fim Governança-->\r\n            <!--Sobre nós-->\r\n            <div class=\"col-lg-13\" style=\"padding-top:\r\n               3%;\">\r\n               <div class=\"ibox-title\" style=\"\r\n                  background-image:\r\n                  linear-gradient(#50E1BC,\r\n                  #50E1BC);\r\n                  border-radius: 10px 10px 0px\r\n                  0px;\">\r\n                  <div class=\"row flex-row flex-wrap\">\r\n                     <div class=\"col-sm-6\">\r\n                        <h3 style=\"color:#363636\">\r\n                           <strong>\r\n                              <svg\r\n                                 xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"16\"\r\n                                 height=\"16\"\r\n                                 fill=\"currentColor\"\r\n                                 class=\"bi\r\n                                 bi-question-circle-fill\"\r\n                                 viewBox=\"0 0 16\r\n                                 16\"\r\n                                 >\r\n                                 <path d=\"M16 8A8\r\n                                    8 0\r\n                                    1\r\n                                    1 0 8a8 8 0 0\r\n                                    1\r\n                                    16\r\n                                    0zM5.496\r\n                                    6.033h.825c.138\r\n                                    0\r\n                                    .248-.113.266-.25.09-.656.54-1.134\r\n                                    1.342-1.134.686\r\n                                    0\r\n                                    1.314.343\r\n                                    1.314\r\n                                    1.168 0\r\n                                    .635-.374.927-.965\r\n                                    1.371-.673.489-1.206\r\n                                    1.06-1.168\r\n                                    1.987l.003.217a.25.25\r\n                                    0 0 0\r\n                                    .25.246h.811a.25.25\r\n                                    0 0 0\r\n                                    .25-.25v-.105c0-.718.273-.927\r\n                                    1.01-1.486.609-.463\r\n                                    1.244-.977\r\n                                    1.244-2.056\r\n                                    0-1.511-1.276-2.241-2.673-2.241-1.267\r\n                                    0-2.655.59-2.75\r\n                                    2.286a.237.237\r\n                                    0\r\n                                    0 0\r\n                                    .241.247zm2.325\r\n                                    6.443c.61 0\r\n                                    1.029-.394\r\n                                    1.029-.927\r\n                                    0-.552-.42-.94-1.029-.94-.584\r\n                                    0-1.009.388-1.009.94\r\n                                    0 .533.425.927\r\n                                    1.01.927z\"/>\r\n                              </svg>\r\n                              &nbsp;\r\n                              Sobre\r\n                              nós\r\n                           </strong>\r\n                        </h3>\r\n                     </div>\r\n                     <div class=\"col-sm-6\" style=\"text-align:right\">\r\n                        <button\r\n                           class=\"btn\r\n                           btn-primary\"\r\n                           type=\"button\"\r\n                           data-toggle=\"collapse\"\r\n                           data-target=\"#multiCollapseExample5\"\r\n                           aria-expanded=\"false\"\r\n                           aria-controls=\"multiCollapseExample5\"\r\n                           style=\"\r\n                           background-color:\r\n                           transparent;\r\n                           background-repeat:\r\n                           no-repeat;\r\n                           border: none;\r\n                           cursor: pointer;\r\n                           overflow: hidden;\r\n                           outline: none;\r\n                           \"\r\n                           >\r\n                           <svg\r\n                              xmlns=\"http://www.w3.org/2000/svg\"\r\n                              width=\"26\"\r\n                              height=\"26\"\r\n                              fill=\"currentColor\"\r\n                              class=\"bi\r\n                              bi-list\"\r\n                              viewBox=\"0 0 16\r\n                              16\"\r\n                              style=\"color:#363636\"\r\n                              >\r\n                              <path fill-rule=\"evenodd\" d=\"M2.5\r\n                                 12a.5.5 0\r\n                                 0\r\n                                 1\r\n                                 .5-.5h10a.5.5\r\n                                 0\r\n                                 0\r\n                                 1 0 1H3a.5.5 0\r\n                                 0\r\n                                 1-.5-.5zm0-4a.5.5\r\n                                 0\r\n                                 0 1\r\n                                 .5-.5h10a.5.5\r\n                                 0\r\n                                 0 1 0 1H3a.5.5\r\n                                 0\r\n                                 0\r\n                                 1-.5-.5zm0-4a.5.5\r\n                                 0\r\n                                 0 1\r\n                                 .5-.5h10a.5.5\r\n                                 0\r\n                                 0 1 0 1H3a.5.5\r\n                                 0\r\n                                 0\r\n                                 1-.5-.5z\"/>\r\n                           </svg>\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class=\"collapse\r\n                  multi-collapse\" id=\"multiCollapseExample5\">\r\n                  <div class=\"card\r\n                     card-body\">\r\n                     <ul>\r\n                        <div>\r\n                           <li>\r\n                              <a data-toggle=\"modal\" data-target=\"#imgAmpliada\">\r\n                                 <h4 style=\"color:#337AB7\">\r\n                                    <i class=\"fa\r\n                                       fa-bullhorn\" aria-hidden=\"true\"></i>\r\n                                    &nbsp;&nbsp;\r\n                                    <strong>\r\n                                    Quem\r\n                                    Somos\r\n                                    ?\r\n                                    </strong>\r\n                                 </h4>\r\n                           </li>\r\n                           </a>\r\n                        </div>\r\n                        <br>\r\n                        <a href=\"https://algarnet-my.sharepoint.com/:p:/r/personal/lucianom_algartelecom_com_br/Documents/Assessment%20Portugal%202030.pptx?d=we33a6f79d4c646a09b11fabf4db0c93e&csf=1&web=1&e=9akGah\" target=\"_blank\">\r\n                           <li>\r\n                              <h4>\r\n                                 <i class=\"fa\r\n                                    fa-book\" aria-hidden=\"true\"></i>\r\n                                 &nbsp;&nbsp;\r\n                                 <strong>\r\n                                 Como\r\n                                 Operamos\r\n                                 ?\r\n                                 </strong>\r\n                              </h4>\r\n                        </a>\r\n                        <br>\r\n                        </li>\r\n                        <li>\r\n                           <h4>\r\n                              <strong>\r\n                              <i class=\"fa\r\n                                 fa-thumbs-up\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;Avalie\r\n                              nosso Time\r\n                              </strong>\r\n                              <small>\r\n                              -\r\n                              WIP\r\n                              </small>\r\n                           </h4>\r\n                        </li>\r\n                     </ul>\r\n                     <!--modal-->\r\n                     <div\r\n                        class=\"modal\r\n                        inmodal\"\r\n                        id=\"imgAmpliada\"\r\n                        tabindex=\"-1\"\r\n                        role=\"dialog\"\r\n                        aria-hidden=\"true\"\r\n                        >\r\n                        <div class=\"modal-dialog\r\n                           modal-lg\">\r\n                           <div class=\"modal-content\r\n                              animated\r\n                              fadeIn\">\r\n                              <div class=\"modal-header\">\r\n                                 <h4 class=\"modal-title\">\r\n                                    <a href=\"https://algarnet-my.sharepoint.com/:p:/r/personal/lucianom_algartelecom_com_br/Documents/Assessment%20Portugal%202030.pptx?d=we33a6f79d4c646a09b11fabf4db0c93e&csf=1&web=1&e=9akGah\" target=\"_blank\">\r\n                                    Clique\r\n                                    para\r\n                                    ver\r\n                                    nossa\r\n                                    estrutura!\r\n                                    </a>\r\n                                 </h4>\r\n                              </div>\r\n                              <div class=\"modal-body\">\r\n                                 <img src=\"/api/content/read/137/time.png\" width=\"100%\">\r\n                              </div>\r\n                              <div class=\"modal-footer\">\r\n                                 <button type=\"button\" class=\"btn\r\n                                    btn-white\" data-dismiss=\"modal\">Fechar</button>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <!--Cultura de Dados-->\r\n            <div class=\"col-lg-13\" style=\"padding-top: 3%;\">\r\n               <div class=\"ibox-title\" style=\"\r\n                  background-image: linear-gradient(#50E1BC,\r\n                  #50E1BC);\r\n                  border-radius: 10px 10px 0px 0px;\r\n                  \">\r\n                  <div class=\"row\">\r\n                     <div class=\"col-sm-6\">\r\n                        <h3 style=\"color:#363636\">\r\n                           <strong>\r\n                              <svg\r\n                                 xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"16\"\r\n                                 height=\"16\"\r\n                                 fill=\"currentColor\"\r\n                                 class=\"bi\r\n                                 bi-journal-bookmark\"\r\n                                 viewBox=\"0\r\n                                 0\r\n                                 16\r\n                                 16\"\r\n                                 >\r\n                                 <path fill-rule=\"evenodd\" d=\"M6\r\n                                    8V1h1v6.117L8.743 6.07a.5.5 0\r\n                                    0\r\n                                    1\r\n                                    .514 0L11 7.117V1h1v7a.5.5 0\r\n                                    0\r\n                                    1-.757.429L9 7.083 6.757\r\n                                    8.43A.5.5\r\n                                    0 0 1 6 8z\"/>\r\n                                 <path d=\"M3 0h10a2 2 0 0 1 2\r\n                                    2v12a2\r\n                                    2 0 0 1-2 2H3a2 2 0 0\r\n                                    1-2-2v-1h1v1a1 1 0 0 0 1\r\n                                    1h10a1\r\n                                    1 0 0 0 1-1V2a1 1 0 0\r\n                                    0-1-1H3a1\r\n                                    1 0 0 0-1 1v1H1V2a2 2 0 0\r\n                                    1\r\n                                    2-2z\"/>\r\n                                 <path d=\"M1 5v-.5a.5.5 0 0\r\n                                    1\r\n                                    1\r\n                                    0V5h.5a.5.5 0 0 1 0\r\n                                    1h-2a.5.5\r\n                                    0 0 1 0-1H1zm0\r\n                                    3v-.5a.5.5\r\n                                    0 0\r\n                                    1 1 0V8h.5a.5.5 0 0 1 0\r\n                                    1h-2a.5.5 0 0 1\r\n                                    0-1H1zm0\r\n                                    3v-.5a.5.5 0 0 1 1\r\n                                    0v.5h.5a.5.5 0 0 1 0\r\n                                    1h-2a.5.5 0 0 1\r\n                                    0-1H1z\"/>\r\n                              </svg>\r\n                              &nbsp; Cultura de\r\n                              Dados\r\n                           </strong>\r\n                        </h3>\r\n                     </div>\r\n                     <div class=\"col-sm-6\" style=\"text-align:right;\">\r\n                        <button\r\n                           class=\"btn btn-primary\"\r\n                           type=\"button\"\r\n                           data-toggle=\"collapse\"\r\n                           data-target=\"#multiCollapseExample2\"\r\n                           aria-expanded=\"false\"\r\n                           aria-controls=\"multiCollapseExample2\"\r\n                           style=\"\r\n                           background-color:\r\n                           transparent;\r\n                           background-repeat: no-repeat;\r\n                           border: none;\r\n                           cursor: pointer;\r\n                           overflow: hidden;\r\n                           outline: none;\r\n                           \"\r\n                           >\r\n                           <svg\r\n                              xmlns=\"http://www.w3.org/2000/svg\"\r\n                              width=\"26\"\r\n                              height=\"26\"\r\n                              fill=\"currentColor\"\r\n                              class=\"bi\r\n                              bi-list\"\r\n                              viewBox=\"0 0 16\r\n                              16\"\r\n                              style=\"color:#363636\"\r\n                              >\r\n                              <path fill-rule=\"evenodd\" d=\"M2.5 12a.5.5 0 0 1\r\n                                 .5-.5h10a.5.5 0 0 1 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5zm0-4a.5.5 0 0 1\r\n                                 .5-.5h10a.5.5 0 0 1 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5zm0-4a.5.5 0 0 1\r\n                                 .5-.5h10a.5.5 0 0 1 0\r\n                                 1H3a.5.5 0 0\r\n                                 1-.5-.5z\"/>\r\n                           </svg>\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class=\"collapse multi-collapse\" id=\"multiCollapseExample2\">\r\n                  <div class=\"card card-body\">\r\n                     <ul>\r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa\r\n                                 fa-sort-alpha-asc\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>\r\n                              ABC\r\n                              de Dados\r\n                              </strong>\r\n                           </h4>\r\n                        </li>\r\n                        <ul>\r\n                           <li>\r\n                              <h4>\r\n                                 link\r\n                                 <small>- WIP</small>\r\n                              </h4>\r\n                           </li>\r\n                        </ul>\r\n                        <br>\r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa\r\n                                 fa-search\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>Pesquisa</strong>\r\n                           </h4>\r\n                           <ul>\r\n                              <li>\r\n                                 <h4>\r\n                                    Link\r\n                                    <small>\r\n                                    -\r\n                                    WIP\r\n                                    </small>\r\n                                 </h4>\r\n                              </li>\r\n                           </ul>\r\n                           <br>\r\n                        </li>\r\n                        <li>\r\n                           <h4>\r\n                              <i class=\"fa\r\n                                 fa-newspaper-o\" aria-hidden=\"true\"></i>\r\n                              &nbsp;&nbsp;\r\n                              <strong>Newslatter</strong>\r\n                           </h4>\r\n                        </li>\r\n                        <ul>\r\n                           <li>\r\n                              <h4>\r\n                                 Link\r\n                                 <small>- WIP</small>\r\n                              </h4>\r\n                           </li>\r\n                        </ul>\r\n                     </ul>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <!--Fim Cultura de Dados-->\r\n            <!---->\r\n         </div>\r\n         <!--Fim Sobre nós-->\r\n         \r\n         <!--Whatsapp-->\r\n         <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css\">\r\n         <div class=\"small-chat-box fadeInRight animated\">\r\n            <div class=\"heading\" draggable=\"true\">\r\n               <small class=\"chat-date float-right\">\r\n               2023\r\n               </small>\r\n               <img  src=\"/api/content/read/137/icon_ana_ly.png\"\r\n                                    id=\"image-analy\" style=\"width:60px;height:50px\"> Analy\r\n            </div>\r\n            <div class=\"content\">\r\n               <div class=\"left\">\r\n                  <div class=\"author-name\">\r\n                     Analy <small class=\"chat-date\">\r\n                     \r\n                     </small>\r\n                  </div>\r\n                  <div class=\"chat-message active\">\r\n                     Olá, sou a Analy e futuramente será possível conversar comigo, por meio desse chat!\r\n                  </div>\r\n               </div>\r\n               <div class=\"right\">\r\n                  <div class=\"author-name\">\r\n                     Usuário\r\n                     <small class=\"chat-date\">\r\n                     \r\n                     </small>\r\n                  </div>\r\n                  <div class=\"chat-message\">\r\n                     Como poderei utilizar esse chat ?\r\n                  </div>\r\n               </div>\r\n               <div class=\"left\">\r\n                  <div class=\"author-name\">\r\n                    Analy\r\n                     <small class=\"chat-date\">\r\n                     \r\n                     </small>\r\n                  </div>\r\n                  <div class=\"chat-message active\">\r\n                     Poderei tirar dúvidas a respeito da página, como funcionamentos e indicadores!\r\n                  </div>\r\n               </div>\r\n               \r\n               \r\n            </div>\r\n            <div class=\"form-chat\">\r\n               <div class=\"input-group input-group-sm\">\r\n                  <input type=\"text\" class=\"form-control\">\r\n                  <span class=\"input-group-btn\"> <button\r\n                     class=\"btn btn-primary\" type=\"button\">Send\r\n                  </button> </span>\r\n               </div>\r\n            </div>\r\n         </div>\r\n         <div id=\"small-chat\">\r\n            <span class=\"badge badge-warning float-right\">1</span>\r\n            <a class=\"open-small-chat\" href=\"\">\r\n                \r\n            <i class=\"fa fa-comments\"></i>\r\n            <!--<img class=\"d-block w-100\" src=\"/api/content/read/22/analy.png\"\r\n            id=\"image-analy\" >-->\r\n            </a>\r\n         </div>\r\n         <!--fim box-->\r\n      </div>\r\n   </div>\r\n   <!-- Mainly scripts -->\r\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\r\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\r\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\r\n   <!-- Custom and plugin javascript -->\r\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\r\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\r\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n   <script>\r\n   \r\n      fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n      \r\n      async function carregando() {\r\n\t\t\t  var carrega = document.getElementById(\"carregando\");\r\n              carrega.style.display = \"block\";\r\n              await sleep(5000);\r\n              carrega.style.display = \"none\";\r\n              \r\n          };  \r\n      \r\n      //função para criar um tempo até para rodar\r\n      function sleep(ms) {\r\n          return new Promise(resolve => setTimeout(resolve, ms));\r\n      }\r\n      \r\n      \r\n      var dadosNLP = Array(0);\r\nvar insights_final = Array(0);\r\n\r\nfetch('https://gaio.algartelecom.com.br/api/rest/pnaVxMEfqPVKHAzwmBbkkeB_wtmUQqJh/tmp_hom_processa_nlp/?filtro_api_id_nlp=all_')\r\n.then(response => {\r\n    return response.json();\r\n})\r\n.then(data => {\r\n    dadosNLP = data;\r\n\r\n});\r\n\r\n\r\n\r\nlet dia_um = 0;\r\n\r\nif(context.params.dia_mes == 1){\r\n    dia_um = 1;\r\n}\r\n\r\n\r\n\r\n(async () => {\r\n    await sleep(4000);\r\n    \r\n    insights_final = dadosNLP.filter(dadosNLP => (dadosNLP.id_insight == 2000));\r\n    \r\n    for (var i = 0; i < dadosNLP.length; i++) {\r\n        switch (dadosNLP[i].id_insight.substring(0, 2)) {\r\n          case '10':\r\n            if(dadosNLP[i].metrica.match('Venda')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_csl_vnd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Perda de Receita Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_csl_prd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Base de Clientes Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_csl_cli').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '20':\r\n            if(dadosNLP[i].metrica.match('Venda')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_crp_vnd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }    \r\n            else if(dadosNLP[i].metrica.match('Perda de Receita Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_crp_prd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Base de Clientes Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_crp_cli').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '21':\r\n            if(dadosNLP[i].metrica.match('Venda')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_emp_vnd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Perda de Receita Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_emp_prd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Base de Clientes Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_emp_cli').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '22':\r\n            if(dadosNLP[i].metrica.match('Venda')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_res_vnd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Perda de Receita Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_res_prd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Base de Clientes Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_res_cli').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '23':\r\n            if(dadosNLP[i].metrica.match('Venda')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_ope_vnd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Perda de Receita Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_ope_prd').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            else if(dadosNLP[i].metrica.match('Base de Clientes Mensal')){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                $('#result_insights_ope_cli').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          default:\r\n            console.log('Erro.');\r\n        }\r\n        \r\n        \r\n        \r\n        \r\n    }\r\n\r\n})();\r\n      \r\n       //entra no ebit\r\n      $(\"#item_menu_ebit\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      \r\n      \r\n      \r\n       //entra no ebitda\r\n      $(\"#item_menu_ebitda\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      \r\n        //entra no margem contribuiçao\r\n      $(\"#item_menu_margem_contribuicao\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Margem Contribuição Mensal', 'Receita Liquida Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      \r\n        //entra na receita bruta\r\n      $(\"#item_menu_receita-bruta\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Bruta Mensal','Receita Bruta'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n    \r\n      \r\n      \r\n      \r\n        //entra na receita liquida\r\n      $(\"#item_menu_receita-liquida\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n    \r\n      \r\n      \r\n      \r\n    \r\n      \r\n      \r\n      //entra no base clientes\r\n      $(\"#item_menu_base_cliente\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      //entra no base contratos\r\n      $(\"#item_menu_base_contrato\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n          await sleep(5000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //entra no base venda\r\n      /*$(\"#item_menu_venda\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n                      });*/\r\n                      \r\n\r\n      //entra no base Faturamento (Ticket Medio)\r\n      $(\"#item_menu_faturamento\").click(async function() {\r\n           await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      \r\n       });\r\n            \r\n      //entra no base migrações entrantes\r\n      $(\"#item_menu_migracoes_entrantes\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Entrante', 'Migração Entrante Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      //entra no base migrações saintes\r\n      $(\"#item_menu_migracoes_saintes\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Sainte', 'Migração Sainte Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      //entra no base churn fisico\r\n      $(\"#item_menu_churn_fisico\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Churn Físico', 'Churn Físico Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      //entra no base perda de receita\r\n      $(\"#item_menu_perda_receita\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      \r\n      \r\n      //Menu de Gráficos\r\n      //Gráfico Venda\r\n      $(\"#link_grafico_venda\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      //Gráfico Contratos\r\n      $(\"#link_grafico_contratos\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n        await sleep(5000);\r\n        await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //entra no base Faturamento (Ticket Medio)\r\n      $(\"#link_arpu\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //Gárafico Migrações Entrantes\r\n      \r\n      $(\"#link_migracoes_entrantes\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Entrante', 'Migração Entrante Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //Gráfico Migrações Saintes\r\n      $(\"#link_migracoes_saintes\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Sainte', 'Migração Sainte Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //Churn Churn Fisico\r\n      $(\"#link_churn_fisico\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Churn Físico', 'Churn Físico Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //Gráfico Perda Receita\r\n      $(\"#link_perda_receita\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      //Gráfico Base cliente\r\n      $(\"#link_base_cliente\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(1000);\r\n          await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await carregando();\r\n          await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      //Gráfico Ebit\r\n      $(\"#link_ebit\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        //await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n         // await sleep(1000);\r\n         // await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          //await carregando();\r\n          //await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n       //Gráfico Ebitda\r\n      $(\"#link_ebitda\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n        params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                 { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                 { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n        await sleep(2000);\r\n        //await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n         // await sleep(1000);\r\n         // await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          //await carregando();\r\n          //await sleep(1000);\r\n        await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n      \r\n      \r\n       //Gráfico Receita Liquida\r\n      $(\"#link_receita_liquida\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n       //Gráfico Fluxo de Caixa\r\n      $(\"#item_menu_caixa\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Mensal','Fluxo de Caixa'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n       //Gráfico Recebimento\r\n      $(\"#item_menu_recebimento\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Recebimentos de Caixa Mensal','Recebimentos de Caixa'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n       //Gráfico Fluxo de Caixa Livre\r\n      $(\"#item_caixa_livre\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Livre Mensal','Fluxo de Caixa Livre'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n      });\r\n      \r\n       //Gráfico Receita Liquida\r\n      $(\"#link_capex\").click(async function() {\r\n        await carregando();\r\n        await sleep(2000);\r\n        await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['CAPEX', 'CAPEX Mensal']}] });\r\n       });\r\n      \r\n      \r\n      \r\n      // Botão que leva ao indicador Desempenho Projetos\r\n             $(\"#item_menu_desempenho_projeto\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3400, formType: 'openFlow', params: [{}] });\r\n              });\r\n      // Botão que leva ao indicador CAPEX\r\n             $(\"#item_menu_capex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['CAPEX', 'CAPEX Mensal']}] });\r\n              });\r\n      // Botão que leva ao indicador CAPEX\r\n             $(\"#item_menu_opex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['OPEX', 'OPEX Mensal']}] });\r\n              });\r\n      \r\n      \r\n      \r\n          \r\n          $(\"#item_menu_venda_consolidada\").click(async function() {\r\n          await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          //await sleep(2000);\r\n          //await fetch('https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          //await sleep(1000);\r\n          //await fetch('https://gaio.algartelecom.com.br/api/rest/HNfEksBvFQmEowYpsquUWUtaeoRZVLHK/tb_insights_externa/?api_tabela_inproject=https://gaio.algartelecom.com.br/api/rest/bGjcuXEJpwQOqWbzPnKigPoCvjOreROX/api_insights/');\r\n          await sleep(2000);\r\n          await carregando();\r\n          await sleep(1000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}]  });\r\n                      });\r\n          \r\n          \r\n      \r\n      \r\n      //limpa filtro\r\n      $(\"#limpar_filtro\").click(function () {\r\n          dispatchEvent(\r\n              {\r\n                  formFlowId: 1809,\r\n                  formType: 'loadFlow',\r\n                  params: [{ paramName: 'Mes_Ref', paramValue: 'all_' }]\r\n      \r\n              })\r\n      });\r\n      \r\n      //filtro\r\n      $(\"#filtrar\").click(function () {\r\n          dispatchEvent(\r\n              {\r\n                  formId: 'QylXyg'\r\n              })\r\n      });\r\n      \r\n        \r\n      \r\n      //Opções gerais do BarChart\r\n      var optionsBarChart = {\r\n      series: [{\r\n      name: \"Orçado\",\r\n      data: [{% for item in tmp_men_clientes %}\r\n            {{ item.ORCADO }},\r\n              {% endfor %}]\r\n      \r\n      },\r\n      {\r\n      name: \"Real\",\r\n      data: [{% for item in tmp_men_clientes %}\r\n            {{ item.REAL }},\r\n              {% endfor %}]\r\n      \r\n      }],\r\n      \r\n      chart: {\r\n      height: 350,\r\n      type: 'bar',\r\n      zoom: {\r\n      enabled: false\r\n      },\r\n      toolbar: {\r\n        show: false\r\n      }\r\n      },\r\n      \r\n      legend: {\r\n      show: true,\r\n      position: 'bottom',\r\n      horizontalAlign: 'center', \r\n      fontSize: '14px',\r\n      fontFamily: 'Helvetica, Arial',\r\n      fontWeight: 400,\r\n      markers: {\r\n       width: 12,\r\n       height: 12,\r\n       strokeWidth: 0,\r\n       strokeColor: '#fff',\r\n       fillColors: ['#008FFB', '#00E396'],\r\n       radius: 12,\r\n      },\r\n      itemMargin: {\r\n       horizontal: 5,\r\n       vertical: 0\r\n      },\r\n      onItemClick: {\r\n       toggleDataSeries: true\r\n      },\r\n      onItemHover: {\r\n       highlightDataSeries: true\r\n      },\r\n      },\r\n      \r\n      dataLabels: {\r\n      enabled: true,\r\n      style: {\r\n             fontSize: '9px',\r\n             fontWeight: 'bold',\r\n             colors: ['black'],\r\n      },\r\n      background: {\r\n         enabled: false,\r\n         foreColor: '#000',\r\n         borderRadius: 2,\r\n         padding: 4,\r\n         opacity: 0.9,\r\n         borderWidth: 1,\r\n         borderColor: '#fff'\r\n       }, \r\n      offsetY: -15,\r\n      formatter: function (value) {\r\n        return (value/1000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      plotOptions: {\r\n       bar: {\r\n         horizontal: false,\r\n         borderRadius: 2,\r\n         dataLabels: {\r\n           position: 'top',\r\n           \r\n             \r\n         },\r\n       },\r\n       \r\n      },\r\n      \r\n      yaxis: {\r\n      grid: {\r\n        show: false,\r\n        stokeDashArray: 0,\r\n      },\r\n      labels: {\r\n        show: false,\r\n        formatter: function (value) {\r\n        return (value/1000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      },\r\n      stroke: {\r\n      curve: 'straight',\r\n      colors: [\"transparent\"],\r\n      width: 2\r\n      },\r\n      fill: {\r\n      colors: ['#008FFB', '#00E396'],\r\n      opacity: 1\r\n      },\r\n      grid: {\r\n      show: false,\r\n      axis: {\r\n        lines: {\r\n            show: false\r\n        }\r\n      },\r\n      yaxis: {\r\n        lines: {\r\n            show: false\r\n        }\r\n      }\r\n      },\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_clientes %}\r\n            '{{ item.DIA }}',\r\n            '{{ item.DIA }}',\r\n          {% endfor %}],\r\n      grid: {\r\n        show: false,\r\n        stokeDashArray: 0,\r\n      },\r\n      }\r\n      };\r\n      \r\n      // GRAFICOS DE LINHAS\r\n         var optionsLineChart= {\r\n         series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_dia %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         chart: {\r\n         height: 350,\r\n         type: 'area',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            /*fillColors: ['#008FFB', '#00E396'],*/\r\n            fillColors: ['#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         dataLabels: {\r\n         enabled: false\r\n         \r\n         },\r\n         \r\n         yaxis: {\r\n            tickAmount: 5,\r\n             \r\n         labels: {\r\n             show: true,\r\n             formatter: function (value) {\r\n             return (value/1000).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0});\r\n           },\r\n         },\r\n         \r\n          axisBorder: {\r\n              show: true,\r\n              color: '#000000',\r\n              offsetX: 0,\r\n              offsetY: 0\r\n          },\r\n          axisTicks: {\r\n              show: true,\r\n              borderType: 'solid',\r\n              color: '#000000',\r\n              width: 6,\r\n              offsetX: 0,\r\n              offsetY: 0\r\n          },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         width: 3\r\n         },\r\n         \r\n         /*colors: ['#008FFB', '#00E396'],*/\r\n         colors: ['#00E396'],\r\n          dataLabels: {\r\n            enabled: false,\r\n         },\r\n         grid: {\r\n         show: true,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n            \r\n            \r\n             lines: {\r\n                 show: false\r\n             }\r\n             \r\n         }\r\n         },\r\n         markers: {\r\n            size: 5\r\n         },\r\n         markers: {\r\n            size: 0,\r\n        },\r\n         xaxis: {\r\n            \r\n            tickAmount: 10,\r\n             tickPlacement: 'between',\r\n            \r\n            \r\n         categories: [{% for item in tmp_csl_dia %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         \r\n         }\r\n         };\r\n      \r\n      // GRÁFICO VENDA MENSAL\r\n      var optionsVenda = {\r\n      series: [/*{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_venda %}\r\n             {{ item.ORCADO_ACU }},\r\n               {% endfor %}]\r\n      },*/\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_venda %}\r\n             {{ item.REAL_ACU }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n        \r\n      categories: [{% for item in tmp_men_venda %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              \r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            },\r\n            \r\n            \r\n      };\r\n      \r\n      var chartgraficoVenda = new ApexCharts(document.querySelector(\"#graficoVenda\"), optionsLineChart);\r\n      chartgraficoVenda.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoVenda.updateOptions(optionsVenda)\r\n      }, 1);\r\n      \r\n      // GRÁFICO Receita Líquida\r\n    var optionsReceitaLiquida = {\r\n      series: [{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_receita_liq %}\r\n             {{ item.ORCADO }},\r\n               {% endfor %}]\r\n      \r\n      },\r\n      \r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_receita_liq %}\r\n             {{ item.REAL }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      yaxis: {\r\n      grid: {\r\n        show: false,\r\n        stokeDashArray: 0,\r\n      },\r\n      labels: {\r\n        show: false,\r\n        formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      },\r\n      dataLabels: {\r\n      enabled: true,\r\n      style: {\r\n             fontSize: '9px',\r\n             fontWeight: 'bold',\r\n             colors: ['black'],\r\n      },\r\n      background: {\r\n         enabled: false,\r\n         foreColor: '#000',\r\n         borderRadius: 2,\r\n         padding: 4,\r\n         opacity: 0.9,\r\n         borderWidth: 1,\r\n         borderColor: '#fff'\r\n       }, \r\n      offsetY: -15,\r\n      formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_receita_liq %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n        \r\n      };\r\n      \r\n      var chartgraficoReceitaLiquida= new ApexCharts(document.querySelector(\"#graficoReceitaLiquida\"),  optionsBarChart);\r\n      chartgraficoReceitaLiquida.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoReceitaLiquida.updateOptions(optionsReceitaLiquida)\r\n      }, 1);\r\n      \r\n      \r\n      \r\n      // GRÁFICO CAPEX\r\n    var optionsCapex = {\r\n      series: [{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_capex %}\r\n             {{ item.ORCADO }},\r\n               {% endfor %}]\r\n      \r\n      },\r\n      \r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_capex %}\r\n             {{ item.REAL }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      yaxis: {\r\n      grid: {\r\n        show: false,\r\n        stokeDashArray: 0,\r\n      },\r\n      labels: {\r\n        show: false,\r\n        formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      },\r\n      dataLabels: {\r\n      enabled: true,\r\n      style: {\r\n             fontSize: '9px',\r\n             fontWeight: 'bold',\r\n             colors: ['black'],\r\n      },\r\n      background: {\r\n         enabled: false,\r\n         foreColor: '#000',\r\n         borderRadius: 2,\r\n         padding: 4,\r\n         opacity: 0.9,\r\n         borderWidth: 1,\r\n         borderColor: '#fff'\r\n       }, \r\n      offsetY: -15,\r\n      formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_capex %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n        \r\n      };\r\n      \r\n      var chartgraficoCapex= new ApexCharts(document.querySelector(\"#graficoCapex\"),  optionsBarChart);\r\n      chartgraficoCapex.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoCapex.updateOptions(optionsCapex)\r\n      }, 1);\r\n      \r\n      // Gráfico Ebit\r\n      var optionsEbit = {\r\n      series: [{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_ebit %}\r\n             {{ item.ORCADO }},\r\n               {% endfor %}]\r\n      \r\n      },\r\n      \r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_ebit %}\r\n             {{ item.REAL }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      yaxis: {\r\n      grid: {\r\n        show: false,\r\n        stokeDashArray: 0,\r\n      },\r\n      labels: {\r\n        show: false,\r\n        formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      },\r\n      dataLabels: {\r\n      enabled: true,\r\n      style: {\r\n             fontSize: '9px',\r\n             fontWeight: 'bold',\r\n             colors: ['black'],\r\n      },\r\n      background: {\r\n         enabled: false,\r\n         foreColor: '#000',\r\n         borderRadius: 2,\r\n         padding: 4,\r\n         opacity: 0.9,\r\n         borderWidth: 1,\r\n         borderColor: '#fff'\r\n       }, \r\n      offsetY: -15,\r\n      formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_ebit %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n        \r\n      };\r\n      \r\n      var chartgraficoEbit = new ApexCharts(document.querySelector(\"#graficoEbit\"), optionsBarChart);\r\n      chartgraficoEbit.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoEbit.updateOptions(optionsEbit)\r\n      }, 1);\r\n      \r\n      \r\n       \r\n      // Gráfico Ebitda\r\n      var optionsEbitda = {\r\n      series: [{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_ebitda %}\r\n             {{ item.ORCADO }},\r\n               {% endfor %}]\r\n      \r\n      },\r\n      \r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_ebitda %}\r\n             {{ item.REAL }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      yaxis: {\r\n      grid: {\r\n        show: false,\r\n        stokeDashArray: 0,\r\n      },\r\n      labels: {\r\n        show: false,\r\n        formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      },\r\n      dataLabels: {\r\n      enabled: true,\r\n      style: {\r\n             fontSize: '9px',\r\n             fontWeight: 'bold',\r\n             colors: ['black'],\r\n      },\r\n      background: {\r\n         enabled: false,\r\n         foreColor: '#000',\r\n         borderRadius: 2,\r\n         padding: 4,\r\n         opacity: 0.9,\r\n         borderWidth: 1,\r\n         borderColor: '#fff'\r\n       }, \r\n      offsetY: -15,\r\n      formatter: function (value) {\r\n        return (value/1000000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n      },\r\n      },\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_ebit %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n        \r\n      };\r\n      \r\n      var chartgraficoEbitda = new ApexCharts(document.querySelector(\"#graficoEbitda\"), optionsBarChart);\r\n      chartgraficoEbitda.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoEbitda.updateOptions(optionsEbitda)\r\n      }, 1);\r\n      \r\n    \r\n      \r\n      // GRÁFICO Base de Clientes\r\n      var optionsClientes = {\r\n      series: [{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_clientes %}\r\n             {{ item.ORCADO }},\r\n               {% endfor %}]\r\n      \r\n      },\r\n      \r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_clientes %}\r\n             {{ item.REAL }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_clientes %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n      };\r\n      \r\n      var chartgraficoClientes = new ApexCharts(document.querySelector(\"#graficoClientes\"), optionsBarChart);\r\n      chartgraficoClientes.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoClientes.updateOptions(optionsClientes)\r\n      }, 1);\r\n      \r\n      // GRÁFICO Opex\r\n      var optionsOpex = {\r\n      series: [/*{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_opex %}\r\n             {{ item.ORCADO_WIP }},\r\n               {% endfor %}]\r\n      \r\n      },*/\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_opex %}\r\n             {{ item.REAL_WIP }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_opex %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n      };\r\n      \r\n      var chartgraficoOpex = new ApexCharts(document.querySelector(\"#graficoOpex\"), optionsBarChart);\r\n      chartgraficoOpex.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoOpex.updateOptions(optionsOpex)\r\n      }, 1);\r\n      \r\n      \r\n   \r\n\r\n      \r\n      // GRÁFICO Perda Receita\r\n      var PERDA = {\r\n      series: [/*{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_perda_receita %}\r\n             {{ item.ORCADO_ACU }},\r\n               {% endfor %}]\r\n      \r\n      },*/\r\n      \r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_perda_receita %}\r\n             {{ item.REAL_ACU }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_perda_receita %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n      };\r\n      \r\n      var chartPERDA = new ApexCharts(document.querySelector(\"#graficoPerdaReceita\"), optionsLineChart);\r\n      chartPERDA.render();\r\n      \r\n      setTimeout(function() {\r\n      chartPERDA.updateOptions(PERDA)\r\n      }, 1);\r\n      \r\n      \r\n      \r\n      // GRÁFICO Caixa\r\n      var optionsCaixa = {\r\n      series: [/*{\r\n       name: \"Orçado\",\r\n       data: [{% for item in tmp_men_caixa %}\r\n             {{ item.ORCADO_WIP }},\r\n               {% endfor %}]\r\n      \r\n      },*/\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_men_caixa %}\r\n             {{ item.REAL_WIP }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n      categories: [{% for item in tmp_men_caixa %}\r\n              '{{ item.DIA }}',\r\n              \r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            }\r\n      };\r\n\r\n\r\n\r\n\r\n      \r\n      \r\n      var chartgraficoCaixa = new ApexCharts(document.querySelector(\"#graficoCaixa\"), optionsBarChart);\r\n      chartgraficoCaixa.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoCaixa.updateOptions(optionsCaixa)\r\n      }, 1);\r\n   </script>\r\n</body>\r\n\r\n\r\n","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}\r\n\r\n\r\n.text-yellow{\r\n    color:#FAF603;\r\n}\r\n\r\n.img-container{\r\n   width: 600px;\r\n   height: 200px;\r\n   overflow: hidden;\r\n  \r\n}\r\n\r\n.img-container img{\r\n    width: 100%;\r\n   height: 100%;\r\n   -webkit-transition: -webkit-transform .5s ease;\r\n   transition: transform .5s ease;\r\n}\r\n\r\n.img-container:hover img{\r\n   -webkit-transform: scale(1.25);\r\n   transform: scale(1.25);\r\n}\r\n\r\n.sticky{\r\n    position: fixed;\r\n    top: 0; \r\n   \r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .carousel-inner .carousel-item > div {\r\n        display: none;\r\n    }\r\n    .carousel-inner .carousel-item > div:first-child {\r\n        display: block;\r\n    }\r\n}\r\n\r\n.carousel-inner .carousel-item.active,\r\n.carousel-inner .carousel-item-next,\r\n.carousel-inner .carousel-item-prev {\r\n    display: flex;\r\n}\r\n\r\n/* display 3 */\r\n@media (min-width: 768px) {\r\n    \r\n    .carousel-inner .carousel-item-right.active,\r\n    .carousel-inner .carousel-item-next {\r\n      transform: translateX(33.333%);\r\n    }\r\n    \r\n    .carousel-inner .carousel-item-left.active, \r\n    .carousel-inner .carousel-item-prev {\r\n      transform: translateX(-33.333%);\r\n    }\r\n}\r\n\r\n.carousel-inner .carousel-item-right,\r\n.carousel-inner .carousel-item-left{ \r\n  transform: translateX(0);\r\n}\r\n\r\n#image-carousel{\r\n    max-width: 350px;\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n    \r\n}\r\n#legenda-carousel{\r\n    text-align: right;\r\n}\r\n","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}\n\n//toggle -> mensagem ao passar o mouse em cima da analy\n$(document).ready(function(){\n  $('[data-toggle=\"tooltip\"]').tooltip();\n});\n\n//Carousel\n$('#recipeCarousel').carousel({\n  interval: 5000\n})\n\n$('.carousel .carousel-item').each(function(){\n    var minPerSlide = 3;\n    var next = $(this).next();\n    if (!next.length) {\n    next = $(this).siblings(':first');\n    }\n    next.children(':first-child').clone().appendTo($(this));\n    \n    for (var i=0;i<minPerSlide;i++) {\n        next=next.next();\n        if (!next.length) {\n        \tnext = $(this).siblings(':first');\n      \t}\n        \n        next.children(':first-child').clone().appendTo($(this));\n      }\n});\n"},"noSpeech":true,"position":{"x":181.2781897730653,"y":-35.537965470183394},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true},{"id":"skYumY","type":"userMirror","appId":137,"label":"tabela_usuario","client":"clickhouse","fields":["name","email","created","role","group"],"repoId":1,"created":false,"position":{"x":106.99664741454042,"y":-260.99182219808455},"userType":"userAll","sourceType":"bucket","resultTable":"tabela_usuario","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fiuOUs","type":"table","appId":137,"label":"tabela_usuario","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":220.9958954327551,"y":-260.99182219808455},"tableName":"tabela_usuario","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"oZFZmW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"HgIFSo","type":"value","andOr":"and","value":"userId","dataType":"Nullable(Int64)","operator":"=","fieldType":"value","tableName":"tabela_usuario","valueType":"parameter","columnName":"userId","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"RIwICO","type":"value","alias":"IDUsuario","dataType":"Nullable(Int64)","distinct":false,"tableName":"tabela_usuario","columnName":"userId","columnLength":null,"databaseName":"bucket_137"},{"id":"UyJGoM","type":"value","alias":"Nome","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_usuario","columnName":"name","columnLength":null,"databaseName":"bucket_137"},{"id":"TBiEhi","type":"value","alias":"Email","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_usuario","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"wQIeoq","type":"computed","alias":"HoraAcesso","content":"now()","dataType":"Nullable(DateTime)","distinct":false,"columnName":"HoraAcesso","computedId":"IySzhH"},{"id":"wbgzBb","type":"computed","alias":"Aplicacao","content":"'Portal Analytics'","dataType":"Nullable(String)","distinct":false,"columnName":"Aplicacao","computedId":"ZneQMa"},{"id":"pAZzAc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_usuario","columnName":"type","columnLength":null,"databaseName":"bucket_137"},{"id":"qgwRvu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_usuario","columnName":"group","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"HoraAcesso","content":"now()","dataType":"Nullable(DateTime)","columnName":"HoraAcesso","computedId":"IySzhH"},{"type":"computed","alias":"Aplicacao","content":"'Portal Analytics'","dataType":"Nullable(String)","columnName":"Aplicacao","computedId":"ZneQMa"}]},"created":false,"optimize":false,"position":{"x":310.9958954327551,"y":-260.99182219808455},"tableName":"tabela_usuario","tableView":false,"temporary":false,"insertMode":true,"sourceType":"bucket","resultTable":"base_log_acesso","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eItZys","type":"table","appId":137,"label":"base_log_acesso","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":412.9955194418625,"y":-260.9918221980846},"tableName":"base_log_acesso","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mphRcM","type":"api","appId":137,"label":"API: base_log_acesso","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":554.9910702162994,"y":-260.9918221980846},"tableName":"base_log_acesso","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137","paramReferences":[]}],"edges":[{"id":"LEIoyb","source":"fiuOUs","target":"oZFZmW"},{"id":"rEKTOz","source":"oZFZmW","target":"eItZys"},{"id":"LuQteP","type":"manual","label":"","source":"omsfzN","target":"bzJJuI"},{"id":"KjxKmm","type":"manual","label":"","source":"kYMnRb","target":"omsfzN"},{"id":"gpmhET","source":"eItZys","target":"mphRcM"},{"id":"bfeGHd","source":"skYumY","target":"fiuOUs"}]},"cron":null,"options":{"folder":"PORTAL - MENU","reload":0,"isWindow":true,"onDestroy":"resetFlow","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"fZxX_xTcRPaUzZPHVtWwV_xiQsXFfyBD","flowDescription":"","locked":"no","created":"2023-02-14 09:44:48","updated":"2023-09-15 17:22:34"},{"flowId":"3466","appId":137,"flowName":"StatusBases","workflow":{"nodes":[{"id":"dWJphg","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT    TIP_MTC\r\n\t\t, CASE \r\n\t\t\tWHEN TIP_MTC = 'CHURN RECEITA' THEN 'Churn de Receita'\r\n\t\t\tWHEN TIP_MTC = 'DOWNGRADE' THEN 'Downgrade'\r\n\t\t\tWHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n\t\t\tWHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n\t\t\tWHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL')  THEN 'Venda'\r\n\t\t\tELSE 'OUTRO'\r\n\t\t  END AS METRICA\r\n\t\t, TRUNC(DAT_DIA_MES_REF,'MM') AS MES_REF\r\n\t\t, DSC_SGM_CLI AS SEGMENTO\r\n\t\t, COUNT(DISTINCT DSC_LNH_NGC) AS ABERTURA_PRODUTO\r\n\t\t, COUNT(DISTINCT DAT_DIA_MES_REF) AS ABERTURA_DIA\r\n\t\t, COUNT(DISTINCT DSC_DIR) AS ABERTURA_DIR\r\n\t\t, COUNT(DISTINCT DSC_GER) AS ABERTURA_GER\r\n\t\t, COUNT(DISTINCT DSC_COR) AS ABERTURA_COR\r\n\t\t, COUNT(DISTINCT DSC_REG_ITL) AS ABERTURA_REG\r\nFROM DWADM.IND_SAP_PLANEJAMENTO ISP\r\nWHERE 1 = 1\r\n    AND DSC_SGM_CLI IS NOT NULL\r\n\tAND EXTRACT(YEAR FROM DAT_DIA_MES_REF) = 2023\r\n\tAND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'CHURN RECEITA'\r\n\t            , 'CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA')\r\n\t     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n\t     OR (ISP.TIP_MTC IN ('DOWNGRADE') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL')))\r\nGROUP BY  TIP_MTC\r\n\t\t, CASE \r\n\t\t\tWHEN TIP_MTC = 'CHURN RECEITA' THEN 'Churn de Receita'\r\n\t\t\tWHEN TIP_MTC = 'DOWNGRADE' THEN 'Downgrade'\r\n\t\t\tWHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n\t\t\tWHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n\t\t\tWHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL')  THEN 'Venda'\r\n\t\t\tELSE 'OUTRO'\r\n\t\t  END\r\n\t\t, DSC_SGM_CLI\r\n\t\t, TRUNC(DAT_DIA_MES_REF,'MM')\r\nORDER BY 1, 2, 3, 4","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-122.99301283591132,"y":47.001660626442685},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"INDICADORES_PORTAL","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"NoemBd","type":"table","appId":137,"label":"INDICADORES_PORTAL","client":"clickhouse","repoId":1,"shared":false,"position":{"x":162.00087731208282,"y":47.00369724377788},"sourceId":7,"tableName":"INDICADORES_PORTAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"Mspktt","source":"dWJphg","target":"NoemBd"}]},"cron":null,"options":{"folder":"Status Bases","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"XlgNVvwVw_tOUDlugVp_QOIwJaEzozYd","flowDescription":"Processo para controle das automatizações do Portal","locked":"no","created":"2023-07-17 13:20:09","updated":"2023-09-08 09:08:23"},{"flowId":"1794","appId":137,"flowName":"CARGA - Carrega Base","workflow":{"nodes":[{"id":"MsPPrm","type":"sourceRaw","appId":137,"label":"DWADM","query":"WITH\r\n\r\nDIARIO AS (\r\n  SELECT    DAT_DIA_MES_REF AS DATA_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL')  THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n          ELSE TIP_MTC\r\n          END AS TIP_MTC\r\n    , DSC_SGM_CLI AS SEGMENTO\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_1\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_2\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_3\r\n    , DSC_LNH_NGC \r\n    , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t\tWHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(350951.01/154394.78)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(2454547/2393040.61)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(295000/601990.91)\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1817978/1812930.3)\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%IOT%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%IOT%'\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(95914.61/92751.67)\r\n    \tELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n  AND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'BASE DE CLIENTES', 'DADOS FISICOS - BASE', 'CHURN RECEITA', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE'\r\n            , 'DADOS FISICOS - MIGRAÇÃO SAINTE', 'CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('DOWNGRADE') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA'))\r\n     )\r\n  AND DAT_DIA_MES_REF IS NOT NULL\r\n  \r\n  AND TRUNC(DAT_DIA_MES_REF,'MM') >= TO_DATE('20230301','YYYYMMDD')\r\nGROUP BY  DAT_DIA_MES_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n          ELSE TIP_MTC\r\n          END\r\n    , DSC_SGM_CLI\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL_2 AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n          WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t\tWHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(350951.01/154394.78)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(2454547/2393040.61)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(295000/601990.91)\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1817978/1812930.3)\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%IOT%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%IOT%'\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(95914.61/92751.67)\r\n    \tELSE VLR_IND END) AS REAL\r\n      , SUM(NVL(TXA_ITL,0)) AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n   WHERE 1 = 1\r\n    AND (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'CHURN RECEITA', 'DADOS FISICOS - CANCELAMENTO'\r\n              , 'DADOS FISICOS - MIGRAÇÃO ENTRANTE', 'DADOS FISICOS - MIGRAÇÃO SAINTE')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('DOWNGRADE') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA'))\r\n     \r\n     )\r\n\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nONE_PAGE AS (\r\nSELECT O3.IDT_CAD_IND_ONE_PGE,\r\n       O3.NOM_IND,\r\n       O3.DSC_SGM AS SEGMENTO,\r\n       O3.DAT_MES_REF,\r\n       O3.DAT_REF_RGT,\r\n       O3.VLR_RLZ,\r\n       O3.VLR_OCD AS OCD,\r\n       O3.VLR_FCT,\r\n       O3.VLR_OTR,\r\n       O3.DAT_CRG_RGT,\r\n       O3.NOM_JOB_CRG,\r\n       to_date(to_char(O3.MES_REF, 'YYYY')||'-'||to_char(O3.MES_REF, 'MM')||'-1', 'YYYY-MM-DD') as MES_REF\r\nFROM (SELECT *\r\nFROM arthural.IND_ONE_PAGE O\r\nINNER JOIN (SELECT DAT_MES_REF DAT_MES_REF_2,\r\n                   MAX(O2.DAT_REF_RGT) MES_REF\r\n            FROM ARTHURAL.IND_ONE_PAGE O2\r\n            WHERE 1=1\r\n            AND O2.DAT_REF_RGT >= to_date('01/01/2022', 'dd/mm/rrrr')\r\n            GROUP BY DAT_MES_REF) DT ON (O.DAT_REF_RGT = DT.MES_REF)\r\norder by DAT_REF_RGT) O3\r\n\r\n),\r\n\r\nTICKET_MEDIO AS (\r\n\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Ticket Medio' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI <> 'OPERADORAS'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Base de Contratos TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI = 'OPERADORAS'\r\n          AND DSC_LNH_NGC = 'Conectividade'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('DADOS FISICOS - BASE')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n\r\n),\r\n\r\nVENDA_ONE_PAGE AS (\r\nSELECT    MES_REF AS DATA_REF\r\n    , 'Venda Mensal' TIP_MTC\r\n    , SEGMENTO\r\n    , '' HRQ_1\r\n    , '' HRQ_2\r\n    , '' HRQ_3\r\n    , '' DSC_LNH_NGC\r\n    , REAL\r\n    , 0 AS TAXA_INSTALACAO\r\nFROM (\r\n  SELECT     MES_REF\r\n      , 'CORPORATIVO' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (1) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n    AND SEGMENTO in ('Corporativo')\r\n    AND NOM_IND IN ('Valor de Vendas','Receita Vendas Total')\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'EMPRESARIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (106, 117) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'OPERADORAS' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (35) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'RESIDENCIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (139,497) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  \r\n  GROUP BY MES_REF\r\n)\r\nWHERE 1 = 1\r\n    AND MES_REF < TO_DATE('20230301','YYYYMMDD')\r\n)\r\n\r\n\r\n\r\n\r\nSELECT    DATA_REF\r\n    , TIP_MTC\r\n    , SEGMENTO\r\n    , HRQ_1\r\n    , HRQ_2\r\n    , HRQ_3\r\n    , DSC_LNH_NGC\r\n    , REAL\r\n    , TAXA_INSTALACAO\r\nFROM (\r\nSELECT *\r\nFROM (\r\n  SELECT *\r\n  FROM DIARIO\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL_2\r\n  UNION ALL\r\n  SELECT *\r\n  FROM TICKET_MEDIO\r\n\r\n\r\n)\r\nWHERE 1 = 1\r\n    AND (ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM') AND TIP_MTC <> 'Venda Mensal')\r\n     OR  (TIP_MTC = 'Venda Mensal' AND TRUNC(DATA_REF, 'MM') >= TO_DATE('20230301','YYYYMMDD'))\r\n) f      \r\n\r\n\r\nWHERE ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM')","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-145.4398064519139,"y":148.77704617814885},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"resultTable":"IND_SAP_PLANEJAMENTO_VALIDACAO","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"TwVFhj","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_VALIDACAO","client":"clickhouse","repoId":1,"shared":false,"position":{"x":260.8573557351493,"y":151.1069180671143},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"McEEni","source":"MsPPrm","target":"TwVFhj"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"MRPhHTaRwMmK_QpxVFWhIeZnXDOkGTZV","flowDescription":"Processo principal de carga, responsável pela carga de todos os dados vindos do banco.","locked":"no","created":"2023-02-09 10:21:42","updated":"2023-09-08 09:08:23"},{"flowId":"2002","appId":137,"flowName":"Carrega Dados - Base Geral","workflow":{"nodes":[{"id":"XNRArt","type":"table","appId":137,"label":"parametros_portal","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2185.4984020387064,"y":897.9892215944103},"sourceId":7,"tableName":"parametros_portal","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bBMpCb","type":"table","appId":137,"label":"base_orcado_raw","client":"clickhouse","repoId":1,"created":false,"position":{"x":52.5,"y":391},"tableName":"base_orcado_raw","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"WPYqTE","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"hCktZh","type":"computed","alias":"tip_mtc","content":"case\n    when metrica = 'CHURN FISICO' then 'Churn Físico Mensal'\n    when metrica = 'MIGRACAO SAINTE' then 'Migração Sainte Mensal'\n    when metrica = 'MIGRACAO ENTRANTE' then 'Migração Entrante Mensal'\n    when metrica = 'BASE DE CONTRATOS' then 'Base de Contratos Mensal'\n    when metrica = 'VENDAS' then 'Venda Mensal'\n    when metrica = 'BASE DE CLIENTES' then 'Base de Clientes Mensal'\n    when metrica = 'ARPU' then 'ARPU Mensal'\n    when metrica = 'PERDA DE RECEITA' then 'Perda de Receita Mensal'\n    when metrica = 'Receita Bruta' then 'Receita Bruta Mensal'\n    when metrica = 'Receita Líquida' then 'Receita Líquida Mensal'\n    when metrica = 'Fluxo de Caixa' then 'Fluxo de Caixa Mensal'\n    when metrica = 'Recebimentos de Caixa' then 'Recebimentos de Caixa Mensal'\n    when metrica = 'Fluxo de Caixa Livre' then 'Fluxo de Caixa Livre Mensal'\n    ELSE metrica\nend","dataType":"Nullable(String)","distinct":false,"columnName":"tip_mtc","computedId":"kJpbpz"},{"id":"cVZqCH","type":"computed","alias":"produto","content":"CASE\r\nWHEN metrica in ('Receita Líquida', 'Receita Bruta') then linha_de_negocio_produto\r\nWHEN linha_de_negocio_produto = '130 - Voz Fixa' THEN 'Voz Fixa'\r\nWHEN linha_de_negocio_produto = '110 - Banda Larga' THEN 'Banda Larga'\r\nWHEN linha_de_negocio_produto = '160 - TIC' THEN 'TIC'\r\nWHEN linha_de_negocio_produto = '180 - Móvel - Pós' THEN 'Móvel - Pós'\r\nWHEN linha_de_negocio_produto = '210 - Outros' THEN 'Outros'\r\nWHEN linha_de_negocio_produto = '100 - Conectividade' THEN 'Conectividade'\r\nWHEN linha_de_negocio_produto = '140 - Voz Corporativa' THEN 'Voz Corporativa'\r\nWHEN linha_de_negocio_produto = '150 - DDG' THEN 'DDG'\r\nWHEN linha_de_negocio_produto = '170 - IOT' THEN 'IOT'\r\nWHEN linha_de_negocio_produto = '190 - Móvel - Pré' THEN 'Móvel - Pré'\r\nELSE linha_de_negocio_produto\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"produto","computedId":"uCzczz"},{"id":"HfSKOt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"eGeTMs","type":"computed","alias":"segmento_tratado","content":"case\nwhen segmento = 'ATACADO' THEN 'OPERADORAS'\nELSE segmento\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"dhbSWc"},{"id":"PijXqY","type":"computed","alias":"marcacao_tic_iot","content":"case\nwhen upper(produto) like '%TIC%'  then 'TIC'\nwhen upper(produto) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","columnName":"marcacao_tic_iot","computedId":"PHBCdZ"},{"id":"RJdmer","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"CNHZnv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"RxsoSo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"Iiiusw","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_raw","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"tvkAIy","type":"computed","alias":"tip_mtc","content":"case\n    when metrica = 'CHURN FISICO' then 'Churn Físico Mensal'\n    when metrica = 'MIGRACAO SAINTE' then 'Migração Sainte Mensal'\n    when metrica = 'MIGRACAO ENTRANTE' then 'Migração Entrante Mensal'\n    when metrica = 'BASE DE CONTRATOS' then 'Base de Contratos Mensal'\n    when metrica = 'VENDAS' then 'Venda Mensal'\n    when metrica = 'BASE DE CLIENTES' then 'Base de Clientes Mensal'\n    when metrica = 'ARPU' then 'ARPU Mensal'\n    when metrica = 'PERDA DE RECEITA' then 'Perda de Receita Mensal'\n    when metrica = 'Receita Bruta' then 'Receita Bruta Mensal'\n    when metrica = 'Receita Líquida' then 'Receita Líquida Mensal'\n    when metrica = 'Fluxo de Caixa' then 'Fluxo de Caixa Mensal'\n    when metrica = 'Recebimentos de Caixa' then 'Recebimentos de Caixa Mensal'\n    when metrica = 'Fluxo de Caixa Livre' then 'Fluxo de Caixa Livre Mensal'\n    ELSE metrica\nend","dataType":"Nullable(String)","distinct":false,"columnName":"tip_mtc","computedId":"kJpbpz"},{"id":"SSAgiV","type":"computed","alias":"produto","content":"CASE\r\nWHEN metrica in ('Receita Líquida', 'Receita Bruta') then linha_de_negocio_produto\r\nWHEN linha_de_negocio_produto = '130 - Voz Fixa' THEN 'Voz Fixa'\r\nWHEN linha_de_negocio_produto = '110 - Banda Larga' THEN 'Banda Larga'\r\nWHEN linha_de_negocio_produto = '160 - TIC' THEN 'TIC'\r\nWHEN linha_de_negocio_produto = '180 - Móvel - Pós' THEN 'Móvel - Pós'\r\nWHEN linha_de_negocio_produto = '210 - Outros' THEN 'Outros'\r\nWHEN linha_de_negocio_produto = '100 - Conectividade' THEN 'Conectividade'\r\nWHEN linha_de_negocio_produto = '140 - Voz Corporativa' THEN 'Voz Corporativa'\r\nWHEN linha_de_negocio_produto = '150 - DDG' THEN 'DDG'\r\nWHEN linha_de_negocio_produto = '170 - IOT' THEN 'IOT'\r\nWHEN linha_de_negocio_produto = '190 - Móvel - Pré' THEN 'Móvel - Pré'\r\nELSE linha_de_negocio_produto\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"produto","computedId":"uCzczz"},{"id":"HfSKOt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"erIokX","type":"computed","alias":"segmento_tratado","content":"case\nwhen segmento = 'ATACADO' THEN 'OPERADORAS'\nELSE segmento\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"dhbSWc"},{"id":"ObVcXM","type":"computed","alias":"marcacao_tic_iot","content":"case\nwhen upper(produto) like '%TIC%'  then 'TIC'\nwhen upper(produto) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","distinct":false,"columnName":"marcacao_tic_iot","computedId":"PHBCdZ"},{"id":"RJdmer","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"CNHZnv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"RxsoSo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"Iiiusw","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_raw","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"lARCbR","type":"sum","alias":"orcado","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_raw","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"tip_mtc","content":"case\n    when metrica = 'CHURN FISICO' then 'Churn Físico Mensal'\n    when metrica = 'MIGRACAO SAINTE' then 'Migração Sainte Mensal'\n    when metrica = 'MIGRACAO ENTRANTE' then 'Migração Entrante Mensal'\n    when metrica = 'BASE DE CONTRATOS' then 'Base de Contratos Mensal'\n    when metrica = 'VENDAS' then 'Venda Mensal'\n    when metrica = 'BASE DE CLIENTES' then 'Base de Clientes Mensal'\n    when metrica = 'ARPU' then 'ARPU Mensal'\n    when metrica = 'PERDA DE RECEITA' then 'Perda de Receita Mensal'\n    when metrica = 'Receita Bruta' then 'Receita Bruta Mensal'\n    when metrica = 'Receita Líquida' then 'Receita Líquida Mensal'\n    when metrica = 'Fluxo de Caixa' then 'Fluxo de Caixa Mensal'\n    when metrica = 'Recebimentos de Caixa' then 'Recebimentos de Caixa Mensal'\n    when metrica = 'Fluxo de Caixa Livre' then 'Fluxo de Caixa Livre Mensal'\n    ELSE metrica\nend","dataType":"Nullable(String)","columnName":"tip_mtc","computedId":"kJpbpz"},{"type":"computed","alias":"produto","content":"CASE\r\nWHEN metrica in ('Receita Líquida', 'Receita Bruta') then linha_de_negocio_produto\r\nWHEN linha_de_negocio_produto = '130 - Voz Fixa' THEN 'Voz Fixa'\r\nWHEN linha_de_negocio_produto = '110 - Banda Larga' THEN 'Banda Larga'\r\nWHEN linha_de_negocio_produto = '160 - TIC' THEN 'TIC'\r\nWHEN linha_de_negocio_produto = '180 - Móvel - Pós' THEN 'Móvel - Pós'\r\nWHEN linha_de_negocio_produto = '210 - Outros' THEN 'Outros'\r\nWHEN linha_de_negocio_produto = '100 - Conectividade' THEN 'Conectividade'\r\nWHEN linha_de_negocio_produto = '140 - Voz Corporativa' THEN 'Voz Corporativa'\r\nWHEN linha_de_negocio_produto = '150 - DDG' THEN 'DDG'\r\nWHEN linha_de_negocio_produto = '170 - IOT' THEN 'IOT'\r\nWHEN linha_de_negocio_produto = '190 - Móvel - Pré' THEN 'Móvel - Pré'\r\nELSE linha_de_negocio_produto\r\nEND","dataType":"Nullable(String)","columnName":"produto","computedId":"uCzczz"},{"type":"computed","alias":"segmento_tratado","content":"case\nwhen segmento = 'ATACADO' THEN 'OPERADORAS'\nELSE segmento\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"dhbSWc"},{"type":"computed","alias":"marcacao_tic_iot","content":"case\nwhen upper(produto) like '%TIC%'  then 'TIC'\nwhen upper(produto) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","columnName":"marcacao_tic_iot","computedId":"PHBCdZ"}]},"created":false,"position":{"x":182,"y":391},"tableName":"base_orcado_raw","sourceType":"bucket","resultTable":"base_orcado_portal_analytics","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"DVDkVy","type":"table","appId":137,"label":"base_orcado_portal_analytics","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":343.5,"y":391},"tableName":"base_orcado_portal_analytics","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"MyUSlE","type":"builder","appId":137,"label":"DUP -Orçado Consolidado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"fXIqag","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"SyAMou","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"yQRdQa","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fXIqag","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"SyAMou","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"UDHiAQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"sRjWEC","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":518.4999686674257,"y":212.99949867880963},"tableName":"base_orcado_portal_analytics","sourceType":"bucket","resultTable":"base_orcado_portal_csl_home","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eTTfuH","type":"table","appId":137,"label":"base_orcado_portal_csl_home","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":705.9999686674256,"y":212.99949867880963},"tableName":"base_orcado_portal_csl_home","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UyBTnC","type":"builder","appId":137,"label":"Orçado Insight","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"SStoUO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"ersJuQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VcORuE","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"TeYAFu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"produto","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SStoUO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"ersJuQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VcORuE","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"WlZCMM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"produto","columnLength":null,"databaseName":"bucket_137"},{"id":"AAAknv","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":517.5,"y":331},"tableName":"base_orcado_portal_analytics","sourceType":"bucket","resultTable":"base_orcado_portal_sgm_pdt","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"rMoObY","type":"table","appId":137,"label":"base_orcado_portal_sgm_pdt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":705,"y":331},"tableName":"base_orcado_portal_sgm_pdt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EndZbO","type":"builder","appId":137,"label":"[INATIVADO] Orçado Consolidado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"fXIqag","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"SyAMou","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fXIqag","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"SyAMou","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"sRjWEC","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":136.51193771084218,"y":840.991853530659},"tableName":"base_orcado_portal_analytics","sourceType":"bucket","resultTable":"base_orcado_portal_csl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Rnplmw","type":"table","appId":137,"label":"base_orcado_portal_csl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":324.0119377108422,"y":840.991853530659},"tableName":"base_orcado_portal_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dWNLEB","type":"builder","appId":137,"label":"[INATIVADO] Base Orçado Portal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"WoKXOj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"Auepsm","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"OtaYZw","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"RDSQMV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"gSfkbS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"kOjdwb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WoKXOj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"Auepsm","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"wBENjo","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"RDSQMV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"gSfkbS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"kOjdwb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"BKVenv","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":127.51221970401168,"y":1123.9663801476809},"tableName":"base_orcado_portal_analytics","sourceType":"bucket","resultTable":"base_orcado_portal_hrq","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NQiOkX","type":"table","appId":137,"label":"base_orcado_portal_hrq","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":315.01221970401167,"y":1123.9663801476809},"tableName":"base_orcado_portal_hrq","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SSyDHI","type":"builder","appId":137,"label":"[Analy] Base Orçado Segmento","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"SStoUO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"ersJuQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VcORuE","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SStoUO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"ersJuQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VcORuE","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"AAAknv","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":136.51193771084218,"y":986.991853530661},"tableName":"base_orcado_portal_analytics","sourceType":"bucket","resultTable":"base_orcado_portal_sgm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"LfItkb","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":324.0119377108422,"y":986.991853530661},"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QPmitS","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"MWWgGl","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_analytics","valueType":"parameter","columnName":"produto","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"qAovHG","type":"value","andOr":"and","value":"prm_filtro_tic_iot","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_analytics","valueType":"parameter","columnName":"marcacao_tic_iot","extraValue":[],"columnLength":null,"databaseName":"bucket_137"},{"id":"ssmfhl","type":"value","andOr":"and","value":"prm_filtro_regional","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_analytics","valueType":"parameter","columnName":"hieraraquia_nivel_3","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"iCKbyc","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"MJhEzh","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"produto","columnLength":null,"databaseName":"bucket_137"},{"id":"ghXpzd","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"wIGdAa","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"COqpEq","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"marcacao_tic_iot","columnLength":null,"databaseName":"bucket_137"},{"id":"jiyCuz","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"zRTNRc","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"dQGHBw","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"jJqakw","type":"value","dataType":"Nullable(Date)","tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CbMstG","type":"value","dataType":"Nullable(Float64)","tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":517.5,"y":453},"tableName":"base_orcado_portal_analytics","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_orcado_portal_analytics","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"VGeMgN","type":"table","appId":137,"label":"tmp_base_orcado_portal_analytics","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":705,"y":453},"tableName":"tmp_base_orcado_portal_analytics","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"oFznyG","type":"builder","appId":137,"label":"Orçado Consolidado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"fXIqag","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"SyAMou","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fXIqag","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"SyAMou","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"sRjWEC","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":891.5,"y":248},"tableName":"tmp_base_orcado_portal_analytics","sourceType":"bucket","resultTable":"tmp_base_orcado_portal_csl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BBYyBY","type":"table","appId":137,"label":"tmp_base_orcado_portal_csl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1066,"y":248},"tableName":"tmp_base_orcado_portal_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ldXzDv","type":"builder","appId":137,"label":"Base Orçado Segmento","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"SStoUO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"ersJuQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VcORuE","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SStoUO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"ersJuQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VcORuE","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"IGQxSQ","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":891.5,"y":452},"tableName":"tmp_base_orcado_portal_analytics","sourceType":"bucket","resultTable":"tmp_base_orcado_portal_sgm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"sAfAvI","type":"table","appId":137,"label":"tmp_base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1066,"y":452},"tableName":"tmp_base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DUhHKy","type":"builder","appId":137,"label":"Base Orçado Portal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"WoKXOj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"Auepsm","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"OtaYZw","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"RDSQMV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"gSfkbS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"kOjdwb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WoKXOj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"Auepsm","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"wBENjo","type":"value","alias":"segmento","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"segmento_tratado","columnLength":null,"databaseName":"bucket_137"},{"id":"RDSQMV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"gSfkbS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"kOjdwb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"VnRFpl","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":863.4979439279787,"y":622.0022029343085},"tableName":"tmp_base_orcado_portal_analytics","sourceType":"bucket","resultTable":"tmp_base_orcado_portal_hrq","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"wHtDMR","type":"table","appId":137,"label":"tmp_base_orcado_portal_hrq","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1068.999906002277,"y":622.9990286901939},"tableName":"tmp_base_orcado_portal_hrq","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cnNstL","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1284,"y":450},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hxgKDP","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"OnNvCb","type":"value","andOr":"and","value":"PRM_TIP_MTC","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"parameter","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QtVAZe","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"HDWUuE","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"SABrGu","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"KsMNTe","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"SxzIDl","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"mCYxmI","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"nwwVzd","type":"computed","alias":"marcacao_tic_iot","content":"case\nwhen upper(PRODUTO) like '%TIC%'  then 'TIC'\nwhen upper(PRODUTO) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","distinct":false,"columnName":"marcacao_tic_iot","computedId":"hKnrGC"},{"id":"ViCXjj","type":"computed","alias":"PRODUTO","content":"CASE\nWHEN DSC_LNH_NGC = 'TIC Dados' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC TI' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC' then 'TIC'\nELSE DSC_LNH_NGC\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"gMTKoZ"},{"id":"tCVaqg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"hnWgMt","type":"value","dataType":"Nullable(Float64)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"aSlYYj","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"},{"id":"mzXhcZ","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"XVDJBz"},{"id":"Sodfqs","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"ZKlybt"},{"id":"EGfXud","type":"computed","alias":"JOIN_INDICADOR","content":"CASE\r\nWHEN TIP_MTC = 'Venda Mensal' THEN 'Venda'\r\nWHEN TIP_MTC = 'Base de Clientes Mensal' THEN 'Base de Clientes'\r\nWHEN TIP_MTC = 'Base de Contratos Mensal' THEN 'Base de Contratos'\r\nWHEN TIP_MTC = 'Perda de Receita Mensal' THEN 'Perda de Receita'\r\nWHEN TIP_MTC = 'Churn Físico Mensal' THEN 'Churn Físico'\r\nWHEN TIP_MTC = 'Migração Entrante Mensal' THEN 'Migração Entrante'\r\nWHEN TIP_MTC = 'Migração Sainte Mensal' THEN 'Migração Sainte'\r\nWHEN TIP_MTC = 'Ebit Mensal' THEN 'Ebit'\r\nWHEN TIP_MTC = 'Ebitda Mensal' THEN 'Ebitda'\r\nWHEN TIP_MTC = 'Margem Contribuição Mensal' THEN 'Margem Contribuição'\r\nWHEN TIP_MTC = 'Receita Liquida Mensal' THEN 'Receita Liquida'\r\nELSE TIP_MTC\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"JOIN_INDICADOR","computedId":"SrUmku"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"XVDJBz"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"ZKlybt"},{"type":"computed","alias":"JOIN_INDICADOR","content":"CASE\r\nWHEN TIP_MTC = 'Venda Mensal' THEN 'Venda'\r\nWHEN TIP_MTC = 'Base de Clientes Mensal' THEN 'Base de Clientes'\r\nWHEN TIP_MTC = 'Base de Contratos Mensal' THEN 'Base de Contratos'\r\nWHEN TIP_MTC = 'Perda de Receita Mensal' THEN 'Perda de Receita'\r\nWHEN TIP_MTC = 'Churn Físico Mensal' THEN 'Churn Físico'\r\nWHEN TIP_MTC = 'Migração Entrante Mensal' THEN 'Migração Entrante'\r\nWHEN TIP_MTC = 'Migração Sainte Mensal' THEN 'Migração Sainte'\r\nWHEN TIP_MTC = 'Ebit Mensal' THEN 'Ebit'\r\nWHEN TIP_MTC = 'Ebitda Mensal' THEN 'Ebitda'\r\nWHEN TIP_MTC = 'Margem Contribuição Mensal' THEN 'Margem Contribuição'\r\nWHEN TIP_MTC = 'Receita Liquida Mensal' THEN 'Receita Liquida'\r\nELSE TIP_MTC\r\nEND","dataType":"Nullable(String)","columnName":"JOIN_INDICADOR","computedId":"SrUmku"},{"type":"computed","alias":"PRODUTO","content":"CASE\nWHEN DSC_LNH_NGC = 'TIC Dados' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC TI' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC' then 'TIC'\nELSE DSC_LNH_NGC\nEND","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"gMTKoZ"},{"type":"computed","alias":"marcacao_tic_iot","content":"case\nwhen upper(PRODUTO) like '%TIC%'  then 'TIC'\nwhen upper(PRODUTO) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","columnName":"marcacao_tic_iot","computedId":"hKnrGC"}]},"created":false,"position":{"x":1443,"y":450},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","sourceType":"bucket","resultTable":"tmp_base_inicial","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"KJLFMH","type":"table","appId":137,"label":"tmp_base_inicial","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1569.5,"y":450},"sourceId":7,"tableName":"tmp_base_inicial","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mEbdbz","type":"builder","appId":137,"label":"Consulta 2","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"cubViQ","type":"value","andOr":"and","value":"Mensal","dataType":"Nullable(String)","operator":"doesNotEndsWith","fieldType":"value","tableName":"tmp_base_inicial","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SVecXI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"UKJHbf","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"OrJHQy"},{"id":"SAFgHB","type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"NDGteb"},{"id":"EzkEur","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_inicial","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"TKhANp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"marcacao_tic_iot","columnLength":null,"databaseName":"bucket_137"},{"id":"NzAdtU","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_inicial","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"sPwbWk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"dDUTbp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"OHNxSN","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_inicial","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"wSmOBd","type":"value","alias":"DSC_LNH_NGC","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"YxywuC","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_inicial","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"NDGteb"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"OrJHQy"}]},"created":false,"position":{"x":1749.5,"y":302},"sourceId":7,"tableName":"tmp_base_inicial","sourceType":"bucket","resultTable":"tmp_aux_dia_base_geral","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"IxKNEo","type":"table","appId":137,"label":"tmp_aux_dia_base_geral","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1955.5,"y":302},"sourceId":7,"tableName":"tmp_aux_dia_base_geral","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RkFwAk","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"DwbaJW","type":"value","alias":"","andOr":"and","value":"Mes_Ref","dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"parameter","columnName":"Mes_Ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"RkduRQ","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"parameter","columnName":"DSC_LNH_NGC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"SYLRsg","type":"value","andOr":"and","value":"2023-06-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"bchzmR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ZMLBfb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ABDlGI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"XHwTOr","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_aux_dia_base_geral","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tJziEL","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"dyLdMd","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"XDZKsP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"HqunYe","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"pfYzdn","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"XISwMC","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zHUReO","type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"DIA","computedId":"XHYWSO"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"XHYWSO"}]},"created":false,"position":{"x":2134.5,"y":302},"sourceId":7,"tableName":"tmp_aux_dia_base_geral","sourceType":"bucket","resultTable":"base_geral_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eDcnBu","type":"table","appId":137,"label":"base_geral_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2287.5,"y":302},"sourceId":7,"tableName":"base_geral_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"KshDQD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"DwbaJW","type":"value","alias":"","andOr":"and","value":"Mes_Ref","dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"parameter","columnName":"Mes_Ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"RkduRQ","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"parameter","columnName":"DSC_LNH_NGC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"SYLRsg","type":"value","andOr":"and","value":"2023-06-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"WFLAsZ","type":"value","andOr":"and","value":"prm_filtro_tic_iot","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"parameter","columnName":"marcacao_tic_iot","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"eiEupI","type":"value","andOr":"and","value":"prm_filtro_regional","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_dia_base_geral","valueType":"parameter","columnName":"HRQ_3","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"bchzmR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ZMLBfb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ABDlGI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"XHwTOr","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_aux_dia_base_geral","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tJziEL","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"dyLdMd","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"XDZKsP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"HqunYe","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"pfYzdn","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_dia_base_geral","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"XISwMC","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_dia_base_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zHUReO","type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"DIA","computedId":"XHYWSO"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"XHYWSO"}]},"created":false,"position":{"x":2127.4974307288994,"y":222.00532653764608},"sourceId":7,"tableName":"tmp_aux_dia_base_geral","sourceType":"bucket","resultTable":"tmp_base_geral_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vUoqfz","type":"table","appId":137,"label":"tmp_base_geral_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2244.4965847493913,"y":221.00535787022045},"sourceId":7,"tableName":"tmp_base_geral_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pswoCc","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"cubViQ","type":"value","andOr":"and","value":"Mensal","dataType":"Nullable(String)","operator":"endsWith","fieldType":"value","tableName":"tmp_base_inicial","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="},{"list":[{"id":"ivmlMQ","type":"value","andOr":"and","value":["Ticket Medio","Base de Contratos TM","Faturamento Bruto Mensal TM"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_base_inicial","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"}],"andOr":"or","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"yqqcCg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"UKJHbf","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"OrJHQy"},{"id":"SAFgHB","type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"NDGteb"},{"id":"EzkEur","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_inicial","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"oQWlmb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"marcacao_tic_iot","columnLength":null,"databaseName":"bucket_137"},{"id":"NzAdtU","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_inicial","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"sPwbWk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"dDUTbp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"OHNxSN","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_inicial","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"jpSRAw","type":"value","alias":" DSC_LNH_NGC","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_inicial","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"YxywuC","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_inicial","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"suSwiv","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_inicial","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"NDGteb"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"OrJHQy"}]},"created":false,"position":{"x":1749.5,"y":418},"sourceId":7,"tableName":"tmp_base_inicial","sourceType":"bucket","resultTable":"tmp_aux_mes_base_geral","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"AVsXuk","type":"table","appId":137,"label":"tmp_aux_mes_base_geral","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1955.5,"y":418},"sourceId":7,"tableName":"tmp_aux_mes_base_geral","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cSmTTy","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"DwbaJW","type":"value","alias":"","andOr":"and","value":"Mes_Ref","dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"Mes_Ref","extraValue":[],"columnLength":null,"databaseName":"bucket_137"},{"id":"kJYlNs","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"DSC_LNH_NGC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"JCDMIH","type":"value","andOr":"and","value":"prm_filtro_tic_iot","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"marcacao_tic_iot","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"iZGlAn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ZMLBfb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ABDlGI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"XHwTOr","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_aux_mes_base_geral","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tJziEL","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"dyLdMd","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"XDZKsP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"HqunYe","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"pfYzdn","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"XISwMC","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_mes_base_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zsXkiy","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":2134.5,"y":418},"sourceId":7,"tableName":"tmp_aux_mes_base_geral","sourceType":"bucket","resultTable":"base_geral_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vgATWr","type":"table","appId":137,"label":"base_geral_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2287.5,"y":418},"sourceId":7,"tableName":"base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kjITlT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"DwbaJW","type":"value","alias":"","andOr":"and","value":"Mes_Ref","dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"Mes_Ref","extraValue":[],"columnLength":null,"databaseName":"bucket_137"},{"id":"kJYlNs","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"DSC_LNH_NGC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"JCDMIH","type":"value","andOr":"and","value":"prm_filtro_tic_iot","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"marcacao_tic_iot","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"gcnZHg","type":"value","andOr":"and","value":"prm_filtro_regional","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_mes_base_geral","valueType":"parameter","columnName":"HRQ_3","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"iZGlAn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ZMLBfb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ABDlGI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"XHwTOr","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_aux_mes_base_geral","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tJziEL","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"dyLdMd","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"XDZKsP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"HqunYe","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"pfYzdn","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_mes_base_geral","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"XISwMC","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_mes_base_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zsXkiy","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_mes_base_geral","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":2125.496026701997,"y":488.0006266514876},"sourceId":7,"tableName":"tmp_aux_mes_base_geral","sourceType":"bucket","resultTable":"tmp_base_geral_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qVdPaF","type":"table","appId":137,"label":"tmp_base_geral_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2288.495206116119,"y":537.9990600227683},"sourceId":7,"tableName":"tmp_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jrXhnD","type":"table","appId":137,"label":"parametros_portal_analytics","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1753.4998746697024,"y":637.9973680637513},"tableName":"parametros_portal_analytics","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dAcaUo","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_inicial","id":"jETEly","to":"parametros_portal_analytics","raw":"","list":[{"id":"KOygQz","andOr":"and","tableBy":"tmp_base_inicial","tableTo":"parametros_portal_analytics","columnBy":"JOIN_INDICADOR","columnTo":"indicador_selecionado","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"EZXoVh","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"indicador_selecionado","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"ufYRCm","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"indicador_selecionado","columnLength":null,"databaseName":"bucket_137"},{"id":"ppTDaF","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"indicador_pai","columnLength":null,"databaseName":"bucket_137"},{"id":"aczdMr","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"hrq1","columnLength":null,"databaseName":"bucket_137"},{"id":"jevvib","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"hrq2","columnLength":null,"databaseName":"bucket_137"},{"id":"OUnRWe","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"hrq3","columnLength":null,"databaseName":"bucket_137"},{"id":"goLQZF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"visao_diaria","columnLength":null,"databaseName":"bucket_137"},{"id":"jgENkS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"escala_valor","columnLength":null,"databaseName":"bucket_137"},{"id":"JEFDlI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"escala_texto","columnLength":null,"databaseName":"bucket_137"},{"id":"PECDDm","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"escala_decimal","columnLength":null,"databaseName":"bucket_137"},{"id":"uXVynd","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"escala_prefixo","columnLength":null,"databaseName":"bucket_137"},{"id":"KYVhek","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"escala_sufixo","columnLength":null,"databaseName":"bucket_137"},{"id":"NuGJOh","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"visao_hierarquia","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ufYRCm","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"indicador_selecionado","columnLength":null,"databaseName":"bucket_137"},{"id":"ppTDaF","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"indicador_pai","columnLength":null,"databaseName":"bucket_137"},{"id":"aczdMr","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"hrq1","columnLength":null,"databaseName":"bucket_137"},{"id":"jevvib","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"hrq2","columnLength":null,"databaseName":"bucket_137"},{"id":"OUnRWe","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"hrq3","columnLength":null,"databaseName":"bucket_137"},{"id":"tiauVk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"visao_diaria","columnLength":null,"databaseName":"bucket_137"},{"id":"jgENkS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"escala_valor","columnLength":null,"databaseName":"bucket_137"},{"id":"JEFDlI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"escala_texto","columnLength":null,"databaseName":"bucket_137"},{"id":"PECDDm","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"escala_decimal","columnLength":null,"databaseName":"bucket_137"},{"id":"uXVynd","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"escala_prefixo","columnLength":null,"databaseName":"bucket_137"},{"id":"KYVhek","type":"value","dataType":"Nullable(String)","tableName":"parametros_portal_analytics","columnName":"escala_sufixo","columnLength":null,"databaseName":"bucket_137"},{"id":"scAJKN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics","columnName":"visao_hierarquia","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":1968.4995926765328,"y":616.0000939977231},"sourceId":7,"tableName":"tmp_base_inicial","sourceType":"bucket","resultTable":"tmp_parametros_portal","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Drxxtl","type":"table","appId":137,"label":"tmp_parametros_portal","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2108.4980260478133,"y":627.9997180068304},"sourceId":7,"tableName":"tmp_parametros_portal","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QNGwzl","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":2291.4998746697024,"y":637.9973680637513},"tableName":"tmp_parametros_portal","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":false,"fieldToParamList":[{"paramName":"prm_indicador","columnName":"indicador_selecionado"},{"paramName":"prm_indicador_pai","columnName":"indicador_pai"},{"paramName":"prm_hrq1","columnName":"hrq1"},{"paramName":"prm_hrq2","columnName":"hrq2"},{"paramName":"prm_hrq3","columnName":"hrq3"},{"paramName":"prm_visao_diaria","columnName":"visao_diaria"},{"paramName":"prm_escala_valor","columnName":"escala_valor"},{"paramName":"prm_escala_texto","columnName":"escala_texto"},{"paramName":"prm_escala_decimais","columnName":"escala_decimal"},{"paramName":"prm_escala_prefixo","columnName":"escala_prefixo"},{"paramName":"prm_escala_sufixo","columnName":"escala_sufixo"},{"paramName":"prm_visao_hierarquia","columnName":"visao_hierarquia"}]},{"id":"XuJvHD","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"2003","repoId":1,"created":false,"position":{"x":2409,"y":474}},{"id":"qeeCny","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"2003","repoId":1,"created":false,"position":{"x":2381.4998746697024,"y":539}}],"edges":[{"id":"llWmPo","source":"WPYqTE","target":"DVDkVy"},{"id":"dbWcZX","source":"cSmTTy","target":"vgATWr"},{"id":"FtflAc","source":"MyUSlE","target":"eTTfuH"},{"id":"hOToMa","type":"manual","label":"","source":"eDcnBu","target":"XuJvHD"},{"id":"ATyeCI","type":"manual","label":"","source":"vgATWr","target":"XuJvHD"},{"id":"WiKltk","type":"manual","label":"","source":"QNGwzl","target":"XuJvHD"},{"id":"NUwdwJ","source":"DVDkVy","target":"MyUSlE"},{"id":"rEUEgJ","source":"IxKNEo","target":"RkFwAk"},{"id":"lpCKNq","source":"RkFwAk","target":"eDcnBu"},{"id":"uBAtLw","source":"DVDkVy","target":"UyBTnC"},{"id":"yQezIl","source":"UyBTnC","target":"rMoObY"},{"id":"eHzGyl","source":"cnNstL","target":"hxgKDP"},{"id":"ckHFkD","source":"hxgKDP","target":"KJLFMH"},{"id":"ilzTrR","source":"KJLFMH","target":"mEbdbz"},{"id":"dzrneN","source":"mEbdbz","target":"IxKNEo"},{"id":"AZutnl","source":"KJLFMH","target":"pswoCc"},{"id":"gnehcv","source":"pswoCc","target":"AVsXuk"},{"id":"XShgqJ","source":"AVsXuk","target":"cSmTTy"},{"id":"JqTZtV","source":"VGeMgN","target":"oFznyG"},{"id":"xNcLxg","source":"oFznyG","target":"BBYyBY"},{"id":"YpBept","type":"manual","label":"","source":"BBYyBY","target":"cnNstL"},{"id":"OjYdYR","type":"manual","label":"","source":"sAfAvI","target":"cnNstL"},{"id":"uRlPUV","type":"manual","label":"","source":"wHtDMR","target":"cnNstL"},{"id":"eGQaBK","type":"manual","label":"","source":"vUoqfz","target":"XuJvHD"},{"id":"WDJpYR","type":"manual","label":"","source":"kjITlT","target":"XuJvHD"},{"id":"vqWNOe","source":"VGeMgN","target":"ldXzDv"},{"id":"WxDNto","source":"ldXzDv","target":"sAfAvI"},{"id":"zwDxIi","source":"VGeMgN","target":"DUhHKy"},{"id":"fNTYAG","source":"DUhHKy","target":"wHtDMR"},{"id":"BqXRyy","source":"DVDkVy","target":"EndZbO"},{"id":"KDgnKx","source":"EndZbO","target":"Rnplmw"},{"id":"kTBfPf","source":"DVDkVy","target":"dWNLEB"},{"id":"IItLNa","source":"dWNLEB","target":"NQiOkX"},{"id":"aFOkvq","source":"DVDkVy","target":"SSyDHI"},{"id":"WzgUhF","source":"SSyDHI","target":"LfItkb"},{"id":"ouNPeL","source":"DVDkVy","target":"QPmitS"},{"id":"pvXmaC","source":"QPmitS","target":"VGeMgN"},{"id":"dWzZmQ","source":"IxKNEo","target":"KshDQD"},{"id":"aszaPg","source":"KshDQD","target":"vUoqfz"},{"id":"ieAkCZ","source":"AVsXuk","target":"kjITlT"},{"id":"FNJdQZ","source":"kjITlT","target":"qVdPaF"},{"id":"uiSsbS","source":"KJLFMH","target":"dAcaUo"},{"id":"eGicIX","source":"jrXhnD","target":"dAcaUo"},{"id":"LRZVtr","source":"dAcaUo","target":"Drxxtl"},{"id":"tkFnqp","source":"Drxxtl","target":"QNGwzl"},{"id":"KJLyBM","source":"QNGwzl","target":"qeeCny"},{"id":"ZPkSAR","source":"bBMpCb","target":"WPYqTE"}]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"jJmWIdONatljqNaQiQUERLpafRTVwEF_","flowDescription":"","locked":"no","created":"2023-03-06 09:39:52","updated":"2023-09-20 15:18:47"},{"flowId":"2473","appId":137,"flowName":"Highlight","workflow":{"nodes":[{"id":"gximIv","grid":{"h":123,"w":64,"x":0,"y":0,"hidden":false},"type":"report","appId":137,"label":"Dados","limit":100,"width":1473,"height":733,"layout":{"lg":{"h":123,"w":64,"x":0,"y":0,"height":733,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":0,"height":290,"hidden":false}},"tables":["tmp_men_venda","tmp_men_contratos","tmp_men_clientes","tmp_men_churn_fisico","tmp_men_perda_receita","tmp_men_migracoes_entrantes","tmp_men_migracoes_saintes","tmp_men_caixa","tmp_men_receita_liquida","tmp_men_opex","tmp_men_capex","tmp_ticket_medio","tmp_csl_dia","tbl_vnd_forecast_best","tmp_base_highlight_vnd","tmp_highlight_vnd","tmp_base_highlight_prd","tmp_highlight_prd","tmp_recebimento_caixa_mes","tmp_recebimento_caixa_ano","tmp_recebimento_caixa_dia","tmp_recebimento_caixa_plus","tmp_vnd_tic_iot_highlight","base_forecast_highlight_TIC"],"content":" ","created":false,"project":{"html":"<!DOCTYPE html>\r\n<html lang=\"pt-br\">\r\n<head>\r\n    <title>Highlights</title>\r\n    \r\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css\" integrity=\"sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh\" crossorigin=\"anonymous\">\r\n    \r\n    <script src=\"https://code.jquery.com/jquery-3.4.1.slim.min.js\" integrity=\"sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js\" integrity=\"sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js\" integrity=\"sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n    \r\n    <meta charset=\"utf-8\">\r\n</head>\r\n<body>\r\n    <div style=\"border:solid;border-color:#50E1BC\">\r\n    \r\n\r\n        <div style=\"background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n            <div class=\"container-fluid\">\r\n                <div class=\"row\">\r\n               \r\n                <div class=\"col-3\" style=\"text-align:left;margin: auto;\">\r\n                    <img\r\n                    src=\"/api/content/read/137/analytics_logo.png\"\r\n                    width=\"148px\">\r\n                </div>\r\n\r\n                <div class=\"col-6\"><h4 style=\"text-align:center; font-size: 30px;margin:auto\">\r\n                    PORTAL ANALYTICS - HIGHLIGHTS \r\n                    \r\n                    </h4></div>\r\n                \r\n                <div class=\"col-3\" style=\"font-size: 12px;margin: auto; text-align:right\"><img\r\n                        src=\"/api/content/read/137/logo_algartelecom.png\"\r\n                        height=\"40px\"></div>\r\n               \r\n             </div>\r\n            </div>\r\n\r\n\r\n\r\n            \r\n        </div>\r\n\r\n</div>\r\n<div style=\"padding-top:6px\"></div>\r\n<div style=\"border:solid;border-color:#50E1BC\">\r\n    \r\n\r\n        <div style=\"background-image: linear-gradient(#6BE1BC, #6BE1BC);\">\r\n            <div class=\"container-fluid\">\r\n                <div class=\"row\">\r\n               \r\n                <div class=\"col-3\" style=\"text-align:left;margin: auto;\" id=\"dataAtual\"></div>\r\n\r\n                <div class=\"col-6\"><h4 style=\"text-align:center\">PRINCIPAIS INDICADORES DE NEGÓCIOS E FINANCEIRO</h4></div>\r\n                \r\n                <div class=\"col-3\" style=\"font-size: 12px;margin: auto;\"><p style=\"margin: auto;\">Legenda: \r\n                    <strong style=\"color:green\"> ● </strong> Atingido &nbsp;\r\n                    <strong style=\"color:#EEAD00\"> ● </strong> Desvio &le; 5% &nbsp;\r\n                    <strong style=\"color:red\"> ● </strong> Desvio &ge; 5% </p></div>\r\n               \r\n             </div>\r\n            </div>\r\n\r\n\r\n\r\n            \r\n        </div>\r\n    \r\n        <div class=\"container-fluid\" style=\"padding-top: 6px;\">\r\n\r\n            <div class=\"row\" >\r\n                <div class=\"col-4\" style=\"border-right: solid #50E1BC;\">\r\n                    <div id=\"div-border\">\r\n                    <div style=\"background-image: linear-gradient(#A0E1BC, #A0E1BC);\">\r\n                        <h4 style=\"text-align:center;\">VENDAS (R$ mil)</h4></div>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-sm w-100\">\r\n                                <table>\r\n                                    <tr>\r\n                                        <td class=\"vlr_real\">{{ (tmp_base_highlight_vnd[0].REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"line-height: 1;\">Real  <br><small>({{tmp_recebimento_caixa_plus[0].diario}})</small></td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td class=\"vlr_forecast\">{{ (tmp_base_highlight_vnd[0].FORECAST_VENDA_/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"line-height: 1;\">Forecast <br><small>(mensal)</small></td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td class=\"vlr_orcado \">{{ (tmp_base_highlight_vnd[0].ORCADO/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"line-height: 1;\">Orçado <br><small>(mensal)</small></td>\r\n                                    </tr>\r\n                                    <tr>      \r\n                                        {% if tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL >= 100 %}                                  \r\n                                        <td class=\"vlr_forecast_percentual\" style=\"color:green\">{{ (tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n                                        {% elif tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL < 95 %}                                  \r\n                                        <td class=\"vlr_forecast_percentual\" style=\"color:red\">{{ (tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n\r\n                                        {% else %}\r\n                                        <td class=\"vlr_forecast_percentual\" style=\"color:#EEAD00\">{{ (tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n\r\n                                        {% endif %}\r\n                                        <td class=\"label\" style=\"line-height: 1;\">% Orçado<br> <small>(Forecast x Orçado)</small></td>\r\n                                    </tr>\r\n\r\n                                </table>\r\n                            </div>\r\n                            <div class=\"col-sm w-100\">\r\n                                <div id=\"graficoVenda\"></div>\r\n                            </div>\r\n                            \r\n                        </div>\r\n                        <div class=\"container-fluid\">\r\n                            <div class=\"row\">\r\n                        <table class=\"table table-sm\">\r\n                        <thead class=\"table\">\r\n                        <tr>\r\n                        <th scope=\"col\"></th>\r\n                        <th scope=\"col\" style=\"text-align:center\">Varejo</th>\r\n                        <th scope=\"col\" style=\"text-align:center\">&nbsp;MPE&nbsp;</th>\r\n                        <th scope=\"col\" style=\"text-align:center\">Corporativo</th>\r\n                        <th scope=\"col\" style=\"text-align:center\">Atacado</th>\r\n                        <th scope=\"col\" style=\"text-align:center;border-left: 2px solid #DEE2E6;\">*TIC<small style=\"padding:2.5px\">+</small>IoT</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr>\r\n                        <th scope=\"row\">Real <br><small>({{tmp_recebimento_caixa_plus[0].diario}})</small></th>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;border-left: 2px solid #DEE2E6;\">{% for item in base_forecast_highlight_TIC %}\r\n                            {% if item.Produto == 'TIC/IoT' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n\r\n                        </tr>\r\n                        <tr>\r\n                        <th scope=\"row\" >% Orçado<br> <small>(Forecast&nbsp;x&nbsp;Orçado)</small></th>\r\n                        {% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                                {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n                                {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n        \r\n                                {% else %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n                                {% endif %}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}\r\n                        \r\n                        {% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                                {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n                                {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n        \r\n                                {% else %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n                                {% endif %}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}\r\n                    </td>\r\n                    {% for item in tmp_base_highlight_vnd %}\r\n                    {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                        {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                        <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}%</td>\r\n                        {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                        <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n\r\n                        {% else %}\r\n                        <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n                        {% endif %}\r\n                    {% else %}\r\n                    {% endif %}\r\n                {% endfor %}\r\n                {% for item in tmp_base_highlight_vnd %}\r\n                {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                    {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                    <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                maximumFractionDigits: 0}) }}%</td>\r\n                    {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                    <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n\r\n                    {% else %}\r\n                    <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                    {% endif %}\r\n                {% else %}\r\n                {% endif %}\r\n            {% endfor %}\r\n            \r\n            {% for item in base_forecast_highlight_TIC %}\r\n                {% if item.Produto == 'TIC/IoT' %}\r\n                    {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n            <td style=\"text-align:center;vertical-align: middle;color:green;border-left: 2px solid #DEE2E6;\">\r\n                    {{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                 {% elif  item.FORECAST_PERCENTUAL < 95 %}\r\n                 <td style=\"text-align:center;vertical-align: middle;color:red;border-left: 2px solid #DEE2E6;\">\r\n                    {{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                  {% else %}   \r\n                  <td style=\"text-align:center;vertical-align: middle;color:#EEAD00;border-left: 2px solid #DEE2E6;\">\r\n                    {{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                  {% endif %}\r\n            {% else %}\r\n            {% endif %}\r\n            {% endfor %}\r\n                        </tr>\r\n                        \r\n                        </tbody>\r\n                        </table>\r\n                        <p class=\"label\" style=\"font-size:13px;padding:0;margin:0;margin-top:-15px\"><small>*Resultados de TIC + IoT estão contidos nos Segmentos de Negócios</small></p>\r\n                                \r\n                            \r\n                        </div>\r\n                        </div>\r\n                </div>\r\n\r\n                </div>\r\n                <div class=\"col-4\" style=\"border-right: solid #50E1BC;\">\r\n                    <div style=\"background-image: linear-gradient(#A0E1BC, #A0E1BC);\">\r\n                        <h4 style=\"text-align:center\">PERDA DE RECEITA (R$ mil)</h4></div>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-sm w-100\" >\r\n                                <table>\r\n                                    <tr style=\"padding-top:10.05px;padding-bottom:10.05px\">\r\n                                        <td class=\"vlr_real\" style=\"padding-top:10.05px;padding-bottom:10.05px\">{{ (tmp_base_highlight_prd[0].REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"padding-top:10.05px;padding-bottom:10.05px;line-height: 1\">Real <br><small>({{tmp_recebimento_caixa_plus[0].diario}})</small></td>\r\n                                    </tr>\r\n                                   \r\n                                    <tr style=\"padding-top:10.05px;padding-bottom:10.05px\">\r\n                                        <td class=\"vlr_orcado\" style=\"padding-top:10.05px;padding-bottom:10.05px\">{{ (tmp_base_highlight_prd[0].ORCADO/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"padding-top:10.05px;padding-bottom:10.05px;line-height: 1\">Orçado<br> <small>(mensal)</small></td>\r\n                                    </tr>\r\n                                    <tr style=\"padding-top:10.05px;padding-bottom:10.05px\">\r\n                                        \r\n                                        {% if tmp_base_highlight_prd[0].FORECAST_PERCENTUAL >= 105%}\r\n                                        <td class=\"vlr_forecast_percentual desvioPrd\" style=\"padding-top:10.05px;padding-bottom:10.05px;color:red\">{{ (tmp_base_highlight_prd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n                                        {% elif tmp_base_highlight_prd[0].FORECAST_PERCENTUAL >100 %}\r\n                                        <td class=\"vlr_forecast_percentual desvioPrd\" style=\"padding-top:10.05px;padding-bottom:10.05px;color:#EEAD00\">{{ (tmp_base_highlight_prd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n                                        {% else %}\r\n                                        <td class=\"vlr_forecast_percentual desvioPrd\" style=\"padding-top:10.05px;padding-bottom:10.05px;color:green\">{{ (tmp_base_highlight_prd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n\r\n                                        {% endif%}\r\n                                        <td class=\"label\" style=\"padding-top:10.05px;padding-bottom:10.05px;line-height: 1\">% Orçado<br><small>(Real x Orçado)</small></td>\r\n                                    </tr>\r\n\r\n                                </table>\r\n                            </div>\r\n                            <div class=\"col-sm w-100\">\r\n                                <div id=\"graficoPerda\"></div>\r\n                            </div>\r\n                            \r\n                        \r\n                    </div>\r\n                    <div class=\"container-fluid\">\r\n                        <div class=\"row\">\r\n                    <table class=\"table table-sm\">\r\n                    <thead class=\"table\">\r\n                    <tr>\r\n                    <th scope=\"col\"></th>\r\n                    <th scope=\"col\" style=\"text-align:center\">Varejo</th>\r\n                    <th scope=\"col\" style=\"text-align:center\">&nbsp;MPE&nbsp;</th>\r\n                    <th scope=\"col\" style=\"text-align:center\">Corporativo</th>\r\n                    <th scope=\"col\" style=\"text-align:center\">Atacado</th>\r\n                    </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                    <tr>\r\n                    <th scope=\"row\">Real <br><small> ({{tmp_recebimento_caixa_plus[0].diario}})</small></th>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    </tr>\r\n                    <tr>\r\n                    <th scope=\"row\">% Orçado<br> <small>(Real&nbsp;x&nbsp;Orçado)</small></th>\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    \r\n                    </tbody>\r\n                    </table>\r\n                            \r\n                        \r\n                    </div>\r\n                </div>\r\n                </div>\r\n                <div class=\"col-4\">\r\n                    <div style=\"background-image: linear-gradient(#A0E1BC, #A0E1BC);\">\r\n                        <h4 style=\"text-align:center\">RECEBIMENTOS DE CAIXA (R$ MM)</h4></div>\r\n                        <div class=\"container-fluid\" >\r\n                            <div style=\"padding-top:25px\"></div>\r\n                        <div class=\"row\" >\r\n<table class=\"table table-striped\">\r\n  <thead class=\"table table-borderless\">\r\n    <tr>\r\n      <th scope=\"col\" style=\"text-align:left;vertical-align: top;\">Posição de Caixa</th>\r\n      <th scope=\"col\" style=\"text-align:center\">Diário<br><small>({{tmp_recebimento_caixa_plus[0].diario}})</small></th>\r\n      <th scope=\"col\" style=\"text-align:center\">{{ tmp_recebimento_caixa_dia[0].mes }}/{{tmp_recebimento_caixa_plus[0].ano_2}} <br><small>(acum)</small></th>\r\n      <th scope=\"col\" style=\"text-align:center\">{{tmp_recebimento_caixa_plus[0].ano}}<br> <small>(acum YTD)</small></th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <th scope=\"row\">Previsto <br> <small>(Revisão)</small></th>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_dia[0].ORCADO/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_mes[0].ORCADO/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_ano[0].ORCADO/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Real</th>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_dia[0].REAL/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_mes[0].REAL/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_ano[0].REAL/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n    </tr>\r\n    \r\n    <tr>\r\n      <th scope=\"row\">Desvio abs.<br><small>(Real x Previsto)</small></th>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_dia[0].ABS/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_mes[0].ABS/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_ano[0].ABS/1).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n    </tr>\r\n    \r\n    <tr>\r\n      <th scope=\"row\">% Previsto<br><small>(Real x Previsto)</small></th>\r\n      {% if tmp_recebimento_caixa_dia[0].DESVIO < -5 %}\r\n        <td class=\"desvioCx\" style=\"color:red ; text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_dia[0].DESVIO }}%</td>\r\n      {% elif tmp_recebimento_caixa_dia[0].DESVIO >= 0 %}\r\n        <td class=\"desvioCx\" style=\"color:green;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_dia[0].DESVIO }}%</td>\r\n      {% else %}\r\n        <td class=\"desvioCx\" style=\"color:#EEAD00;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_dia[0].DESVIO }}%</td>\r\n      {% endif %}\r\n\r\n      {% if tmp_recebimento_caixa_mes[0].DESVIO < -5 %}\r\n        <td class=\"desvioCx\" style=\"color:red;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_mes[0].DESVIO }}%</td>\r\n      {% elif tmp_recebimento_caixa_mes[0].DESVIO >= 0 %}\r\n        <td class=\"desvioCx\" style=\"color:green;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_mes[0].DESVIO }}%</td>\r\n      {% else %}\r\n        <td class=\"desvioCx\" style=\"color:#EEAD00;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_mes[0].DESVIO }}%</td>\r\n      {% endif %}\r\n      \r\n      {% if tmp_recebimento_caixa_ano[0].DESVIO < -5 %}\r\n        <td class=\"desvioCx\" style=\"color:red;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_ano[0].DESVIO.toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% elif tmp_recebimento_caixa_ano[0].DESVIO >= 0 %}\r\n        <td class=\"desvioCx\" style=\"color:green;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_ano[0].DESVIO.toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% else %}\r\n        <td class=\"desvioCx\" style=\"color:#EEAD00;text-align:center;vertical-align: middle;\">{{ tmp_recebimento_caixa_ano[0].DESVIO.toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% endif %}\r\n      \r\n    </tr>\r\n  </tbody>\r\n</table>\r\n                            \r\n                        \r\n                    </div>\r\n                </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n            </div>\r\n       </div>\r\n<!-- CARROUSEL -->\r\n<div style=\"padding-top:6px\"></div>\r\n<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ\" crossorigin=\"anonymous\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe\" crossorigin=\"anonymous\"></script>\r\n<div style=\"border:solid;border-color:#50E1BC\">\r\n   \r\n    <div style=\"background-image: linear-gradient(#6BE1BC, #6BE1BC); text-align:center;\"><h4>PRINCIPAIS NOTÍCIAS DA COMPANHIA</h4></div>\r\n    \r\n   \r\n          <div class=\"row mx-auto my-auto justify-content-center\">\r\n        <div id=\"recipeCarousel\" class=\"carousel slide carousel-fade\" data-bs-ride=\"carousel\" data-bs-interval=\"10000\">\r\n            <div class=\"carousel-inner\" role=\"listbox\">\r\n                <div class=\"carousel-item active\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\" >\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_5.png\" class=\"img-fluid\">\r\n                            </div>\r\n                            <!--<div class=\"card-img-overlay\">1</div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_6.png\" class=\"img-fluid\">\r\n                            </div>\r\n                            <!--<div class=\"card-img-overlay\">2</div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\" style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_7.png\" class=\"img-fluid\">\r\n                            </div>\r\n                           <!-- <div class=\"card-img-overlay\">3/div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_8.png\" class=\"img-fluid\">\r\n                            </div>\r\n                           <!-- <div class=\"card-img-overlay\">4</div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <!-- Slot 5 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_5.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n               \r\n                <!-- Slot 6 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_6.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n             \r\n                <!-- Slot 7 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_7.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n               \r\n                <!-- Slot 8  \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_8.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n               \r\n                <!-- Slot 9 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_9.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                -->\r\n                <!-- Slot 10 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_10.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                -->\r\n            </div>\r\n            <a class=\"carousel-control-prev bg-transparent w-aut\" href=\"#recipeCarousel\" role=\"button\" data-bs-slide=\"prev\">\r\n                <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n            </a>\r\n            <a class=\"carousel-control-next bg-transparent w-aut\" href=\"#recipeCarousel\" role=\"button\" data-bs-slide=\"next\">\r\n                <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n            </a>\r\n        </div>\r\n       \r\n        </div>\r\n        <div style=\"padding-bottom:6px\"></div>\r\n         \r\n    \r\n    <!--<h5 class=\"mt-2 fw-light\">advances one slide at a time</h5>-->\r\n</div>\r\n\r\n<!-- FIM CARROUSEL -->\r\n\r\n  <script>\r\n      // GRAFICOS DE LINHAS\r\n         var optionsLineChart= {\r\n         series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_highlight_vnd %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         chart: {\r\n         height: 150,\r\n         type: 'area',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         dataLabels: {\r\n         enabled: false\r\n         \r\n         },\r\n         \r\n         yaxis: {\r\n            tickAmount: 3,\r\n             \r\n         labels: {\r\n             show: true,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0});\r\n           },\r\n           style: {\r\n            fontSize: '9px',\r\n            fontWeight: 'light',\r\n          }\r\n         },\r\n         \r\n          axisBorder: {\r\n              show: true,\r\n              color: '#000000',\r\n              offsetX: 0,\r\n              offsetY: 0\r\n          },\r\n          axisTicks: {\r\n              show: true,\r\n              borderType: 'solid',\r\n              color: '#000000',\r\n              width: 3,\r\n              offsetX: 0,\r\n              offsetY: 0\r\n          },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         width: 3\r\n         },\r\n         \r\n         /*colors: ['#008FFB', '#00E396'],*/\r\n         colors: ['#00E396'],\r\n          dataLabels: {\r\n            enabled: false,\r\n         },\r\n         grid: {\r\n         show: true,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n            \r\n            \r\n             lines: {\r\n                 show: false\r\n             }\r\n             \r\n         }\r\n         },\r\n         markers: {\r\n            size: 5\r\n         },\r\n         markers: {\r\n            size: 0,\r\n        },\r\n         xaxis: {\r\n\r\n             tickAmount: 5,\r\n             tickPlacement: 'between',\r\n            labels: {\r\n              style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 400,\r\n                  cssClass: 'apexcharts-xaxis-label',\r\n              }\r\n            }, \r\n         categories: [{% for item in tmp_highlight_vnd %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         \r\n         }\r\n         };\r\n      \r\n      // GRÁFICO VENDA MENSAL\r\n      var optionsVenda = {\r\n      series: [\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_highlight_vnd %}\r\n             {{ item.REAL_ACU }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n        \r\n      categories: [{% for item in tmp_highlight_vnd %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              \r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            },\r\n            chart: {\r\n    height: '180px',\r\n    width:'200px'\r\n},\r\ntitle: {\r\n    text: \"Evolução Diária {{tmp_recebimento_caixa_plus[0].diario}}\",\r\n    align: 'center',\r\n    margin: 10,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    floating: false,\r\n    style: {\r\n      fontSize:  '14px',\r\n      fontWeight:  'bold',\r\n      fontFamily:  undefined,\r\n      color:  '#263238'\r\n    },\r\n},\r\nyaxis: {\r\n      labels: {\r\n    formatter: function (value) {\r\n        return (value/1000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n    }\r\n  },\r\n  show: false,\r\n  \r\n}        \r\n            \r\n      };\r\n      \r\n      var chartgraficoVenda = new ApexCharts(document.querySelector(\"#graficoVenda\"), optionsLineChart);\r\n      chartgraficoVenda.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoVenda.updateOptions(optionsVenda)\r\n      }, 1);\r\n      \r\n      // GRÁFICO Perda MENSAL\r\n      var optionsPerda = {\r\n      series: [\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_highlight_prd %}\r\n             {{ item.REAL_ACU }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n        \r\n      categories: [{% for item in tmp_highlight_prd %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              \r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            },\r\n            chart: {\r\n    height: '180',\r\n    width:'200px'\r\n},\r\ntitle: {\r\n    text: \"Evolução Diária {{tmp_recebimento_caixa_plus[0].diario}}\",\r\n    align: 'center',\r\n    margin: 10,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    floating: false,\r\n    style: {\r\n      fontSize:  '14px',\r\n      fontWeight:  'bold',\r\n      fontFamily:  undefined,\r\n      color:  '#263238'\r\n    },\r\n},\r\n\r\n\r\nyaxis: {\r\n      labels: {\r\n    formatter: function (value) {\r\n        return (value/1000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n    }\r\n  },\r\n  show: false,\r\n  \r\n}\r\n            \r\n            \r\n      };\r\n      \r\n      var chartgraficoPerda = new ApexCharts(document.querySelector(\"#graficoPerda\"), optionsLineChart);\r\n      chartgraficoPerda.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoPerda.updateOptions(optionsPerda)\r\n      }, 1);\r\n      \r\n  </script>\r\n\r\n</body>\r\n</html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"\n.vlr_real {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 24px;\n}\n\n.vlr_forecast {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n  \n    font-size: 24px;\n}\n\n.vlr_orcado {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 24px;\n}\n\n.vlr_forecast_percentual {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 24px;\n}\n\n.label{\n    color: #454545;\n    font-weight: 500;\n   \n    \n    font-size: 15px;\n}\n\n.titulo_segmento {\n    \n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 16px;\n}\n\n.label_valor_segmento {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 16px;\n}\n.desvio,.desvioPrd,.desvioCx{text-align: center;}\n\n\n\ntd{font-weight: 700;\n    color: #576575;\n    font-size:18px;\n}\n\n\n\n/* Carrousel\n*/\n\n/*\n.card-img{\n    height:200px ;\n    \n}*/\n\n\n@media (max-width: 767px) {\n    .carousel-inner .carousel-item > div {\n        display: none;\n    }\n    .carousel-inner .carousel-item > div:first-child {\n        display: block;\n    }\n}\n\n.carousel-inner .carousel-item.active,\n.carousel-inner .carousel-item-next,\n.carousel-inner .carousel-item-prev {\n    display: flex;\n}\n\n/* medium and up screens */\n@media (min-width: 768px) {\n    \n    .carousel-inner .carousel-item-end.active,\n    .carousel-inner .carousel-item-next {\n      transform: translateX(25%);\n    }\n    \n    .carousel-inner .carousel-item-start.active, \n    .carousel-inner .carousel-item-prev {\n      transform: translateX(-25%);\n    }\n}\n\n.carousel-inner .carousel-item-end,\n.carousel-inner .carousel-item-start { \n  transform: translateX(0);\n}","script":"////////get date (DADOS)\r\nvar data = new Date();\r\n\r\nvar dia = String(data.getDate()).padStart(2, '0');\r\n\r\nvar mes = String(data.getMonth() + 1).padStart(2, '0');\r\n\r\nvar ano = data.getFullYear();\r\n\r\ndataAtual = 'Atualizado: ' + dia + '/' + mes + '/' + ano;\r\n\r\nconsole.log(dataAtual);\r\n\r\ndocument.getElementById(\"dataAtual\").innerHTML = dataAtual;\r\n\r\n\r\n\r\n//////////Carrousel\r\nlet items = document.querySelectorAll('.carousel .carousel-item')\r\n\r\nitems.forEach((el) => {\r\n    const minPerSlide = 4\r\n    let next = el.nextElementSibling\r\n    for (var i=1; i<minPerSlide; i++) {\r\n        if (!next) {\r\n            // wrap carousel by using first child\r\n        \tnext = items[0]\r\n      \t}\r\n        let cloneChild = next.cloneNode(true)\r\n        el.appendChild(cloneChild.children[0])\r\n        next = next.nextElementSibling\r\n    }\r\n})\r\n\r\nvar myCarousel = document.querySelector('#carousel')\r\nvar carousel = new bootstrap.Carousel(myCarousel,{\r\n    interval: 100,\r\n    wrap: false\r\n})"},"noSpeech":true,"position":{"x":429.16343715276264,"y":220.42657123543665},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":30,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"ZttEtuIWsTqIHJlhiAefcGdNTAnphbsT","flowDescription":"","locked":"no","created":"2023-04-18 15:22:13","updated":"2023-09-08 09:08:23"},{"flowId":"2005","appId":137,"flowName":"Portal Analytics","workflow":{"nodes":[{"id":"WlYHzl","grid":{"h":50,"w":64,"x":0,"y":1,"hidden":false},"type":"report","appId":137,"label":"Base","limit":100,"width":1321,"height":290,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_csl_dia","tmp_csl_mes","tmp_hrq_ata","tmp_hrq_crp","tmp_hrq_emp","tmp_hrq_vrj","tmp_sgm_ata_dia","tmp_sgm_ata_mes","tmp_sgm_crp_dia","tmp_sgm_crp_mes","tmp_sgm_emp_dia","tmp_sgm_emp_mes","tmp_sgm_vrj_dia","tmp_sgm_vrj_mes","tbl_vnd_forecast_best","forecast_atacado","tmp_sgm_emp_mes_tm","tmp_sgm_crp_mes_tm","tmp_sgm_ope_mes_tm","tmp_sgm_vrj_mes_tm","tmp_pdt_base_ata","tmp_pdt_base_crp","tmp_pdt_base_vrj","tmp_pdt_base_emp","tmp_total_pdt_crp","tmp_total_pdt_ata","tmp_total_pdt_emp","tmp_total_pdt_vrj"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\r\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\r\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\r\n\r\n   <style>\r\n      #btn_exp_sgm:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_hrq:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_produto:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_pdt:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_view_mensal:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_view_diaria:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      text-align: center;\r\n      }\r\n      #logo_analytics {\r\n      width: 70%;\r\n      }\r\n      #btn_menu {\r\n      font-size: 140%;\r\n      color: #FFFFFF;\r\n      }\r\n      .hrq_nivel_1 {\r\n      display: {{params.prm_hrq1}};\r\n      width: 500px !important;\r\n      }\r\n      .hrq_nivel_2 {\r\n      display: {{params.prm_hrq2}};\r\n      }\r\n      .hrq_nivel_3 {\r\n      display: {{params.prm_hrq3}};\r\n      }\r\n      .labelDataRefDia{\r\n          display: none;\r\n      }\r\n      #visao_diaria {\r\n      display: {{params.prm_visao_diaria}};\r\n      }\r\n      .hrq_real {\r\n      text-align: right;\r\n      }\r\n      .filtrarMes{\r\n          display: none;\r\n          color: black;\r\n          font-weight: 650;\r\n          text-decoration: underline;\r\n          cursor: pointer;\r\n          color:inherit;\r\n      }\r\n      #btn_exp_hrq {\r\n      display: {{params.prm_visao_hierarquia}};\r\n      }\r\n      #abertura_hrq {\r\n      display: {{params.prm_visao_hierarquia}};\r\n      }\r\n      .html5buttons {\r\n      display: none;\r\n      }\r\n      \r\n      #DataTables_Table_0_length, #DataTables_Table_1_length, #DataTables_Table_2_length, #DataTables_Table_3_length {\r\n      display: none;\r\n      }\r\n      #DataTables_Table_0_paginate, #DataTables_Table_1_paginate, #DataTables_Table_2_paginate, #DataTables_Table_3_paginate {\r\n      display: none;\r\n      }\r\n      #DataTables_Table_0, #DataTables_Table_1, #DataTables_Table_2, #DataTables_Table_3 {\r\n      width: 100% !important;\r\n      }\r\n      .table.dataTable thead .sorting_asc:after {\r\n      content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n      width: 24px;\r\n      }\r\n      .table.dataTable thead .sorting_desc:after {\r\n      content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/decrescente.png\");\r\n      }\r\n      .table.dataTable thead .sorting:after {\r\n      opacity: 0.2;\r\n      content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n      }\r\n      .table table-striped table-bordered table-hover dataTables-example dataTable no-footer {\r\n      width: 100%;\r\n      }\r\n      .table table-striped table-bordered table-hover dataTables-example dataTable no-footer{\r\n          width: 100% !important; \r\n      }\r\n      #result_insights_csl {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_crp {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_emp {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_ope {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_res {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #filtrarMesHrqCrp, #labelDataRefDiaHrqCrp {\r\n          display: block;\r\n      }\r\n      #carregando {\r\n            animation: rodar 1s infinite;\r\n            border: 6px solid #ededed;\r\n            border-radius: 50%;\r\n            border-top-color: #51d4db;\r\n            height: 30px;\r\n            width: 30px;\r\n            position: fixed;\r\n            margin:  25% 50% 0%;\r\n            z-index: 1;\r\n        }\r\n        \r\n        @keyframes rodar {\r\n            to {\r\n                transform: rotate(1turn);\r\n            }\r\n        }\r\n        .percentual {\r\n            font-weight: 600;\r\n            display: inline-block; \r\n        }\r\n        #aviso_confidencial{\r\n            font-weight: 600;\r\n            font-size: 15px;\r\n            color: #090909;\r\n            margin-top: 15px;\r\n            margin-bottom: 15px;\r\n            /*background-color: #c22c18;*/\r\n            border: 2px solid #c22c18;\r\n            text-align: center;\r\n        }\r\n   </style>\r\n   <meta charset=\"utf-8\">\r\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n   <title>Portal Analytics</title>\r\n</head>\r\n<body>\r\n    <div id=\"carregando\" style=\"display: none\"></div>\r\n   <div id=\"wrapper\">\r\n      <!-- Ínicio menu -->\r\n      <nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a onclick=\"get_results()\">\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\"  class=\"{% if params.prm_indicador_pai == 'Negócio' %}\r\n                                              active\r\n                                            {% else %}\r\n                                             \r\n                                            {% endif %}\" >\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a onclick=\"get_results()\">\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li><!--\r\n                              <a  target=\"_blank\" href=\"http://spotfirehom.algartelecom.com.br/spotfire/wp/OpenAnalysis?file=200d4235-9a88-4887-8a6d-e69fb53583ff\" id=\"item_menu_venda_digital\">\r\n                              Digital\r\n                              </a>-->\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a>Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a >Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a onclick=\"get_results()\">\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_atendimento_digital\">\r\n                        <a onclick=\"get_results()\" style=\"color: #676a6c;\"  href=\"https://gaio.algartelecom.com.br/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                    </li>\r\n                     \r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a >Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     \r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\"   class=\"{% if params.prm_indicador_pai == 'Financeiro' %}\r\n                                              active\r\n                                            {% else %}\r\n                                             \r\n                                            {% endif %}\" >\r\n                  <a> \r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                      <li id=\"item_menu_margem_contribuicao\">\r\n                        <a onclick=\"get_results()\">Margem Contribuição</a>\r\n                     </li>\r\n                      <li id=\"item_menu_ebit\">\r\n                        <a onclick=\"get_results()\">Ebit</a>\r\n                     </li>\r\n                      <li id=\"item_menu_ebitda\">\r\n                        <a onclick=\"get_results()\">Ebitda</a>\r\n                     </li> \r\n   \r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Bruta\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Líquida\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_caixa_livre\">\r\n                        <a>Caixa Livre (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex</a>\r\n                     </li>\r\n                      \r\n                    \r\n                     \r\n                     \r\n                  </ul>\r\n               </li>\r\n               \r\n                <li id=\"side-bar-transformacao\">\r\n                  <a> \r\n                  <i class=\"fa fa-rocket\"></i>\r\n                  <span class=\"nav-label\" >\r\n                  Transformação (WIP)\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-transformacao-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_desempenho_projeto\">\r\n                        <a onclick=\"get_results()\">Desempenho de Projetos (WIP)</a>\r\n                     </li>\r\n                    \r\n                  </ul>\r\n               </li>\r\n               \r\n               \r\n               \r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               \r\n\r\n               <li id=\"side-bar-ed\">\r\n                <a>\r\n                <i class=\"fa fa-cloud-download\"></i>\r\n                <span class=\"nav-label\">Tecnologia (WIP)</span>\r\n                </a>\r\n                <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                   collapse\">\r\n                <li id=\"item_menu_evolucao_digital\">\r\n                    <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                \r\n                            \r\n                            <li id=\"item_menu_pulse_check\">\r\n                                <a>Data Driven (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Operações automatizadas (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Novos negócios digitais (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Mindset Digital (WIP)</a>\r\n                            </li>\r\n                        </ul>\r\n                </ul>\r\n            </li>\r\n             </li>\r\n\r\n\r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>\r\n      <!-- Fim menu -->\r\n\t  \r\n      <!-- Ínicio conteúdo -->\r\n      <div id=\"page-wrapper\" class=\"gray-bg\">\r\n         <div class=\"row border-bottom\">\r\n         </div>\r\n         <!-- Ínicio cabeçalho -->\r\n         <div class=\"col-lg-12 \">\r\n            <div class=\"row \" style=\"height: 86px;\">\r\n               <nav class=\"navbar navbar-static-top\" role=\"navigation\"\r\n                  style=\"margin-bottom: 10px; background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n                  <div class=\"navbar-header\">\r\n                     <a id=\"btn_menu\" class=\"navbar-minimalize\r\n                        minimalize-styl-2\" href=\"#\">\r\n                     <i class=\"fa fa-bars\"></i>\r\n                     </a>\r\n                     <a class=\"navbar-minimalize minimalize-styl-2\"\r\n                        href=\"#\"\r\n                        style=\"cursor: default; margin-top: 5px;\">\r\n                     <img src=\"/api/content/read/137/analytics_logo.png\" width=\"240px\">\r\n                     </a>\r\n                  </div>\r\n                  <h2 class=\"m-r-sm text-white welcome-message\"\r\n                     style=\"font-size: 24px; font-weight: 500;\">\r\n                     <strong style=\"color:#363636;font-size: 30px\">Portal Analytics</strong>\r\n                  </h2>\r\n                  <ul class=\"nav navbar-top-links navbar-right\">\r\n                     <li>\r\n                        <span class=\"m-r-sm text-muted\r\n                           welcome-message\">\r\n                            <img src=\"/api/content/read/137/logo_algartelecom.png\" height=\"50px\">\r\n                            <!--\r\n                        <img\r\n                           src=\"/api/content/read/22/logo_algar.png\"\r\n                           height=\"34px\">-->\r\n                        </span>\r\n                     </li>\r\n                  </ul>\r\n               </nav>\r\n            </div>\r\n            <div id=\"aviso_confidencial\">&#60;&#60;&#60;\r\n               AS INFORMAÇÕES PUBLICADAS NESTE PORTAL SÃO CONFIDENCIAIS E NÃO PODEM SER DIVULGADAS NEM REPRODUZIDAS.\r\n               &#62;&#62;&#62;\r\n            </div>\r\n         </div>\r\n         <!-- Fim Cabeçalho -->\r\n\t\t \r\n\t\t <!-- Ínicio Área Filtros -->\r\n         <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-7\" style=\"margin-top: 50px;\">\r\n               <ol class=\"breadcrumb\">\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Indicadores</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>{{params.prm_indicador_pai}}</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item active\">\r\n                     <a>{{params.prm_indicador}}</a>\r\n                  </li>\r\n               </ol>\r\n               <span>Linha de Negócio Filtrada: {{params.ProdutoBaseContrato}}</span>\r\n            </div>\r\n            <div class=\"col-lg-3\">\r\n               <div class=\"title-action\">\r\n                  <h2>\r\n                     <i id=\"limpar_filtro\" class=\"text-muted fa fa-refresh\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Limpar Filtros\" style=\"cursor: pointer;\"></i> \r\n                     <i id=\"filtrar\"\r\n                        class=\"text-muted fa fa-filter\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Filtros\"\r\n                        style=\"cursor: pointer;\"></i>\r\n                  </h2>\r\n               </div>\r\n            </div>\r\n            <div class=\"col-lg-2\">\r\n            </div>\r\n         </div>\r\n         <!-- Ínicio Área Filtros -->\r\n\t\t \r\n         <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!-- Ínicio \"Seção 1\" -->\r\n            {% if params.prm_indicador == 'Ticket Medio' %}\r\n            \r\n            {% else %}\r\n            <div class=\"row\">\r\n               <!-- Ínicio \"Gráfico 1\" -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5>\r\n                           {{params.prm_indicador}} ({{params.prm_escala_texto}})\r\n                           <span style=\"color: #D3D3D3\">\r\n                           {% if params.prm_indicador == 'Base de Clientes' %}\r\n                           * Para Base de 2022 não se aplica orçado / 2023 considera Revisão Orçamento\r\n                           {% elif params.prm_indicador == 'Venda' %}\r\n                           * 2023 considera Revisão Orçamento\r\n                           {% else %}\r\n                           * 2023 considera Revisão Orçamento\r\n                           {% endif %}\r\n                           </span>\r\n                         \r\n                           \r\n                           <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\r\n                               \r\n                              <span class=\"btn btn-white\" id=\"btn_view_mensal\" style=\"display:none\">Ver Mensal</span>\r\n                              <a class=\"btn btn-white\" id=\"btn_view_diaria\" style=\"display:block\"><span>Ver Diário</span></a>\r\n                           </div>\r\n                        </h5>\r\n                        <div class='filtrarMes' id=\"filtrarMescsl\">Filtrar Mês</div>\r\n                        <div class=\"labelDataRefDia\" id=\"labelDataRefDiacsl\">\r\n                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                        </div>\r\n                     </div>\r\n                     <div class=\"ibox-content\">\r\n                        <div id=\"grafMes\" style=\"display:block\">\r\n                           <div id=\"graficoConsolidadoMensal\"></div>\r\n                        </div>\r\n                        <div id=\"grafDia\" style=\"display:none\">\r\n                           <div id=\"graficoConsolidadoDiario\"></div>\r\n                        </div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Gráfico 1\" -->\r\n               <!-- Ínicio \"Insights 1\" -->\r\n            </div>\r\n            <div class=\"row\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                     </div>\r\n                     <div class=\"ibox-content\">\r\n                        <!--<ul id=\"result_insights\">\r\n                            \r\n                        </ul>-->\r\n                        {% if params.prm_indicador == 'Ebit' %}\r\n                       \r\n                       <ul><li>WIP</li></ul> \r\n\r\n                        {% elif params.prm_indicador == 'Ebitda' %}\r\n                        <ul><li>WIP</li></ul> \r\n                        {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                        <ul><li>WIP</li></ul> \r\n\r\n                        {% else %}\r\n                        <ul id=\"result_insights_csl\">\r\n                            \r\n                        </ul>\r\n                         {% endif %}\r\n                       \r\n                        \r\n                        <ul>\r\n                        {% if params.prm_indicador == 'Venda' %}\r\n                                                    {% for item in tbl_vnd_forecast_best %}\r\n                                                        {% if item.SEGMENTO == 'CONSOLIDADO' %}\r\n                                                           <!--<li>O Forecast aponta para R$ {{ ((item.VENDA_FORECAST/1000).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0})) }} mil ({{ item.percentual_orcado }}% do Orçado), considerando produtividade diária e Best Guess de Vendas (em sistema).</li>-->\r\n                                                        {% else %}\r\n                                                  \r\n                                                        {% endif %}\r\n                                                        \r\n                                                        {% endfor %}\r\n                                                \r\n                                                {% else %}\r\n                                                {% endif %}\r\n                        \r\n                        \r\n                                                {% if params.prm_indicador == 'Venda' %}\r\n\r\n                                                 <!--<li>O Forecast consolidado aponta para R$7.843  mil (96% do Orçado), considerando produtividade diária/Bestguess.</li>-->\r\n                                                 <li>O Forecast TIC + IoT aponta para R$ 1.118 mil (61% do Orçado), considerando produtividade diária/Best Sistêmico.</li>\r\n                                                {% endif %}\r\n                        \r\n                        \r\n                        {% if params.prm_indicador == 'Base de Clientes' %}\r\n                            <h5>Nota:</h5>\r\n                            <span>Métrica dependente dos ciclos de faturamento.</span>\r\n                            {% elif params.prm_indicador == 'Receita Bruta' %}\r\n                            <h5>Nota:</h5>\r\n                            <span>Receita Bruta Eliminada</span>\r\n                            {% elif params.prm_indicador == 'Receita Líquida' %}\r\n                            <h5>Nota:</h5>\r\n                            <span>Receita Líquida Eliminada</span>\r\n                            \r\n                            {% elif params.prm_indicador == 'Ticket Medio' %}\r\n                            <h5>Nota:</h5>\r\n                            <span>Métrica calculada como Faturamento (R$) / # Base de Clientes, portanto é influenciada pelos ciclos de faturamento para mês corrente</span>\r\n                            {% elif params.prm_indicador == 'Venda' %}\r\n                            \r\n                            {% else %}\r\n                            {% endif %}\r\n                            \r\n                            </ul>\r\n                            \r\n                            \r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Insights 1\" -->\r\n            </div>\r\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\r\n            <div class=\"ibox-content\" style=\"text-align: center; {% if params.prm_indicador == 'Fluxo de Caixa' %}\r\n                                              display: none\r\n                                            {% elif params.prm_indicador == 'Recebimentos de Caixa' %}\r\n                                                display: none\r\n                                            {% elif params.prm_indicador == 'Fluxo de Caixa Livre' %}\r\n                                                display: none\r\n                                            {% else %}\r\n                                              display: revert;\r\n                                            {% endif %}\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_sgm\" class=\"btn btn-white\">Abertura Segmento</span>\r\n                  <!-- <a class=\"btn btn-white\" id=\"btn_exp_pdt\" href=\"https://gaio.algartelecom.com.br/dashboard/qVZOUAbwNJvYeofYKcbCxFjGFskMSWxckVcK\"><span>Abertura Produto</span></a> -->\r\n               </div>\r\n            </div>\r\n            {% endif %}\r\n            \r\n            <!-- Ínicio \"Seção 2\" -->\r\n            <div id=\"abertura_sgm\" class=\"row\"              {% if params.prm_indicador == 'Ticket Medio' %}\r\n                                                              style=\"display: block;\"\r\n                                                            {% else %}\r\n                                                              style=\"display: none;\"\r\n                                                            {% endif %}>\r\n               <!-- Ínicio \"Tabs\" Segmento -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                        <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-11\"> Corporativo</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-21\">MPE</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-31\">Atacado</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-41\">Varejo</a></li>\r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio Corporativo -->\r\n                        <div role=\"tabpanel\" id=\"tab-11\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico Corporativo\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             {{params.prm_indicador}} ({{params.prm_escala_texto}})\r\n                                             <span style=\"color: #D3D3D3\">\r\n                                               {% if params.prm_indicador == 'Base de Clientes' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% elif params.prm_indicador == 'Venda' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% else %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% endif %}\r\n                                               </span>\r\n                                             <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;;\">\r\n                                                <span class=\"btn btn-white\" id=\"btn_view_mensal_crp\" style=\"display:none\">Ver Mensal</span>\r\n                                                <span class=\"btn btn-white\" id=\"btn_view_diaria_crp\" style=\"display:block\">Ver Diário</span>\r\n                                             </div>\r\n                                          </h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMescrp\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiacrp\">\r\n                                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                        </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <div id=\"grafMesCorp\" style=\"display:block\">\r\n                                             <div id=\"graficoCorporativoMensal\"></div>\r\n                                          </div>\r\n                                          <div id=\"grafDiaCorp\" style=\"display:none\">\r\n                                             <div id=\"graficoCorporativoDiario\"></div>\r\n                                          </div>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico Corporativo\" -->\r\n                                 <!-- Ínicio \"Insights Corporativo\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          \r\n                                           \r\n                                          \r\n                                            \r\n                                             {% if params.prm_indicador == 'Ebit' %}\r\n                       \r\n                                               <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% elif params.prm_indicador == 'Ebitda' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                                                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% else %}\r\n                                                <ul id=\"result_insights_crp\">\r\n                                                    \r\n                                                </ul>\r\n                                                 {% endif %}    \r\n                                            \r\n                                             \r\n                                             <ul>   \r\n                                             \r\n                                             {% if params.prm_indicador == 'Venda' %}\r\n                                                    {% for item in tbl_vnd_forecast_best %}\r\n                                                        {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                                                           <!--<li>O Forecast aponta para R$ {{ ((item.VENDA_FORECAST/1000).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0})) }} mil ({{ item.percentual_orcado }}% do Orçado), considerando Best Guess de Vendas (em sistema).</li>-->\r\n                                                        {% else %}\r\n                                                  \r\n                                                        {% endif %}\r\n                                                        \r\n                                                        {% endfor %}\r\n                                                \r\n                                                {% else %}\r\n                                                {% endif %}\r\n                                                \r\n                                                {% if params.prm_indicador == 'Venda' %}\r\n                                                 <!--<li>O Forecast para o Corporativo aponta para R$ 4.014 mil (100% do Orçado), considerando Bestguess.</li>-->\r\n                                                <h5>Nota:</h5>\r\n                                               <span>Considera-se Falcon a partir de Jan/23.</span><br>\r\n                                               <span>Considera-se Taxa de Instalação a partir de Abr/23.</span>\r\n                                               {% elif params.prm_indicador == 'Ticket Medio' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Métrica dependente dos ciclos de faturamento.</span>\r\n                                               {% elif params.prm_indicador == 'Receita Bruta' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Bruta Eliminada</span>\r\n                                                {% elif params.prm_indicador == 'Receita Líquida' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Líquida Eliminada</span>\r\n                                               {% else %}\r\n                                               \r\n                                              {% endif %}\r\n                                            \r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights Corporativo\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Corporativo -->\r\n                        <!-- Ínicio Empresarial\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico Empresarial\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             {{params.prm_indicador}} ({{params.prm_escala_texto}})\r\n                                             <span style=\"color: #D3D3D3\">\r\n                                               {% if params.prm_indicador == 'Base de Clientes' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% elif params.prm_indicador == 'Venda' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% else %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% endif %}\r\n                                               </span>\r\n                                             <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\r\n                                                <span class=\"btn btn-white\" id=\"btn_view_mensal_emp\" style=\"display:none\">Ver Mensal</span>\r\n                                                <a class=\"btn btn-white\" id=\"btn_view_diaria_emp\" style=\"display:block\"><span>Ver Diário</span></a>\r\n                                             </div>\r\n                                          </h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesemp\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiaemp\">\r\n                                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                        </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <div id=\"grafMesEmp\" style=\"display:block\">\r\n                                             <div id=\"graficoEmpresarialMensal\"></div>\r\n                                          </div>\r\n                                          <div id=\"grafDiaEmp\" style=\"display:none\">\r\n                                             <div id=\"graficoEmpresarialDiario\"></div>\r\n                                          </div>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico Empresarial\" -->\r\n                                 <!-- Ínicio \"Insights Empresarial\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          \r\n                                           {% if params.prm_indicador == 'Ebit' %}\r\n                       \r\n                                               <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% elif params.prm_indicador == 'Ebitda' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                                                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% else %}\r\n                                                <ul id=\"result_insights_emp\">\r\n                                                    \r\n                                                </ul>\r\n                                                 {% endif %}\r\n                                          \r\n                                          \r\n                                          \r\n                                          <ul>\r\n                                             \r\n                                             {% if params.prm_indicador == 'Venda' %}\r\n                                                    {% for item in tbl_vnd_forecast_best %}\r\n                                                        {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                                                           <!--<li>O Forecast aponta para R$ {{ ((item.VENDA_FORECAST/1000).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0})) }} mil ({{ item.percentual_orcado }}% do Orçado), considerando produtividade diária.</li>-->\r\n                                                        {% else %}\r\n                                                  \r\n                                                        {% endif %}\r\n                                                        \r\n                                                        {% endfor %}\r\n                                                \r\n                                                {% else %}\r\n                                                {% endif %}\r\n                                                \r\n                                                {% if params.prm_indicador == 'Venda' %}\r\n\r\n                                                 <!--<li>O Forecast para o MPE aponta para R$ 873 mil (76% do Orçado), considerando produtividade diária.</li>-->\r\n                                                {% endif %}\r\n                                                \r\n                                              \r\n                                             {% if params.prm_indicador ==  'Ticket Medio' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Métrica dependente dos ciclos de faturamento.</span>\r\n                                             {% elif params.prm_indicador == 'Receita Bruta' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Bruta Eliminada</span>\r\n                                                {% elif params.prm_indicador == 'Receita Líquida' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Líquida Eliminada</span>\r\n                                               {% else %}\r\n                                               \r\n                                              {% endif %}\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights Empresarial\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Empresarial -->\r\n                        <!-- Ínicio Atacado\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-31\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico Atacado\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                              \r\n                                             {{params.prm_indicador}} ({{params.prm_escala_texto}})\r\n                                             <span style=\"color: #D3D3D3\">\r\n                                               {% if params.prm_indicador == 'Base de Clientes' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% elif params.prm_indicador == 'Venda' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% else %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% endif %}\r\n                                               </span>\r\n                                             <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;;\">\r\n                                                <span class=\"btn btn-white\" id=\"btn_view_mensal_ata\" style=\"display:none\">Ver Mensal</span>\r\n                                                <a class=\"btn btn-white\" id=\"btn_view_diaria_ata\" style=\"display:block\"><span>Ver Diário</span></a>\r\n                                             </div>\r\n                                          </h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesata\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiaata\">\r\n                                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                        </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <div id=\"grafMesAta\" style=\"display:block\">\r\n                                             <div id=\"graficoAtacadoMensal\"></div>\r\n                                          </div>\r\n                                          <div id=\"grafDiaAta\" style=\"display:none\">\r\n                                             <div id=\"graficoAtacadoDiario\"></div>\r\n                                          </div>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico Atacado\" -->\r\n                                 <!-- Ínicio \"Insights Atacado\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          \r\n                                          {% if params.prm_indicador == 'Ebit' %}\r\n                       \r\n                                               <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% elif params.prm_indicador == 'Ebitda' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                                                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% else %}\r\n                                                <ul id=\"result_insights_ope\">\r\n                                                    \r\n                                                </ul>\r\n                                                 {% endif %}\r\n                                          \r\n                                          \r\n                                          <ul>\r\n                                              \r\n                                             \r\n                                             {% if params.prm_indicador == 'Venda' %}\r\n                                                    {% for item in tbl_vnd_forecast_best %}\r\n                                                        {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                                                           <!--<li>O Forecast aponta para R$ {{ ((item.VENDA_FORECAST/1000).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0})) }} mil ({{ item.percentual_orcado }}% do Orçado), considerando produtividade diária.</li>-->\r\n                                                        {% else %}\r\n                                                  \r\n                                                        {% endif %}\r\n                                                        \r\n                                                        {% endfor %}\r\n                                                \r\n                                                {% else %}\r\n                                                {% endif %}\r\n                                                \r\n                                                {% if params.prm_indicador == 'Venda' %}\r\n\r\n                                                 <!--<li>O Forecast para o Atacado aponta para R$ 373 mil (109% do Orçado), considerando Bestguess.</li>-->\r\n                                                {% endif %}\r\n                                                \r\n                                                {% if params.prm_indicador == 'Venda' %}\r\n                                                <h5>Nota:</h5>\r\n                                               <span>Considera-se Falcon a partir de Fev/23</span><br>\r\n                                               <span>Forecast Atacado atualizado em: {{ forecast_atacado[0].Data }}.</span>\r\n                                               {% elif params.prm_indicador == 'Ticket Medio' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Métrica dependente dos ciclos de faturamento.</span><br>\r\n                                                <span>Métrica cálculada em relação aos circuitos de conectividade.</span>\r\n                                                {% elif params.prm_indicador == 'Receita Bruta' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Bruta Eliminada</span>\r\n                                                {% elif params.prm_indicador == 'Receita Líquida' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Líquida Eliminada</span>\r\n                                               {% else %}\r\n                                               \r\n                                              {% endif %}\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights Atacado\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim  Atacado -->\r\n                        <!-- Ínicio Varejo\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico Varejo\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             {{params.prm_indicador}} ({{params.prm_escala_texto}})\r\n                                             <span style=\"color: #D3D3D3\">\r\n                                               {% if params.prm_indicador == 'Base de Clientes' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% elif params.prm_indicador == 'Venda' %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% else %}\r\n                                               * 2023 considera Revisão Orçamento\r\n                                               {% endif %}\r\n                                               </span>\r\n                                             <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\r\n                                                <span class=\"btn btn-white\" id=\"btn_view_mensal_vrj\" style=\"display:none\">Ver Mensal</span>\r\n                                                <a class=\"btn btn-white\" id=\"btn_view_diaria_vrj\" style=\"display:block\"><span>Ver Diário</span></a>\r\n                                             </div>\r\n                                          </h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesres\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiares\">\r\n                                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                        </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <div id=\"grafMesVar\" style=\"display:block\">\r\n                                             <div id=\"graficoVarejoMensal\"></div>\r\n                                          </div>\r\n                                          <div id=\"grafDiaVar\" style=\"display:none\">\r\n                                             <div id=\"graficoVarejoDiario\"></div>\r\n                                          </div>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico Varejo\" -->\r\n                                 <!-- Ínicio \"Insights Varejo\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           {% if params.prm_indicador == 'Ebit' %}\r\n                       \r\n                                               <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% elif params.prm_indicador == 'Ebitda' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                                                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                <ul><li>WIP</li></ul> \r\n                        \r\n                                                {% else %}\r\n                                                <ul id=\"result_insights_res\">\r\n                                                    \r\n                                                </ul>\r\n                                                 {% endif %}\r\n                                          \r\n                                          \r\n                                          \r\n                                          <ul>\r\n                                             \r\n                                             \r\n                                             {% if params.prm_indicador == 'Venda' %}\r\n                                                    {% for item in tbl_vnd_forecast_best %}\r\n                                                        {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                                               <!--<li>O Forecast para o Residencial aponta para R$ 2.582 mil (96% do Orçado), considerando produtividade diária.</li> -->\r\n                                                           <!--<li>O Forecast aponta para R$ {{ ((item.VENDA_FORECAST/1000).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0})) }} mil ({{ item.percentual_orcado }}% do Orçado), considerando produtividade diária.</li>-->\r\n                                                        {% else %}\r\n                                                  \r\n                                                        {% endif %}\r\n                                                        \r\n                                                        {% endfor %}\r\n                                                \r\n                                                {% else %}\r\n                                                {% endif %}\r\n                                                \r\n                                                \r\n                                                {% if params.prm_indicador ==  'Ticket Medio' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Métrica dependente dos ciclos de faturamento.</span>\r\n                                                {% elif params.prm_indicador == 'Venda' %}\r\n                                                \r\n                                                {% elif params.prm_indicador == 'Receita Bruta' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Bruta Eliminada</span>\r\n                                                {% elif params.prm_indicador == 'Receita Líquida' %}\r\n                                                <h5>Nota:</h5>\r\n                                                <span>Receita Líquida Eliminada</span>\r\n                                                {% else %}\r\n                                                {% endif %}\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights Varejo\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim  Varejo -->\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Segmento -->\r\n            </div>\r\n            <!-- Fim \"Seção 2\" -->\r\n            <div id=\"pai_btn_exp_hrq\" class=\"ibox-content\" style=\"text-align: center; display: none\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_hrq\" class=\"btn btn-white\">Abertura Hierarquia</span>\r\n                  <span style=\"display: {% if params.prm_indicador == 'Receita Bruta' %}\r\n                                                block\r\n                                                {% elif params.prm_indicador == 'Receita Líquida' %}\r\n                                                block\r\n                                                {% elif params.prm_indicador == 'Migração Entrante' %}\r\n                                                block\r\n                                               {% else %}\r\n                                               none\r\n                                              {% endif %};\" id=\"btn_exp_produto\" class=\"btn btn-white\">Abertura Produto</span>\r\n               </div>\r\n            </div>\r\n            <div id=\"abertura_produto\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" Produto -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                        <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-p11\">Corporativo</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-p21\">MPE</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-p31\">Atacado</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-p41\">Varejo</a></li>\r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio Corporativo -->\r\n                        <div role=\"tabpanel\" id=\"tab-p11\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th style=\"text-align:center;\">Linha de Negócio</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-2)</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-1)</th>\r\n                                                   <th style=\"text-align:center;\">Variação</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% for item in tmp_pdt_base_crp %}\r\n                                                <tr>\r\n                                                   <td>{{ item.DSC_LNH_NGC }}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.VARIACAO/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                                </tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% endfor %}\r\n                                             </tbody>\r\n                                             <tfoot style='font-weight: 700'>\r\n                                                 <td>Total</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_crp[0].REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_crp[0].REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ ((tmp_total_pdt_crp[0].REAL_MES_ANTERIOR-tmp_total_pdt_crp[0].REAL_MES_ATUAL)/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                             </tfoot>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Corporativo -->\r\n                        <!-- Ínicio Empresarial\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-p21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th style=\"text-align:center;\">Linha de Negócio</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-2)</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-1)</th>\r\n                                                   <th style=\"text-align:center;\">Variação</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% for item in tmp_pdt_base_emp %}\r\n                                                <tr>\r\n                                                   <td>{{ item.DSC_LNH_NGC }}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.VARIACAO/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                                </tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% endfor %}\r\n                                             </tbody>\r\n                                             <tfoot style='font-weight: 700'>\r\n                                                 <td>Total</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_emp[0].REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_emp[0].REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ ((tmp_total_pdt_emp[0].REAL_MES_ANTERIOR-tmp_total_pdt_emp[0].REAL_MES_ATUAL)/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                             </tfoot>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Empresarial -->\r\n                        <!-- Ínicio Atacado\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-p31\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th style=\"text-align:center;\">Linha de Negócio</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-2)</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-1)</th>\r\n                                                   <th style=\"text-align:center;\">Variação</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% for item in tmp_pdt_base_ata  %}\r\n                                                <tr>\r\n                                                   <td>{{ item.DSC_LNH_NGC }}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.VARIACAO/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}} </td>\r\n                                                </tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% endfor %}\r\n                                             </tbody>\r\n                                             <tfoot style='font-weight: 700'>\r\n                                                 <td>Total</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_ata[0].REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_ata[0].REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ ((tmp_total_pdt_ata[0].REAL_MES_ANTERIOR-tmp_total_pdt_ata[0].REAL_MES_ATUAL)/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                             </tfoot>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Atacado -->\r\n                        <!-- Ínicio Varejo\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-p41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th style=\"text-align:center;\">Linha de Negócio</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-2)</th>\r\n                                                   <th style=\"text-align:center;\">Real (M-1)</th>\r\n                                                   <th style=\"text-align:center;\">Variação</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% for item in tmp_pdt_base_vrj %}\r\n                                                <tr>\r\n                                                   <td>{{ item.DSC_LNH_NGC }}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t   <td class=\"hrq_real\">{{ (item.VARIACAO/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                                </tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{% endfor %}\r\n                                             </tbody>\r\n                                             <tfoot style='font-weight: 700'>\r\n                                                 <td>Total</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_vrj[0].REAL_MES_ANTERIOR/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ (tmp_total_pdt_vrj[0].REAL_MES_ATUAL/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2}) }}</td>\r\n                                                 <td class=\"hrq_real\">{{ ((tmp_total_pdt_vrj[0].REAL_MES_ANTERIOR-tmp_total_pdt_vrj[0].REAL_MES_ATUAL)/1000000).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 2,\r\n                                                           maximumFractionDigits: 2})}}</td>\r\n                                             </tfoot>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Varejo -->\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Produto -->\r\n            </div>\r\n            <!-- Ínicio \"Seção 3\"-->\r\n            <div id=\"abertura_hrq\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" Hierarquia -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                        <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-h11\">{% if params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Corporativo\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Corporativo\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Corporativo\r\n                                                      {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Corporativo\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Corporativo\r\n                                                      {% else %}\r\n                                                      Corporativo (WIP)\r\n                                                      {% endif %}</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h21\">{% if params.prm_indicador == 'Receita Líquida' %}\r\n                                                      MPE\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      MPE\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      MPE\r\n                                                      {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      MPE\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      MPE\r\n                                                      {% else %}\r\n                                                      MPE (WIP)\r\n                                                      {% endif %}</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h31\">{% if params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Atacado\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Atacado\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Atacado\r\n                                                      {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Atacado\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Atacado\r\n                                                      {% else %}\r\n                                                      Atacado (WIP)\r\n                                                      {% endif %}</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h41\">{% if params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Varejo\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Varejo\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Varejo\r\n                                                      {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Varejo\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Varejo\r\n                                                      {% else %}\r\n                                                      Varejo (WIP)\r\n                                                      {% endif %}</a></li>\r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio Corporativo -->\r\n                        <div role=\"tabpanel\" id=\"tab-h11\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesHrqCrp\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\">\r\n                                              <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                           </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <!--<th class='hrq_nivel_1'>{% if params.prm_indicador == 'Venda' %}\r\n                                                      Diretoria\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Diretoria\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   <th class='hrq_nivel_2'> {% if params.prm_indicador == 'Venda' %}\r\n                                                      Gerencia\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Gerencia\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>-->\r\n                                                   {% if params.prm_indicador == 'Venda' %}\r\n                                                   {% else %}\r\n                                                   <th class='hrq_nivel_3'> {% if params.prm_indicador == 'Migração Entrante' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Migração Sainte' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Base de Contratos' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Churn Físico' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Venda' %}\r\n                                                      Coordenação\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Coordenação\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Regional\r\n                                                       {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Regional\r\n                                                       {% elseif params.prm_indicador == 'Receita Liquida' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Regional\r\n                                                      \r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   {% endif %}\r\n                                                   <th>Real</th>\r\n                                                   <th>Orçado</th>\r\n                                                   <th>Consecução</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_hrq_crp %}\r\n                                                <tr>\r\n                                                   <!--<td class='hrq_nivel_1'>{{ item.HRQ_1 }}</td>\r\n                                                   <td class='hrq_nivel_2'>{{ item.HRQ_2 }}</td>-->\r\n                                                   {% if params.prm_indicador == 'Venda' %}\r\n                                                   {% else %}\r\n                                                   <td class='hrq_nivel_3'>{{ item.HRQ_3 }}</td>\r\n                                                   {% endif %}\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.REAL/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.ORCADO/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ ((item.REAL/item.ORCADO)*100).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 0,\r\n                                                           maximumFractionDigits: 0})}} %</td>\r\n                                                </tr>\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Corporativo -->\r\n                        <!-- Ínicio Empresarial\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-h21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                        <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesHrqCrp\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\">\r\n                                              <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                           </div>\r\n                                       </div>\r\n                                       \r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <!--<th class='hrq_nivel_1'>{% if params.prm_indicador == 'Venda' %}\r\n                                                      Área de Atuação\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Área de Atuação\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   <th class='hrq_nivel_2'>{% if params.prm_indicador == 'Venda' %}\r\n                                                      Gerência\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Gerência\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>-->\r\n                                                   <th class='hrq_nivel_3'>{% if params.prm_indicador == 'Migração Entrante' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Migração Sainte' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Base de Contratos' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Churn Físico' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Venda' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Regional\r\n                                                       {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Regional\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   <th>Real</th>\r\n                                                   <th>Orçado</th>\r\n                                                   <th>Consecução</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_hrq_emp %}\r\n                                                <tr>\r\n                                                   <!--<td class='hrq_nivel_1'>{{ item.HRQ_1 }}</td>\r\n                                                   <td class='hrq_nivel_2'>{{ item.HRQ_2 }}</td>-->\r\n                                                   {% if params.prm_indicador == 'Venda' %}\r\n                                                   {% else %}\r\n                                                   <td class='hrq_nivel_3'>{{ item.HRQ_3 }}</td>\r\n                                                   {% endif %}\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.REAL/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.ORCADO/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ ((item.REAL/item.ORCADO)*100).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 0,\r\n                                                           maximumFractionDigits: 0})}} %</td>\r\n                                                </tr>\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Empresarial -->\r\n                        <!-- Ínicio Atacado\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-h31\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesHrqCrp\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\">\r\n                                              <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                           </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th class='hrq_nivel_3'>{% if params.prm_indicador == 'Migração Entrante' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Migração Sainte' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Base de Contratos' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Churn Físico' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Venda' %}\r\n                                                      Subsegmento\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Subsegmento\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Regional\r\n                                                       {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Regional\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   <th>Real</th>\r\n                                                   <th>Orçado</th>\r\n                                                   <th>Consecução</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_hrq_ata %}\r\n                                                <tr>\r\n                                                  <!-- <td class='hrq_nivel_1'>{{ item.HRQ_1 }}</td>\r\n                                                   <td class='hrq_nivel_2'>{{ item.HRQ_2 }}</td>-->\r\n                                                   {% if params.prm_indicador == 'Venda' %}\r\n                                                   {% else %}\r\n                                                   <td class='hrq_nivel_3'>{{ item.HRQ_3 }}</td>\r\n                                                   {% endif %}\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.REAL/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.ORCADO/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ ((item.REAL/item.ORCADO)*100).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 0,\r\n                                                           maximumFractionDigits: 0})}} %</td>\r\n                                                </tr>\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Atacado -->\r\n                        <!-- Ínicio Varejo\" -->\r\n                        <div role=\"tabpanel\" id=\"tab-h41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>{{params.prm_indicador}} ({{params.prm_escala_texto}})</h5>\r\n                                          <div class='filtrarMes' id=\"filtrarMesHrqCrp\">Filtrar Mês</div>\r\n                                          <div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\">\r\n                                              <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\r\n                                           </div>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <!--<th class='hrq_nivel_1'>{% if params.prm_indicador == 'Venda' %}\r\n                                                      Gestão\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Gestão\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   <th class='hrq_nivel_2'>{% if params.prm_indicador == 'Venda' %}\r\n                                                      Área de Atuação\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Área de Atuação\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>-->\r\n                                                   <th class='hrq_nivel_3'>{% if params.prm_indicador == 'Migração Entrante' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Migração Sainte' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Base de Contratos' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Churn Físico' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Venda' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Perda de Receita' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Margem Contribuição' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Ebit' %}\r\n                                                      Regional\r\n                                                       {% elseif params.prm_indicador == 'Ebitda' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Líquida' %}\r\n                                                      Regional\r\n                                                      {% elseif params.prm_indicador == 'Receita Bruta' %}\r\n                                                      Regional\r\n                                                      {% else %}\r\n                                                      Erro\r\n                                                      {% endif %}\r\n                                                   </th>\r\n                                                   <th>Real</th>\r\n                                                   <th>Orçado</th>\r\n                                                   <th>Consecução</th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_hrq_vrj %}\r\n                                                <tr>\r\n                                                   <!--<td class='hrq_nivel_1'>{{ item.HRQ_1 }}</td>\r\n                                                   <td class='hrq_nivel_2'>{{ item.HRQ_2 }}</td>-->\r\n                                                   {% if params.prm_indicador == 'Venda' %}\r\n                                                   {% else %}\r\n                                                   <td class='hrq_nivel_3'>{{ item.HRQ_3 }}</td>\r\n                                                   {% endif %}\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.REAL/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ params.prm_escala_prefixo }}{{ (item.ORCADO/params.prm_escala_decimais).toLocaleString('pt-BR') }}</td>\r\n                                                   <td class='hrq_real'>{{ ((item.REAL/item.ORCADO)*100).toLocaleString('pt-BR', \r\n                                                          {minimumFractionDigits: 0,\r\n                                                           maximumFractionDigits: 0})}} %</td>\r\n                                                </tr>\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Varejo -->\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Hierarquia -->\r\n            </div>\r\n               <!-- Fim \"Tabs\" Hierarquia -->\r\n            </div>\r\n            <!-- Fim \"Seção3\" -->\r\n         </div>\r\n      </div>\r\n      <!-- Fim conteúdo -->\r\n   </div>\r\n   <!-- Mainly scripts -->\r\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\r\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\r\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\r\n   <!-- Custom and plugin javascript -->\r\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\r\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\r\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\r\n   <script>\r\n\t\t// Função criada para inserir tempo de espera entre execuções\r\n      function sleep(ms) {\r\n            return new Promise(resolve => setTimeout(resolve, ms));\r\n         };\r\n         \r\n      async function carregando() {\r\n\t\t\t  var carrega = document.getElementById(\"carregando\");\r\n              carrega.style.display = \"block\";\r\n              await sleep(10000);\r\n              carrega.style.display = \"none\";\r\n              \r\n          };  \r\n          \r\nvar base_ctt = 'teste';\r\n\r\n{% if params.prm_indicador == 'Base de Contratos' %}\r\n    base_ctt = ' Mensal - ' + context.params.ProdutoBaseContrato;\r\n    console.log(base_ctt);\r\n{% else %}\r\n    base_ctt = ''\r\n{% endif %}\r\n\r\n\r\nvar dadosNLP = Array(0);\r\nvar insights_final = Array(0);\r\n\r\nfetch('https://gaio.algartelecom.com.br/api/rest/pnaVxMEfqPVKHAzwmBbkkeB_wtmUQqJh/tmp_hom_processa_nlp/?filtro_api_id_nlp=all_')\r\n.then(response => {\r\n    return response.json();\r\n})\r\n.then(data => {\r\n    dadosNLP = data;\r\n\r\n});\r\n\r\nlet dia_um = 0;\r\n\r\nif(context.params.dia_mes == 1){\r\n    dia_um = 1;\r\n}\r\n    \r\n\r\n$(document).ready(function(){\r\n              $('.dataTables-example').DataTable({\r\n                  pageLength: 100,\r\n                  responsive: true,\r\n                  dom: '<\"html5buttons\"B>lTfgitp',\r\n                  buttons: [\r\n                      { extend: 'copy'},\r\n                      {extend: 'csv'},\r\n                      {extend: 'excel', title: 'ExampleFile'},\r\n                      {extend: 'pdf', title: 'ExampleFile'},\r\n         \r\n                      {extend: 'print',\r\n                       customize: function (win){\r\n                              $(win.document.body).addClass('white-bg');\r\n                              $(win.document.body).css('font-size', '10px');\r\n         \r\n                              $(win.document.body).find('table')\r\n                                      .addClass('compact')\r\n                                      .css('font-size', 'inherit');\r\n                      }\r\n                      }\r\n                  ]\r\n         \r\n              });\r\n         \r\n          });\r\n\r\n\r\n(async () => {\r\n    await sleep(4000);\r\n    \r\n    \r\n    \r\n    for (var i = 0; i < dadosNLP.length; i++) {\r\n        switch (dadosNLP[i].id_insight.substring(0, 2)) {\r\n          case '10':\r\n            if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                    \r\n                $('#result_insights_csl').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '20':\r\n            if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                    \r\n                $('#result_insights_crp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '21':\r\n            if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                    \r\n                $('#result_insights_emp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            } \r\n            break;\r\n          case '22':\r\n            if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                    \r\n                $('#result_insights_res').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n            break;\r\n          case '23':\r\n            if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                const texto = dadosNLP[i].nlp;\r\n                const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                let insight_tratado = prefixo;\r\n                if(dia_um == 1){\r\n                    insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                }\r\n                    \r\n                $('#result_insights_ope').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n            }\r\n                \r\n            break;\r\n          default:\r\n            console.log('Erro.');\r\n        }\r\n        \r\n        \r\n        \r\n        \r\n    }\r\n\r\n})();\r\n         \r\n    // Botão que leva ao indicador Venda Consolidado\r\n          $(\"#item_menu_venda_consolidada\").click(async function() {\r\n              \r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(5000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });     \r\n         \r\n\t  // Botão que leva ao Menu\r\n\t\t  $(\"#side-bar-menu\").click(async function() {\r\n\t\t\t// Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['all_'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                       await carregando();\r\n              await sleep(5000);\r\n              await dispatchEvent({ formFlowId: 1808, formType: 'openFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: 'all_' }]});\r\n          });\r\n\t  \r\n\t\t  // Botão que leva ao indicador Base de Contratos\r\n\t\t  $(\"#item_menu_base_contrato\").click(async function() {\r\n\t\t\t  // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });  \r\n          });\r\n\t\t  \r\n\t\t  \r\n          \r\n          // Botão que leva ao indicador Base de Clientes\r\n          $(\"#item_menu_base_cliente\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                       { paramName:'insights', paramValue: 'all_' },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n\t\t\t  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] }); \r\n         \r\n          });\r\n\r\n\t\t  // Botão que leva ao indicador Ticket Medio\r\n          $(\"#item_menu_faturamento\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         \r\n          });\r\n          \r\n          \r\n           // Botão que leva ao indicador Ebit\r\n         $(\"#item_menu_ebit\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n       \r\n\r\n          \r\n            // Botão que leva ao indicador Ebitda\r\n         $(\"#item_menu_ebitda\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n          \r\n            // Botão que leva ao indicador Margem Contribuição\r\n         $(\"#item_menu_margem_contribuicao\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Margem Contribuição Mensal', 'Receita Liquida Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n          \r\n          \r\n           //  Botão que leva ao indicador Receita Liquida\r\n        $(\"#item_menu_receita-bruta\").click(async function() {\r\n             await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n             params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Bruta Mensal','Receita Bruta'] },\r\n                      { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                      { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n             await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         }); \r\n          \r\n          \r\n          \r\n            //  Botão que leva ao indicador Receita Liquida\r\n        $(\"#item_menu_receita-liquida\").click(async function() {\r\n             await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n             params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                      { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                      { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n             await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         }); \r\n          \r\n        //  Botão que leva ao indicador Receita Liquida\r\n        $(\"#item_menu_caixa\").click(async function() {\r\n             await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n             params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Mensal','Fluxo de Caixa'] },\r\n                      { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                      { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n             await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         }); \r\n         \r\n         //Gráfico Recebimento\r\n      $(\"#item_menu_recebimento\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Recebimentos de Caixa Mensal','Recebimentos de Caixa'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await carregando();\r\n          await sleep(10000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n      });\r\n      \r\n       //Gráfico Fluxo de Caixa Livre\r\n      $(\"#item_caixa_livre\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Livre Mensal','Fluxo de Caixa Livre'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await carregando();\r\n          await sleep(10000);\r\n          await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n      });\r\n         \r\n          \r\n          \r\n          \r\n         // Botão que leva ao indicador Perda de Receita\r\n         $(\"#item_menu_perda_receita\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n\t\t  // Botão que leva ao indicador Churn Físico\r\n          $(\"#item_menu_churn_fisico\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Churn Físico', 'Churn Físico Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n\t\t  // Botão que leva ao indicador Migrações Entrantes\r\n          $(\"#item_menu_migracoes_entrantes\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Entrante', 'Migração Entrante Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n\t\t  // Botão que leva ao indicador Migrações Saintes\r\n          $(\"#item_menu_migracoes_saintes\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Sainte', 'Migração Sainte Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n          \r\n          \r\n            // Botão que leva ao indicador Desempenho Projetos\r\n             $(\"#item_menu_desempenho_projeto\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3400, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              // Botão que leva ao indicador CAPEX\r\n             $(\"#item_menu_capex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['CAPEX', 'CAPEX Mensal']}] });\r\n              });\r\n              \r\n             \r\n             // Botão que leva ao indicador CAPEX\r\n             $(\"#item_menu_opex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['OPEX', 'OPEX Mensal']}] });\r\n              });\r\n          \r\n          \r\n          \r\n\t\t  \r\n          \r\n                      \r\n                      \r\n         \r\n         \r\n         $(\"#btn_exp_sgm\").click(function() {\r\n           var area_segmento = document.getElementById(\"abertura_sgm\");\r\n           var area_hierarquia = document.getElementById(\"abertura_hrq\");\r\n           var area_produto = document.getElementById(\"abertura_produto\");\r\n           var btn_sgm = document.getElementById(\"btn_exp_sgm\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           var btn_pdt = document.getElementById(\"btn_exp_produto\");\r\n           var pai_btn_hrq = document.getElementById(\"pai_btn_exp_hrq\");\r\n           if (area_segmento.style.display === \"none\") {\r\n           \tarea_segmento.style.display = \"block\";\r\n           \tpai_btn_hrq.style.display = \"block\";\r\n           \tbtn_sgm.innerHTML = \"Esconder Segmento\";\r\n           } else {\r\n           \tarea_segmento.style.display = \"none\";\r\n           \tbtn_sgm.innerHTML = \"Abertura Segmento\";\r\n           \tpai_btn_hrq.style.display = \"none\";\r\n           \tarea_hierarquia.style.display = \"none\";\r\n           \tarea_produto.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Hierarquia\";\r\n           \tbtn_pdt.innerHTML = \"Abertura Produto\";\r\n           }\r\n          });\r\n          \r\n          \r\n          $(\"#btn_exp_pdt\").click(function() {\r\n           dispatchEvent({ formFlowId: 1694, formType: 'loadFlow', params: []  });\r\n          });\r\n          \r\n           $(\"#btn_exp_hrq\").click(function() {\r\n               var area_hierarquia = document.getElementById(\"abertura_hrq\");\r\n               var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n               var area_produto = document.getElementById(\"abertura_produto\");\r\n               var btn_pdt = document.getElementById(\"btn_exp_produto\");\r\n               area_produto.style.display = \"none\";\r\n               btn_pdt.innerHTML = \"Abertura Produto\";\r\n           \r\n           if (area_hierarquia.style.display === \"none\") {\r\n           \t    area_hierarquia.style.display = \"block\";\r\n           \t    btn_hrq.innerHTML = \"Esconder Hierarquia\";\r\n           } else {\r\n           \t    area_hierarquia.style.display = \"none\";\r\n           \t    btn_hrq.innerHTML = \"Abertura Hierarquia\";\r\n           }\r\n          });\r\n          \r\n          $(\"#btn_exp_produto\").click(function() {\r\n           var area_produto = document.getElementById(\"abertura_produto\");\r\n           var btn_pdt = document.getElementById(\"btn_exp_produto\");\r\n           \r\n           var area_hierarquia = document.getElementById(\"abertura_hrq\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           \r\n           \tarea_hierarquia.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Hierarquia\";\r\n           \r\n           \r\n           \r\n           if (area_produto.style.display === \"none\") {\r\n           \tarea_produto.style.display = \"block\";\r\n           \tbtn_pdt.innerHTML = \"Esconder Produto\";\r\n           } else {\r\n           \tarea_produto.style.display = \"none\";\r\n           \tbtn_pdt.innerHTML = \"Abertura Produto\";\r\n           }\r\n          });\r\n          \r\n          // Inicio consolidado\r\n          $(\"#btn_view_diaria\").click(function() {\r\n           var grafDia = document.getElementById(\"grafDia\");\r\n           var grafMes = document.getElementById(\"grafMes\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacsl\");\r\n           var filtro = document.getElementById(\"filtrarMescsl\");\r\n           var btn_view_diaria = document.getElementById(\"btn_view_diaria\");\r\n           var btn_view_mensal = document.getElementById(\"btn_view_mensal\");\r\n           if (grafDia.style.display === \"none\") {\r\n           \tgrafDia.style.display = \"block\";\r\n           \tbtn_view_diaria.style.display = \"none\";\r\n           \tgrafMes.style.display = \"none\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tbtn_view_mensal.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDia.style.display = \"none\";\r\n           \tbtn_view_diaria.style.display = \"block\";\r\n           \tgrafMes.style.display = \"block\";\r\n           \tbtn_view_mensal.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal\").click(function() {\r\n           var grafDia = document.getElementById(\"grafDia\");\r\n           var grafMes = document.getElementById(\"grafMes\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacsl\");\r\n           var filtro = document.getElementById(\"filtrarMescsl\");\r\n           var btn_view_diaria = document.getElementById(\"btn_view_diaria\");\r\n           var btn_view_mensal = document.getElementById(\"btn_view_mensal\");\r\n           if (grafMes.style.display === \"none\") {\r\n           \tgrafDia.style.display = \"none\";\r\n           \tbtn_view_diaria.style.display = \"block\";\r\n           \tgrafMes.style.display = \"block\";\r\n           \tbtn_view_mensal.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDia.style.display = \"block\";\r\n           \tbtn_view_diaria.style.display = \"none\";\r\n           \tgrafMes.style.display = \"none\";\r\n           \tbtn_view_mensal.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim consolidado\r\n         \r\n         // Inicio Corporativo\r\n         $(\"#btn_view_diaria_crp\").click(function() {\r\n           var grafDiaCorp = document.getElementById(\"grafDiaCorp\");\r\n           var grafMesCorp = document.getElementById(\"grafMesCorp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacrp\");\r\n           var filtro = document.getElementById(\"filtrarMescrp\");\r\n           var btn_view_diaria_crp = document.getElementById(\"btn_view_diaria_crp\");\r\n           var btn_view_mensal_crp = document.getElementById(\"btn_view_mensal_crp\");\r\n           if (grafDiaCorp.style.display === \"none\") {\r\n           \tgrafDiaCorp.style.display = \"block\";\r\n           \tbtn_view_diaria_crp.style.display = \"none\";\r\n           \tgrafMesCorp.style.display = \"none\";\r\n           \tbtn_view_mensal_crp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaCorp.style.display = \"none\";\r\n           \tbtn_view_diaria_crp.style.display = \"block\";\r\n           \tgrafMesCorp.style.display = \"block\";\r\n           \tbtn_view_mensal_crp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_crp\").click(function() {\r\n           var grafDiaCorp = document.getElementById(\"grafDiaCorp\");\r\n           var grafMesCorp = document.getElementById(\"grafMesCorp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacrp\");\r\n           var filtro = document.getElementById(\"filtrarMescrp\");\r\n           var btn_view_diaria_crp = document.getElementById(\"btn_view_diaria_crp\");\r\n           var btn_view_mensal_crp = document.getElementById(\"btn_view_mensal_crp\");\r\n           if (grafMesCorp.style.display === \"none\") {\r\n           \tgrafDiaCorp.style.display = \"none\";\r\n           \tbtn_view_diaria_crp.style.display = \"block\";\r\n           \tgrafMesCorp.style.display = \"block\";\r\n           \tbtn_view_mensal_crp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaCorp.style.display = \"block\";\r\n           \tbtn_view_diaria_crp.style.display = \"none\";\r\n           \tgrafMesCorp.style.display = \"none\";\r\n           \tbtn_view_mensal_crp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Corporativo\r\n         \r\n         \r\n         // Inicio Empresarial\r\n          $(\"#btn_view_diaria_emp\").click(function() {\r\n           var grafDiaEmp = document.getElementById(\"grafDiaEmp\");\r\n           var grafMesEmp = document.getElementById(\"grafMesEmp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaemp\");\r\n           var filtro = document.getElementById(\"filtrarMesemp\");\r\n           var btn_view_diaria_emp = document.getElementById(\"btn_view_diaria_emp\");\r\n           var btn_view_mensal_emp = document.getElementById(\"btn_view_mensal_emp\");\r\n           if (grafDiaEmp.style.display === \"none\") {\r\n           \tgrafDiaEmp.style.display = \"block\";\r\n           \tbtn_view_diaria_emp.style.display = \"none\";\r\n           \tgrafMesEmp.style.display = \"none\";\r\n           \tbtn_view_mensal_emp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaEmp.style.display = \"none\";\r\n           \tbtn_view_diaria_emp.style.display = \"block\";\r\n           \tgrafMesEmp.style.display = \"block\";\r\n           \tbtn_view_mensal_emp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_emp\").click(function() {\r\n           var grafDiaEmp = document.getElementById(\"grafDiaEmp\");\r\n           var grafMesEmp = document.getElementById(\"grafMesEmp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaemp\");\r\n           var filtro = document.getElementById(\"filtrarMesemp\");\r\n           var btn_view_diaria_emp = document.getElementById(\"btn_view_diaria_emp\");\r\n           var btn_view_mensal_emp = document.getElementById(\"btn_view_mensal_emp\");\r\n           if (grafMesEmp.style.display === \"none\") {\r\n           \tgrafDiaEmp.style.display = \"none\";\r\n           \tbtn_view_diaria_emp.style.display = \"block\";\r\n           \tgrafMesEmp.style.display = \"block\";\r\n           \tbtn_view_mensal_emp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaEmp.style.display = \"block\";\r\n           \tbtn_view_diaria_emp.style.display = \"none\";\r\n           \tgrafMesEmp.style.display = \"none\";\r\n           \tbtn_view_mensal_emp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Empresarial\r\n         \r\n         // Inicio Atacado\r\n          $(\"#btn_view_diaria_ata\").click(function() {\r\n           var grafDiaAta = document.getElementById(\"grafDiaAta\");\r\n           var grafMesAta = document.getElementById(\"grafMesAta\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaata\");\r\n           var filtro = document.getElementById(\"filtrarMesata\");\r\n           var btn_view_diaria_ata = document.getElementById(\"btn_view_diaria_ata\");\r\n           var btn_view_mensal_ata = document.getElementById(\"btn_view_mensal_ata\");\r\n           if (grafDiaAta.style.display === \"none\") {\r\n           \tgrafDiaAta.style.display = \"block\";\r\n           \tbtn_view_diaria_ata.style.display = \"none\";\r\n           \tgrafMesAta.style.display = \"none\";\r\n           \tbtn_view_mensal_ata.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaAta.style.display = \"none\";\r\n           \tbtn_view_diaria_ata.style.display = \"block\";\r\n           \tgrafMesAta.style.display = \"block\";\r\n           \tbtn_view_mensal_ata.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_ata\").click(function() {\r\n           var grafDiaAta = document.getElementById(\"grafDiaAta\");\r\n           var grafMesAta = document.getElementById(\"grafMesAta\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaata\");\r\n           var filtro = document.getElementById(\"filtrarMesata\");\r\n           var btn_view_diaria_ata = document.getElementById(\"btn_view_diaria_ata\");\r\n           var btn_view_mensal_ata = document.getElementById(\"btn_view_mensal_ata\");\r\n           if (grafMesAta.style.display === \"none\") {\r\n           \tgrafDiaAta.style.display = \"none\";\r\n           \tbtn_view_diaria_ata.style.display = \"block\";\r\n           \tgrafMesAta.style.display = \"block\";\r\n           \tbtn_view_mensal_ata.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaAta.style.display = \"block\";\r\n           \tbtn_view_diaria_ata.style.display = \"none\";\r\n           \tgrafMesAta.style.display = \"none\";\r\n           \tbtn_view_mensal_ata.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Atacado\r\n         \r\n         \r\n         // Inicio Varejo\r\n          $(\"#btn_view_diaria_vrj\").click(function() {\r\n           var grafDiaVar = document.getElementById(\"grafDiaVar\");\r\n           var grafMesVar = document.getElementById(\"grafMesVar\");\r\n           var labelData = document.getElementById(\"labelDataRefDiares\");\r\n           var filtro = document.getElementById(\"filtrarMesres\");\r\n           var btn_view_diaria_vrj = document.getElementById(\"btn_view_diaria_vrj\");\r\n           var btn_view_mensal_vrj = document.getElementById(\"btn_view_mensal_vrj\");\r\n           if (grafDiaVar.style.display === \"none\") {\r\n           \tgrafDiaVar.style.display = \"block\";\r\n           \tbtn_view_diaria_vrj.style.display = \"none\";\r\n           \tgrafMesVar.style.display = \"none\";\r\n           \tbtn_view_mensal_vrj.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaVar.style.display = \"none\";\r\n           \tbtn_view_diaria_vrj.style.display = \"block\";\r\n           \tgrafMesVar.style.display = \"block\";\r\n           \tbtn_view_mensal_vrj.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_vrj\").click(function() {\r\n           var grafDiaVar = document.getElementById(\"grafDiaVar\");\r\n           var grafMesVar = document.getElementById(\"grafMesVar\");\r\n           var labelData = document.getElementById(\"labelDataRefDiares\");\r\n           var filtro = document.getElementById(\"filtrarMesres\");\r\n           var btn_view_diaria_vrj = document.getElementById(\"btn_view_diaria_vrj\");\r\n           var btn_view_mensal_vrj = document.getElementById(\"btn_view_mensal_vrj\");\r\n           if (grafMesVar.style.display === \"none\") {\r\n           \tgrafDiaVar.style.display = \"none\";\r\n           \tbtn_view_diaria_vrj.style.display = \"block\";\r\n           \tgrafMesVar.style.display = \"block\";\r\n           \tbtn_view_mensal_vrj.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaVar.style.display = \"block\";\r\n           \tbtn_view_diaria_vrj.style.display = \"none\";\r\n           \tgrafMesVar.style.display = \"none\";\r\n           \tbtn_view_mensal_vrj.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Varejo\r\n         \r\n         \r\n          \r\n          \r\n         \r\n         \r\n         /*$( \"#limpar_filtro\" ).click(function() {\r\n          dispatchEvent(\r\n                              {   \r\n                                  formFlowId: 1807,\r\n                                   formType: 'loadFlow',\r\n                                   params: [{ paramName:'Mes_Ref', paramValue: 'all_' },\r\n                                            { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]\r\n                                              })\r\n         });*/\r\n         \r\n         \r\n         {% if params.prm_indicador == 'Venda' %}\r\n          //tic_iot\r\n         $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'aDpFvH'\r\n               })\r\n         });\r\n        {% elif params.prm_indicador == 'Perda de Receita' %}\r\n          $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'aDpFvH'\r\n               })\r\n         });\r\n         {% elif params.prm_indicador == 'Ebit' %}\r\n          $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'EQPaGv'\r\n               })\r\n         });\r\n         {% elif params.prm_indicador == 'Ebitda' %}\r\n          $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'EQPaGv'\r\n               })\r\n         });\r\n        {% else %}\r\n          //Geral produto + Tic_iot\r\n         $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'EQPaGv'\r\n               })\r\n         }); \r\n        {% endif %}\r\n         \r\n\r\n         \r\n         \r\n         \r\n         $(\".filtrarMes\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'XYsRMO'\r\n               })\r\n         }); \r\n         \r\n         \r\n         $(\"#limpar_filtro\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', formReload: true,\r\n              params: [ { paramName:'ProdutoBaseContrato', paramValue: 'all_' },\r\n                        { paramName:'prm_filtro_tic_iot', paramValue: 'all_'  },\r\n                        { paramName:'prm_filtro_regional', paramValue: 'all_'  }]});\r\n          });\r\n         \r\n         \r\n         // OPCOES GERAIS GRAFICOS\r\n         // GRAFICOS DE BARRAS\r\n         var optionsBarChart = {\r\n         series: [{\r\n           name: \"Orçado\",\r\n           data: [{% for item in tmp_csl_mes %}\r\n                 {{ item.ORCADO }},\r\n                   {% endfor %}]\r\n         \r\n         },\r\n         {\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_mes %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         \r\n         chart: {\r\n         height: 350,\r\n         type: 'bar',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#008FFB', '#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\r\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\r\n           },\r\n         },\r\n         plotOptions: {\r\n            bar: {\r\n              horizontal: false,\r\n              borderRadius: 2,\r\n              dataLabels: {\r\n                position: 'top',\r\n                \r\n                  \r\n              },\r\n            },\r\n            \r\n         },\r\n         \r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\r\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\r\n           },\r\n         },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         colors: [\"transparent\"],\r\n         width: 2\r\n         },\r\n         fill: {\r\n         colors: ['#008FFB', '#00E396'],\r\n         opacity: 1\r\n         },\r\n         grid: {\r\n         show: false,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         }\r\n         },\r\n         xaxis: {\r\n         categories: [{% for item in tmp_csl_mes %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         }\r\n         };\r\n         \r\n         // GRAFICOS DE LINHAS\r\n         var optionsLineChart= {\r\n         series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_dia %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         chart: {\r\n         height: 350,\r\n         type: 'area',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#008FFB', '#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         dataLabels: {\r\n         enabled: false\r\n         \r\n         },\r\n         \r\n         yaxis: {\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\r\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\r\n           },\r\n         },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         width: 3\r\n         },\r\n         /*colors: ['#008FFB', '#00E396'],*/\r\n         colors: ['#00E396'],\r\n          dataLabels: {\r\n            enabled: false,\r\n         },\r\n         grid: {\r\n         show: true,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         }\r\n         },\r\n         markers: {\r\n            size: 5\r\n         },\r\n         xaxis: {\r\n         categories: [{% for item in tmp_csl_dia %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         \r\n         }\r\n         };\r\n         \r\n         // GRÁFICO CONSOLIDADO MENSAL\r\n         var optionsConsolidadoMensal = {\r\n          series: [\r\n          {\r\n           name: \"Orçado\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_csl_mes %}\r\n                      {{ item.ORCADO_CSL }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_csl_mes %}\r\n                    ({{ item.ORCADO_MC }}/{{ item.ORCADO_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_csl_mes %}\r\n                      {{ item.ORCADO_CSL }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n          },\r\n          {\r\n           name: \"Real\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_csl_mes %}\r\n                     {{ item.REAL_TM }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_csl_mes %}\r\n                     ({{ item.REAL_MC }}/{{ item.REAL_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_csl_mes %}\r\n                     {{ item.REAL }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n          }],\r\n          \r\n          {% if params.prm_indicador == 'Margem Contribuição' %}\r\n                     \r\n                   \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         },\r\n         {% else %}\r\n                     \r\n                   {% endif %}\r\n          xaxis: {\r\n          categories: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_csl_mes %}\r\n                      '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_csl_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_csl_mes %}\r\n                      '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% endif %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n              },\r\n                  \r\n          grid: {\r\n                  show: true,\r\n                 \r\n              }\r\n          };\r\n          \r\n         var optionsConsolidadoMensalSemOrcado = {\r\n          series: [\r\n          \r\n          {\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_mes %}\r\n                   {% if params.prm_indicador == 'Ticket Medio' %}\r\n                     {{ item.REAL_TM }},\r\n                   {% else %}\r\n                     {{ item.REAL }},\r\n                   {% endif %}\r\n                 \r\n                   {% endfor %}]\r\n         \r\n          }],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_csl_mes %}\r\n                  '{{ item.DIA }}',\r\n                  {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n              },\r\n          colors: ['#00E396'], \r\n          legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#008FFB', '#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n          grid: {\r\n                  show: true,\r\n                 \r\n              }\r\n          };    \r\n         \r\n         var chartConsolidadoMensal = new ApexCharts(document.querySelector(\"#graficoConsolidadoMensal\"), optionsBarChart);\r\n         chartConsolidadoMensal.render();\r\n         \r\n         setTimeout(function() {\r\n             {% if params.prm_indicador == 'Ticket Medio' %}\r\n                     chartConsolidadoMensal.updateOptions(optionsConsolidadoMensalSemOrcado)\r\n                   {% else %}\r\n                     chartConsolidadoMensal.updateOptions(optionsConsolidadoMensal)\r\n                   {% endif %}\r\n             \r\n          \r\n         }, 1);\r\n         \r\n         \r\n         // GRÁFICO CONSOLIDADO - DIÁRIO\r\n         var optionsConsolidadoDiario = {\r\n          series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_dia %}\r\n                      {% if params.prm_indicador == 'Base de Contratos' %}\r\n                      {{ item.REAL }},\r\n                      {% else %}\r\n                      {{ item.REAL_ACU }},\r\n                      {% endif %}\r\n                   {% endfor %}]\r\n         \r\n          }/*, {\r\n          name: 'Orçado',\r\n          data: [{% for item in tmp_csl_dia %}\r\n                      {% if params.prm_indicador == 'Base de Contratos' %}\r\n                      {{ item.ORCADO_NAO_ACU }},\r\n                      {% else %}\r\n                      {{ item.ORCADO_ACU }},\r\n                      {% endif %}\r\n                   {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                }\r\n        }*/],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_csl_dia %}\r\n                  '{{ item.DIA }}',\r\n                  {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                  }\r\n          };\r\n         \r\n         var chartConsolidadoDiario = new ApexCharts(document.querySelector(\"#graficoConsolidadoDiario\"), optionsLineChart);\r\n         chartConsolidadoDiario.render();\r\n         \r\n         setTimeout(function() {\r\n          chartConsolidadoDiario.updateOptions(optionsConsolidadoDiario)\r\n         }, 1);\r\n         \r\n         \r\n         \r\n         \r\n         // GRÁFICO CORPORATIVO MENSAL\r\n         var optionsCorporativoMensal = {\r\n         series: [\r\n         {\r\n           name: \"Orçado\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_crp_mes_tm %}\r\n                      {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_crp_mes %}\r\n                    ({{ item.ORCADO_MC }}/{{ item.ORCADO_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_crp_mes %}\r\n                      {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         },\r\n         {\r\n           name: \"Real\",\r\n           data: [ {% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_crp_mes_tm %}\r\n                     {{ item.REAL_TM }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_crp_mes %}\r\n                     ({{ item.REAL_MC }}/{{ item.REAL_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_crp_mes %}\r\n                     {{ item.REAL }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         }],\r\n         {% if params.prm_indicador == 'Margem Contribuição' %}\r\n                     \r\n                   \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         },\r\n         {% else %}\r\n                     \r\n                   {% endif %}\r\n         xaxis: {\r\n         categories: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_crp_mes_tm %}\r\n                      '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_crp_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_crp_mes %}\r\n                      '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% endif %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n              },\r\n                  \r\n          grid: {\r\n                  show: true,\r\n                 \r\n              }\r\n         };\r\n         \r\n         var chartCorporativoMensal = new ApexCharts(document.querySelector(\"#graficoCorporativoMensal\"), optionsBarChart);\r\n         chartCorporativoMensal.render();\r\n         \r\n         setTimeout(function() {\r\n          chartCorporativoMensal.updateOptions(optionsCorporativoMensal)\r\n         }, 1);\r\n         \r\n         \r\n         \r\n         \r\n         // GRÁFICO CORPORATIVO - DIÁRIO\r\n         var optionsCorporativoDiario = {\r\n          series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_sgm_crp_dia %}\r\n                      {% if params.prm_indicador == 'Base de Contratos' %}\r\n                      {{ item.REAL }},\r\n                      {% else %}\r\n                      {{ item.REAL_ACU }},\r\n                      {% endif %}\r\n                   {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n         \r\n          }],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_sgm_crp_dia %}\r\n                  '{{ item.DIA }}',\r\n                  {% endfor %}],\r\n                  }\r\n          };\r\n         \r\n         var chartCorporativoDiario = new ApexCharts(document.querySelector(\"#graficoCorporativoDiario\"), optionsLineChart);\r\n         chartCorporativoDiario.render();\r\n         \r\n         setTimeout(function() {\r\n          chartCorporativoDiario.updateOptions(optionsCorporativoDiario)\r\n         }, 1);\r\n         \r\n         \r\n         // GRÁFICO EMPRESARIAL MENSAL\r\n         var optionsEmpresarialMensal = {\r\n         series: [\r\n         {\r\n           name: \"Orçado\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_emp_mes_tm %}\r\n                     {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_emp_mes %}\r\n                     ({{ item.ORCADO_MC }}/{{ item.ORCADO_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_emp_mes %}\r\n                     {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         },\r\n         {\r\n           name: \"Real\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_emp_mes_tm %}\r\n                     {{ item.REAL_TM }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_emp_mes %}\r\n                      ({{ item.REAL_MC }}/{{ item.REAL_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_emp_mes %}\r\n                     {{ item.REAL }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         }],\r\n         {% if params.prm_indicador == 'Margem Contribuição' %}\r\n                     \r\n                   \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         },\r\n         {% else %}\r\n                     \r\n                   {% endif %}\r\n         \r\n         xaxis: {\r\n         categories: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_emp_mes_tm %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_emp_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_emp_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% endif %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n              },\r\n                  \r\n          grid: {\r\n                  show: true,\r\n                 \r\n              }\r\n         };\r\n         \r\n         var chartEmpresarialMensal = new ApexCharts(document.querySelector(\"#graficoEmpresarialMensal\"), optionsBarChart);\r\n         chartEmpresarialMensal.render();\r\n         \r\n         setTimeout(function() {\r\n          chartEmpresarialMensal.updateOptions(optionsEmpresarialMensal)\r\n         }, 1);    \r\n         \r\n         \r\n         // GRÁFICO EMPRESARIAL - DIÁRIO\r\n         var optionsEmpresarialDiario = {\r\n          series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_sgm_emp_dia %}\r\n                     {% if params.prm_indicador == 'Base de Contratos' %}\r\n                      {{ item.REAL }},\r\n                      {% else %}\r\n                      {{ item.REAL_ACU }},\r\n                      {% endif %}\r\n                   {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n         \r\n          }],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_sgm_emp_dia %}\r\n                  '{{ item.DIA }}',\r\n                  {% endfor %}],\r\n                  }\r\n          };\r\n         \r\n         var chartEmpresarialDiario = new ApexCharts(document.querySelector(\"#graficoEmpresarialDiario\"), optionsLineChart);\r\n         chartEmpresarialDiario.render();\r\n         \r\n         setTimeout(function() {\r\n          chartEmpresarialDiario.updateOptions(optionsEmpresarialDiario)\r\n         }, 1);\r\n         \r\n         \r\n         // GRÁFICO ATACADO MENSAL\r\n         var optionsAtacadoMensal = {\r\n         series: [{\r\n           name: \"Orçado\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_ope_mes_tm %}\r\n                     {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_ata_mes %}\r\n                      ({{ item.ORCADO_MC }}/{{ item.ORCADO_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_ata_mes %}\r\n                     {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         },\r\n         {\r\n           name: \"Real\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_ope_mes_tm %}\r\n                     {{ item.REAL_TM }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_ata_mes %}\r\n                     ({{ item.REAL_MC }}/{{ item.REAL_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_ata_mes %}\r\n                     {{ item.REAL }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         }],\r\n         \r\n         {% if params.prm_indicador == 'Margem Contribuição' %}\r\n                     \r\n                   \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         },\r\n         {% else %}\r\n              \r\n         \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 1,\r\n                   maximumFractionDigits: 1});\r\n           },\r\n         },\r\n         \r\n         \r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 1,\r\n                   maximumFractionDigits: 1});\r\n           },\r\n         },\r\n         },\r\n             \r\n         \r\n         \r\n        {% endif %}\r\n        \r\n        \r\n         chart: {\r\n         height: 350,\r\n         type: 'bar',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#008FFB', '#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         plotOptions: {\r\n            bar: {\r\n              horizontal: false,\r\n              borderRadius: 2,\r\n              dataLabels: {\r\n                position: 'top',\r\n                \r\n                  \r\n              },\r\n            },\r\n            \r\n         },\r\n         \r\n         stroke: {\r\n         curve: 'straight',\r\n         colors: [\"transparent\"],\r\n         width: 2\r\n         },\r\n         fill: {\r\n         colors: ['#008FFB', '#00E396'],\r\n         opacity: 1\r\n         },\r\n         grid: {\r\n         show: false,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         }\r\n         },  \r\n         xaxis: {\r\n         categories: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_ope_mes_tm %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_ata_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_ata_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% endif %}],\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         }\r\n         }\r\n         };\r\n         \r\n         var chartAtacadoMensal = new ApexCharts(document.querySelector(\"#graficoAtacadoMensal\"), optionsBarChart);\r\n         chartAtacadoMensal.render();\r\n         \r\n         setTimeout(function() {\r\n          chartAtacadoMensal.updateOptions(optionsAtacadoMensal)\r\n         }, 1);\r\n         \r\n         \r\n         // GRÁFICO ATACADO - DIÁRIO\r\n         var optionsAtacadoDiario = {\r\n          series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_sgm_ata_dia %}\r\n                     {% if params.prm_indicador == 'Base de Contratos' %}\r\n                      {{ item.REAL }},\r\n                      {% else %}\r\n                      {{ item.REAL_ACU }},\r\n                      {% endif %}\r\n                   {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n         \r\n          }],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_sgm_ata_dia %}\r\n                  '{{ item.DIA }}',\r\n                  {% endfor %}],\r\n                  }\r\n          };\r\n         \r\n         var chartAtacadoDiario = new ApexCharts(document.querySelector(\"#graficoAtacadoDiario\"), optionsLineChart);\r\n         chartAtacadoDiario.render();\r\n         \r\n         setTimeout(function() {\r\n          chartAtacadoDiario.updateOptions(optionsAtacadoDiario)\r\n         }, 1);\r\n         \r\n         \r\n         // GRÁFICO VAREJO MENSAL\r\n         var optionsVarejoMensal = {\r\n         series: [\r\n         {\r\n           name: \"Orçado\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_vrj_mes_tm %}\r\n                     {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_vrj_mes %}\r\n                      ({{ item.ORCADO_MC }}/{{ item.ORCADO_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_vrj_mes %}\r\n                     {{ item.ORCADO }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         },\r\n         {\r\n           name: \"Real\",\r\n           data: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_vrj_mes_tm %}\r\n                     {{ item.REAL_TM }},\r\n                   {% endfor %}\r\n               {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_vrj_mes %}\r\n                     ({{ item.REAL_MC }}/{{ item.REAL_RL }})*100,\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_vrj_mes %}\r\n                     {{ item.REAL }},\r\n                   {% endfor %}\r\n               {% endif %}]\r\n         \r\n         }],\r\n         \r\n         {% if params.prm_indicador == 'Margem Contribuição' %}\r\n                     \r\n                   \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 2,\r\n                   maximumFractionDigits: 2});\r\n           },\r\n         },\r\n         },\r\n         {% else %}\r\n                     \r\n                   {% endif %}\r\n         \r\n         xaxis: {\r\n         categories: [{% if params.prm_indicador == 'Ticket Medio' %}\r\n                 {% for item in tmp_sgm_vrj_mes_tm %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n                {% elif params.prm_indicador == 'Margem Contribuição' %}\r\n                    {% for item in tmp_sgm_vrj_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% else %}    \r\n                 {% for item in tmp_sgm_vrj_mes %}\r\n                     '{{ item.DIA }}',\r\n                   {% endfor %}\r\n               {% endif %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n              },\r\n                  \r\n          grid: {\r\n                  show: true,\r\n                 \r\n              }\r\n         };\r\n         \r\n         var chartVarejoMensal = new ApexCharts(document.querySelector(\"#graficoVarejoMensal\"), optionsBarChart);\r\n         chartVarejoMensal.render();\r\n         \r\n         setTimeout(function() {\r\n          chartVarejoMensal.updateOptions(optionsVarejoMensal)\r\n         }, 1);\r\n         \r\n         \r\n         // GRÁFICO VAREJO - DIÁRIO\r\n         var optionsVarejoDiario = {\r\n          series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_sgm_vrj_dia %}\r\n                     {% if params.prm_indicador == 'Base de Contratos' %}\r\n                      {{ item.REAL }},\r\n                      {% else %}\r\n                      {{ item.REAL_ACU }},\r\n                      {% endif %}\r\n                   {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n         \r\n          }],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_sgm_vrj_dia %}\r\n                  '{{ item.DIA }}',\r\n                  {% endfor %}],\r\n                  }\r\n          };\r\n         \r\n         var chartVarejoDiario = new ApexCharts(document.querySelector(\"#graficoVarejoDiario\"), optionsLineChart);\r\n         chartVarejoDiario.render();\r\n         \r\n         setTimeout(function() {\r\n          chartVarejoDiario.updateOptions(optionsVarejoDiario)\r\n         }, 1);\r\n         \r\n         \r\n         \r\n         \r\n   </script>\r\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":267.5857863755036,"y":123.48603784820692},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":true,"onDestroy":"resetFlow","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"iTRNtaOUTSOUTpwNCHGIRZi_AwNWlagz","flowDescription":"","locked":"no","created":"2023-03-06 10:38:57","updated":"2023-09-20 10:05:16"},{"flowId":"2003","appId":137,"flowName":"ETL - Base Geral","workflow":{"nodes":[{"id":"XXGaGp","type":"table","appId":137,"label":"base_orcado_portal_sgm_pdt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-66.05932309493373,"y":2159.226757930055},"tableName":"base_orcado_portal_sgm_pdt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rhWjro","type":"table","appId":137,"label":"tmp_base_geral_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-401.9983351317929,"y":1227.8085808097107},"sourceId":7,"tableName":"tmp_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IqQslG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"JDeeqa","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"UPaonQ","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"lmIhUn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"RTAmlZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"UPaonQ","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"lmIhUn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oWDdox","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":-390.6772899154022,"y":1585.197163511849},"sourceId":7,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_aux_insights","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"faiuYZ","type":"table","appId":137,"label":"tmp_aux_insights","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-391.68449596806136,"y":1719.2064794665043},"sourceId":7,"tableName":"tmp_aux_insights","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"PUflmg","type":"builder","appId":137,"label":"Visão Corporativo Mix Produto","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"gENXmz","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"kJZpbI","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"KcGKaR","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"IYAYAI","type":"value","andOr":"and","value":"Venda Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"xmuTzn","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"GCjkhl","type":"value","andOr":"and","value":"2023-06-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"FVErUD","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"pqFdBN","type":"computed","alias":"MIX_PRODUTOS_DADOS","content":"SUM (\nCASE \nWHEN  DSC_LNH_NGC IN ('Conectividade','Banda Larga') THEN REAL - TAXA_INSTALACAO\nELSE 0\nEND\n)\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_DADOS","computedId":"VVWpqj","columnLength":2},{"id":"fwZBke","type":"computed","alias":"MIX_PRODUTOS_VOZ","content":"SUM(\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('Voz Fixa','Voz Corporativa','DDG','Móvel - Pós','Móvel - Pré') THEN REAL-TAXA_INSTALACAO\r\nELSE 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_VOZ","computedId":"wqcWZI","columnLength":2},{"id":"yBzpxJ","type":"computed","alias":"MIX_PRODUTOS_TIC_TI","content":"SUM (\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('TIC TI') THEN REAL-TAXA_INSTALACAO\r\nELSE 0\r\nEND\r\n)","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_TIC_TI","computedId":"YLqqIW","columnLength":2},{"id":"hKYpFK","type":"computed","alias":"MIX_PRODUTOS_IOT","content":"SUM (\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('IOT') THEN REAL-TAXA_INSTALACAO\r\nELSE  0\r\nEND\r\n)","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_IOT","computedId":"XwNvfs","columnLength":2},{"id":"qalmfs","type":"computed","alias":"MIX_PRODUTOS_OUTROS","content":"--SUM(\r\n--CASE \r\n--WHEN  DSC_LNH_NGC  IN ('Banda Larga','Conectividade') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('Voz Fixa','Voz Corporativa','DDG','Móvel - Pós','Móvel - Pré') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('TIC TI') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('IOT') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('TIC Dados') THEN 0\r\n--ELSE REAL-TAXA_INSTALACAO\r\n--END\r\n--)\r\n\r\nSUM(\r\nCASE\r\nWHEN  DSC_LNH_NGC NOT IN ('Banda Larga','Conectividade','Voz Fixa','Voz Corporativa','DDG','Móvel - Pós','Móvel - Pré','TIC TI',\r\n'IOT','TIC Dados')\r\nTHEN  REAL-TAXA_INSTALACAO\r\nELSE 0 \r\nEND\r\n)","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_OUTROS","computedId":"LKwcLJ","columnLength":2},{"id":"ZHOFZl","type":"computed","alias":"MIX_PRODUTOS_TIC_DADOS","content":"SUM(\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('TIC Dados') THEN REAL-TAXA_INSTALACAO\r\nELSE 0\r\nEND\r\n)","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_TIC_DADOS","computedId":"ImRsLq","columnLength":2},{"id":"BzSXxn","type":"computed","alias":"MIX_PRODUTOS_TX_INSTALACAO","content":"SUM (\nCASE \nWHEN  TAXA_INSTALACAO IS NOT NULL THEN TAXA_INSTALACAO\nELSE 0\nEND\n)\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"MIX_PRODUTOS_TX_INSTALACAO","computedId":"KXlSzM","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"ZJdORf"},{"type":"computed","alias":"ORCADO_CSL","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_CSL","computedId":"ujuPKq","columnLength":2},{"type":"computed","alias":"REAL_TM","content":"SUM(CASE WHEN `base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `base_geral_mes`.`TIP_MTC` <> 'Ticket Medio' THEN 0 ELSE `base_geral_mes`.`REAL` END)","dataType":"Nullable(Float64)","columnName":"REAL_TM","computedId":"zrzQTe","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_DADOS","content":"SUM (\nCASE \nWHEN  DSC_LNH_NGC IN ('Conectividade','Banda Larga') THEN REAL - TAXA_INSTALACAO\nELSE 0\nEND\n)\n","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_DADOS","computedId":"VVWpqj","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_VOZ","content":"SUM(\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('Voz Fixa','Voz Corporativa','DDG','Móvel - Pós','Móvel - Pré') THEN REAL-TAXA_INSTALACAO\r\nELSE 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_VOZ","computedId":"wqcWZI","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_TIC_TI","content":"SUM (\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('TIC TI') THEN REAL-TAXA_INSTALACAO\r\nELSE 0\r\nEND\r\n)","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_TIC_TI","computedId":"YLqqIW","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_IOT","content":"SUM (\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('IOT') THEN REAL-TAXA_INSTALACAO\r\nELSE  0\r\nEND\r\n)","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_IOT","computedId":"XwNvfs","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_TIC_DADOS","content":"SUM(\r\nCASE \r\nWHEN  DSC_LNH_NGC IN ('TIC Dados') THEN REAL-TAXA_INSTALACAO\r\nELSE 0\r\nEND\r\n)","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_TIC_DADOS","computedId":"ImRsLq","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_OUTROS","content":"--SUM(\r\n--CASE \r\n--WHEN  DSC_LNH_NGC  IN ('Banda Larga','Conectividade') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('Voz Fixa','Voz Corporativa','DDG','Móvel - Pós','Móvel - Pré') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('TIC TI') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('IOT') THEN 0\r\n--WHEN  DSC_LNH_NGC IN ('TIC Dados') THEN 0\r\n--ELSE REAL-TAXA_INSTALACAO\r\n--END\r\n--)\r\n\r\nSUM(\r\nCASE\r\nWHEN  DSC_LNH_NGC NOT IN ('Banda Larga','Conectividade','Voz Fixa','Voz Corporativa','DDG','Móvel - Pós','Móvel - Pré','TIC TI',\r\n'IOT','TIC Dados')\r\nTHEN  REAL-TAXA_INSTALACAO\r\nELSE 0 \r\nEND\r\n)","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_OUTROS","computedId":"LKwcLJ","columnLength":2},{"type":"computed","alias":"MIX_PRODUTOS_TX_INSTALACAO","content":"SUM (\nCASE \nWHEN  TAXA_INSTALACAO IS NOT NULL THEN TAXA_INSTALACAO\nELSE 0\nEND\n)\n","dataType":"Nullable(Float64)","columnName":"MIX_PRODUTOS_TX_INSTALACAO","computedId":"KXlSzM","columnLength":2}]},"created":false,"position":{"x":341.5327768223713,"y":1120.0777079379968},"sourceId":null,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_crp_mix_pdt","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"TZWRwR","type":"table","appId":137,"label":"tmp_crp_mix_pdt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":649.5380822620666,"y":1112.0781467527145},"sourceId":null,"tableName":"tmp_crp_mix_pdt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RZcgkD","type":"builder","appId":137,"label":"Visão Produto","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_geral_mes","id":"JXvCMU","to":"base_orcado_portal_sgm_pdt","raw":"","list":[{"id":"AknHjC","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"base_orcado_portal_sgm_pdt","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"pJxDkD","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"base_orcado_portal_sgm_pdt","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"biaqFj","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"base_orcado_portal_sgm_pdt","columnBy":"DSC_LNH_NGC","columnTo":"produto","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"cqgzsv","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"base_orcado_portal_sgm_pdt","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"RdqssQ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"yZQbsd","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UFDagV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"HdqDKN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"AphwZg","type":"value","andOr":"and","value":"","dataType":"Nullable(String)","operator":"isNotNull","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"QDcECF","type":"value","andOr":"and","value":["Receita Líquida Mensal","Receita Bruta Mensal"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UFDagV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"FoyeMM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gdyFbe","type":"computed","alias":"REAL_MES_ANTERIOR","content":"SUM(CASE WHEN toStartOfMonth(DATA_REF) = toStartOfMonth(addMonths(today(),-2)) THEN REAL ELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MES_ANTERIOR","computedId":"oLBbRN","columnLength":2},{"id":"wzzmCI","type":"computed","alias":"REAL_MES_ATUAL","content":"SUM(CASE WHEN toStartOfMonth(DATA_REF) = toStartOfMonth(addMonths(today(),-1)) THEN REAL ELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MES_ATUAL","computedId":"YTDwlB","columnLength":2},{"id":"OdXtzT","type":"computed","alias":"VARIACAO","content":"REAL_MES_ATUAL-REAL_MES_ANTERIOR","dataType":"Nullable(Float64)","distinct":false,"columnName":"VARIACAO","computedId":"dbLXoF","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_MES_ATUAL","content":"SUM(CASE WHEN toStartOfMonth(DATA_REF) = toStartOfMonth(addMonths(today(),-1)) THEN REAL ELSE 0 END)","dataType":"Nullable(Float64)","columnName":"REAL_MES_ATUAL","computedId":"YTDwlB","columnLength":2},{"type":"computed","alias":"REAL_MES_ANTERIOR","content":"SUM(CASE WHEN toStartOfMonth(DATA_REF) = toStartOfMonth(addMonths(today(),-2)) THEN REAL ELSE 0 END)","dataType":"Nullable(Float64)","columnName":"REAL_MES_ANTERIOR","computedId":"oLBbRN","columnLength":2},{"type":"computed","alias":"VARIACAO","content":"REAL_MES_ATUAL-REAL_MES_ANTERIOR","dataType":"Nullable(Float64)","columnName":"VARIACAO","computedId":"dbLXoF","columnLength":2}]},"created":false,"position":{"x":-65.7451533038099,"y":1940.2183983830807},"sourceId":null,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_fnl_pdt_base_geral_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"VnwXaM","type":"table","appId":137,"label":"tmp_fnl_pdt_base_geral_mes","client":"clickhouse","repoId":1,"shared":false,"position":{"x":76.7108615322083,"y":1941.6623143437432},"sourceId":null,"tableName":"tmp_fnl_pdt_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYoUOn","type":"builder","appId":137,"label":"Consulta - Corp","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"YbAwzD","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_pdt_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WlxdcO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"nMSvMp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"EQqknQ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pqdbee","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"VARIACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":217.13269694175204,"y":1787.0421712323428},"sourceId":null,"tableName":"tmp_fnl_pdt_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_pdt_base_crp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"TlkcPp","type":"table","appId":137,"label":"tmp_pdt_base_crp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":330.0130537932651,"y":1784.4862125233033},"sourceId":null,"tableName":"tmp_pdt_base_crp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZabIrj","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WutVXC","type":"sum","alias":"REAL_MES_ANTERIOR","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_pdt_base_crp","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"BFiDkf","type":"sum","alias":"REAL_MES_ATUAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_pdt_base_crp","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":460.0159910390099,"y":1789.481806654686},"sourceId":null,"tableName":"tmp_pdt_base_crp","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_total_pdt_crp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"MqupBH","type":"table","appId":137,"label":"tmp_total_pdt_crp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":608.0202500453394,"y":1792.4820269481172},"sourceId":null,"tableName":"tmp_total_pdt_crp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wSMZAN","type":"builder","appId":137,"label":"Consulta - MPE","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"YbAwzD","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_pdt_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WlxdcO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"nMSvMp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"EQqknQ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pqdbee","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"VARIACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":213.70938890121204,"y":1931.0404792733257},"sourceId":null,"tableName":"tmp_fnl_pdt_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_pdt_base_emp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fouUZS","type":"table","appId":137,"label":"tmp_pdt_base_emp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":332.7084802565547,"y":1930.0405106059},"sourceId":null,"tableName":"tmp_pdt_base_emp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FFThnI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MavryB","type":"sum","alias":"REAL_MES_ANTERIOR","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_pdt_base_emp","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"kBJixl","type":"sum","alias":"REAL_MES_ATUAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_pdt_base_emp","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":461.71134407115585,"y":1935.036104737283},"sourceId":null,"tableName":"tmp_pdt_base_emp","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_total_pdt_emp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pFuruf","type":"table","appId":137,"label":"tmp_total_pdt_emp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":609.7157078412034,"y":1935.036523792155},"sourceId":null,"tableName":"tmp_total_pdt_emp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ixfCfw","type":"builder","appId":137,"label":"Consulta - Varejo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"YbAwzD","type":"value","andOr":"and","value":"RESIDENCIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_pdt_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WlxdcO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"nMSvMp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"EQqknQ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pqdbee","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"VARIACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":201.70976489210457,"y":2068.0390066423292},"sourceId":null,"tableName":"tmp_fnl_pdt_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_pdt_base_vrj","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"whmwSZ","type":"table","appId":137,"label":"tmp_pdt_base_vrj","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":325.70869958457536,"y":2069.038975309755},"sourceId":null,"tableName":"tmp_pdt_base_vrj","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"GZydyh","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"TJiKfS","type":"sum","alias":"REAL_MES_ANTERIOR","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_pdt_base_vrj","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"XwvuUb","type":"sum","alias":"REAL_MES_ATUAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_pdt_base_vrj","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":459.7119305548945,"y":2068.0341288542763},"sourceId":null,"tableName":"tmp_pdt_base_vrj","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_total_pdt_vrj","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WSwkLV","type":"table","appId":137,"label":"tmp_total_pdt_vrj","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":620.7170394023734,"y":2068.034862200302},"sourceId":null,"tableName":"tmp_total_pdt_vrj","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JeWTjp","type":"builder","appId":137,"label":"Consulta - Atacado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"YbAwzD","type":"value","andOr":"and","value":"OPERADORAS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_pdt_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WlxdcO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"nMSvMp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"EQqknQ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pqdbee","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_pdt_base_geral_mes","columnName":"VARIACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":199.70982755725345,"y":2246.0382859931183},"sourceId":null,"tableName":"tmp_fnl_pdt_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_pdt_base_ata","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"dElUoc","type":"table","appId":137,"label":"tmp_pdt_base_ata","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":318.7119570604183,"y":2246.0382859931183},"sourceId":null,"tableName":"tmp_pdt_base_ata","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qlDSCq","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhUdaL","type":"sum","alias":"REAL_MES_ANTERIOR","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_pdt_base_ata","columnName":"REAL_MES_ANTERIOR","columnLength":2,"databaseName":"bucket_137"},{"id":"lykWGS","type":"sum","alias":"REAL_MES_ATUAL","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_pdt_base_ata","columnName":"REAL_MES_ATUAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":471.71658322246606,"y":2243.033292675352},"sourceId":null,"tableName":"tmp_pdt_base_ata","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_total_pdt_ata","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NWsHge","type":"table","appId":137,"label":"tmp_total_pdt_ata","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":613.7200873507803,"y":2243.0339212576596},"sourceId":null,"tableName":"tmp_total_pdt_ata","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BBuytA","type":"table","appId":137,"label":"tmp_base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-376.2294750294745,"y":856.6762380345493},"sourceId":null,"tableName":"tmp_base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mZhSqP","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_aux_insights","id":"hXWpSM","to":"tmp_base_orcado_portal_sgm","raw":"","list":[{"id":"zzXQSj","andOr":"and","tableBy":"tmp_aux_insights","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"yHcLnU","andOr":"and","tableBy":"tmp_aux_insights","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"WtOiFz","andOr":"and","tableBy":"tmp_aux_insights","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"foIaCF","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_aux_insights","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"WIXYvI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_insights","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"foIaCF","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_aux_insights","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"WIXYvI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_insights","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"rbGpnv","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_insights","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"aWpNUV","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":-255.667271947296,"y":1718.2064060353605},"sourceId":7,"tableName":"tmp_aux_insights","sourceType":"bucket","resultTable":"tmp_insights","bucketClient":"clickhouse","databaseName":"bucket_137","untilOperator":"=","untilParamName":"coluna_insight","untilParamValue":"1"},{"id":"JhZLWJ","type":"table","appId":137,"label":"tmp_insights","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-114.66373648640746,"y":1718.206196507924},"sourceId":7,"tableName":"tmp_insights","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_geral_mes","id":"eLlTok","to":"tmp_base_orcado_portal_sgm","raw":"","list":[{"id":"NRpWiq","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"wbYasQ","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"RHIkSX","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"CUNwgd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"vDYKtx","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"IYXRJR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"fQAHDJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"AVrYmK","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"OHgNDr","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"cgFMki","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"id":"yYFJel","type":"computed","alias":"REAL_TM","content":"case when `tmp_base_geral_mes`.`SEGMENTO` = 'OPERADORAS' THEN \n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\n\nELSE\n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_TM","computedId":"sdSecy","columnLength":2},{"id":"YrIlKN","type":"sum","alias":"REAL_ORIGINAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"REAL_TM","content":"case when `tmp_base_geral_mes`.`SEGMENTO` = 'OPERADORAS' THEN \n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\n\nELSE\n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\nend","dataType":"Nullable(Float64)","columnName":"REAL_TM","computedId":"sdSecy","columnLength":2}]},"created":false,"position":{"x":-203.93525309347172,"y":856.8768822733429},"sourceId":null,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_aux_sgm_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"elZPRz","type":"table","appId":137,"label":"tmp_aux_sgm_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":202.3932555946033,"y":856.5903549963967},"sourceId":null,"tableName":"tmp_aux_sgm_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qDjjhm","type":"builder","appId":137,"label":"Corporativo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"ubcfgK","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"ERZVTe","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"hqRYNI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"hqRYNI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"jlbcUt","type":"sum","alias":"REAL_TM","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"cMGGrs","type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\nREAL_ORIGINAL\nelse 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MC","computedId":"MqfLIk","columnLength":2},{"id":"AJOrHc","type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\nREAL_ORIGINAL\nelse 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_RL","computedId":"gIJRip","columnLength":2},{"id":"GfzUuh","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"},{"id":"ETyuOt","type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\nORCADO_TRATADO\nelse 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_MC","computedId":"DCdRpT","columnLength":2},{"id":"ZlDwpF","type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\nORCADO_TRATADO\nelse 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_RL","computedId":"medHGR","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\nREAL_ORIGINAL\nelse 0\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_MC","computedId":"MqfLIk","columnLength":2},{"type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\nREAL_ORIGINAL\nelse 0\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_RL","computedId":"gIJRip","columnLength":2},{"type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\nORCADO_TRATADO\nelse 0\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_MC","computedId":"DCdRpT","columnLength":2},{"type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\nORCADO_TRATADO\nelse 0\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_RL","computedId":"medHGR","columnLength":2}]},"created":false,"position":{"x":385.1070592758806,"y":683.1614619950121},"sourceId":null,"tableName":"tmp_aux_sgm_mes","sourceType":"bucket","resultTable":"tmp_sgm_crp_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NDsNBp","type":"table","appId":137,"label":"tmp_sgm_crp_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":536.7067296435107,"y":681.7622074215158},"sourceId":null,"tableName":"tmp_sgm_crp_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HzBSGG","type":"builder","appId":137,"label":"Varejo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"QlwQlv","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"dzXMiT","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"dBFsKv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"RESIDENCIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"dBFsKv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"ieMBcX","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_ORIGINAL","columnLength":2,"databaseName":"bucket_137"},{"id":"RWQJNj","type":"sum","alias":"REAL_TM","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"jccqiv","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"},{"id":"nNTLmB","type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MC","computedId":"EZhHQV","columnLength":2},{"id":"OBKOgG","type":"computed","alias":"REAL_RL","content":"\r\nSUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_RL","computedId":"oRIQFW","columnLength":2},{"id":"QbuLfJ","type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_MC","computedId":"OWOddi","columnLength":2},{"id":"WrXNzd","type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_RL","computedId":"bYWtLB","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_MC","computedId":"EZhHQV","columnLength":2},{"type":"computed","alias":"REAL_RL","content":"\r\nSUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_RL","computedId":"oRIQFW","columnLength":2},{"type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_MC","computedId":"OWOddi","columnLength":2},{"type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_RL","computedId":"bYWtLB","columnLength":2}]},"created":false,"position":{"x":385.1070592758806,"y":799.1614619950121},"sourceId":null,"tableName":"tmp_aux_sgm_mes","sourceType":"bucket","resultTable":"tmp_sgm_vrj_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fxLyDI","type":"table","appId":137,"label":"tmp_sgm_vrj_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":527.1066186890196,"y":799.1614619950121},"sourceId":null,"tableName":"tmp_sgm_vrj_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BxhCYK","type":"builder","appId":137,"label":"Empresarial","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"eLpAtU","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"aekQZP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"DDRpUo","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_ORIGINAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TIvwTp","type":"sum","alias":"REAL_TM","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"GtqLEm","type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MC","computedId":"SlRyRe","columnLength":2},{"id":"AiiKTg","type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_RL","computedId":"AXkhha","columnLength":2},{"id":"LaVGXa","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"},{"id":"IkiqNG","type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_MC","computedId":"ajmNoT","columnLength":2},{"id":"HBxomp","type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_RL","computedId":"DgneEx","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_MC","computedId":"SlRyRe","columnLength":2},{"type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_RL","computedId":"AXkhha","columnLength":2},{"type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_MC","computedId":"ajmNoT","columnLength":2},{"type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_RL","computedId":"DgneEx","columnLength":2}]},"created":false,"position":{"x":385.1070592758806,"y":915.161461995012},"sourceId":null,"tableName":"tmp_aux_sgm_mes","sourceType":"bucket","resultTable":"tmp_sgm_emp_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"wSllIW","type":"table","appId":137,"label":"tmp_sgm_emp_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":533.1070592758813,"y":915.161461995012},"sourceId":null,"tableName":"tmp_sgm_emp_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qwUxHB","type":"builder","appId":137,"label":"Atacado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"LEOplm","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"nAPXKg","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"qnFbQo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"OPERADORAS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"qnFbQo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"iaYWJc","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_ORIGINAL","columnLength":2,"databaseName":"bucket_137"},{"id":"fSEDlk","type":"sum","alias":"REAL_TM","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"JxlglP","type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MC","computedId":"FdgUXI","columnLength":2},{"id":"qPPWnL","type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_RL","computedId":"etOoTN","columnLength":2},{"id":"JTKPuJ","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"},{"id":"ogxZGh","type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_MC","computedId":"IZfwzV","columnLength":2},{"id":"ZxSHjO","type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_RL","computedId":"EQyKeT","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_MC","computedId":"FdgUXI","columnLength":2},{"type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL_ORIGINAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_RL","computedId":"etOoTN","columnLength":2},{"type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_MC","computedId":"IZfwzV","columnLength":2},{"type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO_TRATADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_RL","computedId":"EQyKeT","columnLength":2}]},"created":false,"position":{"x":385.1070592758806,"y":1031.1614619950124},"sourceId":null,"tableName":"tmp_aux_sgm_mes","sourceType":"bucket","resultTable":"tmp_sgm_ata_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"dkZeiN","type":"table","appId":137,"label":"tmp_sgm_ata_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":533.1070592758813,"y":1031.1614619950124},"sourceId":null,"tableName":"tmp_sgm_ata_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"uWHXZx","type":"builder","appId":137,"label":"Visão Segmento TM","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_geral_mes","id":"eLlTok","to":"tmp_base_orcado_portal_sgm","raw":"","list":[{"id":"NRpWiq","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"wbYasQ","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"RHIkSX","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"vDYKtx","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"fQAHDJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"AVrYmK","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"OHgNDr","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"cgFMki","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"id":"yYFJel","type":"computed","alias":"REAL_TM","content":"case when `tmp_base_geral_mes`.`SEGMENTO` = 'OPERADORAS' THEN \n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\n\nELSE\n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_TM","computedId":"sdSecy","columnLength":2},{"id":"YrIlKN","type":"sum","alias":"REAL_ORIGINAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"REAL_TM","content":"case when `tmp_base_geral_mes`.`SEGMENTO` = 'OPERADORAS' THEN \n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\n\nELSE\n\ncase\nwhen SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END), 0)\nelse 0 end\n\nend","dataType":"Nullable(Float64)","columnName":"REAL_TM","computedId":"sdSecy","columnLength":2}]},"created":false,"position":{"x":-258.00002709080985,"y":588.888099334974},"sourceId":null,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_aux_sgm_mes_tm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"yJxHmA","type":"table","appId":137,"label":"tmp_aux_sgm_mes_tm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-136.00102973319036,"y":579.8883813281435},"sourceId":null,"tableName":"tmp_aux_sgm_mes_tm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bGeOPI","type":"builder","appId":137,"label":"Empresarial TM","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"eLpAtU","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"aekQZP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pkWPlc","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"EDRQzZ","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes_tm","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TIvwTp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"LaVGXa","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":13.40199738285744,"y":686.171457086242},"sourceId":null,"tableName":"tmp_aux_sgm_mes_tm","sourceType":"bucket","resultTable":"tmp_sgm_emp_mes_tm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"xNazXV","type":"table","appId":137,"label":"tmp_sgm_emp_mes_tm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":188.39933411403445,"y":687.1714257536677},"sourceId":null,"tableName":"tmp_sgm_emp_mes_tm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VLnYZt","type":"builder","appId":137,"label":"Corporativo TM","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"eLpAtU","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"aekQZP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pkWPlc","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"EDRQzZ","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes_tm","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TIvwTp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"LaVGXa","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":4.997372305515853,"y":494.1802928722198},"sourceId":null,"tableName":"tmp_aux_sgm_mes_tm","sourceType":"bucket","resultTable":"tmp_sgm_crp_mes_tm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Yrpyxd","type":"table","appId":137,"label":"tmp_sgm_crp_mes_tm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":181.994646371544,"y":498.1801675419223},"sourceId":null,"tableName":"tmp_sgm_crp_mes_tm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OryoAz","type":"builder","appId":137,"label":"Varejo TM","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"eLpAtU","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"aekQZP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pkWPlc","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"EDRQzZ","type":"value","andOr":"and","value":"RESIDENCIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes_tm","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TIvwTp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"LaVGXa","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":3.997403638090244,"y":592.1800422116245},"sourceId":null,"tableName":"tmp_aux_sgm_mes_tm","sourceType":"bucket","resultTable":"tmp_sgm_vrj_mes_tm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"rpxYlp","type":"table","appId":137,"label":"tmp_sgm_vrj_mes_tm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":185.99452104124663,"y":593.1800108790503},"sourceId":null,"tableName":"tmp_sgm_vrj_mes_tm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TAnjat","type":"builder","appId":137,"label":"Atacado TM","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"eLpAtU","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"aekQZP","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_sgm_mes_tm","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pkWPlc","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"EDRQzZ","type":"value","andOr":"and","value":"OPERADORAS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_mes_tm","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"CvsurY","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TIvwTp","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"LaVGXa","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_mes_tm","columnName":"ORCADO_TRATADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":24.996745654027876,"y":781.1713004233701},"sourceId":null,"tableName":"tmp_aux_sgm_mes_tm","sourceType":"bucket","resultTable":"tmp_sgm_ope_mes_tm","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OPwijd","type":"table","appId":137,"label":"tmp_sgm_ope_mes_tm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":183.9945837063952,"y":780.1713317559444},"sourceId":null,"tableName":"tmp_sgm_ope_mes_tm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BBYyBY","type":"table","appId":137,"label":"tmp_base_orcado_portal_csl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-86.01368207371381,"y":921.465963311094},"tableName":"tmp_base_orcado_portal_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BqMMuS","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"JkJYlt","type":"value","andOr":"and","value":"Base de Clientes Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_orcado_portal_csl","valueType":"value","columnName":"tip_mtc","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"jEigRn","type":"value","andOr":"and","value":"2023-01-01","dataType":"Nullable(Date)","operator":">=","fieldType":"value","tableName":"tmp_base_orcado_portal_csl","valueType":"value","columnName":"mes_ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="},{"list":[{"id":"BZRDAv","type":"value","andOr":"and","value":"Base de Clientes Mensal","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_base_orcado_portal_csl","valueType":"value","columnName":"tip_mtc","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"or","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"aTmQpT","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_csl","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"RTBuFd","type":"value","dataType":"Nullable(Date)","tableName":"tmp_base_orcado_portal_csl","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"FYRGVe","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_orcado_portal_csl","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":-86.52216269549326,"y":1034.7228703446572},"sourceId":null,"tableName":"tmp_base_orcado_portal_csl","sourceType":"bucket","resultTable":"tmp_ocd_csl_sem_bse_cli","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"CYCZHg","type":"table","appId":137,"label":"tmp_ocd_csl_sem_bse_cli","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":24.27563906025959,"y":1035.7255672468625},"sourceId":null,"tableName":"tmp_ocd_csl_sem_bse_cli","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fTBvoG","type":"builder","appId":137,"label":"Aux - Visão Consolidada","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_geral_mes","id":"wrjfto","to":"tmp_ocd_csl_sem_bse_cli","raw":"","list":[{"id":"EudtDQ","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_ocd_csl_sem_bse_cli","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"CbQjtP","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_ocd_csl_sem_bse_cli","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"gENXmz","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"kJZpbI","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"KcGKaR","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"FVErUD","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"zQRxzE","type":"sum","alias":"REAL_ORIGINAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"HLgBeg","type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MC","computedId":"acaNij","columnLength":2},{"id":"hJkJev","type":"computed","alias":"REAL_TM","content":"SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` <> 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_TM","computedId":"zrzQTe","columnLength":2},{"id":"ljAEIh","type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_RL","computedId":"KRffCw","columnLength":2},{"id":"uADalA","type":"computed","alias":"ORCADO_CSL","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_CSL","computedId":"ujuPKq","columnLength":2},{"id":"otVseh","type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_MC","computedId":"MfxEno","columnLength":2},{"id":"vEvuUl","type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_RL","computedId":"gXaUkc","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"ZJdORf"},{"type":"computed","alias":"ORCADO_CSL","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_CSL","computedId":"ujuPKq","columnLength":2},{"type":"computed","alias":"REAL_TM","content":"SUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END) / \nSUM(CASE WHEN `tmp_base_geral_mes`.`TIP_MTC` <> 'Ticket Medio' THEN 0 ELSE `tmp_base_geral_mes`.`REAL` END)","dataType":"Nullable(Float64)","columnName":"REAL_TM","computedId":"zrzQTe","columnLength":2},{"type":"computed","alias":"REAL_MC","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal'THEN\r\nREAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_MC","computedId":"acaNij","columnLength":2},{"type":"computed","alias":"REAL_RL","content":"SUM(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal'THEN\r\nREAL\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_RL","computedId":"KRffCw","columnLength":2},{"type":"computed","alias":"ORCADO_MC","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Margem Contribuição Mensal' THEN\r\nORCADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_MC","computedId":"MfxEno","columnLength":2},{"type":"computed","alias":"ORCADO_RL","content":"MAX(CASE WHEN '{{prm_indicador}}' = 'Margem Contribuição' AND TIP_MTC = 'Receita Liquida Mensal' THEN\r\nORCADO\r\nelse 0\r\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_RL","computedId":"gXaUkc","columnLength":2}]},"created":false,"position":{"x":26.471423500177167,"y":1304.9122624403922},"sourceId":null,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_aux_csl_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"zEnkpV","type":"table","appId":137,"label":"tmp_aux_csl_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":151.9899464853857,"y":1306.0845474044256},"sourceId":null,"tableName":"tmp_aux_csl_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YdPZqs","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QoVUJp","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_csl_mes","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"TrNqvy","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_csl_mes","columnName":"REAL_ORIGINAL","columnLength":2,"databaseName":"bucket_137"},{"id":"vDCiHu","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_csl_mes","columnName":"REAL_MC","columnLength":2,"databaseName":"bucket_137"},{"id":"QmxoYi","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_csl_mes","columnName":"REAL_TM","columnLength":2,"databaseName":"bucket_137"},{"id":"uEeywL","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_csl_mes","columnName":"REAL_RL","columnLength":2,"databaseName":"bucket_137"},{"id":"seJMdw","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_csl_mes","columnName":"ORCADO_CSL","columnLength":2,"databaseName":"bucket_137"},{"id":"erBQms","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_csl_mes","columnName":"ORCADO_MC","columnLength":2,"databaseName":"bucket_137"},{"id":"UEWExH","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_aux_csl_mes","columnName":"ORCADO_RL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":289.7138560438832,"y":1304.8188772947278},"sourceId":null,"tableName":"tmp_aux_csl_mes","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_csl_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"bOHEbk","type":"table","appId":137,"label":"tmp_csl_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":654.5837905204797,"y":1208.240933505086},"sourceId":null,"tableName":"tmp_csl_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-732.0395516690904,"y":731.0034923061548},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"GkjucI","type":"table","appId":137,"label":"base_orcado_portal_csl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-741.1354459589402,"y":642.2966186718312},"sourceId":null,"tableName":"base_orcado_portal_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eDcnBu","type":"table","appId":137,"label":"base_geral_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-743.8866361342916,"y":531.5129435875426},"sourceId":7,"tableName":"base_geral_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"vgATWr","type":"table","appId":137,"label":"base_geral_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-738.1618873866095,"y":955.810490171939},"sourceId":7,"tableName":"base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pVhlCm","type":"table","appId":137,"label":"tmp_orcado_dia","client":"clickhouse","repoId":1,"created":false,"position":{"x":-173.35088884246997,"y":-69.67887114404945},"tableName":"tmp_orcado_dia","sourceType":"bucket","databaseName":"bucket_137"},{"id":"Xbvcxy","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"IXaeuh","type":"value","andOr":"and","value":"toStartOfMonth(today())","dataType":"Nullable(Date)","operator":"between","fieldType":"value","tableName":"tmp_orcado_dia","valueType":"computed","columnName":"data","extraValue":"addDays(addMonths(toStartOfMonth(today()), 1),-1)","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"vfAVCy","type":"value","dataType":"Nullable(Date)","tableName":"tmp_orcado_dia","columnName":"data","columnLength":null,"databaseName":"bucket_137"},{"id":"GHZnrD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_orcado_dia","columnName":"indice_mes","columnLength":2,"databaseName":"bucket_137"},{"id":"PgNObq","type":"computed","alias":"indice_acu","content":"sum(indice_mes) OVER\r\n       (PARTITION BY 1 ORDER BY data ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"indice_acu","computedId":"HEYjbJ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"dia_join","content":"toDayOfMonth(data)","dataType":"Nullable(Int64)","columnName":"dia_join","computedId":"wnvFuu"},{"type":"computed","alias":"indice_acu","content":"sum(indice_mes) OVER\r\n       (PARTITION BY 1 ORDER BY data ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"indice_acu","computedId":"HEYjbJ","columnLength":2}]},"created":false,"position":{"x":1.22702632781073,"y":-70.03448952105141},"tableName":"tmp_orcado_dia","sourceType":"bucket","resultTable":"tmp_ocd_dia_fnl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"czvZVe","type":"table","appId":137,"label":"tmp_ocd_dia_fnl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":128.87367896850765,"y":-68.44597186662455},"tableName":"tmp_ocd_dia_fnl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NTpNDV","type":"table","appId":137,"label":"base_orcado_portal_hrq","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-735.734203550653,"y":841.2257588617263},"sourceId":null,"tableName":"base_orcado_portal_hrq","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qoxvyD","type":"table","appId":137,"label":"tmp_base_orcado_portal_hrq","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-167.11814708938945,"y":1503.566320200401},"sourceId":null,"tableName":"tmp_base_orcado_portal_hrq","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DPBecT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GLKhAZ","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"xahfxu","type":"value","dataType":"Nullable(Date)","tableName":"tmp_base_orcado_portal_hrq","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"fyuGjy","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"ERtiBs","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"YdQnqN","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"mASUHO","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"upBmSd","type":"value","andOr":"and","value":"2023-01-01","dataType":"Nullable(Date)","operator":">=","fieldType":"value","tableName":"tmp_base_orcado_portal_hrq","valueType":"value","columnName":"mes_ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GLKhAZ","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"xahfxu","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_orcado_portal_hrq","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"fyuGjy","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"ERtiBs","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"YdQnqN","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_orcado_portal_hrq","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"pKLFgV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_orcado_portal_hrq","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"HwXnPG","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_hrq","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":-41.393337721409296,"y":1503.7475507624558},"sourceId":null,"tableName":"tmp_base_orcado_portal_hrq","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_hie_venda","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"LNzkyC","type":"table","appId":137,"label":"tmp_hie_venda","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":64.95382628069571,"y":1505.0222106715314},"sourceId":null,"tableName":"tmp_hie_venda","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"micUCY","type":"builder","appId":137,"label":"Visão Hierarquia","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_geral_mes","id":"CkTzuS","to":"tmp_hie_venda","raw":"","list":[{"id":"PBIydL","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_hie_venda","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SNOnCr","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_hie_venda","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"tdZJaE","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_hie_venda","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"pMsvTH","andOr":"and","tableBy":"tmp_base_geral_mes","tableTo":"tmp_hie_venda","columnBy":"HRQ_3","columnTo":"hieraraquia_nivel_3","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"vAtpCa","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"yBqJMS","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"Ewinum","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"HiqUVh","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"doYgWi","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"npQlaA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"AshtUW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"TnnJmE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"FyFgpo","type":"value","andOr":"and","value":"prm_mes_diario","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"parameter","columnName":"Mes_Ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"oEMYaa","type":"value","andOr":"and","value":["Receita Bruta Mensal","Receita Líquida Mensal"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="},{"list":[{"id":"muDYoP","type":"value","andOr":"and","value":"case\nwhen toMonth(addMonths(today(),-2)) > 9\nthen concat(toString(toYear(addMonths(today(),-2))),toString(toMonth(addMonths(today(),-2))))\nelse concat(toString(toYear(addMonths(today(),-2))),'0',toString(toMonth(addMonths(today(),-2))))\nend","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"computed","columnName":"Mes_Ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"jIwxVO","type":"value","andOr":"and","value":["Ebit Mensal","Ebitda Mensal","Margem Contribuição Mensal"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_base_geral_mes","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"}],"andOr":"or","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"BfJlNV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"npQlaA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"AshtUW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"TnnJmE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"zQRxzE","type":"sum","alias":"REAL","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"tsIRBt","type":"max","alias":"ORCADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_hie_venda","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"JaTjjP","type":"computed","alias":"ORCADO_TTD","content":"case when ORCADO is null then 0 ELSE ORCADO end","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TTD","computedId":"YduFpI"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"ZJdORf"},{"type":"computed","alias":"ORCADO_TTD","content":"case when ORCADO is null then 0 ELSE ORCADO end","dataType":"Nullable(Int64)","columnName":"ORCADO_TTD","computedId":"YduFpI"}]},"created":false,"position":{"x":65.62841990847541,"y":1410.0559754821818},"sourceId":null,"tableName":"tmp_base_geral_mes","sourceType":"bucket","resultTable":"tmp_fnl_hrq_base_geral_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ieNWwW","type":"table","appId":137,"label":"tmp_fnl_hrq_base_geral_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":342.8560563940906,"y":1407.229654551052},"sourceId":null,"tableName":"tmp_fnl_hrq_base_geral_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TZXUky","type":"builder","appId":137,"label":"Hierarquia Corporativo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"yMErAg","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"bhpQjm","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"dRNrot","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"RAjfPX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"moiRTy","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"RfsIFC","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_hrq_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"FTMXjZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"gZxzQd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"zkcDeu","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"GziaHa","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"ORCADO_TTD","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":499.9372750899021,"y":1561.802105753511},"sourceId":null,"tableName":"tmp_fnl_hrq_base_geral_mes","sourceType":"bucket","resultTable":"tmp_hrq_crp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"CUaudU","type":"table","appId":137,"label":"tmp_hrq_crp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":647.9372750899021,"y":1561.802105753511},"sourceId":null,"tableName":"tmp_hrq_crp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LkVjeZ","type":"builder","appId":137,"label":"Hierarquia Varejo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"sQuxlY","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"zVxQfI","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"pfogXJ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"tOoAkC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"cgNJQj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"RfsIFC","type":"value","andOr":"and","value":"RESIDENCIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_hrq_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"xKfBIm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"CzspeA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"zkcDeu","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"bsQVrG","type":"max","alias":"ORCADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"ORCADO_TTD","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":499.53564957314967,"y":1287.490888753233},"sourceId":null,"tableName":"tmp_fnl_hrq_base_geral_mes","sourceType":"bucket","resultTable":"tmp_hrq_vrj","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"mHAMXb","type":"table","appId":137,"label":"tmp_hrq_vrj","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":645.8663701355997,"y":1289.3782560882971},"sourceId":null,"tableName":"tmp_hrq_vrj","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NQdcWf","type":"builder","appId":137,"label":"Hierarquia Empresarial","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"bYihSG","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"TvFZaZ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"UkilLe","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"SfooWR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"vcvEhI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"RfsIFC","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_hrq_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"waAumL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"zUmiRe","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"zkcDeu","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"Qrbwvu","type":"max","alias":"ORCADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"ORCADO_TTD","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":501.8666638601742,"y":1414.3780357948665},"sourceId":null,"tableName":"tmp_fnl_hrq_base_geral_mes","sourceType":"bucket","resultTable":"tmp_hrq_emp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vyyiXE","type":"table","appId":137,"label":"tmp_hrq_emp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":651.8668107224614,"y":1413.3779623637229},"sourceId":null,"tableName":"tmp_hrq_emp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eoQKRC","type":"builder","appId":137,"label":"Hierarquia Atacado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"uckrAh","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"aDdSOY","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"flWenN","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"vEogah","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"pxBcHf","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","dataType":"Nullable(String)","tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"RfsIFC","type":"value","andOr":"and","value":"OPERADORAS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_fnl_hrq_base_geral_mes","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QOKWhZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"shRUmq","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"coLpjm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"zkcDeu","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"XJsxjJ","type":"max","alias":"ORCADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fnl_hrq_base_geral_mes","columnName":"ORCADO_TTD","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":499.9372750899021,"y":1689.802105753511},"sourceId":null,"tableName":"tmp_fnl_hrq_base_geral_mes","sourceType":"bucket","resultTable":"tmp_hrq_ata","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"peCHKr","type":"table","appId":137,"label":"tmp_hrq_ata","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":647.9372750899021,"y":1689.802105753511},"sourceId":null,"tableName":"tmp_hrq_ata","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JSmvft","type":"table","appId":137,"label":"tmp_base_geral_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-436.89625523462905,"y":204.5252259567031},"sourceId":7,"tableName":"tmp_base_geral_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HDyELt","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"DxgrPt","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"GwHERY","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"gIpIXw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ndFJRf","type":"computed","alias":"TIP_MTC_TTD","content":"concat(TIP_MTC, ' Mensal')","dataType":"Nullable(String)","columnName":"TIP_MTC_TTD","computedId":"tpJDdg"},{"id":"lTRaNv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"KUpLgc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"WbnHtT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"CBEyvE","type":"value","andOr":"and","value":"prm_segmento","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_geral_dia","valueType":"parameter","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"WqWrWz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"BlJEaZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"GQNLzO","type":"computed","alias":"TIP_MTC_TTD","content":"concat(TIP_MTC, ' Mensal')","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC_TTD","computedId":"tpJDdg"},{"id":"Sieafw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"dmvfNk","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"rIYVaI","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"rpLzIZ","type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"MES_REF","computedId":"TOwQis"},{"id":"krjqMe","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"OVBiiQ","columnLength":2},{"type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"MES_REF","computedId":"TOwQis"},{"type":"computed","alias":"TIP_MTC_TTD","content":"concat(TIP_MTC, ' Mensal')","dataType":"Nullable(String)","columnName":"TIP_MTC_TTD","computedId":"tpJDdg"}]},"created":false,"position":{"x":-250.8481187367192,"y":415.84358462619184},"sourceId":7,"tableName":"tmp_base_geral_dia","sourceType":"bucket","resultTable":"tmp_csl_dia_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"efGgWH","type":"table","appId":137,"label":"tmp_csl_dia_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-140.9882299972355,"y":414.9520342967117},"sourceId":7,"tableName":"tmp_csl_dia_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TFdSoj","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_csl_dia_aux","id":"GTJCLc","to":"tmp_base_orcado_portal_csl","raw":"","list":[{"id":"CrMbbx","andOr":"and","tableBy":"tmp_csl_dia_aux","tableTo":"tmp_base_orcado_portal_csl","columnBy":"MES_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"ALBRcs","andOr":"and","tableBy":"tmp_csl_dia_aux","tableTo":"tmp_base_orcado_portal_csl","columnBy":"TIP_MTC_TTD","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"IiNHoo","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"TIP_MTC_TTD","columnLength":null,"databaseName":"bucket_137"},{"id":"CLOcGZ","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_csl_dia_aux","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"axMvCw","type":"value","order":"asc","dataType":"Nullable(DateTime)","tableName":"tmp_csl_dia_aux","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ZRYwGO","type":"value","order":"asc","dataType":"Nullable(Date)","tableName":"tmp_csl_dia_aux","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"xtEVNg","type":"value","order":"asc","dataType":"Nullable(Float64)","tableName":"tmp_csl_dia_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"pephAl","type":"value","alias":"","order":"asc","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_csl","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"cHIoaR","type":"value","dataType":"Nullable(String)","tableName":"tmp_csl_dia_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ImZoSn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"hItIKG","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"TIP_MTC_TTD","columnLength":null,"databaseName":"bucket_137"},{"id":"RiaFFx","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_csl_dia_aux","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"iprWur","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_csl_dia_aux","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"PDNVIF","type":"value","dataType":"Nullable(Date)","tableName":"tmp_csl_dia_aux","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"fiCOAD","type":"value","dataType":"Nullable(String)","tableName":"tmp_csl_dia_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CLQnkm","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_csl_dia_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"IZRvRg","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_csl","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HCiZVt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"YkmWHL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"hItIKG","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"TIP_MTC_TTD","columnLength":null,"databaseName":"bucket_137"},{"id":"RiaFFx","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_csl_dia_aux","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"iprWur","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_csl_dia_aux","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"PDNVIF","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"ElRvVU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CLQnkm","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_csl_dia_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"bxGOro","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_orcado_portal_csl","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":-50.98822999723549,"y":414.9520342967117},"sourceId":7,"tableName":"tmp_csl_dia_aux","sourceType":"bucket","resultTable":"tmp_csl_dia_ocd_msl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XDlBBV","type":"table","appId":137,"label":"tmp_csl_dia_ocd_msl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":39.01177000276451,"y":414.9520342967117},"sourceId":7,"tableName":"tmp_csl_dia_ocd_msl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"MXOWow","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_csl_dia_ocd_msl","id":"rOylqV","to":"tmp_ocd_dia_fnl","raw":"","list":[{"id":"ngxNJW","andOr":"and","tableBy":"tmp_csl_dia_ocd_msl","tableTo":"tmp_ocd_dia_fnl","columnBy":"DATA_REF","columnTo":"data","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"rnamQD","type":"value","andOr":"and","value":"prm_mes_diario","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_csl_dia_ocd_msl","valueType":"parameter","columnName":"Mes_Ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"voqVVr","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"XMUxoJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"xDhtCu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"TIP_MTC_TTD","columnLength":null,"databaseName":"bucket_137"},{"id":"fyQDZQ","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"rMtquT","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"tGdPXx","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"dyRNxb","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_csl_dia_ocd_msl","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"rVOVuI","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY TIP_MTC ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"RpOtGV","columnLength":2},{"id":"HPxmgS","type":"computed","alias":"ORCADO_ACU","content":" ORCADO *  indice_acu","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_ACU","computedId":"xRidCx","columnLength":2},{"id":"zaNnrV","type":"computed","alias":"ORCADO_NAO_ACU","content":" ORCADO *  indice_mes","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_NAO_ACU","computedId":"Pudjes","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO_ACU","content":" ORCADO *  indice_acu","dataType":"Nullable(Float64)","columnName":"ORCADO_ACU","computedId":"xRidCx","columnLength":2},{"type":"computed","alias":"ORCADO_NAO_ACU","content":" ORCADO *  indice_mes","dataType":"Nullable(Float64)","columnName":"ORCADO_NAO_ACU","computedId":"Pudjes","columnLength":2},{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY TIP_MTC ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"RpOtGV","columnLength":2}]},"created":false,"position":{"x":129.0117700027645,"y":414.9520342967117},"sourceId":7,"tableName":"tmp_csl_dia_ocd_msl","sourceType":"bucket","resultTable":"tmp_csl_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oKdxtU","type":"table","appId":137,"label":"tmp_csl_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":255.8059623644901,"y":413.59579240527336},"sourceId":7,"tableName":"tmp_csl_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hqmowN","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"LokrUF","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"JmESRh","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"LTlteB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"KCQutz","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"guEopb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"LTlteB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"KCQutz","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"guEopb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"xQzGvN","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":-205.461965162809,"y":109.79838819244044},"sourceId":7,"tableName":"tmp_base_geral_dia","sourceType":"bucket","resultTable":"tmp_sgm_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"rEkVrC","type":"table","appId":137,"label":"tmp_sgm_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-114.19846491418434,"y":109.46849441603705},"sourceId":7,"tableName":"tmp_sgm_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HXAqhl","type":"builder","appId":137,"label":"Visão Segmento Dia","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"bCRjok","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"hbzrne","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uOPtyG","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"vDYKtx","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"UratDO","type":"value","andOr":"and","value":"prm_mes_diario","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_geral_dia","valueType":"parameter","columnName":"Mes_Ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"cfBxIJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"MKtKjL","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"fQAHDJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"UBNLqR","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_geral_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"RKyUft","columnLength":2}]},"created":false,"position":{"x":139.7617902877987,"y":209.7246069904067},"sourceId":null,"tableName":"tmp_base_geral_dia","sourceType":"bucket","resultTable":"tmp_aux_sgm_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ziLiHh","type":"table","appId":137,"label":"tmp_aux_sgm_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":388.5,"y":207},"sourceId":null,"tableName":"tmp_aux_sgm_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"unZVMk","type":"builder","appId":137,"label":"Empresarial","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_dia","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"teZrul","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"puuyZD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"vimTSj","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"lbeYPR","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"lbeYPR","columnLength":2}]},"created":false,"position":{"x":561.5,"y":381},"sourceId":null,"tableName":"tmp_aux_sgm_dia","sourceType":"bucket","resultTable":"tmp_sgm_emp_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"YTcahO","type":"table","appId":137,"label":"tmp_sgm_emp_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":709.5,"y":381},"sourceId":null,"tableName":"tmp_sgm_emp_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"nPSJCJ","type":"builder","appId":137,"label":"Corporativo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_dia","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"gblbzl","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"HoNeay","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"MNOoCD","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"MNOoCD","columnLength":2}]},"created":false,"position":{"x":561.5,"y":33},"sourceId":null,"tableName":"tmp_aux_sgm_dia","sourceType":"bucket","resultTable":"tmp_sgm_crp_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Ncjcwr","type":"table","appId":137,"label":"tmp_sgm_crp_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":709.5,"y":33},"sourceId":null,"tableName":"tmp_sgm_crp_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"xoHOBY","type":"builder","appId":137,"label":"Varejo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"RESIDENCIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_dia","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"UjbFWs","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"wzPtNc","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"ffPDkA","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"ffPDkA","columnLength":2}]},"created":false,"position":{"x":561.5,"y":149},"sourceId":null,"tableName":"tmp_aux_sgm_dia","sourceType":"bucket","resultTable":"tmp_sgm_vrj_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GJzyLO","type":"table","appId":137,"label":"tmp_sgm_vrj_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":709.5,"y":149},"sourceId":null,"tableName":"tmp_sgm_vrj_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TlGSlA","type":"builder","appId":137,"label":"Atacado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"maqmMI","type":"value","andOr":"and","value":"OPERADORAS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_sgm_dia","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CSxUhc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"OmwFXy","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"fwHCbM","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"jPaoej","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"jPaoej","columnLength":2}]},"created":false,"position":{"x":561.5,"y":265},"sourceId":null,"tableName":"tmp_aux_sgm_dia","sourceType":"bucket","resultTable":"tmp_sgm_ata_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"aYPmPU","type":"table","appId":137,"label":"tmp_sgm_ata_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":709.5,"y":265},"sourceId":null,"tableName":"tmp_sgm_ata_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"hpgJKH","source":"JeWTjp","target":"dElUoc"},{"id":"YBLJJE","source":"CYCZHg","target":"fTBvoG"},{"id":"sXQVWl","source":"Xbvcxy","target":"czvZVe"},{"id":"AjRYlZ","source":"pVhlCm","target":"Xbvcxy"},{"id":"kIYFcI","source":"ziLiHh","target":"unZVMk"},{"id":"sctIpV","source":"unZVMk","target":"YTcahO"},{"id":"OnBDIa","source":"ziLiHh","target":"nPSJCJ"},{"id":"splIgS","source":"nPSJCJ","target":"Ncjcwr"},{"id":"StJUOZ","source":"ziLiHh","target":"xoHOBY"},{"id":"MwyDZQ","source":"xoHOBY","target":"GJzyLO"},{"id":"aTUjSL","source":"ziLiHh","target":"TlGSlA"},{"id":"bZbNAD","source":"TlGSlA","target":"aYPmPU"},{"id":"SgrnmR","source":"ieNWwW","target":"TZXUky"},{"id":"TfOKEg","source":"TZXUky","target":"CUaudU"},{"id":"DlqIiN","source":"XDlBBV","target":"MXOWow"},{"id":"dUBQIS","source":"czvZVe","target":"MXOWow"},{"id":"Erwxrd","source":"MXOWow","target":"oKdxtU"},{"id":"dqdaGr","source":"ieNWwW","target":"LkVjeZ"},{"id":"SSEFlx","source":"LkVjeZ","target":"mHAMXb"},{"id":"YRIkDb","source":"ieNWwW","target":"NQdcWf"},{"id":"ijzXkk","source":"NQdcWf","target":"vyyiXE"},{"id":"liMiOv","source":"ieNWwW","target":"eoQKRC"},{"id":"STbiQd","source":"eoQKRC","target":"peCHKr"},{"id":"sUoVOg","source":"efGgWH","target":"TFdSoj"},{"id":"mIjpBo","source":"BBYyBY","target":"TFdSoj"},{"id":"rkLiun","source":"TFdSoj","target":"XDlBBV"},{"id":"speWhr","source":"BBYyBY","target":"BqMMuS"},{"id":"KHxOJn","source":"BqMMuS","target":"CYCZHg"},{"id":"NmGkWF","source":"faiuYZ","target":"mZhSqP"},{"id":"EsMGzK","source":"BBuytA","target":"mZhSqP"},{"id":"wBksdF","source":"mZhSqP","target":"JhZLWJ"},{"id":"jfEJTw","source":"qoxvyD","target":"DPBecT"},{"id":"oEoadh","source":"DPBecT","target":"LNzkyC"},{"id":"IVmmgp","source":"JSmvft","target":"HDyELt"},{"id":"EUeeYb","source":"HDyELt","target":"efGgWH"},{"id":"mDKCvz","source":"JSmvft","target":"hqmowN"},{"id":"LtQtaR","source":"hqmowN","target":"rEkVrC"},{"id":"ZtygJV","source":"JSmvft","target":"HXAqhl"},{"id":"YttDzB","source":"HXAqhl","target":"ziLiHh"},{"id":"qaoYCp","source":"rhWjro","target":"IqQslG"},{"id":"aPCwsE","source":"IqQslG","target":"faiuYZ"},{"id":"MUUpfA","source":"rhWjro","target":"PUflmg"},{"id":"KIXDMR","source":"PUflmg","target":"TZWRwR"},{"id":"ODnLbr","source":"fTBvoG","target":"zEnkpV"},{"id":"SNGoqA","source":"zEnkpV","target":"YdPZqs"},{"id":"xpHiwC","source":"YdPZqs","target":"bOHEbk"},{"id":"ijQUXz","source":"rhWjro","target":"kSIbMZ"},{"id":"CvnLZD","source":"BBuytA","target":"kSIbMZ"},{"id":"fVORHF","source":"kSIbMZ","target":"elZPRz"},{"id":"eCNiot","source":"elZPRz","target":"qDjjhm"},{"id":"imkVpB","source":"qDjjhm","target":"NDsNBp"},{"id":"xGwJkw","source":"elZPRz","target":"HzBSGG"},{"id":"vLGQDQ","source":"HzBSGG","target":"fxLyDI"},{"id":"oXpZFM","source":"rhWjro","target":"uWHXZx"},{"id":"drQXKn","source":"BBuytA","target":"uWHXZx"},{"id":"uzFPpB","source":"uWHXZx","target":"yJxHmA"},{"id":"TuMKjV","source":"yJxHmA","target":"bGeOPI"},{"id":"UDbjrv","source":"bGeOPI","target":"xNazXV"},{"id":"CCRrgK","source":"yJxHmA","target":"VLnYZt"},{"id":"CcaCCL","source":"VLnYZt","target":"Yrpyxd"},{"id":"HENEsx","source":"yJxHmA","target":"OryoAz"},{"id":"IaNalV","source":"OryoAz","target":"rpxYlp"},{"id":"ecNnPA","source":"yJxHmA","target":"TAnjat"},{"id":"sshPIs","source":"TAnjat","target":"OPwijd"},{"id":"MgUuhm","source":"elZPRz","target":"BxhCYK"},{"id":"gyuozj","source":"BxhCYK","target":"wSllIW"},{"id":"vDNYvc","source":"elZPRz","target":"qwUxHB"},{"id":"VkzuHV","source":"qwUxHB","target":"dkZeiN"},{"id":"yZeKDl","source":"rhWjro","target":"fTBvoG"},{"id":"ckdZVC","source":"VnwXaM","target":"DYoUOn"},{"id":"vPlfkF","source":"DYoUOn","target":"TlkcPp"},{"id":"uBzOKO","source":"VnwXaM","target":"wSMZAN"},{"id":"GEGYRt","source":"wSMZAN","target":"fouUZS"},{"id":"josjxg","source":"VnwXaM","target":"ixfCfw"},{"id":"APCRBs","source":"ixfCfw","target":"whmwSZ"},{"id":"mRLjiW","source":"VnwXaM","target":"JeWTjp"},{"id":"dovPyl","source":"rhWjro","target":"micUCY"},{"id":"fqIJVU","source":"LNzkyC","target":"micUCY"},{"id":"NwwpJb","source":"micUCY","target":"ieNWwW"},{"id":"IBRTbT","source":"TlkcPp","target":"ZabIrj"},{"id":"gSSEmN","source":"ZabIrj","target":"MqupBH"},{"id":"YSwzlN","source":"fouUZS","target":"FFThnI"},{"id":"eONHND","source":"FFThnI","target":"pFuruf"},{"id":"bKmHiN","source":"whmwSZ","target":"GZydyh"},{"id":"kPBqLu","source":"GZydyh","target":"WSwkLV"},{"id":"jtvros","source":"dElUoc","target":"qlDSCq"},{"id":"syvSGT","source":"qlDSCq","target":"NWsHge"},{"id":"WfnBAG","source":"rhWjro","target":"RZcgkD"},{"id":"SlsdYH","source":"XXGaGp","target":"RZcgkD"},{"id":"PhHGFe","source":"RZcgkD","target":"VnwXaM"}]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"tQulGdbVhyuqQTotMKvRiHyixGcpIIqs","flowDescription":"","locked":"no","created":"2023-03-06 09:59:07","updated":"2023-09-08 09:08:23"},{"flowId":"2536","appId":137,"flowName":"DASHBOARD INTERNO - Validação Carga","workflow":{"nodes":[{"id":"OBSYrg","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":186.00689316636544,"y":547.0027885991203},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DCdvER","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":50.007739145873984,"y":330.0044805581375},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BhqzeO","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"tSPjpF","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"kwgMTi","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qXVkVm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"eKDiSp","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"mpplOA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"KEizav","type":"value","alias":"","andOr":"and","value":["Perda de Receita Mensal","Venda Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"ObFXdm","type":"value","alias":"","andOr":"and","value":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","distinct":false,"operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VROqZH","type":"value","alias":"Indicador","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"bLAUxX","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"mpplOA","type":"value","alias":"Segmento","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"qYiYUH","type":"computed","alias":"REAL_MIL","content":"round(SUM(REAL)/1000,2)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_MIL","computedId":"RywltA","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_MIL","content":"round(SUM(REAL)/1000,2)","dataType":"Nullable(Float64)","columnName":"REAL_MIL","computedId":"RywltA","columnLength":2}]},"created":false,"optimize":false,"position":{"x":158.007175159535,"y":331.0044492255631},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_validacao_valores","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BIZUor","type":"table","appId":137,"label":"tmp_validacao_valores","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":273.00639184517524,"y":330.0044805581374},"sourceId":null,"tableName":"tmp_validacao_valores","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"nxXnAl","type":"table","appId":137,"label":"VALIDACAO_CARGA","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":179.5,"y":33},"sourceId":7,"tableName":"VALIDACAO_CARGA","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pLCJgY","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH INDICADORES AS (\r\n\tSELECT \t  CASE \r\n\t\t\t\tWHEN TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'VENDAS - NOVA VENDA') THEN 'Venda'\r\n\t\t\t\tWHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n\t\t\t\tWHEN TIP_MTC = 'CHURN RECEITA' THEN 'Churn de Receita'\r\n\t\t\t\tWHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n\t\t\t\tWHEN TIP_MTC = 'DOWNGRADE' THEN 'Downgrade'\r\n\t\t\t\tWHEN TIP_MTC = 'FATURAMENTO - FATURAMENTO BRUTO' THEN 'Faturamento'\r\n\t\t\t  END AS INDICADOR\r\n\t\t\t, CASE \r\n\t\t\t\tWHEN TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'VENDAS - NOVA VENDA') THEN 'Venda'\r\n\t\t\t\tWHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes / Ticket Medio'\r\n\t\t\t\tWHEN TIP_MTC = 'CHURN RECEITA' THEN 'Perda de Receita'\r\n\t\t\t\tWHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n\t\t\t\tWHEN TIP_MTC = 'DOWNGRADE' THEN 'Perda de Receita'\r\n\t\t\t\tWHEN TIP_MTC = 'FATURAMENTO - FATURAMENTO BRUTO' THEN 'Ticket Medio'\r\n\t\t\t  END AS USADO_EM\r\n\t\t\t, DSC_SGM_CLI  AS segmento\r\n\t\t\t, MAX(DAT_CRG_RGT) AS DATA_carga\r\n\t\t\t, MAX(DAT_DIA_MES_REF) AS DATA_REF\r\n\tFROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n\tWHERE 1 = 1\r\n\t\tAND DSC_SGM_CLI IS NOT NULL\r\n\t\tAND (TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO'\r\n\t\t\t\t\t  , 'BASE DE CLIENTES'\r\n\t\t\t\t\t  , 'DADOS FISICOS - BASE'\r\n\t\t\t\t\t  , 'CHURN RECEITA'\r\n\t\t\t\t\t  , 'DOWNGRADE')\r\n\t\t\tOR  (TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL' AND DSC_SGM_CLI = 'EMPRESARIAL')\r\n\t\t\tOR  (TIP_MTC = 'VENDAS - NOVA VENDA' AND DSC_SGM_CLI <> 'EMPRESARIAL')\r\n\t\t\t)\r\n\tGROUP BY  TIP_MTC\r\n\t\t\t, DSC_SGM_CLI\r\n\tORDER BY  TIP_MTC\r\n\t\t\t, DSC_SGM_CLI\r\n)\r\n\r\nSELECT \t  INDICADOR AS INDICADOR_NEW\r\n\t\t, USADO_EM AS USADO_EM_NEW\r\n\t\t, SEGMENTO AS SEGMENTO_NEW\r\n\t\t, DATA_CARGA AS DATA_CARGA_NEW\r\n\t\t, DATA_REF AS DATA_REF_NEW\r\n\t\t, CASE \r\n\t\t\tWHEN TRUNC(SYSDATE, 'DD') = DATA_CARGA THEN 'RODOU' \r\n\t\t\tELSE 'VERIFICAR' \r\n\t\t  END AS STATUS_CARGA_NEW\r\n\t\t, CASE \r\n\t\t\tWHEN TRUNC(SYSDATE-1, 'DD') = DATA_REF OR TRUNC(SYSDATE, 'DD') = DATA_REF THEN 'D-1' \r\n\t\t\tELSE 'VERIFICAR' \r\n\t\t  END AS STATUS_NEW\r\n\t\t, to_char(sysdate,'HH:mi:ss') AS HORARIO_NEW\r\nFROM INDICADORES","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":22,"y":149},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"VALIDACAO_CARGA_ATUAL","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"rRUVLG","type":"table","appId":137,"label":"VALIDACAO_CARGA_ATUAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":179.5,"y":149},"sourceId":7,"tableName":"VALIDACAO_CARGA_ATUAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"aNFDsA","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"VALIDACAO_CARGA","id":"KwApyk","to":"VALIDACAO_CARGA_ATUAL","raw":"","list":[{"id":"lZETVc","andOr":"and","tableBy":"VALIDACAO_CARGA","tableTo":"VALIDACAO_CARGA_ATUAL","columnBy":"INDICADOR","columnTo":"INDICADOR_NEW","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"RAaDXq","andOr":"and","tableBy":"VALIDACAO_CARGA","tableTo":"VALIDACAO_CARGA_ATUAL","columnBy":"SEGMENTO","columnTo":"SEGMENTO_NEW","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZnfyuI","type":"value","dataType":"Nullable(String)","tableName":"VALIDACAO_CARGA","columnName":"INDICADOR","columnLength":2,"databaseName":"bucket_137"},{"id":"SaCPmL","type":"value","dataType":"Nullable(String)","tableName":"VALIDACAO_CARGA","columnName":"USADO_EM","columnLength":2,"databaseName":"bucket_137"},{"id":"dKsoaK","type":"computed","alias":"SGM","content":"case\nwhen SEGMENTO = 'CORPORATIVO' then 'CORPORATIVO'\nwhen SEGMENTO = 'EMPRESARIAL' then 'MPE'\nwhen SEGMENTO = 'RESIDENCIAL' then 'VAREJO'\nwhen SEGMENTO = 'OPERADORAS' then 'ATACADO'\nend","dataType":"Nullable(String)","distinct":false,"columnName":"SGM","computedId":"LXycWt"},{"id":"VWCHRK","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"VALIDACAO_CARGA","columnName":"DATA_CARGA","columnLength":2,"databaseName":"bucket_137"},{"id":"mBQZBx","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"VALIDACAO_CARGA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"DBKLDf","type":"value","dataType":"Nullable(String)","tableName":"VALIDACAO_CARGA","columnName":"STATUS_CARGA","columnLength":2,"databaseName":"bucket_137"},{"id":"oVyObq","type":"value","dataType":"Nullable(String)","tableName":"VALIDACAO_CARGA","columnName":"STATUS","columnLength":2,"databaseName":"bucket_137"},{"id":"qqqENG","type":"value","dataType":"Nullable(String)","tableName":"VALIDACAO_CARGA","columnName":"HORARIO","columnLength":2,"databaseName":"bucket_137"},{"id":"kwdEFT","type":"value","alias":"DATA_CARGA_BANCO","dataType":"Nullable(DateTime)","distinct":false,"tableName":"VALIDACAO_CARGA_ATUAL","columnName":"DATA_CARGA_NEW","columnLength":2,"databaseName":"bucket_137"},{"id":"tAwaSJ","type":"value","alias":"DATA_REF_ATUAL","dataType":"Nullable(DateTime)","distinct":false,"tableName":"VALIDACAO_CARGA_ATUAL","columnName":"DATA_REF_NEW","columnLength":2,"databaseName":"bucket_137"},{"id":"cPPYnu","type":"value","alias":"STATUS_CARGA_ATUAL","dataType":"Nullable(String)","distinct":false,"tableName":"VALIDACAO_CARGA_ATUAL","columnName":"STATUS_CARGA_NEW","columnLength":2,"databaseName":"bucket_137"},{"id":"WsJDPa","type":"value","alias":"STATUS_ATUAL","dataType":"Nullable(String)","distinct":false,"tableName":"VALIDACAO_CARGA_ATUAL","columnName":"STATUS_NEW","columnLength":2,"databaseName":"bucket_137"},{"id":"qTRQWF","type":"value","alias":"HORARIO_ATUAL","dataType":"Nullable(String)","distinct":false,"tableName":"VALIDACAO_CARGA_ATUAL","columnName":"HORARIO_NEW","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"SGM","content":"case\nwhen SEGMENTO = 'CORPORATIVO' then 'CORPORATIVO'\nwhen SEGMENTO = 'EMPRESARIAL' then 'MPE'\nwhen SEGMENTO = 'RESIDENCIAL' then 'VAREJO'\nwhen SEGMENTO = 'OPERADORAS' then 'ATACADO'\nend","dataType":"Nullable(String)","columnName":"SGM","computedId":"LXycWt"}]},"created":false,"optimize":false,"position":{"x":342,"y":91},"sourceId":7,"tableName":"VALIDACAO_CARGA","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_visao_validacao_carga","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"EURecf","type":"table","appId":137,"label":"tmp_visao_validacao_carga","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":498.5,"y":91},"sourceId":7,"tableName":"tmp_visao_validacao_carga","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"nIbQjv","grid":{"h":79,"w":64,"x":0,"y":0,"hidden":false},"type":"report","appId":137,"forms":[],"label":"Explorer","width":1875,"client":"clickhouse","height":469,"layout":{"lg":{"h":79,"w":64,"x":0,"y":0,"height":469,"hidden":false},"md":{"h":50,"i":"2536nIbQjv","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"2536nIbQjv","w":64,"x":0,"y":1,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[{"id":"kkLlwV","type":"value","combo":"first","order":"asc","dataType":"Nullable(String)","tableName":"tmp_visao_validacao_carga","columnName":"INDICADOR","columnLength":2,"databaseName":"bucket_137"},{"id":"CkxjYx","type":"value","alias":"USADO_EM","order":"asc","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"USADO_EM","fontWeight":"400","localOrder":"asc","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"xZxcDk","type":"value","alias":"SGM","order":"asc","title":"SEGMENTO","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"SGM","fontWeight":"400","localOrder":"asc","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"like"}],"group":[],"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"","operator":"="}],"select":[{"id":"SsAyxR","type":"value","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"INDICADOR","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"CkxjYx","type":"value","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"USADO_EM","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"xZxcDk","type":"value","title":"SEGMENTO","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"SGM","fontWeight":"400","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"like"},{"id":"fgymNd","type":"value","title":"CARGA","dataType":"Nullable(DateTime)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"DATA_CARGA","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="},{"id":"nhIwph","type":"value","title":"CARGA  BANCO","dataType":"Nullable(DateTime)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"DATA_CARGA_BANCO","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="},{"id":"AGWkEh","type":"value","title":"DATA","dataType":"Nullable(DateTime)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"DATA_REF","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="},{"id":"ozDNnV","type":"value","title":"DATA BANCO","dataType":"Nullable(DateTime)","fieldType":"","tableName":"tmp_visao_validacao_carga","columnName":"DATA_REF_ATUAL","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="},{"id":"OWoqPn","type":"value","title":"RODOU GAIO","condType":"fontColor","dataType":"Nullable(String)","fontSize":10,"condRules":[{"id":"UmXHFT","icon":"","color":"#00FF26","operator":"=","reference":"RODOU","extraReference":""},{"id":"IkagkN","icon":"","color":"#FFEA00","operator":"=","reference":"VERIFICAR","extraReference":""}],"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"STATUS_CARGA","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","condColumnName":"STATUS_CARGA","filterOperator":"like"},{"id":"GKyHsf","type":"value","title":"RODOU BANCO","condType":"fontColor","dataType":"Nullable(String)","fontSize":10,"condRules":[{"id":"QJCeMJ","icon":"","color":"#FFEA00","operator":"=","reference":"VERIFICAR","extraReference":""},{"id":"PAYcbI","icon":"","color":"#00FF26","operator":"=","reference":"RODOU","extraReference":""}],"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"STATUS_CARGA_ATUAL","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","condColumnName":"STATUS_CARGA_ATUAL","filterOperator":"like"},{"id":"CoocQa","type":"value","condType":"fontColor","dataType":"Nullable(String)","fontSize":10,"condRules":[{"id":"XehtRX","icon":"","color":"#FFEA00","operator":"=","reference":"VERIFICAR","extraReference":""},{"id":"CjApdO","icon":"","color":"#00FF26","operator":"=","reference":"D-1","extraReference":""}],"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"STATUS","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","condColumnName":"STATUS","filterOperator":"like"},{"id":"KDbLVk","type":"value","condType":"fontColor","dataType":"Nullable(String)","fontSize":10,"condRules":[{"id":"yueTRF","icon":"","color":"#FFEA00","operator":"=","reference":"VERIFICAR","extraReference":""},{"id":"tWsMkr","icon":"","color":"#00FF26","operator":"=","reference":"D-1","extraReference":""}],"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"STATUS_ATUAL","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","condColumnName":"STATUS_ATUAL","filterOperator":"like"},{"id":"LnOLNA","type":"value","title":"HORA","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"HORARIO","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"HcYUTb","type":"value","title":"HORA ATUAL","dataType":"Nullable(String)","fontSize":10,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_carga","textAlign":"center","columnName":"HORARIO_ATUAL","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"}],"limitBy":[]},"shared":false,"created":false,"position":{"x":653.5,"y":91},"settings":{"type":"column","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardType":"basic","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":100,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":false,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"clean","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":"10","titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":7,"tableName":"tmp_visao_validacao_carga","tableView":false,"temporary":false,"reportType":"table","sourceType":"bucket","databaseName":"bucket_137"},{"id":"idLFqx","type":"reportPreview","label":"Preview","created":false,"position":{"x":753.5,"y":91},"reportId":"nIbQjv","reportType":"table"},{"id":"FvbqSj","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":178.00103397495485,"y":657.9999060022768},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wTSgSM","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_validacao_valores","id":"aKkmJm","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"sjElAo","andOr":"and","tableBy":"tmp_validacao_valores","tableTo":"base_orcado_portal_sgm","columnBy":"Indicador","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"vcEnbE","andOr":"and","tableBy":"tmp_validacao_valores","tableTo":"base_orcado_portal_sgm","columnBy":"Segmento","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"FjIHwI","andOr":"and","tableBy":"tmp_validacao_valores","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_validacao_valores","id":"gkOwGt","to":"forecast_insight","raw":"","list":[{"id":"SoqMuc","andOr":"and","tableBy":"tmp_validacao_valores","tableTo":"forecast_insight","columnBy":"Segmento","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"cTDCcZ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_validacao_valores","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"},{"id":"qygzwX","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_validacao_valores","columnName":"Segmento","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"GBdgMf","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_valores","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"},{"id":"peZfyT","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_valores","columnName":"Segmento","columnLength":2,"databaseName":"bucket_137"},{"id":"HyIOXX","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_validacao_valores","columnName":"REAL_MIL","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GBdgMf","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_valores","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"},{"id":"peZfyT","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_valores","columnName":"Segmento","columnLength":2,"databaseName":"bucket_137"},{"id":"HyIOXX","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_validacao_valores","columnName":"REAL_MIL","columnLength":2,"databaseName":"bucket_137"},{"id":"fgakyJ","type":"computed","alias":"ORCADO_MIL","content":"round(max(ORCADO)/1000,2)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_MIL","computedId":"hKhhQE","columnLength":2},{"id":"ojFDrF","type":"computed","alias":"FORECAST_MIL","content":"CASE WHEN Indicador = 'Venda Mensal' then ROUND(SUM(FORECAST_VENDA)/1000,2) else 0 end","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_MIL","computedId":"xjPZJz","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO_MIL","content":"round(max(ORCADO)/1000,2)","dataType":"Nullable(Float64)","columnName":"ORCADO_MIL","computedId":"hKhhQE","columnLength":2},{"type":"computed","alias":"FORECAST_MIL","content":"CASE WHEN Indicador = 'Venda Mensal' then ROUND(SUM(FORECAST_VENDA)/1000,2) else 0 end","dataType":"Nullable(Float64)","columnName":"FORECAST_MIL","computedId":"xjPZJz","columnLength":2}]},"created":false,"optimize":false,"position":{"x":342.0070498292374,"y":495.99927935078887},"sourceId":null,"tableName":"tmp_validacao_valores","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_valicacao_valores_final","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"AsBJmk","type":"table","appId":137,"label":"tmp_valicacao_valores_final","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":481.0055145330923,"y":496.9992480182143},"sourceId":null,"tableName":"tmp_valicacao_valores_final","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OnlFJX","grid":{"h":50,"w":64,"x":0,"y":79,"hidden":false},"type":"report","appId":137,"label":"Explorer","client":"clickhouse","height":290,"layout":{"lg":{"h":50,"w":64,"x":0,"y":79,"height":290,"hidden":false},"md":{"h":50,"i":"2536OnlFJX","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"2536OnlFJX","w":64,"x":0,"y":1,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[{"id":"PWvPvQ","type":"value","alias":"Indicador","order":"desc","dataType":"Nullable(String)","fieldType":"","tableName":"tmp_valicacao_valores_final","columnName":"Indicador","localOrder":null,"filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"XJwKdS","type":"value","alias":"Segmento","order":"asc","dataType":"Nullable(String)","fieldType":"","tableName":"tmp_valicacao_valores_final","columnName":"Segmento","localOrder":null,"filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"}],"group":[],"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"select":[{"id":"qPAspu","type":"value","dataType":"Nullable(String)","fieldType":"","tableName":"tmp_valicacao_valores_final","columnName":"Indicador","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"dETBfq","type":"value","dataType":"Nullable(String)","fieldType":"","tableName":"tmp_valicacao_valores_final","columnName":"Segmento","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"HgrVVw","type":"sum","alias":"sum_REAL_MIL","title":"Real","dataType":"Nullable(Float64)","fieldType":"","tableName":"tmp_valicacao_valores_final","textAlign":"right","columnName":"REAL_MIL","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="},{"id":"ZIrPeY","type":"sum","alias":"sum_ORCADO_MIL","title":"Orçado","dataType":"Nullable(Float64)","fieldType":"","tableName":"tmp_valicacao_valores_final","textAlign":"right","columnName":"ORCADO_MIL","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="},{"id":"MDZySr","type":"sum","alias":"sum_FORECAST_MIL","title":"Forecast","dataType":"Nullable(Float64)","fieldType":"","tableName":"tmp_valicacao_valores_final","textAlign":"right","columnName":"FORECAST_MIL","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="}],"limitBy":[]},"shared":false,"created":false,"position":{"x":600.004605888435,"y":497.9992166856399},"settings":{"type":"column","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardType":"basic","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":false,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"clean","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"tmp_valicacao_valores_final","tableView":false,"temporary":false,"reportType":"table","sourceType":"bucket","databaseName":"bucket_137"},{"id":"desAbG","type":"reportPreview","label":"Preview","position":{"x":697.0043865604143,"y":497.9992166856399},"reportId":"OnlFJX","reportType":"table"}],"edges":[{"id":"dfFXLQ","source":"FvbqSj","target":"wTSgSM"},{"id":"lTvRKu","source":"BIZUor","target":"wTSgSM"},{"id":"RjKZQv","source":"pLCJgY","target":"rRUVLG"},{"id":"YGezoQ","source":"nxXnAl","target":"aNFDsA"},{"id":"bRGHga","source":"rRUVLG","target":"aNFDsA"},{"id":"DBRdbV","source":"aNFDsA","target":"EURecf"},{"id":"rpIuAx","source":"EURecf","target":"nIbQjv"},{"id":"ADClHA","source":"nIbQjv","target":"idLFqx"},{"id":"HMHQlv","source":"OBSYrg","target":"wTSgSM"},{"id":"gqElXb","source":"wTSgSM","target":"AsBJmk"},{"id":"roERUY","source":"DCdvER","target":"BhqzeO"},{"id":"AnLNVa","source":"BhqzeO","target":"BIZUor"},{"id":"tzqZCj","source":"AsBJmk","target":"OnlFJX"},{"id":"iMOoba","source":"OnlFJX","target":"desAbG"}]},"cron":"5,10,15,20,25,30,35,40,45,50,55,0 * * * *","options":{"folder":"VALIDAÇÃO","reload":0,"cronBase":{"every":2,"current":"5,10,15,20,25,30,35,40,45,50,55,0 * * * *","dayValues":[],"hourValues":[],"monthValues":[],"minuteValues":[5,10,15,20,25,30,35,40,45,50,55,0],"dayOfMonthValues":[]},"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"E_qsWdnvcSmpCXHNLivTCpBcPyPhxpcY","flowDescription":"Dashboard interno de validação de carga","locked":"no","created":"2023-04-26 08:48:15","updated":"2023-09-08 09:08:23"},{"flowId":"2647","appId":137,"flowName":"DASHBOARD INTERNO - Acessos Portal","workflow":{"nodes":[{"id":"HkKUSY","type":"table","appId":137,"label":"base_log_acesso","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":64.0047312187327,"y":137.9980573803879},"sourceId":null,"tableName":"base_log_acesso","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"XPXASN","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"xNUQJx","type":"computed","alias":"Data","content":"toDate(HoraAcesso)","dataType":"Nullable(Date)","columnName":"Data","computedId":"sMcTLA"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"KvuUBe","type":"computed","alias":"Data","content":"toDate(HoraAcesso)","dataType":"Nullable(Date)","distinct":false,"columnName":"Data","computedId":"sMcTLA"},{"id":"UWuwfv","type":"countDistinct","alias":"UsuarioDistinto","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_log_acesso","columnName":"IDUsuario","columnLength":null,"databaseName":"bucket_137"},{"id":"FHgVhb","type":"count","alias":"Acessos","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_log_acesso","columnName":"IDUsuario","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Data","content":"toDate(HoraAcesso)","dataType":"Nullable(Date)","columnName":"Data","computedId":"sMcTLA"}]},"created":false,"optimize":false,"position":{"x":145.0050132119022,"y":-53.99592676532944},"sourceId":null,"tableName":"base_log_acesso","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_acesso_data","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pEEcAP","type":"table","appId":137,"label":"tmp_acesso_data","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":237.00495054675343,"y":-54.99589543275506},"sourceId":null,"tableName":"tmp_acesso_data","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"tMhgAE","grid":{"h":49,"w":64,"x":0,"y":0,"hidden":false},"type":"report","appId":137,"label":"Diária","moved":false,"width":1892,"client":"clickhouse","height":289,"layout":{"lg":{"h":49,"w":64,"x":0,"y":0,"height":289,"hidden":false},"md":{"h":50,"i":"2647tMhgAE","w":64,"x":0,"y":4,"height":290,"hidden":false},"sm":{"h":50,"i":"2647tMhgAE","w":64,"x":0,"y":4,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[{"id":"HBKAJC","type":"value","order":"asc","dataType":"Nullable(Date)","fieldType":"","tableName":"tmp_acesso_data","columnName":"Data","columnLength":null,"databaseName":"bucket_137"}],"group":[],"limit":50,"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"","operator":"="}],"select":[{"id":"HBKAJC","type":"value","dataType":"Nullable(Date)","fieldType":"","tableName":"tmp_acesso_data","columnName":"Data","columnLength":null,"databaseName":"bucket_137"},{"id":"tmFwav","type":"max","alias":"max_UsuarioDistinto","title":"Usuários Distintos","dataType":"Nullable(Int64)","fieldType":"","showTotal":false,"tableName":"tmp_acesso_data","textAlign":"right","columnName":"UsuarioDistinto","columnLength":null,"databaseName":"bucket_137"},{"id":"CKQHIP","type":"max","alias":"max_Acessos","title":"Acessos","dataType":"Nullable(Int64)","fieldType":"","showTotal":false,"tableName":"tmp_acesso_data","textAlign":"right","columnName":"Acessos","columnLength":null,"databaseName":"bucket_137"}],"limitBy":[]},"shared":false,"created":false,"position":{"x":348.9986213667269,"y":-52.995958097903824},"settings":{"type":"column","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardType":"basic","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":true,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"card","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"tmp_acesso_data","tableView":false,"temporary":false,"reportType":"chart","sourceType":"bucket","databaseName":"bucket_137"},{"id":"lNecfy","type":"reportPreview","label":"Preview","created":false,"position":{"x":458.99799471523914,"y":-50.99602076305261},"reportId":"tMhgAE","reportType":"column"},{"id":"UhFCJt","grid":{"h":41,"w":64,"x":0,"y":103,"hidden":false},"type":"report","appId":137,"forms":[],"label":"Log","width":1858,"client":"clickhouse","height":241,"layout":{"lg":{"h":41,"w":64,"x":0,"y":103,"height":241,"hidden":false},"md":{"h":50,"i":"2647UhFCJt","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"2647UhFCJt","w":64,"x":0,"y":1,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[],"group":[],"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"","operator":"="}],"select":[{"id":"HSlkdV","type":"value","alias":"IDUsuario","combo":"first","dataType":"Nullable(Int64)","showTotal":false,"tableName":"base_log_acesso","textAlign":"right","columnName":"IDUsuario","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"="},{"id":"FkIWOO","type":"value","combo":"first","dataType":"Nullable(String)","tableName":"base_log_acesso","columnName":"Nome","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"like"},{"id":"EqHFuH","type":"value","combo":"first","dataType":"Nullable(String)","tableName":"base_log_acesso","columnName":"Email","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"like"},{"id":"sZBiGb","type":"value","combo":"first","dataType":"Nullable(DateTime)","tableName":"base_log_acesso","columnName":"HoraAcesso","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"="}],"limitBy":[]},"shared":false,"created":false,"position":{"x":154.0047312187327,"y":137.9980573803879},"settings":{"type":"column","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardType":"basic","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":true,"showLegend":false,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"clean","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"base_log_acesso","tableView":false,"temporary":false,"reportType":"table","sourceType":"bucket","databaseName":"bucket_137"},{"id":"HPecMJ","type":"reportPreview","label":"Preview","created":false,"position":{"x":244.0047312187327,"y":137.9980573803879},"reportId":"UhFCJt","reportType":"table"},{"id":"sXaLMF","grid":{"h":53,"w":31,"x":0,"y":50,"hidden":false},"type":"report","appId":137,"label":"Acessos por Usuário","moved":false,"width":914,"client":"clickhouse","height":313,"layout":{"lg":{"h":53,"w":31,"x":0,"y":50,"height":313,"hidden":false},"md":{"h":50,"i":"2647sXaLMF","w":64,"x":0,"y":2,"height":290,"hidden":false},"sm":{"h":50,"i":"2647sXaLMF","w":64,"x":0,"y":2,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[{"id":"xWjDnD","type":"value","order":"asc","dataType":"Nullable(String)","fieldType":"","tableName":"base_log_acesso","columnName":"Nome","columnLength":null,"databaseName":"bucket_137"}],"group":[],"limit":50,"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"","operator":"="}],"select":[{"id":"xWjDnD","type":"value","dataType":"Nullable(String)","fieldType":"","tableName":"base_log_acesso","columnName":"Nome","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"like"},{"id":"wlJPHX","type":"count","alias":"count_IDUsuario","title":"Acessos","dataType":"Nullable(Int64)","fieldType":"","tableName":"base_log_acesso","textAlign":"right","columnName":"IDUsuario","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"="}],"limitBy":[]},"shared":false,"created":false,"position":{"x":148.004919214179,"y":220.99545677671367},"settings":{"type":"table","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardType":"basic","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":false,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"card","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"base_log_acesso","tableView":false,"temporary":false,"reportType":"table","sourceType":"bucket","databaseName":"bucket_137"},{"id":"wmoGgY","type":"reportPreview","label":"Preview","created":false,"position":{"x":244.0047312187327,"y":220.9954567767136},"reportId":"sXaLMF","reportType":"table"},{"id":"KlYBlV","grid":{"h":53,"w":33,"x":31,"y":50,"hidden":false},"type":"report","appId":137,"label":"Visão por Hora","moved":false,"width":974,"client":"clickhouse","height":313,"layout":{"lg":{"h":53,"w":33,"x":31,"y":50,"height":313,"hidden":false},"md":{"h":50,"i":"2647KlYBlV","w":64,"x":0,"y":3,"height":290,"hidden":false},"sm":{"h":50,"i":"2647KlYBlV","w":64,"x":0,"y":3,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":50,"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"select":[{"id":"GHYUaS","type":"value","alias":"Hora","global":false,"content":"toHour(HoraAcesso)","dataType":"Nullable(Int64)","distinct":false,"fieldType":"","tableName":"base_log_acesso","columnName":"Hora","computedId":"PNMzeS"},{"id":"weYKvS","type":"countDistinct","alias":"countDistinct_IDUsuario","title":"Usuários Únicos","hidden":false,"dataType":"Nullable(Int64)","fieldType":"","showTotal":false,"tableName":"base_log_acesso","textAlign":"right","columnName":"IDUsuario","columnLength":null,"databaseName":"bucket_137"},{"id":"PxHDGx","type":"count","alias":"count_IDUsuario","title":"Acessos","dataType":"Nullable(Int64)","fieldType":"","tableName":"base_log_acesso","textAlign":"right","columnName":"IDUsuario","columnLength":null,"databaseName":"bucket_137"}],"limitBy":[],"computed":[{"id":"GHYUaS","type":"value","alias":"Hora","global":false,"content":"toHour(HoraAcesso)","dataType":"Nullable(Int64)","distinct":false,"columnName":"Hora","computedId":"PNMzeS"}]},"shared":false,"created":false,"position":{"x":149.00488788160467,"y":47.00090864465727},"settings":{"type":"line","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"Acessos Por Hora","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardType":"basic","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":true,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"card","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"base_log_acesso","tableView":false,"temporary":false,"reportType":"chart","sourceType":"bucket","databaseName":"bucket_137"},{"id":"ptAiSW","type":"reportPreview","label":"Preview","created":false,"position":{"x":244.00473121873273,"y":47.00090864465727},"reportId":"KlYBlV","reportType":"line"}],"edges":[{"id":"oogXsj","source":"HkKUSY","target":"XPXASN"},{"id":"SPjGnw","source":"XPXASN","target":"pEEcAP"},{"id":"zaLqVE","source":"HkKUSY","target":"UhFCJt"},{"id":"oohIJY","source":"UhFCJt","target":"HPecMJ"},{"id":"vBoEfl","source":"HkKUSY","target":"sXaLMF"},{"id":"pJaECZ","source":"sXaLMF","target":"wmoGgY"},{"id":"pRAyrp","source":"pEEcAP","target":"tMhgAE"},{"id":"yLVJlG","source":"tMhgAE","target":"lNecfy"},{"id":"hFCCCu","source":"HkKUSY","target":"KlYBlV"},{"id":"STFFAF","source":"KlYBlV","target":"ptAiSW"}]},"cron":null,"options":{"folder":"VALIDAÇÃO","reload":1,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"jPRdxcdmwvapRqOKqVE_zsMFelLRjMuy","flowDescription":"","locked":"no","created":"2023-05-10 10:53:58","updated":"2023-09-08 09:08:23"},{"flowId":"2043","appId":137,"flowName":"CARGA - Carrega Orçado","workflow":{"nodes":[{"id":"wsOGPi","type":"fileImport","appId":137,"label":"20230913_14_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"elXQnI","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"dPMApP","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"sgZbMj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"qdVFPu","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"yzyQab","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"pqDtny","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"IBOLcZ","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"cgBoRb","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230913_14_30_orcado.csv","position":{"x":319.02813665180105,"y":646.0021619476329},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"nGgJwA","type":"fileImport","appId":137,"label":"20230828_16_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"hQfnQJ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"ZMfBys","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"DzBSxy","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"qvXWns","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"gCFypm","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"wUliWS","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"sdKhGp","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"UtMwCu","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230828_16_30_orcado.csv","position":{"x":96.62511874109624,"y":551.8864309036545},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"znizGv","type":"fileImport","appId":137,"label":"20230807_10_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"LMQXIn","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"bwvkva","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"KXqBpm","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"hLeXqS","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"fVyvIo","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"iHnkto","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"shegwC","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"YgPpLJ","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230807_10_30_orcado.csv","position":{"x":-13.97769120703515,"y":376.00379124150106},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"dXRigq","type":"fileImport","appId":137,"label":"20230725_09_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"lGVLnU","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"mstmqB","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"MpSnsC","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"PkqqIw","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"IwOIdl","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"BDvePm","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"XhuyZy","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"lRDrXt","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230725_09_30_orcado.csv","position":{"x":-364.71487067310335,"y":360.0212410369349},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"vPhcNz","type":"fileImport","appId":137,"label":"20230710_09_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"UEEdvV","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"xhZtPT","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"XZkrZY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"dWHBoR","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"rppPoN","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"NfmbXG","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"yUtjdu","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"ImvgeA","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230710_09_30_orcado.csv","position":{"x":-784.7013976661163,"y":312.0202697271288},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"NgCEnY","type":"fileImport","appId":137,"label":"20230630_15_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"NYqLZc","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"PxzIgg","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"IrJcyu","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"TwXEfI","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"aRKyEg","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"MLgccv","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"ogRyNR","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"czpEsV","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":2,"alternativeName":"orcado"}],"created":false,"fileName":"20230630_15_30_orcado.csv","position":{"x":-917.6878933265548,"y":246.02534560417996},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"TiJBJB","type":"table","appId":137,"label":"tmp_validacao_orcado_2","client":"clickhouse","repoId":1,"created":false,"position":{"x":879.0048252164557,"y":524.0032585877364},"tableName":"tmp_validacao_orcado_2","sourceType":"bucket","databaseName":"bucket_137"},{"id":"EwhAsH","type":"table","appId":137,"label":"bkp_orcado_20230613","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":797.4406526370116,"y":-92.8838381921989},"tableName":"bkp_orcado_20230613","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qVaxyY","type":"table","appId":137,"label":"perfomance_segmento_orcado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":76.99466671860968,"y":89.99786668744379},"sourceId":null,"tableName":"perfomance_segmento_orcado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cxYsQZ","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"perfomance_segmento_orcado","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"mes_ref"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_orcado","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"metrica"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_orcado","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"segmento"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_orcado","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"hierarquia_nivel_1"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_orcado","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"hierarquia_nivel_2"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_orcado","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"hieraraquia_nivel_3"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_orcado","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"linha_de_negocio_produto"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_orcado","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":208.99670643013343,"y":91.99996866742556},"sourceId":null,"tableName":"perfomance_segmento_orcado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_validacao_orcado","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"PSiUfJ","type":"fileImport","appId":137,"label":"orcado_diario_ponderacao_2023.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"oAtZCd","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"data","alternativeName":"data"},{"id":"qntemA","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"indice_mes","columnLength":2,"alternativeName":"indice_mes"}],"created":false,"fileName":"orcado_diario_ponderacao_2023.csv","position":{"x":-38.487988262621286,"y":-93.41995430527248},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_orcado_dia","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"pVhlCm","type":"table","appId":137,"label":"tmp_orcado_dia","client":"clickhouse","repoId":1,"created":false,"position":{"x":162.45528955462737,"y":-92.12589972799134},"tableName":"tmp_orcado_dia","sourceType":"bucket","databaseName":"bucket_137"},{"id":"TKjlwW","type":"fileImport","appId":137,"label":"20230719_09_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"xbdMVQ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"fbHwvq","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"VLEgYI","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"AMobxe","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"sPtYSy","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"HhZdRI","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"EUovGV","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"QhIIZf","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230719_09_30_orcado.csv","position":{"x":-585.7094188051598,"y":350.0200503991082},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"BQoeFO","type":"fileImport","appId":137,"label":"20230731_15_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"AHLWox","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"LRdSah","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"gcWOOv","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"GvvsPO","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"ZtdZhF","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"iVyAiG","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"MRQXcD","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"hhhFeh","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230731_15_30_orcado.csv","position":{"x":-150.71743994420322,"y":369.0198624036618},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"FOSETO","type":"fileImport","appId":137,"label":"20230809_11_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"hlCrYP","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"YBCqfK","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"EGGAPy","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"egPlIp","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"AWihND","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"PHCZvM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"hGPsFp","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"okeheI","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230809_11_30_orcado.csv","position":{"x":57.02428274515091,"y":471.0030392597157},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"qfoKNh","type":"fileImport","appId":137,"label":"20230912_09_30_orcado.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"VqdBrl","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"iFwZQI","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"EgfwoD","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"DXUYLd","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"wcHKrA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"PlwDwo","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"VwREiF","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"fLUmXH","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":4,"alternativeName":"orcado"}],"created":false,"fileName":"20230912_09_30_orcado.csv","position":{"x":142.51943522157703,"y":645.3284593051076},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tmp_validacao_orcado","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"SyfERm","type":"table","appId":137,"label":"tmp_validacao_orcado","client":"clickhouse","repoId":1,"created":false,"position":{"x":322.44989574645615,"y":294.1040361015127},"tableName":"tmp_validacao_orcado","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eyqMbz","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"YJZecv","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_orcado","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"gYdEOi","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_orcado","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"vSvTRC","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_orcado","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137"},{"id":"asXdti","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_orcado","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137"},{"id":"csVbhn","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_orcado","columnName":"hieraraquia_nivel_3","columnLength":null,"databaseName":"bucket_137"},{"id":"RNVAVJ","type":"value","dataType":"Nullable(String)","tableName":"tmp_validacao_orcado","columnName":"linha_de_negocio_produto","columnLength":null,"databaseName":"bucket_137"},{"id":"Qtiwdl","type":"value","dataType":"Nullable(Date)","tableName":"tmp_validacao_orcado","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"ipUyWV","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_validacao_orcado","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"orcado_tratado","content":"orcado","dataType":"Nullable(Float64)","columnName":"orcado_tratado","computedId":"PzVJEO","columnLength":2}]},"created":false,"position":{"x":453.66927648040166,"y":293.56871946860434},"tableName":"tmp_validacao_orcado","sourceType":"bucket","resultTable":"base_orcado_raw","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"bBMpCb","type":"table","appId":137,"label":"base_orcado_raw","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":457.5072491166385,"y":73.29941908371514},"tableName":"base_orcado_raw","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"HfhTDe","source":"cxYsQZ","target":"SyfERm"},{"id":"RRlNxf","source":"qVaxyY","target":"cxYsQZ"},{"id":"nbJvRl","source":"TKjlwW","target":"SyfERm"},{"id":"hTgzFe","source":"NgCEnY","target":"SyfERm"},{"id":"sMyjUm","source":"vPhcNz","target":"SyfERm"},{"id":"ntSAtU","source":"eyqMbz","target":"bBMpCb"},{"id":"gtqthA","source":"SyfERm","target":"eyqMbz"},{"id":"GrgmRb","source":"PSiUfJ","target":"pVhlCm"},{"id":"OzdyYB","source":"dXRigq","target":"SyfERm"},{"id":"dqKMrQ","source":"BQoeFO","target":"SyfERm"},{"id":"TBxfZV","source":"znizGv","target":"SyfERm"},{"id":"UOtlrg","source":"FOSETO","target":"SyfERm"},{"id":"cdkSEL","source":"nGgJwA","target":"SyfERm"},{"id":"STYRsk","source":"qfoKNh","target":"SyfERm"},{"id":"AEqefd","source":"wsOGPi","target":"SyfERm"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"WcDg_E_r_LuKLbMLzTuHyuhsKOOZVVg_","flowDescription":"Processo responsável pela carga dos dados orçados no Portal.","locked":"no","created":"2023-03-09 13:26:30","updated":"2023-09-13 13:20:37"},{"flowId":"2676","appId":137,"flowName":"TesteNLP","workflow":{"nodes":[{"id":"eDRwtX","grid":{"h":62,"w":64,"x":0,"y":7,"hidden":true},"type":"report","appId":137,"label":"IAnalytics","limit":100,"width":1875,"height":367,"layout":{"lg":{"h":62,"w":64,"x":0,"y":7,"height":367,"hidden":true},"md":{"h":50,"i":"2676gRoQBT","w":64,"x":0,"y":2,"height":290,"hidden":false},"sm":{"h":50,"i":"2676gRoQBT","w":64,"x":0,"y":2,"height":290,"hidden":false}},"tables":["tmp_resultado_gpt"],"content":" ","created":false,"project":{"html":"<!DOCTYPE html>\n<head>\n    <script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n    <meta charset=\"UTF-8\">\n    <title>Chatgpt</title>\n</head>\n\n<body>\n\n    <h2>Uso IAnalytics</h2>\n\n    <!-- Início do formulário-->\n    <form id=\"form-pergunta-chat\">\n\n        <!-- Campo do tipo textarea para o usuário digitar o texto da pergunta-->\n        <label>Pergunta: </label>\n        <textarea id=\"campo-pergunta\" rows=\"5\" cols=\"50\" placeholder=\"Digite a pergunta\"></textarea><br><br>\n\n        <input type=\"submit\" id=\"btn-pergunta-chat\" value=\"Enviar\"><br><br>\n    </form>\n    <!-- Fim do formulário-->\n\n    <!-- Receber o texto da pergunta -->\n    <p id=\"pergunta\"></p>\n\n    <!-- Receber o texto da resposta -->\n    <p id=\"query\"></p>\n    <p id=\"resposta\"></p>\n\n    <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\n</body>\n\n</html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"","script":"// Receber o SELECTOR do formulário\nlet query;\nlet query_string;\nlet pergunta_fato;\nlet resultado;\nconst formPerguntaChat = document.getElementById('form-pergunta-chat');\n// Chave da API do OPENAI\nconst OPENAI_API_KEY = \"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\";\n\n\n// Aguardar o usuário clicar no botão Enviar\nformPerguntaChat.addEventListener(\"submit\", async (e) => {\n\n    // Bloquear o recarregamento da página\n    await e.preventDefault();\n\n    // Substituir o texto do botão para \"Pesquisando...\"\n    document.getElementById('btn-pergunta-chat').value = \"Pesquisando...\";\n\n    // Receber o valor do campo pergunta\n    let prefixo_pergunta = 'Prompt GPT Você é um DBA do banco Clickhouse de uma empresa de telecomunicações e será perguntado por uma informação e deve retornar um consulta que traga apenas 1 linha e 1 coluna de resultado Baseado apenas em uma tabela para a criação dessa consulta, utilize o seguinte esquema de tabela: Nome da tabela: bucket_137.BASE_GPT Estrutura de colunas INDICADOR - Coluna que descreve o indicador a ser análisado (Tipo de Dado: Texto, Valores: Perda de Receita Mensal, Base de Clientes Mensal, Venda Mensal) SEGMENTO - coluna que descreve o segmento da empresa a ser analisado(Tipo de Dado: Texto, Valores: CORPORATIVO, EMPRESARIAL, OPERADORAS, RESIDENCIAL) ANO_MES - coluna com ano e mês no formato YYYYMM para controle de data, não utilize formato YYYY-MM por exemplo, e sim algo como 202304 (Tipo de Dado: Texto) REAL - coluna com valores do realizado para determinado indicador (Tipo de Dado: Real) ORCADO - coluna com valores orçados/metas para determinado indicador (Tipo de Dado: Real) Para segmento, se perguntado sobre o segmento atente-se para apelidos que o cliente pode chamar esse segmento, por exemplo, EMPRESARIAL PODE SER CHAMADO DE MPE, OPERADORAS PODE SER CHAMADO DE ATACADO E RESIDENCIAL PODE SER CHAMADO DE VAREJO, PORÉM APENAS AS PRIMEIRAS VARIAÇÕES DEVEM SER USADAS NA CONSULTA SEMPRE É NECESSÁRIO FILTRAR UM INDICADOR NÃO UTILIZE OS OPERADORES > E < APENAS = OU IN sempre usar soma para trazer o resultado da consulta SEGUE O PEDIDO DO CLIENTE: ';\n    pergunta_fato = document.getElementById('campo-pergunta').value;\n    let pergunta = prefixo_pergunta + pergunta_fato;\n\n    // Enviar o texto da pergunta para a página HTML\n    document.getElementById('pergunta').innerHTML = pergunta_fato;\n\n    // Limpar a resposta\n    document.getElementById('resposta').innerHTML = \"<span></span>\";\n\n    // Requisição para chatgpt\n    await fetch(\"https://api.openai.com/v1/completions\", {\n\n        // Método para enviar os dados\n        method: \"POST\",\n\n        // Dados ennviados no cabeçalho da requisição\n        headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Bearer \" + OPENAI_API_KEY,\n        },\n\n        // Enviar os dados no corpo da requisição\n        body: JSON.stringify({\n            model: \"text-davinci-003\", //Modelo\n            prompt: pergunta, // Texto da pergunta\n            max_tokens: 150, // Tamanho da resposta\n            temperature: 0.5 // Criatividade na resposta\n        }),\n    })\n    // Acessa o then quando obtiver resposta\n    .then((resposta) => resposta.json())\n    .then((dados) => {\n        // Enviar o texto da resposta para a página HTML\n        query_raw = dados.choices[0].text.replace(';', '');\n        query = query_raw.slice(query_raw.indexOf('SELECT'));\n\n        // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\n\n        /*sleep(3000);\n        dispatchEvent({\n            formFlowId: 2677, formType: 'loadFlow', formReload: true,\n            params: [ {\n                paramName: 'prm_query', paramValue: [query]},\n                {\n                    paramName: 'prm_pergunta_nlp', paramValue: [pergunta_fato]}]});*/\n    })\n    // Retorna catch quando gerar erro\n    .catch(() => {\n        // Enviar o texto da resposta para a página HTML\n        document.getElementById('resposta').innerHTML = \"Sem resposta\";\n    });\n    //await console.log('Consulta= ' + query)\n    // Criar forma de executar a consulta no gaio e retornar o valor\n    \n    \n   \n    document.getElementById('query').innerHTML = query;\n    //TIRA ASPAS SIMPLES E COLOCA A PALAVRA ASPAS\n    var a = query;\n    var b = a.replace(/'/g, 'ASPAS');\n    query_string = b;\n    \n    await Enviar_Gaio();\n    await sleep(5000);\n    resultado = obterResultado(pergunta_fato);\n    \n    \n    // Substituir o texto do botão para \"Enviar\"\n    document.getElementById('btn-pergunta-chat').value = \"Enviar\";\n\n});\n\n\nasync function Enviar_Gaio() {\n    // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\n    await dispatchEvent({\n        formFlowId: 2677, formType: 'loadFlow', formReload: false,\n        params: [ {\n            paramName: 'prm_query', paramValue: [query]},\n            {\n            paramName: 'prm_query_string', paramValue: [query_string]},\n            {\n                paramName: 'prm_pergunta_nlp', paramValue: [pergunta_fato]}]});\n};\n\nasync function obterResultado(pergunta_fato) {\n    // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\n    await fetch('http://10.51.130.226/api/rest/RuHrcWvrxgQxwYEADNCNiulHHoWSRyLM/tmp_resultado_gpt/')\n    .then((resposta2) => resposta2.json())\n    .then((dados2) => {\n        resultado = dados2[0].RESULT;\n        console.log(resultado);\n    });\n    console.log(resultado);\n    await nlp(pergunta_fato, resultado);\n};\n\nasync function nlp(pgt, rsp) {\n    let resp_fake = 'R$ 2.466 mil';\n    pergunta = \"Haja como um bot respondendo um executivo de uma empresa, a pergunta é a seguinte: \" + pgt + \". A resposta para essa pergunta é: \" + resp_fake + \", crie uma resposta simples e clara em linguagem natural.\";\n    console.log(pergunta);\n    // Requisição para chatgpt\n    await fetch(\"https://api.openai.com/v1/completions\", {\n        method: \"POST\",\n\n        // Dados ennviados no cabeçalho da requisição\n        headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Bearer \" + OPENAI_API_KEY,\n        },\n\n        // Enviar os dados no corpo da requisição\n        body: JSON.stringify({\n            model: \"text-davinci-003\", //Modelo\n            prompt: pergunta, // Texto da pergunta\n            max_tokens: 150, // Tamanho da resposta\n            temperature: 0.2 // Criatividade na resposta\n        }),\n    })\n    // Acessa o then quando obtiver resposta\n    .then((resposta) => resposta.json())\n    .then((dados) => {\n        let retorno = dados.choices[0].text;\n        console.log(retorno);\n        // Criar forma de executar a consulta no gaio e retornar o valor\n        document.getElementById('resposta').innerHTML = retorno.replace(resp_fake, rsp);\n        \n    })\n    // Retorna catch quando gerar erro\n    .catch(() => {\n        // Enviar o texto da resposta para a página HTML\n        document.getElementById('resposta').innerHTML = \"Sem resposta\";\n    });\n};\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n};"},"noSpeech":true,"position":{"x":51.25084553680803,"y":122.41619116895652},"cardStyle":true,"reportType":"staticContent","assetsCoverWidth":true},{"id":"yVMkAS","grid":{"h":62,"w":64,"x":0,"y":7,"hidden":false},"type":"report","appId":137,"label":"DUP -IAnalytics","limit":100,"width":1875,"height":367,"layout":{"lg":{"h":62,"w":64,"x":0,"y":7,"height":367,"hidden":false},"md":{"h":50,"i":"2676gRoQBT","w":64,"x":0,"y":2,"height":290,"hidden":false},"sm":{"h":50,"i":"2676gRoQBT","w":64,"x":0,"y":2,"height":290,"hidden":false}},"tables":["tmp_resultado_gpt"],"content":" ","created":false,"project":{"html":"<!DOCTYPE html>\n<head>\n    <script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n    <meta charset=\"UTF-8\">\n    <title>Chatgpt</title>\n</head>\n\n<body>\n\n    <h2>Uso IAnalytics</h2>\n\n    <!-- Início do formulário-->\n    <form id=\"form-pergunta-chat\">\n\n        <!-- Campo do tipo textarea para o usuário digitar o texto da pergunta-->\n        <label>Pergunta: </label>\n        <textarea id=\"campo-pergunta\" rows=\"5\" cols=\"50\" placeholder=\"Digite a pergunta\"></textarea><br><br>\n\n        <input type=\"submit\" id=\"btn-pergunta-chat\" value=\"Enviar\"><br><br>\n    </form>\n    <!-- Fim do formulário-->\n\n    <!-- Receber o texto da pergunta -->\n    <p id=\"pergunta\"></p>\n\n    <!-- Receber o texto da resposta -->\n    <p id=\"query\"></p>\n    <p id=\"resposta\"></p>\n\n    <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\n</body>\n\n</html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"","script":"// Receber o SELECTOR do formulário\nlet query;\nlet query_string;\nlet pergunta_fato;\nlet resultado;\nconst formPerguntaChat = document.getElementById('form-pergunta-chat');\n// Chave da API do OPENAI\nconst OPENAI_API_KEY = \"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\";\n\n\n// Aguardar o usuário clicar no botão Enviar\nformPerguntaChat.addEventListener(\"submit\", async (e) => {\n\n    // Bloquear o recarregamento da página\n    await e.preventDefault();\n\n    // Substituir o texto do botão para \"Pesquisando...\"\n    document.getElementById('btn-pergunta-chat').value = \"Pesquisando...\";\n\n    // Receber o valor do campo pergunta\n    let prefixo_pergunta = 'Prompt GPT Você é um DBA do banco MySQL de uma empresa de telecomunicações e será perguntado por uma informação e deve retornar um consulta que traga apenas 1 linha e 1 coluna de resultado Baseado apenas em uma tabela para a criação dessa consulta, utilize o seguinte esquema de tabela: Nome da tabela: bucket_137.BASE_GPT Estrutura de colunas INDICADOR - Coluna que descreve o indicador a ser análisado (Tipo de Dado: Texto, Valores: Perda de Receita Mensal, Base de Clientes Mensal, Venda Mensal) SEGMENTO - coluna que descreve o segmento da empresa a ser analisado(Tipo de Dado: Texto, Valores: CORPORATIVO, EMPRESARIAL, OPERADORAS, RESIDENCIAL) ANO_MES - coluna com ano e mês no formato YYYYMM para controle de data, não utilize formato YYYY-MM por exemplo, e sim algo como 202304 (Tipo de Dado: Texto) REAL - coluna com valores do realizado para determinado indicador (Tipo de Dado: Real) ORCADO - coluna com valores orçados/metas para determinado indicador (Tipo de Dado: Real) Para segmento, se perguntado sobre o segmento atente-se para apelidos que o cliente pode chamar esse segmento, por exemplo, EMPRESARIAL PODE SER CHAMADO DE MPE, OPERADORAS PODE SER CHAMADO DE ATACADO E RESIDENCIAL PODE SER CHAMADO DE VAREJO, PORÉM APENAS AS PRIMEIRAS VARIAÇÕES DEVEM SER USADAS NA CONSULTA SEMPRE É NECESSÁRIO FILTRAR UM INDICADOR NÃO UTILIZE OS OPERADORES > E < APENAS = OU IN sempre usar soma para trazer o resultado da consulta SEGUE O PEDIDO DO CLIENTE: SEMPRE RETORNE O ANO QUE FOI UTILIZADO DE BASE NA RESPOSTA DE LINGUAGEM NATURAL';\n    pergunta_fato = document.getElementById('campo-pergunta').value;\n    let pergunta = prefixo_pergunta + pergunta_fato;\n\n    // Enviar o texto da pergunta para a página HTML\n    document.getElementById('pergunta').innerHTML = pergunta_fato;\n\n    // Limpar a resposta\n    document.getElementById('resposta').innerHTML = \"<span></span>\";\n\n    // Requisição para chatgpt\n    await fetch(\"https://api.openai.com/v1/completions\", {\n\n        // Método para enviar os dados\n        method: \"POST\",\n\n        // Dados ennviados no cabeçalho da requisição\n        headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Bearer \" + OPENAI_API_KEY,\n        },\n\n        // Enviar os dados no corpo da requisição\n        body: JSON.stringify({\n            model: \"text-davinci-003\", //Modelo\n            prompt: pergunta, // Texto da pergunta\n            max_tokens: 150, // Tamanho da resposta\n            temperature: 0.5 // Criatividade na resposta\n        }),\n    })\n    // Acessa o then quando obtiver resposta\n    .then((resposta) => resposta.json())\n    .then((dados) => {\n        // Enviar o texto da resposta para a página HTML\n        query_raw = dados.choices[0].text.replace(';', '');\n        query = query_raw.slice(query_raw.indexOf('SELECT'));\n\n        // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\n\n        /*sleep(3000);\n        dispatchEvent({\n            formFlowId: 2677, formType: 'loadFlow', formReload: true,\n            params: [ {\n                paramName: 'prm_query', paramValue: [query]},\n                {\n                    paramName: 'prm_pergunta_nlp', paramValue: [pergunta_fato]}]});*/\n    })\n    // Retorna catch quando gerar erro\n    .catch(() => {\n        // Enviar o texto da resposta para a página HTML\n        document.getElementById('resposta').innerHTML = \"Sem resposta\";\n    });\n    //await console.log('Consulta= ' + query)\n    // Criar forma de executar a consulta no gaio e retornar o valor\n    \n    \n   \n    document.getElementById('query').innerHTML = query;\n    //TIRA ASPAS SIMPLES E COLOCA A PALAVRA ASPAS\n    var a = query;\n    var b = a.replace(/'/g, 'ASPAS');\n    query_string = b;\n    \n    await Enviar_Gaio();\n    await sleep(5000);\n    resultado = obterResultado(pergunta_fato);\n    \n    \n    // Substituir o texto do botão para \"Enviar\"\n    document.getElementById('btn-pergunta-chat').value = \"Enviar\";\n\n});\n\n\nasync function Enviar_Gaio() {\n    // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\n    await dispatchEvent({\n        formFlowId: 2677, formType: 'loadFlow', formReload: false,\n        params: [ {\n            paramName: 'prm_query', paramValue: [query]},\n            {\n            paramName: 'prm_query_string', paramValue: [query_string]},\n            {\n                paramName: 'prm_pergunta_nlp', paramValue: [pergunta_fato]}]});\n};\n\nasync function obterResultado(pergunta_fato) {\n    // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\n    await fetch('https://gaio.algartelecom.com.br/api/rest/RuHrcWvrxgQxwYEADNCNiulHHoWSRyLM/tmp_resultado_gpt/')\n    .then((resposta2) => resposta2.json())\n    .then((dados2) => {\n        resultado = dados2[0].RESULT;\n        console.log(resultado);\n    });\n    console.log(resultado);\n    await nlp(pergunta_fato, resultado);\n};\n\nasync function nlp(pgt, rsp) {\n    let resp_fake = 'R$ 2.466 mil';\n    pergunta = \"Haja como um bot respondendo um executivo de uma empresa, a pergunta é a seguinte: \" + pgt + \". A resposta para essa pergunta é: \" + resp_fake + \", crie uma resposta simples e clara em linguagem natural.\";\n    console.log(pergunta);\n    // Requisição para chatgpt\n    await fetch(\"https://api.openai.com/v1/completions\", {\n        method: \"POST\",\n\n        // Dados ennviados no cabeçalho da requisição\n        headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Bearer \" + OPENAI_API_KEY,\n        },\n\n        // Enviar os dados no corpo da requisição\n        body: JSON.stringify({\n            model: \"text-davinci-003\", //Modelo\n            prompt: pergunta, // Texto da pergunta\n            max_tokens: 150, // Tamanho da resposta\n            temperature: 0.2 // Criatividade na resposta\n        }),\n    })\n    // Acessa o then quando obtiver resposta\n    .then((resposta) => resposta.json())\n    .then((dados) => {\n        let retorno = dados.choices[0].text;\n        console.log(retorno);\n        // Criar forma de executar a consulta no gaio e retornar o valor\n        document.getElementById('resposta').innerHTML = retorno.replace(resp_fake, rsp);\n        \n    })\n    // Retorna catch quando gerar erro\n    .catch(() => {\n        // Enviar o texto da resposta para a página HTML\n        document.getElementById('resposta').innerHTML = \"Sem resposta\";\n    });\n};\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n};"},"noSpeech":true,"position":{"x":205.26031815433456,"y":160.4171457738235},"cardStyle":true,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"folder":"IANALYTICS","reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"PnolorojtNNzqEubrbxDboWhNkhCCvmw","flowDescription":"","locked":"no","created":"2023-05-15 14:07:59","updated":"2023-09-08 09:08:23"},{"flowId":"2109","appId":137,"flowName":"ETL - Insights","workflow":{"nodes":[{"id":"cppKlb","type":"table","appId":137,"label":"TAXA_INSTALACAO_INSIGHT","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":834.9994046810866,"y":273.00448055813763},"sourceId":null,"tableName":"TAXA_INSTALACAO_INSIGHT","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gKetGs","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":440.0159345581649,"y":278.99757677226063},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wodmIZ","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":45.99317090364366,"y":27.98289054353731},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IqQslG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"JDeeqa","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"UPaonQ","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"lmIhUn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"cilMHM","type":"value","andOr":"and","value":"Mensal","dataType":"Nullable(String)","operator":"like","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"jALfsN","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"parameter","columnName":"DSC_LNH_NGC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"RTAmlZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"UPaonQ","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"lmIhUn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oWDdox","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"chave","content":"concat(TIP_MTC, DSC_LNH_NGC)","dataType":"Nullable(String)","columnName":"chave","computedId":"BjgWVC"}]},"created":false,"position":{"x":182.00044058686169,"y":29.999779706569115},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","sourceType":"bucket","resultTable":"tmp_aux_insights","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"faiuYZ","type":"table","appId":137,"label":"tmp_aux_insights","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":325.5,"y":33},"sourceId":7,"tableName":"tmp_aux_insights","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rMoObY","type":"table","appId":137,"label":"base_orcado_portal_sgm_pdt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":48.5148829728347,"y":221.99924801821447},"tableName":"base_orcado_portal_sgm_pdt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"foXqHV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"himGjT","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_sgm_pdt","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"BmJFIx","type":"value","dataType":"Nullable(Date)","tableName":"base_orcado_portal_sgm_pdt","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"YzcEFh","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_sgm_pdt","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"yQRpyj","type":"value","andOr":"and","value":"ProdutoBaseContrato","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"base_orcado_portal_sgm_pdt","valueType":"parameter","columnName":"produto","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"himGjT","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_sgm_pdt","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"BmJFIx","type":"value","dataType":"Nullable(Date)","tableName":"base_orcado_portal_sgm_pdt","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"YzcEFh","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_sgm_pdt","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"kfEVdH","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm_pdt","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":169.51391166302864,"y":221.9992480182144},"tableName":"base_orcado_portal_sgm_pdt","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_orcado_insight_produto","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"wwndMx","type":"table","appId":137,"label":"tmp_orcado_insight_produto","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":288.51300301837136,"y":222.99921668564016},"tableName":"tmp_orcado_insight_produto","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mZhSqP","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_aux_insights","id":"MwroOE","to":"tmp_orcado_insight_produto","raw":"","list":[{"id":"LfUJMy","andOr":"and","tableBy":"tmp_aux_insights","tableTo":"tmp_orcado_insight_produto","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"BlDigL","andOr":"and","tableBy":"tmp_aux_insights","tableTo":"tmp_orcado_insight_produto","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"WCQHoN","andOr":"and","tableBy":"tmp_aux_insights","tableTo":"tmp_orcado_insight_produto","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"IXuukG","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_insights","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"foIaCF","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_aux_insights","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"WIXYvI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_insights","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"cdkHXU","type":"computed","alias":"SEGMENTO_EXIBICAO","content":"case\r\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\r\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\r\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\r\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\r\n    when SEGMENTO = 'CONSOLIDADO' THEN 'Consolidado'\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_EXIBICAO","computedId":"fUeROj"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"dyKgsR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_insights","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"foIaCF","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_aux_insights","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"WIXYvI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_insights","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"NOwSYf","type":"computed","alias":"SEGMENTO_EXIBICAO","content":"case\r\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\r\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\r\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\r\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\r\n    when SEGMENTO = 'CONSOLIDADO' THEN 'Consolidado'\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_EXIBICAO","computedId":"fUeROj"},{"id":"rbGpnv","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_insights","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zWJgeX","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_orcado_insight_produto","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO_EXIBICAO","content":"case\r\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\r\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\r\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\r\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\r\n    when SEGMENTO = 'CONSOLIDADO' THEN 'Consolidado'\r\nEND","dataType":"Nullable(String)","columnName":"SEGMENTO_EXIBICAO","computedId":"fUeROj"}]},"created":false,"position":{"x":475,"y":91},"sourceId":7,"tableName":"tmp_aux_insights","sourceType":"bucket","resultTable":"tmp_api_insights_aux","bucketClient":"clickhouse","databaseName":"bucket_137","untilOperator":"=","untilParamName":"coluna_insight","untilParamValue":"1"},{"id":"QseMHa","type":"delete","appId":137,"label":"Delete","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"ZZjavM","type":"value","andOr":"and","value":"Forecast Vendas","dataType":"Nullable(String)","operator":"=","tableName":"tmp_api_insights_aux","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"xJzLWU","type":"value","andOr":"or","value":"Taxa Venda Mensal","dataType":"Nullable(String)","operator":"=","tableName":"tmp_api_insights_aux","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":627.0460413270479,"y":-34.002496658883004},"tableName":"tmp_api_insights_aux","databaseName":"bucket_137","clearMutation":true},{"id":"QZWYaj","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"forecast_insight","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"forecast_insight","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO_EXIBICAO"},{"dataType":"Nullable(Int64)","tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"forecast_insight","columnName":"orcado","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO"}]},"shared":false,"created":false,"position":{"x":578.0210013070742,"y":279.99706275425535},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_api_insights_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"ggVPYG","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO_EXIBICAO"},{"dataType":"Nullable(Int64)","tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO"}]},"shared":false,"created":false,"position":{"x":708.0062978474522,"y":274.0035719134804},"sourceId":null,"tableName":"TAXA_INSTALACAO_INSIGHT","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_api_insights_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"KGkNZg","type":"table","appId":137,"label":"tmp_api_insights_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":582.0012483294414,"y":93.00014686228724},"sourceId":7,"tableName":"tmp_api_insights_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ihAmPG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"yxLZRq","type":"value","andOr":"and","value":"PRM_TIP_MTC","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_api_insights_aux","valueType":"parameter","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"wyDxTN","type":"value","dataType":"Nullable(String)","tableName":"tmp_api_insights_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"fJUbBj","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_api_insights_aux","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"JNSRJR","type":"value","alias":"SEGMENTO","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_api_insights_aux","columnName":"SEGMENTO_EXIBICAO","columnLength":null,"databaseName":"bucket_137"},{"id":"DQoVbL","type":"computed","alias":"SEGMENTO_TRATADO","content":"case\r\n    when SEGMENTO_EXIBICAO IN ('Atacado','OPERADORAS') THEN 4\r\n    when SEGMENTO_EXIBICAO IN ('Corporativo','CORPORATIVO') THEN 1\r\n    when SEGMENTO_EXIBICAO IN ('MPE','EMPRESARIAL') THEN 2\r\n    when SEGMENTO_EXIBICAO IN ('Varejo','RESIDENCIAL') THEN 3\r\n    when SEGMENTO_EXIBICAO IN ('Consolidado','CONSOLIDADO') THEN 5\r\nEND\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_TRATADO","computedId":"FoVeCS"},{"id":"SWxnyu","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_api_insights_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"oawgYg","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_api_insights_aux","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"CoppIb","type":"computed","alias":"TIP_MTC_TRATADO","content":"case\r\n    when TIP_MTC IN ('Receita Liquida Mensal') THEN 1\r\n    when TIP_MTC IN ('Ebit Mensal') THEN 2\r\n    when TIP_MTC IN ('Ebitda Mensal') THEN 2\r\n    when TIP_MTC IN ('Margem Contribuição Mensal') THEN 2\r\n    else 0\r\n\r\nEND\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC_TRATADO","computedId":"eboiVT"}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO_TRATADO","content":"case\r\n    when SEGMENTO_EXIBICAO IN ('Atacado','OPERADORAS') THEN 4\r\n    when SEGMENTO_EXIBICAO IN ('Corporativo','CORPORATIVO') THEN 1\r\n    when SEGMENTO_EXIBICAO IN ('MPE','EMPRESARIAL') THEN 2\r\n    when SEGMENTO_EXIBICAO IN ('Varejo','RESIDENCIAL') THEN 3\r\n    when SEGMENTO_EXIBICAO IN ('Consolidado','CONSOLIDADO') THEN 5\r\nEND\r\n","dataType":"Nullable(String)","columnName":"SEGMENTO_TRATADO","computedId":"FoVeCS"},{"type":"computed","alias":"TIP_MTC_TRATADO","content":"case\r\n    when TIP_MTC IN ('Receita Liquida Mensal') THEN 1\r\n    when TIP_MTC IN ('Ebit Mensal') THEN 2\r\n    when TIP_MTC IN ('Ebitda Mensal') THEN 2\r\n    when TIP_MTC IN ('Margem Contribuição Mensal') THEN 2\r\n    else 0\r\n\r\nEND\r\n","dataType":"Nullable(String)","columnName":"TIP_MTC_TRATADO","computedId":"eboiVT"}]},"created":false,"optimize":false,"position":{"x":695.0029372457446,"y":95.00029372457448},"sourceId":7,"tableName":"tmp_api_insights_aux","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"api_insights","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"QmfpwN","type":"table","appId":137,"label":"api_insights","client":"clickhouse","repoId":1,"shared":false,"position":{"x":800.0040387128989,"y":95.0002937245745},"sourceId":7,"tableName":"api_insights","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TfwXSZ","type":"api","appId":137,"label":"API: api_insights","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":890.5133644681382,"y":93.00014686228724},"sourceId":7,"tableName":"api_insights","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137","paramReferences":[]}],"edges":[{"id":"jjsXrr","source":"mZhSqP","target":"KGkNZg"},{"id":"choEeH","source":"QseMHa","target":"KGkNZg"},{"id":"lgTode","source":"QmfpwN","target":"TfwXSZ"},{"id":"UNZEuv","source":"gKetGs","target":"QZWYaj"},{"id":"dvxmsM","source":"wodmIZ","target":"IqQslG"},{"id":"nasfDK","source":"IqQslG","target":"faiuYZ"},{"id":"BiIPxB","type":"manual","label":"","source":"QseMHa","target":"QZWYaj"},{"id":"OPqhsN","source":"QZWYaj","target":"KGkNZg"},{"id":"KHQDkM","type":"manual","label":"","source":"mZhSqP","target":"QseMHa"},{"id":"NpfjWL","source":"cppKlb","target":"ggVPYG"},{"id":"XMgSeO","source":"ggVPYG","target":"KGkNZg"},{"id":"UPBiuM","type":"manual","label":"","source":"QseMHa","target":"ggVPYG"},{"id":"CUQNXq","source":"rMoObY","target":"foXqHV"},{"id":"wDTLij","source":"foXqHV","target":"wwndMx"},{"id":"iFGmWb","source":"faiuYZ","target":"mZhSqP"},{"id":"BYnpNi","source":"wwndMx","target":"mZhSqP"},{"id":"QrqyNa","source":"KGkNZg","target":"ihAmPG"},{"id":"nBUDcQ","source":"ihAmPG","target":"QmfpwN"}]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"bGjcuXEJpwQOqWbzPnKigPoCvjOreROX","flowDescription":"","locked":"no","created":"2023-03-16 17:23:29","updated":"2023-09-08 09:08:23"},{"flowId":"2667","appId":137,"flowName":"INPUT FORECAST","workflow":{"nodes":[{"id":"Ssuceb","type":"report","appId":137,"label":"getCSV","limit":100,"tables":["max_row_id_input"],"content":" ","project":{"html":"<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css\" integrity=\"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-3.3.1.slim.min.js\" integrity=\"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js\" integrity=\"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js\" integrity=\"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM\" crossorigin=\"anonymous\"></script>\n    <link href=\"/api/content/read/22/bootstrap.min.css\" rel=\"stylesheet\">\n    <link href=\"/api/content/read/22/font_awesome.css\" rel=\"stylesheet\">\n    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'>\n    <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script>\n    <link href=\"/api/content/read/22/animate.css\" rel=\"stylesheet\">\n    <script type=\"text/javascript\" src=\"/api/content/read/118/simple_excel.js\"></script>\n    <style>\n        * {\n            font-family: Helvetica, Arial, sans-serif;\n            font-size: 12px;\n            margin: 10px\n        }\n        td {\n            border: 1px solid #000;\n            padding: 10px\n        }\n    </style>\n</head>\n<body>\n    <span id=\"menu1\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Voltar ao Health Check\"\n        style=\"cursor: pointer;\"><a><div class=\"a\">\n            <h2></h2>\n            <span id=\"menu\">Voltar - Portal Analytics</span>\n        </div>\n        </a></span>\n    <label>Load CSV file: </label><input type=\"file\" id=\"fileInputCSV\" /><br />\n\n\n<table id=\"result\"></table>\n<input type=\"button\" id=\"fileExport\" hidden=\"true\" />\n<p id=\"demo\"></p>\n<script type=\"text/javascript\">\n\nfunction sleep(ms) {\nreturn new Promise(resolve => setTimeout(resolve, ms));\n}\n\n// check browser support\n//console.log(SimpleExcel.isSupportedBrowser);\n\nvar csvRecords = Array(0);\nvar fileInputCSV = document.getElementById('fileInputCSV');\nvar fileInputXML = document.getElementById('fileInputXML');\n\n\n// when local file loaded\nfileInputCSV.addEventListener('change', function (e) {\n\n// parse as CSV\nvar file = e.target.files[0];\nvar csvParser = new SimpleExcel.Parser.CSV();\ncsvParser.setDelimiter(';');\ncsvParser.loadFile(file, function () {\n\n// draw HTML table based on sheet data\nvar sheet = csvParser.getSheet();\nvar table = document.getElementById('result');\ntable.innerHTML = \"\";\nsheet.forEach(function (el, i) {\nvar row = document.createElement('tr');\nel.forEach(function (el, i) {\nvar cell = document.createElement('td');\ncell.innerHTML = el.value;\nrow.appendChild(cell);\n});\ntable.appendChild(row);\n});\n\n// create button to export as TSV\nvar btnSave = document.getElementById('fileExport');\nbtnSave.hidden = false;\nbtnSave.value = 'Save as TSV file ->';\ndocument.body.appendChild(btnSave);\n\n// aparecer linhas cadastradas\n\n\n// export when button clicked\nbtnSave.addEventListener('click', async function (e) {\n\n// print to console just for quick testing\ncsvRecords = csvParser.getSheet(1);\n\nasync function* asyncLinhas() {\nlet i = 1;\nwhile (i < csvRecords.length) {\nyield i++;\n}\n}\n\nasync function* asyncColunas() {\nlet j = 0;\nwhile (j < csvRecords[1].length) {\nyield j++;\n}\n}\n\n//var novaTabela='CREATE TABLE if not exists bucket_115.healthcheck(row_id_input Int,';\nvar novaTabela = 'drop table if exists forecast_input; CREATE TABLE bucket_115.healthcheck (row_id_input Int,';\n\nfor await (const coluna_input of asyncColunas()) {\nif (coluna_input == (csvRecords[0].length-1)) {\nnovaTabela = novaTabela+csvRecords[0][coluna_input]+' String';\n} else {\nnovaTabela = novaTabela+csvRecords[0][coluna_input]+' String,';\n}\n}\n\nnovaTabela = novaTabela+') ENGINE MergeTree ORDER BY tuple();';\n\nawait dispatchEvent({\nformFlowId: 2670, formType: 'loadFlow', params: [{\nparamName: 'nova_tabela_input', paramValue: novaTabela\n}]\n});\n\nvar novos_dados_input = 'INSERT INTO forecast_input (row_id_input) VALUES ';\n\nfor await (const linha of asyncLinhas()) {\n\nvar num = parseInt(linha)+parseInt({{\nmax_row_id_input[0].max_row_id_input\n}});\n\nif (linha == (csvRecords.length-1)) {\nnovos_dados_input = novos_dados_input+'('+num+');';\n} else {\nnovos_dados_input = novos_dados_input+'('+num+'),';\n}\n}\n\nawait sleep(300);\nawait dispatchEvent({\nformFlowId: 2669, formType: 'loadFlow', params: [{\nparamName: 'novos_dados_input', paramValue: novos_dados_input\n}]\n});\n\n\n\nfor await (const linha of asyncLinhas()) {\nvar num = parseInt(linha)+parseInt({{\nmax_row_id_input[0].max_row_id_input\n}});\n\nfor await (const coluna_input of asyncColunas()) {\nawait sleep(100);\nawait dispatchEvent({\nformFlowId: 2668, formType: 'loadFlow',\nparams: [{\nparamName: 'coluna_input', paramValue: csvRecords[0][coluna_input].value\n},\n{\nparamName: 'valor_input', paramValue: csvRecords[linha][coluna_input].value\n},\n{\nparamName: 'row_id_input', paramValue: num\n}]\n});\n}\n// await console.log('Linha '+num+' cadastrada com sucesso!');\ndocument.getElementById(\"demo\").innerHTML = \"Linha:  \" + num + \" cadastrada com sucesso!\";\n//document.body.innerHTML = \"<p>Linha:  \" + num + \" cadastrada com sucesso!<p>\"\n\n\n}\n\nawait sleep(300);\n\nawait dispatchEvent({\nformFlowId: 1578, formType: 'loadFlow', params: [{\nparamName: 'row_id_input', paramValue: num\n}]\n});\n\n\n\n});\n\n});\n\n});\n\n$(\"#menu2\").click(function () {\ndispatchEvent(\n{\nformFlowId: 1642,\nformType: 'openFlow',\nparams: [{}]\n/*{ paramName: 'nome_parametro',\n                      paramValue: 'valor_input'}*/\n})\n});\n\n$(\"#menu1\").click(function () {\ndispatchEvent(\n{\nformFlowId: 1808,\nformType: 'openFlow',\nparams: [{}]\n/*{ paramName: 'nome_parametro',\n                      paramValue: 'valor_input'}*/\n})\n});\n\n\n\n</script>\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"","script":"/*\nUse the following code to access the data from the table\nReference: window.context = { params: {}, tableName1: [], tableName2: [] };\n\nExample of parameters: context.params.paramName;\nExample of tables: context.tableName\n*/"},"noSpeech":true,"cardStyle":true,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"folder":"DATA INPUT CSV","reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"DClZaSfUtEcWJAGWhmwwjmAN_SEVhQAy","flowDescription":"","locked":"no","created":"2023-05-15 09:41:34","updated":"2023-09-08 09:08:23"},{"flowId":"3105","appId":137,"flowName":"TesteGraficoCombinação","workflow":{"nodes":[{"id":"SRjxLB","grid":{"h":101,"w":64,"x":0,"y":5,"hidden":false},"type":"report","appId":137,"label":"GRAFICO COLUNAS EMPILHADAS","limit":100,"width":1321,"height":601,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_csl_dia","tmp_csl_mes","tmp_hrq_ata","tmp_hrq_crp","tmp_hrq_emp","tmp_hrq_vrj","tmp_sgm_ata_dia","tmp_sgm_ata_mes","tmp_sgm_crp_dia","tmp_sgm_crp_mes","tmp_sgm_emp_dia","tmp_sgm_emp_mes","tmp_sgm_vrj_dia","tmp_sgm_vrj_mes","tbl_vnd_forecast_best","forecast_atacado","tmp_crp_mix_pdt"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\n\n\n<style> \n\n #ponta { \n    width: 0;\n    height: 0; \n    border-top: 5px solid transparent;\n    border-left: 10px solid #a3a3a3;\n    border-bottom: 5px solid transparent;\n    margin-left: 500px;\n    display: inline-block;\n}\n#ponta2 { \n    width: 0;\n    height: 0; \n    border-top: 5px solid transparent;\n    border-right: 10px solid #a3a3a3;\n    border-bottom: 5px solid transparent;\n    margin-right: -5px;\n    display: inline-block;\n}\n#corpo { \n    width: 500px;\n    height: 2px;\n    background: #a3a3a3; \n    position: absolute; \n    margin-top: 8px;\n    margin-left: 0px;\n    display: inline-block;\n}\n#rnt {\n  display: inline-block;\n  font-size: 18px;\n  color: #a3a3a3;\n  font-style: italic;\n}\n#seta {\n  text-align: center;\n\n}\n#mais {\n  margin-left: 40px;\n  display: inline-block;\n  font-size: 35px;\n  font-weight: 800;\n  color:     #9ACD32;\n}\n\n \n\n#menos {\n  margin-right: 40px;\n  display: inline-block;\n  font-size: 35px;\n  font-weight: 800;\n  color: #EEDD82;\n}  \n                            \n\n\n\n\n</style>\n   \n   <meta charset=\"utf-8\">\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n   <title>Portal Analytics</title>\n</head>\n<body>\n    <div id=\"carregando\" style=\"display: none\"></div>\n   <div id=\"wrapper\">\n      <!-- Ínicio menu -->\n      \n         <!-- Ínicio Área Filtros -->\n\t\t \n         <div class=\"wrapper wrapper-content animated fadeInRight\">\n            <!-- Ínicio \"Seção 1\" -->\n            {% if params.prm_indicador == 'Ticket Medio' %}\n            \n            {% else %}\n            <div class=\"row\">\n               <!-- Ínicio \"Gráfico 1\" -->\n               <div class=\"col-lg-12\">\n                  <div class=\"ibox \">\n                     <div class=\"ibox-title\">\n                        <h5>\n                           {{params.prm_indicador}} ({{params.prm_escala_texto}})\n                           <span style=\"color: #D3D3D3\">\n                           {% if params.prm_indicador == 'Base de Clientes' %}\n                           * Para Base de 2022 não se aplica orçado / 2023 considera Revisão Orçamento\n                           {% elif params.prm_indicador == 'Venda' %}\n                           * 2023 considera Revisão Orçamento\n                           {% else %}\n                           * 2023 considera Revisão Orçamento\n                           {% endif %}\n                           </span>\n                         \n                           \n                           <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\n                               \n                              <span class=\"btn btn-white\" id=\"btn_view_mensal\" style=\"display:none\">Ver Mensal</span>\n                              <a class=\"btn btn-white\" id=\"btn_view_diaria\" style=\"display:block\"><span>Ver Diário</span></a>\n                           </div>\n                        </h5>\n                        <div class='filtrarMes' id=\"filtrarMescsl\">Filtrar Mês</div>\n                        <div class=\"labelDataRefDia\" id=\"labelDataRefDiacsl\">\n                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\n                        </div>\n                     </div>\n                     <div class=\"ibox-content\">\n                        <div id=\"grafMes\" style=\"display:block\">\n                           <div id=\"graficoConsolidadoMensal\"></div>\n                        </div>\n                        <div id=\"grafDia\" style=\"display:none\">\n                           <div id=\"graficoConsolidadoDiario\"></div>\n                        </div>\n                         <div id=\"grafMes\" style=\"display:block\">\n                           <div id=\"graficoColunaEmpilhadaMensal\"></div> \n                          <div id=\"seta\">\n                            <!-- Seta -->\n                            <div id=\"ponta2\"></div>\n                            <div id=\"corpo\"></div>\n                            <div id=\"ponta\"></div>\n                            <!-- Seta -->\n                            <br>\n                            <!-- Texto -->\n                            <div id=\"menos\">-</div>\n                            <div id=\"rnt\">Rentabilidade</div>\n                            <div id=\"mais\">+</div>\n                            <!-- Texto -->\n                            </div>\n                            \n                            \n                         \n                            \n                            \n                          \n                          \n                         </div>\n                        \n                     </div>\n                  </div>\n               </div>\n               <!-- Fim \"Gráfico 1\" -->\n              \n              \n              \n            </div>\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\n\n            {% endif %}\n            \n            <!-- Ínicio \"Seção 2\" -->\n\n            <!-- Fim \"Seção3\" -->\n         </div>\n      </div>\n      <!-- Fim conteúdo -->\n   </div>\n   <!-- Mainly scripts -->\n   \n   \n   \n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\n   <!-- Custom and plugin javascript -->\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\n   <script>\n\t\n     \n          // GRÁFICO EMPILHADO\n  \n      \n            var options_col_emp = {\n          \n          series: [ \n              \n         \n         {\n          name: 'TAXA INSTALAÇÃO',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_TX_INSTALACAO }},\n               {% endfor %}]\n        },     \n              \n              \n              \n         {\n          name: 'OUTROS',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_OUTROS }},\n               {% endfor %}]\n        },      \n        \n              \n       \n        {\n          name: 'DADOS',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_DADOS}},\n               {% endfor %}]\n          \n          \n        },\n        \n        \n        {\n          name: 'VOZ',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_VOZ }},\n               {% endfor %}]\n        }, \n         \n       \n              \n          \n             \n        {\n          name: 'TIC_TI',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_TIC_TI }},\n               {% endfor %}]\n        },     \n           \n           \n          {\n          name: 'IOT',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_IOT }},\n               {% endfor %}]\n        },   \n        \n        \n          {\n          name: 'TIC_DADOS',\n          data: [{% for item in tmp_crp_mix_pdt %}\n             {{ item.MIX_PRODUTOS_TIC_DADOS }},\n               {% endfor %}]\n        },\n        \n        \n        \n        ],\n          chart: {\n          type: 'bar',\n          height: 350,\n          width:1000,\n          stacked: true,\n          toolbar: {\n            show: false\n          },\n          zoom: {\n            enabled: true\n          }\n        },\n        responsive: [{\n          breakpoint: 480,\n          options: {\n            legend: {\n             position: 'bottom',\n              offsetX: -10,\n              offsetY: 0\n            }\n          }\n        }],\n        plotOptions: {\n          bar: {\n            horizontal: false,\n            borderRadius: 2,// contorno da barra\n            dataLabels: {\n              total: {\n                enabled: true,\n                style: {\n                  colors: ['#E91E63', '#E91E63','#E91E63'],\n                  fontSize: '9px',\n                  fontWeight: 700\n                }\n              }\n            }\n          },\n        },\n        xaxis: {\n            \n            \n          type: 'text',\n          categories: [{% for item in tmp_crp_mix_pdt %}\n                  '{{ item.DIA }}',\n                  {% endfor %}\n          ],\n          \n          \n          // Altera a linha do eixo X    \n                axisBorder: {\n                    show: true,\n                    color: '#000000',\n                    height: 1,\n                    width: '100%',\n                    offsetX: 0,\n                    offsetY: 0},\n          \n          // Altera a divisão da linha do eixo X  \n                axisTicks: {\n                    show: true,\n                    borderType: 'solid',\n                    color: '#000000',\n                    height: 6,\n                    offsetX: 0,\n                    offsetY: 0\n                },   \n          \n          \n        },\n        legend: {\n         show: true,\n         position: 'bottom',\n         horizontalAlign: 'center', \n         fontSize: '14px',\n         fontFamily: 'Helvetica, Arial',\n         fontWeight: 400,\n         markers: {\n            width: 12,\n            height: 10,\n            strokeWidth: 0,\n            strokeColor: '#fff',\n            fillColors: ['#c9c9c9','#aaaaaa','#e2ab05', '#fffa28' ,'#a8da10', '#3da70a', '#347b09'],\n            radius: 12,\n         },\n         itemMargin: {\n            horizontal: 5,\n            vertical: 0\n         },\n         onItemClick: {\n            toggleDataSeries: true\n         },\n         onItemHover: {\n            highlightDataSeries: true\n         },\n         }, \n         \n         \n        fill: {\n          colors: ['#c9c9c9','#aaaaaa','#e2ab05', '#fffa28' ,'#a8da10', '#3da70a', '#347b09'],\n          opacity: 1\n        },\n        \n        yaxis: [\n          {\n          \n            grid: {\n             show: false,\n             stokeDashArray: 0,\n         }, \n         \n         \n         labels: {\n             show: false,\n             formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           },\n         } \n         \n            \n          },\n        \n        ],\n        \n        dataLabels: {\n             \n         enabled:true,\n           style: {\n                  fontSize: '9px',\n                  fontWeight: 'bold',\n                  colors: ['black'],\n          },\n          \n           background: {\n              enabled: false,\n              foreColor: '#000',\n              borderRadius: 2,\n              padding: 4,\n              opacity: 0.9,\n              borderWidth: 1,\n              borderColor: '#fff'\n            },\n            \n            \n             offsetY: 0,// legenda centralida no grafico\n         formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           }\n           \n          \n           \n           \n          \n        },\n        \n        //remover o grid no grafico\n         grid: {\n      show: false,\n      axis: {\n        lines: {\n            show: false\n        }\n      },\n      yaxis: {\n        lines: {\n            show: false\n        }\n      }\n      },\n        \n        \n        \n        };\n        \n        \n        \n        \n        var chart = new ApexCharts(document.querySelector(\"#graficoColunaEmpilhadaMensal\"), options_col_emp);\n        chart.render();\n      \n\n      \n      \n    \n         \n     \n    \n          \n          \n         \n   </script>\n</body>\n\n\n\n\n\n\n\n\n\n","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":106.0700394080815,"y":220.44453685685528},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true},{"id":"bIarlJ","grid":{"h":101,"w":64,"x":0,"y":5,"hidden":false},"type":"report","appId":137,"label":"TESTE COMBINAÇÃO  v2","limit":100,"width":1321,"height":601,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_csl_dia","tmp_csl_mes","tmp_hrq_ata","tmp_hrq_crp","tmp_hrq_emp","tmp_hrq_vrj","tmp_sgm_ata_dia","tmp_sgm_ata_mes","tmp_sgm_crp_dia","tmp_sgm_crp_mes","tmp_sgm_emp_dia","tmp_sgm_emp_mes","tmp_sgm_vrj_dia","tmp_sgm_vrj_mes","tbl_vnd_forecast_best","forecast_atacado"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\n\n   \n   <meta charset=\"utf-8\">\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n   <title>Portal Analytics</title>\n</head>\n<body>\n    <div id=\"carregando\" style=\"display: none\"></div>\n   <div id=\"wrapper\">\n      <!-- Ínicio menu -->\n      \n         <!-- Ínicio Área Filtros -->\n\t\t \n         <div class=\"wrapper wrapper-content animated fadeInRight\">\n            <!-- Ínicio \"Seção 1\" -->\n            {% if params.prm_indicador == 'Ticket Medio' %}\n            \n            {% else %}\n            <div class=\"row\">\n               <!-- Ínicio \"Gráfico 1\" -->\n               <div class=\"col-lg-12\">\n                  <div class=\"ibox \">\n                     <div class=\"ibox-title\">\n                        <h5>\n                           {{params.prm_indicador}} ({{params.prm_escala_texto}})\n                           <span style=\"color: #D3D3D3\">\n                           {% if params.prm_indicador == 'Base de Clientes' %}\n                           * Para Base de 2022 não se aplica orçado / 2023 considera Revisão Orçamento\n                           {% elif params.prm_indicador == 'Venda' %}\n                           * 2023 considera Revisão Orçamento\n                           {% else %}\n                           * 2023 considera Revisão Orçamento\n                           {% endif %}\n                           </span>\n                         \n                           \n                           <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\n                               \n                              <span class=\"btn btn-white\" id=\"btn_view_mensal\" style=\"display:none\">Ver Mensal</span>\n                              <a class=\"btn btn-white\" id=\"btn_view_diaria\" style=\"display:block\"><span>Ver Diário</span></a>\n                           </div>\n                        </h5>\n                        <div class='filtrarMes' id=\"filtrarMescsl\">Filtrar Mês</div>\n                        <div class=\"labelDataRefDia\" id=\"labelDataRefDiacsl\">\n                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\n                        </div>\n                     </div>\n                     <div class=\"ibox-content\">\n                        <div id=\"grafMes\" style=\"display:block\">\n                           <div id=\"graficoConsolidadoMensal\"></div>\n                        </div>\n                        <div id=\"grafDia\" style=\"display:none\">\n                           <div id=\"graficoConsolidadoDiario\"></div>\n                        </div>\n                     </div>\n                  </div>\n               </div>\n               <!-- Fim \"Gráfico 1\" -->\n              \n            </div>\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\n\n            {% endif %}\n            \n            <!-- Ínicio \"Seção 2\" -->\n\n            <!-- Fim \"Seção3\" -->\n         </div>\n      </div>\n      <!-- Fim conteúdo -->\n   </div>\n   <!-- Mainly scripts -->\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\n   <!-- Custom and plugin javascript -->\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\n   <script>\n\t\n     \n         // OPCOES GERAIS GRAFICOS\n         // GRAFICOS DE BARRAS\n       var options_teste = {\n          series: [{\n          name: \"Orçado\",\n           type: 'column',\n           data: [{% for item in tmp_csl_mes %}\n                 {{ item.ORCADO_CSL }},\n                   {% endfor %}]\n          \n          \n        }, {\n         name: \"Real\",\n         type: 'column',\n          data: [{% for item in tmp_csl_mes %}\n                   \n                     {{ item.REAL }},\n                   \n                 \n                   {% endfor %}]\n        }, {\n         name: \"Real\",\n         type: 'line',\n          data: [{% for item in tmp_csl_mes %}\n                   \n                     {{ item.REAL}},\n                   \n                 \n                   {% endfor %}]\n        }],\n          chart: {\n          height: 350,\n          type: 'bar',\n          //stacked: false\n          zoom: {\n           enabled: false\n         },\n         toolbar: {\n             show: false\n         },\n          \n          \n         legend: {\n         show: true,\n         position: 'bottom',\n         horizontalAlign: 'center', \n         fontSize: '14px',\n         fontFamily: 'Helvetica, Arial',\n         fontWeight: 400,\n         markers: {\n            width: 12,\n            height: 12,\n            strokeWidth: 0,\n            strokeColor: '#fff',\n            fillColors: ['#008FFB', '#00E396'],\n            radius: 12,\n         },\n         itemMargin: {\n            horizontal: 5,\n            vertical: 0\n         },\n         onItemClick: {\n            toggleDataSeries: true\n         },\n         onItemHover: {\n            highlightDataSeries: true\n         },\n         }, \n          \n        },\n        dataLabels: {\n          enabled:true,\n           style: {\n                  fontSize: '9px',\n                  fontWeight: 'bold',\n                  colors: ['black'],\n          },\n          \n           background: {\n              enabled: false,\n              foreColor: '#000',\n              borderRadius: 2,\n              padding: 4,\n              opacity: 0.9,\n              borderWidth: 1,\n              borderColor: '#fff'\n            },\n            \n            \n             offsetY: -15,\n         formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           },\n          \n        },\n        \n         plotOptions: {\n            bar: {\n              horizontal: false,\n              borderRadius: 2,\n              dataLabels: {\n                position: 'top',\n                \n                  \n              },\n            },\n            \n         },\n        \n        \n        \n        //função \"nativa\"\n        stroke: {\n          width: [1, 1, 4]\n        },\n        \n        \n        \n       \n        xaxis: {\n          categories: [{% for item in tmp_csl_mes %}\n                  '{{ item.DIA }}',\n                  {% endfor %}],\n                // Altera a linha do eixo X    \n                axisBorder: {\n                    show: true,\n                    color: '#000000',\n                    height: 1,\n                    width: '100%',\n                    offsetX: 0,\n                    offsetY: 0},\n        // Altera a divisão da linha do eixo X  \n                axisTicks: {\n                    show: true,\n                    borderType: 'solid',\n                    color: '#000000',\n                    height: 6,\n                    offsetX: 0,\n                    offsetY: 0\n                },            \n                    \n                    \n                    \n                    \n        },\n        \n     \n        yaxis: [\n          {\n          \n            grid: {\n             show: false,\n             stokeDashArray: 0,\n         }, \n         \n         \n         labels: {\n             show: false,\n             formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           },\n         } \n         \n         \n         \n         \n            \n          },\n         \n        \n        ],\n        tooltip: {\n          fixed: {\n            enabled: true,\n            position: 'topLeft', // topRight, topLeft, bottomRight, bottomLeft\n            offsetY: 30,\n            offsetX: 60\n          },\n        },\n        \n        };\n\n         var chartConsolidadoMensal = new ApexCharts(document.querySelector(\"#graficoConsolidadoMensal\"),options_teste);\n         chartConsolidadoMensal.render(); \n      \n      \n    \n         \n     \n    \n          \n          \n         \n   </script>\n</body>\n\n\n\n\n\n\n\n\n\n","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":269.0818353716273,"y":73.43688202944793},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true},{"id":"WlYHzl","grid":{"h":101,"w":64,"x":0,"y":5,"hidden":false},"type":"report","appId":137,"label":"TESTE COMBINAÇÃO","limit":100,"width":1321,"height":601,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_csl_dia","tmp_csl_mes","tmp_hrq_ata","tmp_hrq_crp","tmp_hrq_emp","tmp_hrq_vrj","tmp_sgm_ata_dia","tmp_sgm_ata_mes","tmp_sgm_crp_dia","tmp_sgm_crp_mes","tmp_sgm_emp_dia","tmp_sgm_emp_mes","tmp_sgm_vrj_dia","tmp_sgm_vrj_mes","tbl_vnd_forecast_best","forecast_atacado"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\n\n   \n   <meta charset=\"utf-8\">\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n   <title>Portal Analytics</title>\n</head>\n<body>\n    <div id=\"carregando\" style=\"display: none\"></div>\n   <div id=\"wrapper\">\n      <!-- Ínicio menu -->\n      \n         <!-- Ínicio Área Filtros -->\n\t\t \n         <div class=\"wrapper wrapper-content animated fadeInRight\">\n            <!-- Ínicio \"Seção 1\" -->\n            {% if params.prm_indicador == 'Ticket Medio' %}\n            \n            {% else %}\n            <div class=\"row\">\n               <!-- Ínicio \"Gráfico 1\" -->\n               <div class=\"col-lg-12\">\n                  <div class=\"ibox \">\n                     <div class=\"ibox-title\">\n                        <h5>\n                           {{params.prm_indicador}} ({{params.prm_escala_texto}})\n                           <span style=\"color: #D3D3D3\">\n                           {% if params.prm_indicador == 'Base de Clientes' %}\n                           * Para Base de 2022 não se aplica orçado / 2023 considera Revisão Orçamento\n                           {% elif params.prm_indicador == 'Venda' %}\n                           * 2023 considera Revisão Orçamento\n                           {% else %}\n                           * 2023 considera Revisão Orçamento\n                           {% endif %}\n                           </span>\n                         \n                           \n                           <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\n                               \n                              <span class=\"btn btn-white\" id=\"btn_view_mensal\" style=\"display:none\">Ver Mensal</span>\n                              <a class=\"btn btn-white\" id=\"btn_view_diaria\" style=\"display:block\"><span>Ver Diário</span></a>\n                           </div>\n                        </h5>\n                        <div class='filtrarMes' id=\"filtrarMescsl\">Filtrar Mês</div>\n                        <div class=\"labelDataRefDia\" id=\"labelDataRefDiacsl\">\n                            <h6>Exibindo: {{ tmp_csl_dia[0].Mes_Ref_Visual }}</h6>\n                        </div>\n                     </div>\n                     <div class=\"ibox-content\">\n                        <div id=\"grafMes\" style=\"display:block\">\n                           <div id=\"graficoConsolidadoMensal\"></div>\n                        </div>\n                        <div id=\"grafDia\" style=\"display:none\">\n                           <div id=\"graficoConsolidadoDiario\"></div>\n                        </div>\n                     </div>\n                  </div>\n               </div>\n               <!-- Fim \"Gráfico 1\" -->\n              \n            </div>\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\n\n            {% endif %}\n            \n            <!-- Ínicio \"Seção 2\" -->\n\n            <!-- Fim \"Seção3\" -->\n         </div>\n      </div>\n      <!-- Fim conteúdo -->\n   </div>\n   <!-- Mainly scripts -->\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\n   <!-- Custom and plugin javascript -->\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\n   <script>\n\t\n  /*       \n         // OPCOES GERAIS GRAFICOS\n         // GRAFICOS DE BARRAS\n         var optionsBarChart = {\n         series: [\n          {\n           name: \"Orçado\",\n           data: [{% for item in tmp_csl_mes %}\n                 {{ item.ORCADO_CSL }},\n                   {% endfor %}]\n         \n          },\n          {\n           name: \"Real\",\n           data: [{% for item in tmp_csl_mes %}\n                   \n                     {{ item.REAL }},\n                   \n                 \n                   {% endfor %}]\n         \n          }],\n         \n         chart: {\n         height: 350,\n         type: 'bar',\n         zoom: {\n           enabled: false\n         },\n         toolbar: {\n             show: false\n         }\n         },\n         \n         legend: {\n         show: true,\n         position: 'bottom',\n         horizontalAlign: 'center', \n         fontSize: '14px',\n         fontFamily: 'Helvetica, Arial',\n         fontWeight: 400,\n         markers: {\n            width: 12,\n            height: 12,\n            strokeWidth: 0,\n            strokeColor: '#fff',\n            fillColors: ['#008FFB', '#00E396'],\n            radius: 12,\n         },\n         itemMargin: {\n            horizontal: 5,\n            vertical: 0\n         },\n         onItemClick: {\n            toggleDataSeries: true\n         },\n         onItemHover: {\n            highlightDataSeries: true\n         },\n         },\n         \n         dataLabels: {\n         enabled: true,\n         style: {\n                  fontSize: '9px',\n                  fontWeight: 'bold',\n                  colors: ['black'],\n          },\n         background: {\n              enabled: false,\n              foreColor: '#000',\n              borderRadius: 2,\n              padding: 4,\n              opacity: 0.9,\n              borderWidth: 1,\n              borderColor: '#fff'\n            }, \n          offsetY: -15,\n         formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           },\n         },\n         plotOptions: {\n            bar: {\n              horizontal: false,\n              borderRadius: 2,\n              dataLabels: {\n                position: 'top',\n                \n                  \n              },\n            },\n            \n         },\n         \n         yaxis: {\n         grid: {\n             show: false,\n             stokeDashArray: 0,\n         },\n         labels: {\n             show: false,\n             formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           },\n         },\n         },\n         stroke: {\n         curve: 'straight',\n         colors: [\"transparent\"],\n         width: 2\n         },\n         fill: {\n         colors: ['#008FFB', '#00E396'],\n         opacity: 1\n         },\n         grid: {\n         show: false,\n         axis: {\n             lines: {\n                 show: false\n             }\n         },\n         yaxis: {\n             lines: {\n                 show: false\n             }\n         }\n         },\n         xaxis: {\n          categories: [{% for item in tmp_csl_mes %}\n                  '{{ item.DIA }}',\n                  {% endfor %}],\n                // Altera a linha do eixo X    \n                axisBorder: {\n                    show: true,\n                    color: '#000000',\n                    height: 1,\n                    width: '100%',\n                    offsetX: 0,\n                    offsetY: 0\n                },\n                // Altera a divisão da linha do eixo X  \n                axisTicks: {\n                    show: true,\n                    borderType: 'solid',\n                    color: '#000000',\n                    height: 6,\n                    offsetX: 0,\n                    offsetY: 0\n                },\n              },\n         };\n         \n         \n         \n          \n         \n         var chartConsolidadoMensal = new ApexCharts(document.querySelector(\"#graficoConsolidadoMensal\"), optionsBarChart);\n         chartConsolidadoMensal.render(); */\n         \n     \n     \n         \n         \n       // OPCOES GERAIS GRAFICOS\n         // GRAFICOS DE BARRAS\n         var options_teste = {\n         series: [\n          {\n           name: \"Orçado\",\n           type: 'column',\n           data: [{% for item in tmp_csl_mes %}\n                 {{ item.ORCADO_CSL }},\n                   {% endfor %}]\n         \n          }, \n          \n          {\n           name: \"Real\",\n           type: 'column',\n           data: [{% for item in tmp_csl_mes %}\n                     {{ item.REAL }},\n                   {% endfor %}]\n         \n          },\n          \n           {\n           name: \"Real_Orçadoxxx\",\n           type: 'line',\n           data: [{% for item in tmp_csl_mes %}\n                     {{ item.REAL/item.ORCADO_CSL }},\n                   {% endfor %}]\n         \n          }],\n          \n           chart: {\n         height: 350,\n         type: 'line',\n         stacked: false\n         //nao precisou utilizar \n         /*zoom: {\n         //  enabled: false\n         },\n         toolbar: {\n             show: false\n         }*/\n         },\n         \n          legend: {\n         show: true,\n         position: 'bottom',\n         horizontalAlign: 'center', \n         fontSize: '14px',\n         fontFamily: 'Helvetica, Arial',\n         fontWeight: 400,\n         markers: {\n            width: 12,\n            height: 12,\n            strokeWidth: 0,\n            strokeColor: '#fff',\n            fillColors: ['#008FFB', '#00E396'],\n            radius: 12,\n         },\n         itemMargin: {\n            horizontal: 5,\n            vertical: 0\n         },\n         onItemClick: {\n            toggleDataSeries: true\n         },\n         onItemHover: {\n            highlightDataSeries: true\n         },\n         },\n         \n         dataLabels: {\n         enabled: false\n         /*enabled: true,\n         style: {\n                  fontSize: '9px',\n                  fontWeight: 'bold',\n                  colors: ['black'],\n          },\n         background: {\n              enabled: false,\n              foreColor: '#000',\n              borderRadius: 2,\n              padding: 4,\n              opacity: 0.9,\n              borderWidth: 1,\n              borderColor: '#fff'\n            }, \n          offsetY: -15,\n         formatter: function (value) {\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \n                  {minimumFractionDigits: {{params.prm_escala_decimais/1}},\n                   maximumFractionDigits: {{params.prm_escala_decimais/1}}});\n           },*/\n         }, \n         \n          stroke: {\n         curve: 'straight',\n         colors: [\"transparent\"],\n         //width: 2 //script barchat\n         width: [1, 1, 4]\n         },\n         \n         \n        fill: {\n         colors: ['#008FFB', '#00E396'],\n         opacity: 1\n         },\n         grid: {\n         show: false,\n         axis: {\n             lines: {\n                 show: false\n             }\n         },\n         yaxis: {\n             lines: {\n                 show: false\n             }\n         }\n         },\n         xaxis: {\n          categories: [{% for item in tmp_csl_mes %}\n                  '{{ item.DIA }}',\n                  {% endfor %}],\n                // Altera a linha do eixo X    \n                axisBorder: {\n                    show: true,\n                    color: '#000000',\n                    height: 1,\n                    width: '100%',\n                    offsetX: 0,\n                    offsetY: 0\n                },\n                // Altera a divisão da linha do eixo X  \n                axisTicks: {\n                    show: true,\n                    borderType: 'solid',\n                    color: '#000000',\n                    height: 6,\n                    offsetX: 0,\n                    offsetY: 0\n                },\n              },\n         };\n         \n         \n           \n         var chartConsolidadoMensal = new ApexCharts(document.querySelector(\"#graficoConsolidadoMensal\"),options_teste);\n         chartConsolidadoMensal.render(); \n          \n          \n          \n          \n          \n          \n          \n          \n          \n          \n          \n          \n          \n         \n   </script>\n</body>\n\n\n\n\n\n\n\n\n\n","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":106.07317663242888,"y":79.43882710854328},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":7,"flowStart":1,"flowType":"infoPub","flowKey":"OLuKZMHHWSHSw_JpwN__jWTeUsaqSYgI","flowDescription":"","locked":"no","created":"2023-06-21 11:24:34","updated":"2023-09-08 09:08:23"},{"flowId":"2201","appId":137,"flowName":"carregaGraficosMenu","workflow":{"nodes":[{"id":"xchFgg","type":"table","appId":137,"label":"tmp_csl_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":54.83190604907418,"y":55.00720757661648},"sourceId":null,"tableName":"tmp_csl_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IuPelx","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"PfXTlF","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"tmp_csl_dia","valueType":"computed","columnName":"MES_REF","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"BZjRVl","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_csl_dia","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"mGQgVC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_csl_dia","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"yDtbCG","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_csl_dia","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"sWHzLH","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_csl_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"ECyaET","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_csl_dia","columnName":"REAL_ACU","columnLength":2,"databaseName":"bucket_137"},{"id":"BzZmcG","type":"value","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_csl_dia","columnName":"ORCADO_NAO_ACU","columnLength":2,"databaseName":"bucket_137"},{"id":"zGbEhA","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_csl_dia","columnName":"ORCADO_ACU","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":168.67693198968686,"y":54.1014647764944},"sourceId":null,"tableName":"tmp_csl_dia","sourceType":"bucket","resultTable":"tmp_men_geral","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"bHAkDc","type":"table","appId":137,"label":"tmp_men_geral","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":299.17693198968686,"y":54.1014647764944},"sourceId":null,"tableName":"tmp_men_geral","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JTbQuU","type":"builder","appId":137,"label":"Receita Liquida","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"dCFSyu","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"XsJLdc","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"dEMMmb","type":"value","andOr":"and","value":"Migração Entrante","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"pQMQqQ","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"lHWdKt","type":"computed","alias":"REAL_WIP","content":"sum(0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_WIP","computedId":"YSONQS","columnLength":2},{"id":"OwOijc","type":"computed","alias":"ORCADO_WIP","content":"sum(0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_WIP","computedId":"yUFgkX","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_WIP","content":"sum(0)","dataType":"Nullable(Float64)","columnName":"REAL_WIP","computedId":"YSONQS","columnLength":2},{"type":"computed","alias":"ORCADO_WIP","content":"sum(0)","dataType":"Nullable(Float64)","columnName":"ORCADO_WIP","computedId":"yUFgkX","columnLength":2}]},"created":false,"position":{"x":440.67693198968664,"y":350.10146477649414},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_receita_liquida","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OdsdFr","type":"table","appId":137,"label":"tmp_men_receita_liquida","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":350.10146477649414},"sourceId":null,"tableName":"tmp_men_receita_liquida","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rCNoRn","type":"builder","appId":137,"label":"churn receita","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"VInJgc","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"awZIHV","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"sTqhUe","type":"value","andOr":"and","value":"Perda de Receita","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"KljLCp","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"GAYuNB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"JawLmv","type":"sum","alias":"REAL_ACU","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL_ACU","columnLength":null,"databaseName":"bucket_137"},{"id":"pQpQyP","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"KQbOiF","type":"sum","alias":"ORCADO_ACU","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO_ACU","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"ORCADO_PR","content":"SUM(0)","dataType":"Nullable(Float64)","columnName":"ORCADO_PR","computedId":"mOTzdS","columnLength":2}]},"created":false,"position":{"x":440.67693198968664,"y":588.1014647764944},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_perda_receita","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"zqCDdc","type":"table","appId":137,"label":"tmp_men_perda_receita","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":588.1014647764944},"sourceId":null,"tableName":"tmp_men_perda_receita","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"Xlhhet","type":"builder","appId":137,"label":"Venda","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"nODuqw","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"RqWzPk","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"hRDnUf","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AChRwL","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"zFNDtv","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"yRvKip","type":"sum","alias":"REAL_ACU","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL_ACU","columnLength":null,"databaseName":"bucket_137"},{"id":"VLlycg","type":"sum","alias":"ORCADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"viMqIM","type":"sum","alias":"ORCADO_ACU","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO_ACU","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":440.67693198968664,"y":228.10146477649428},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_venda","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OrhvNz","type":"table","appId":137,"label":"tmp_men_venda","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":228.10146477649428},"sourceId":null,"tableName":"tmp_men_venda","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jmOsJp","type":"builder","appId":137,"label":"contratos","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"AIrMGQ","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"EaXLsc","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"joqCik","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"fRzYWH","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"StIHzS","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":440.67693198968664,"y":472.10146477649414},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_contratos","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NjdlSz","type":"table","appId":137,"label":"tmp_men_contratos","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":619.1770054208303,"y":472.1014647764941},"sourceId":null,"tableName":"tmp_men_contratos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"zpTWdk","type":"builder","appId":137,"label":"Opex","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"tnqowi","type":"value","order":"asc","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"SwasmX","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"sSKuJJ","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"twRutA","type":"computed","alias":"REAL_WIP","content":"0","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_WIP","computedId":"kNJtVQ","columnLength":2},{"id":"YQTieC","type":"computed","alias":"ORCADO_WIP","content":"0","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_WIP","computedId":"eTniHO","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_WIP","content":"0","dataType":"Nullable(Float64)","columnName":"REAL_WIP","computedId":"kNJtVQ","columnLength":2},{"type":"computed","alias":"ORCADO_WIP","content":"0","dataType":"Nullable(Float64)","columnName":"ORCADO_WIP","computedId":"eTniHO","columnLength":2}]},"created":false,"position":{"x":440.67693198968664,"y":-3.898535223505604},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_opex","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fQVRNv","type":"table","appId":137,"label":"tmp_men_opex","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":-3.898535223505604},"sourceId":null,"tableName":"tmp_men_opex","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mFMeCf","type":"builder","appId":137,"label":"Caixa","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"nxMrRV","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"LAvsde","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ecDZcW","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"VsqnBm","type":"computed","alias":"REAL_WIP","content":"0","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_WIP","computedId":"YSONQS","columnLength":2},{"id":"sBPnGF","type":"computed","alias":"ORCADO_WIP","content":"0","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_WIP","computedId":"yUFgkX","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_WIP","content":"0","dataType":"Nullable(Float64)","columnName":"REAL_WIP","computedId":"YSONQS","columnLength":2},{"type":"computed","alias":"ORCADO_WIP","content":"0","dataType":"Nullable(Float64)","columnName":"ORCADO_WIP","computedId":"yUFgkX","columnLength":2}]},"created":false,"position":{"x":440.67693198968664,"y":-375.89853522350586},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_caixa","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XtKdAw","type":"table","appId":137,"label":"tmp_men_caixa","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":-375.89853522350586},"sourceId":null,"tableName":"tmp_men_caixa","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"nrqimL","type":"builder","appId":137,"label":"migrações entrantes","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"UrKTRc","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"moJoCn","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"lhDDDq","type":"value","andOr":"and","value":"Migração Entrante","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"pEVtfm","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"vSyrDV","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"SmCIPP","type":"sum","alias":"sum_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":440.67693198968664,"y":-253.89853522350575},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_migracoes_entrantes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oLVEbR","type":"table","appId":137,"label":"tmp_men_migracoes_entrantes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":-253.89853522350575},"sourceId":null,"tableName":"tmp_men_migracoes_entrantes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZgmlLg","type":"builder","appId":137,"label":"migrações saintes","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"fwdqHD","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"sWSoBJ","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"SnmIIz","type":"value","andOr":"and","value":"Migração Sainte","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"dOOMBy","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"ZiGeci","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"WnEhEH","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":440.67693198968664,"y":-125.8985352235056},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_migracoes_saintes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"AhBOPN","type":"table","appId":137,"label":"tmp_men_migracoes_saintes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":-125.8985352235056},"sourceId":null,"tableName":"tmp_men_migracoes_saintes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wwtixo","type":"builder","appId":137,"label":"churn fisico","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"MyyucE","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"OdruBE","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"EWgLTY","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL_ACU","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"CKxPCK","type":"value","andOr":"and","value":"Churn Físico","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"PBWbpT","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"nPDKQl","type":"value","alias":"REAL","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_men_geral","columnName":"REAL_ACU","columnLength":null,"databaseName":"bucket_137"},{"id":"vnubKD","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"position":{"x":445.67729914540496,"y":-492.89860865464937},"sourceId":null,"tableName":"tmp_men_geral","sourceType":"bucket","resultTable":"tmp_men_churn_fisico","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"IBhvPF","type":"table","appId":137,"label":"tmp_men_churn_fisico","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":618.1769319896866,"y":-491.89853522350575},"sourceId":null,"tableName":"tmp_men_churn_fisico","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ROnSzD","type":"table","appId":137,"label":"base_orcado_portal_csl_home","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":581.8131789026812,"y":940.7049819165728},"sourceId":null,"tableName":"base_orcado_portal_csl_home","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"Yronxj","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":67.58856064237895,"y":704.1993794193327},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BjjQzJ","type":"builder","appId":137,"label":"DUP -Geral","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"NSnEqN","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"CwYnzg"},{"id":"sVCOOI","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"yIRGIu"},{"id":"OuVqQt","type":"value","dataType":"Nullable(DateTime)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"wwMOuL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"QwwbPp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"zVktnK","type":"value","andOr":"and","value":"addMonths(today(), -6)","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"BPJAQJ","type":"value","andOr":"and","value":"2023-01-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GNzcgA","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"CwYnzg"},{"id":"dllsCZ","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"yIRGIu"},{"id":"GnVxaw","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"wwMOuL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"rkpQyD","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"BBvGhp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"CwYnzg"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"yIRGIu"}]},"created":false,"position":{"x":244.89714016059472,"y":704.9078645583645},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","sourceType":"bucket","resultTable":"tmp_men_aux_geral","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"QcxIDy","type":"table","appId":137,"label":"tmp_men_aux_geral","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":416.39714016059474,"y":704.9078645583645},"sourceId":null,"tableName":"tmp_men_aux_geral","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"lKSTdp","type":"builder","appId":137,"label":"Geral","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_men_aux_geral","id":"UKWYXf","to":"base_orcado_portal_csl_home","raw":"","list":[{"id":"tJCrHI","andOr":"and","tableBy":"tmp_men_aux_geral","tableTo":"base_orcado_portal_csl_home","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"aLCHMU","andOr":"and","tableBy":"tmp_men_aux_geral","tableTo":"base_orcado_portal_csl_home","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"VXXBCq","andOr":"and","tableBy":"tmp_men_aux_geral","tableTo":"base_orcado_portal_csl_home","columnBy":"SEGMENTO","columnTo":"segmento_tratado","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"hcGIeJ","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_aux_geral","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"jXUojU","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_aux_geral","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"LVuynY","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_aux_geral","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"SGpKuS","type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"MES_REF","computedId":"FNzUys"},{"id":"ehcXNQ","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_men_aux_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"GvWcAS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_aux_geral","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"zVktnK","type":"value","andOr":"and","value":"addMonths(today(), -4)","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"tmp_men_aux_geral","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"hcGIeJ","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_aux_geral","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"jXUojU","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_aux_geral","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"LVuynY","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_aux_geral","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ehcXNQ","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_men_aux_geral","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"XGSCLa","type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"MES_REF","computedId":"FNzUys"},{"id":"CWZgTo","type":"max","alias":"ORCADO_GERAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_csl_home","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"riryvg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_aux_geral","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"CwYnzg"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"yIRGIu"},{"type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"MES_REF","computedId":"FNzUys"}]},"created":false,"position":{"x":582.1985700802975,"y":706.1628220877317},"sourceId":null,"tableName":"tmp_men_aux_geral","sourceType":"bucket","resultTable":"tmp_men_geral2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eHRYRa","type":"table","appId":137,"label":"tmp_men_geral2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":702.0054839745193,"y":709.261801659838},"sourceId":null,"tableName":"tmp_men_geral2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bDpXAt","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"ddjYZm","type":"value","alias":"","order":"desc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"srfRvu","type":"computed","alias":"ORD_SGM","order":"asc","content":"case\r\n    when SEGMENTO = 'OPERADORAS'  THEN 4\r\n    when SEGMENTO = 'CORPORATIVO' THEN 1\r\n    when SEGMENTO = 'EMPRESARIAL' THEN 2\r\n    when SEGMENTO = 'RESIDENCIAL' THEN 3\r\nEND","dataType":"Nullable(Int64)","columnName":"ORD_SGM","computedId":"spSnSB"}],"group":[{"id":"azOYXa","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"vzxyYF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"QjrJQM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"sBpLVb","type":"computed","alias":"SEGMENTO_TTD","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'ATACADO'\n    when SEGMENTO = 'CORPORATIVO' THEN 'CORPORATIVO'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'VAREJO'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_TTD","computedId":"CoCnym"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"rhwefY","type":"value","andOr":"and","value":["Ticket Medio","Faturamento Bruto Mensal","Base de Contratos TM","Faturamento Bruto Mensal TM"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_men_geral2","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"MKnDow","type":"value","alias":"","andOr":"and","value":"toStartOfMonth(toStartOfMonth(today())-1)","dataType":"Nullable(Date)","distinct":false,"operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"computed","columnName":"MES_REF","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"azOYXa","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"JHdNTB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"VpeKII","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"HqETHv","type":"computed","alias":"REAL_TM","content":"case when `tmp_men_geral2`.`SEGMENTO` = 'OPERADORAS' THEN \n\ncase\nwhen SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) / \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END), 0)\nelse 0 end\n\n\nELSE\n\ncase\nwhen SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) / \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_men_geral2`.`REAL` END), 0)\nelse 0 end\n\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_TM","computedId":"QPWILf","columnLength":2},{"id":"bOGJSX","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral2","columnName":"ORCADO_GERAL","columnLength":2,"databaseName":"bucket_137"},{"id":"fCGyDz","type":"computed","alias":"SEGMENTO_TTD","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'ATACADO'\n    when SEGMENTO = 'CORPORATIVO' THEN 'CORPORATIVO'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'VAREJO'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_TTD","computedId":"CoCnym"}],"update":[],"computed":[{"type":"computed","alias":"REAL_TM","content":"case when `tmp_men_geral2`.`SEGMENTO` = 'OPERADORAS' THEN \n\ncase\nwhen SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Base de Contratos TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) / \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal TM' THEN 0 ELSE `tmp_men_geral2`.`REAL` END), 0)\nelse 0 end\n\n\nELSE\n\ncase\nwhen SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0 and \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) > 0\nthen \nfloor(SUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Ticket Medio' THEN 0 ELSE `tmp_men_geral2`.`REAL` END) / \nSUM(CASE WHEN `tmp_men_geral2`.`TIP_MTC` = 'Faturamento Bruto Mensal' THEN 0 ELSE `tmp_men_geral2`.`REAL` END), 0)\nelse 0 end\n\nend","dataType":"Nullable(Float64)","columnName":"REAL_TM","computedId":"QPWILf","columnLength":2},{"type":"computed","alias":"SEGMENTO_TTD","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'ATACADO'\n    when SEGMENTO = 'CORPORATIVO' THEN 'CORPORATIVO'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'VAREJO'\nEND","dataType":"Nullable(String)","columnName":"SEGMENTO_TTD","computedId":"CoCnym"},{"type":"computed","alias":"ORD_SGM","content":"case\r\n    when SEGMENTO = 'OPERADORAS'  THEN 4\r\n    when SEGMENTO = 'CORPORATIVO' THEN 1\r\n    when SEGMENTO = 'EMPRESARIAL' THEN 2\r\n    when SEGMENTO = 'RESIDENCIAL' THEN 3\r\nEND","dataType":"Nullable(Int64)","columnName":"ORD_SGM","computedId":"spSnSB"}]},"created":false,"position":{"x":714.8332010974434,"y":951.050605868032},"sourceId":null,"tableName":"tmp_men_geral2","sourceType":"bucket","resultTable":"tmp_ticket_medio","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NnjPay","type":"table","appId":137,"label":"tmp_ticket_medio","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":847.5638190407522,"y":953.0505432028835},"sourceId":null,"tableName":"tmp_ticket_medio","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pYQFhY","type":"builder","appId":137,"label":"Ebit Mensal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"iMsAUh","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"DPGnJZ","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"UjGoaj","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"ObMInV","type":"value","andOr":"and","value":"Ebit Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"fjYfbE","type":"value","andOr":"and","value":"prm_segmento","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"parameter","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SrIEnN","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"NlIBaL","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PAZfok","type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}]},"created":false,"position":{"x":865.002070835686,"y":594.1671146504228},"sourceId":null,"tableName":"tmp_men_geral2","sourceType":"bucket","resultTable":"tmp_men_ebit","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"IqEhCv","type":"table","appId":137,"label":"tmp_men_ebit","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":998.0007235349872,"y":596.167051985274},"sourceId":null,"tableName":"tmp_men_ebit","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pFaipG","type":"builder","appId":137,"label":"Ebitda Mensal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"iMsAUh","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"DPGnJZ","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"UjGoaj","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"ObMInV","type":"value","andOr":"and","value":"Ebitda Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"fjYfbE","type":"value","andOr":"and","value":"prm_segmento","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"parameter","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SrIEnN","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"NlIBaL","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PAZfok","type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}]},"created":false,"position":{"x":863.006461045656,"y":802.1785968915339},"sourceId":null,"tableName":"tmp_men_geral2","sourceType":"bucket","resultTable":"tmp_men_ebitda","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"UulWjc","type":"table","appId":137,"label":"tmp_men_ebitda","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":992.0052390752548,"y":803.1785655589593},"sourceId":null,"tableName":"tmp_men_ebitda","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UOWLSy","type":"builder","appId":137,"label":"Clientes Mensal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"iMsAUh","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"DPGnJZ","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"UjGoaj","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"ObMInV","type":"value","andOr":"and","value":"Base de Clientes Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"fjYfbE","type":"value","andOr":"and","value":"prm_segmento","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"parameter","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"alHHtY","type":"value","andOr":"and","value":"addMonths(today(), -3)","dataType":"Nullable(Date)","operator":">=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"computed","columnName":"MES_REF","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SrIEnN","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"NlIBaL","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PAZfok","type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}]},"created":false,"position":{"x":864.6028598394053,"y":706.1628220877316},"sourceId":null,"tableName":"tmp_men_geral2","sourceType":"bucket","resultTable":"tmp_men_clientes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OJPXsV","type":"table","appId":137,"label":"tmp_men_clientes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":986.9964252007434,"y":707.9642520074342},"sourceId":null,"tableName":"tmp_men_clientes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"MVHFBa","type":"builder","appId":137,"label":"Receita Liquida Mensal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"iMsAUh","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"DPGnJZ","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"UjGoaj","type":"value","dataType":"Nullable(String)","tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"ObMInV","type":"value","andOr":"and","value":"Receita Líquida Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"fjYfbE","type":"value","andOr":"and","value":"prm_segmento","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_men_geral2","valueType":"parameter","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SrIEnN","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_men_geral2","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"NlIBaL","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_men_geral2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PAZfok","type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"SUM(CASE WHEN ORCADO_GERAL IS NULL THEN 0 ELSE ORCADO_GERAL END)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"AqSzVZ","columnLength":2}]},"created":false,"position":{"x":859.0043285264817,"y":494.1588952813093},"sourceId":null,"tableName":"tmp_men_geral2","sourceType":"bucket","resultTable":"tmp_men_receita_liq","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"kBMeQI","type":"table","appId":137,"label":"tmp_men_receita_liq","client":"clickhouse","repoId":1,"shared":false,"position":{"x":988.0047999431846,"y":492.15735863641544},"sourceId":null,"tableName":"tmp_men_receita_liq","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RErJKB","type":"table","appId":137,"label":"aux_base_bases_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":733.4799784849655,"y":413.9989660250451},"sourceId":7,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"KfadWI","type":"builder","appId":137,"label":"Mensal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"HfCNTH","type":"computed","alias":"Mes_Ref","order":"asc","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"dDFnLp"},{"id":"AsGgTR","type":"computed","alias":"DIA","order":"asc","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"DIA","computedId":"DpzNEg"}],"group":[{"id":"yADqif","type":"computed","alias":"DIA","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"DIA","computedId":"DpzNEg"},{"id":"YVlvIB","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_base_bases_sem_segmento","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"qkpnyR","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"dDFnLp"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"tVfnSE","type":"value","andOr":"and","value":"CAPEX Mensal","dataType":"Nullable(String)","operator":"like","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"dXguPe","type":"value","andOr":"and","value":"addMonths(today(), -4)","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"XbiEOV","type":"computed","alias":"DIA","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"DIA","computedId":"DpzNEg"},{"id":"KHxRah","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"aux_base_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"dWYbAu","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"aux_base_bases_sem_segmento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"dDFnLp"},{"type":"computed","alias":"DIA","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"DIA","computedId":"DpzNEg"}]},"created":false,"optimize":false,"position":{"x":853.4814511159619,"y":414.9934828245272},"sourceId":7,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_men_capex","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GNLjqI","type":"table","appId":137,"label":"tmp_men_capex","client":"clickhouse","repoId":1,"shared":false,"position":{"x":978.1656522629067,"y":417.0919083413057},"sourceId":7,"tableName":"tmp_men_capex","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"VWRSow","source":"bHAkDc","target":"JTbQuU"},{"id":"JLvelT","source":"rCNoRn","target":"zqCDdc"},{"id":"kpkRpx","source":"bHAkDc","target":"rCNoRn"},{"id":"YjgUsZ","source":"BjjQzJ","target":"QcxIDy"},{"id":"YQYgXF","source":"JTbQuU","target":"OdsdFr"},{"id":"WVhSRc","source":"bHAkDc","target":"Xlhhet"},{"id":"kJqAuR","source":"Xlhhet","target":"OrhvNz"},{"id":"HYVgzm","source":"bHAkDc","target":"jmOsJp"},{"id":"jmIHgi","source":"jmOsJp","target":"NjdlSz"},{"id":"XDrDFZ","source":"bHAkDc","target":"zpTWdk"},{"id":"XyyGkt","source":"zpTWdk","target":"fQVRNv"},{"id":"gZzAYE","source":"bHAkDc","target":"mFMeCf"},{"id":"bMvlpn","source":"mFMeCf","target":"XtKdAw"},{"id":"yPzuzb","source":"bHAkDc","target":"nrqimL"},{"id":"zJrYga","source":"nrqimL","target":"oLVEbR"},{"id":"SqRyKw","source":"bHAkDc","target":"ZgmlLg"},{"id":"xfuSJy","source":"ZgmlLg","target":"AhBOPN"},{"id":"qnqYMQ","source":"bHAkDc","target":"wwtixo"},{"id":"JMAuGz","source":"wwtixo","target":"IBhvPF"},{"id":"Shlavx","source":"Yronxj","target":"BjjQzJ"},{"id":"RxjUCk","source":"eHRYRa","target":"bDpXAt"},{"id":"iPTwKP","source":"bDpXAt","target":"NnjPay"},{"id":"krVjQg","source":"xchFgg","target":"IuPelx"},{"id":"VBvaXH","source":"IuPelx","target":"bHAkDc"},{"id":"PtitZX","source":"eHRYRa","target":"pYQFhY"},{"id":"WYjcmk","source":"pYQFhY","target":"IqEhCv"},{"id":"JHPetr","source":"eHRYRa","target":"pFaipG"},{"id":"NgDJLX","source":"pFaipG","target":"UulWjc"},{"id":"qrYPAr","source":"QcxIDy","target":"lKSTdp"},{"id":"AfAtED","source":"ROnSzD","target":"lKSTdp"},{"id":"Yycehv","source":"lKSTdp","target":"eHRYRa"},{"id":"fKNDsY","source":"eHRYRa","target":"UOWLSy"},{"id":"orDhUc","source":"UOWLSy","target":"OJPXsV"},{"id":"wYgtHm","source":"eHRYRa","target":"MVHFBa"},{"id":"tesebO","source":"MVHFBa","target":"kBMeQI"},{"id":"MrUDYU","source":"RErJKB","target":"KfadWI"},{"id":"COFUos","source":"KfadWI","target":"GNLjqI"}]},"cron":null,"options":{"folder":"PORTAL - MENU","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"DtytWOFQRlCqMymOwCDatuqReDXTxNeT","flowDescription":"","locked":"no","created":"2023-03-27 09:54:50","updated":"2023-09-12 08:50:11"},{"flowId":"3400","appId":137,"flowName":"Portal Analytics - Desempenho Projetos","workflow":{"nodes":[{"id":"lWJwTp","grid":{"h":101,"w":64,"x":0,"y":5,"hidden":false},"type":"report","appId":137,"label":"Desempenho de Projetos - 2.0","limit":1000,"width":1321,"height":601,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_projetos_progresso_bu","tmp_projetos_progresso_csl","tmp_projetos_risco_csl","tmp_projetos_risco_bu","tmp_projetos_detalhado","tmp_projetos_progresso_bu_aberto"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\r\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\r\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\r\n\r\n<link href=\"/api/content/read/130/datatables.min.css\" rel=\"stylesheet\"> \r\n<style>\r\n   #btn_exp_sgm:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #btn_exp_hrq:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #logo_analytics {\r\n   width: 70%;\r\n   }\r\n   #btn_menu {\r\n   font-size: 140%;\r\n   color: #FFFFFF;\r\n   }\r\n   .labelDataRefDia{\r\n   display: none;\r\n   }\r\n   .hrq_real {\r\n   text-align: right;\r\n   }\r\n   .filtrarMes{\r\n   display: none;\r\n   color: black;\r\n   font-weight: 650;\r\n   text-decoration: underline;\r\n   cursor: pointer;\r\n   color:inherit;\r\n   }\r\n   .html5buttons {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0_length, #DataTables_Table_1_length, #DataTables_Table_2_length, #DataTables_Table_3_length {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0_paginate, #DataTables_Table_1_paginate, #DataTables_Table_2_paginate, #DataTables_Table_3_paginate {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0, #DataTables_Table_1, #DataTables_Table_2, #DataTables_Table_3 {\r\n   width: 100% !important;\r\n   }\r\n   .table.dataTable thead .sorting_asc:after {\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n   width: 24px;\r\n   }\r\n   .table.dataTable thead .sorting_desc:after {\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/decrescente.png\");\r\n   }\r\n   .table.dataTable thead .sorting:after {\r\n   opacity: 0.2;\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n   }\r\n   .table table-striped table-bordered table-hover dataTables-example dataTable no-footer {\r\n   width: 100%;\r\n   }\r\n   #result_insights_csl {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_crp {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_emp {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_ope {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_res {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #filtrarMesHrqCrp, #labelDataRefDiaHrqCrp {\r\n   display: block;\r\n   }\r\n   #carregando {\r\n   animation: rodar 1s infinite;\r\n   border: 6px solid #ededed;\r\n   border-radius: 50%;\r\n   border-top-color: #51d4db;\r\n   height: 30px;\r\n   width: 30px;\r\n   position: fixed;\r\n   margin:  25% 50% 0%;\r\n   z-index: 1;\r\n   }\r\n   @keyframes rodar {\r\n   to {\r\n   transform: rotate(1turn);\r\n   }\r\n   }\r\n   .percentual {\r\n   font-weight: 600;\r\n   display: inline-block; \r\n   }\r\n   #aviso_confidencial{\r\n   font-weight: 600;\r\n   font-size: 15px;\r\n   color: #090909;\r\n   margin-top: 15px;\r\n   margin-bottom: 15px;\r\n   border: 2px solid #c22c18;\r\n   text-align: center;\r\n   }\r\n   .insight_classe {\r\n   display: none;\r\n   }\r\n   .subtitulo_grafico{\r\n       text-align: center;\r\n   }\r\n</style>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<title>Portal Analytics</title>\r\n</head>\r\n<body>\r\n   <div id=\"carregando\" style=\"display: none\"></div>\r\n   <div id=\"wrapper\">\r\n      <!-- Ínicio menu -->\r\n      <nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a onclick=\"get_results()\">\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\">\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a onclick=\"get_results()\">\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li><!--\r\n                              <a  target=\"_blank\" href=\"http://spotfirehom.algartelecom.com.br/spotfire/wp/OpenAnalysis?file=200d4235-9a88-4887-8a6d-e69fb53583ff\" id=\"item_menu_venda_digital\">\r\n                              Digital\r\n                              </a>-->\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a>Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a >Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a onclick=\"get_results()\">\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_atendimento_digital\">\r\n                        <a onclick=\"get_results()\" style=\"color: #676a6c;\"  href=\"https://gaio.algartelecom.com.br/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                    </li>\r\n                     \r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a >Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     \r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\">\r\n                  <a> \r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                      <li id=\"item_menu_margem_contribuicao\">\r\n                        <a onclick=\"get_results()\">Margem Contribuição</a>\r\n                     </li>\r\n                      <li id=\"item_menu_ebit\">\r\n                        <a onclick=\"get_results()\">Ebit</a>\r\n                     </li>\r\n                      <li id=\"item_menu_ebitda\">\r\n                        <a onclick=\"get_results()\">Ebitda</a>\r\n                     </li> \r\n   \r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Bruta\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Líquida\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_caixa_livre\">\r\n                        <a>Caixa Livre (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex</a>\r\n                     </li>\r\n                      \r\n                    \r\n                     \r\n                     \r\n                  </ul>\r\n               </li>\r\n               \r\n                <li id=\"side-bar-transformacao\" class=\"active\">\r\n                  <a> \r\n                  <i class=\"fa fa-rocket\"></i>\r\n                  <span class=\"nav-label\" >\r\n                  Transformação (WIP)\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-transformacao-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_desempenho_projeto\">\r\n                        <a onclick=\"get_results()\">Desempenho de Projetos (WIP)</a>\r\n                     </li>\r\n                    \r\n                  </ul>\r\n               </li>\r\n               \r\n               \r\n               \r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               \r\n\r\n               <li id=\"side-bar-ed\">\r\n                <a>\r\n                <i class=\"fa fa-cloud-download\"></i>\r\n                <span class=\"nav-label\">Tecnologia (WIP)</span>\r\n                </a>\r\n                <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                   collapse\">\r\n                <li id=\"item_menu_evolucao_digital\">\r\n                    <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                \r\n                            \r\n                            <li id=\"item_menu_pulse_check\">\r\n                                <a>Data Driven (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Operações automatizadas (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Novos negócios digitais (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Mindset Digital (WIP)</a>\r\n                            </li>\r\n                        </ul>\r\n                </ul>\r\n            </li>\r\n             </li>\r\n\r\n\r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>\r\n      <!-- Fim menu -->\r\n      <!-- Ínicio conteúdo -->\r\n      <div id=\"page-wrapper\" class=\"gray-bg\">\r\n         <div class=\"row border-bottom\">\r\n         </div>\r\n         <!-- Ínicio cabeçalho -->\r\n         <div class=\"col-lg-12 \">\r\n            <div class=\"row \" style=\"height: 86px;\">\r\n               <nav class=\"navbar navbar-static-top\" role=\"navigation\"\r\n                  style=\"margin-bottom: 10px; background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n                  <div class=\"navbar-header\">\r\n                     <a id=\"btn_menu\" class=\"navbar-minimalize\r\n                        minimalize-styl-2\" href=\"#\">\r\n                     <i class=\"fa fa-bars\"></i>\r\n                     </a>\r\n                     <a class=\"navbar-minimalize minimalize-styl-2\"\r\n                        href=\"#\"\r\n                        style=\"cursor: default; margin-top: 5px;\">\r\n                     <img src=\"/api/content/read/137/analytics_logo.png\" width=\"240px\">\r\n                     </a>\r\n                  </div>\r\n                  <h2 class=\"m-r-sm text-white welcome-message\"\r\n                     style=\"font-size: 24px; font-weight: 500;\">\r\n                     <strong style=\"color:#363636;font-size: 30px\">Portal Analytics</strong>\r\n                  </h2>\r\n                  <ul class=\"nav navbar-top-links navbar-right\">\r\n                     <li>\r\n                        <span class=\"m-r-sm text-muted\r\n                           welcome-message\">\r\n                        <img src=\"/api/content/read/137/logo_algartelecom.png\" height=\"50px\">\r\n                        </span>\r\n                     </li>\r\n                  </ul>\r\n               </nav>\r\n            </div>\r\n            <div id=\"aviso_confidencial\">&#60;&#60;&#60;\r\n               AS INFORMAÇÕES PUBLICADAS NESTE PORTAL SÃO CONFIDENCIAIS E NÃO PODEM SER DIVULGADAS NEM REPRODUZIDAS.\r\n               &#62;&#62;&#62;\r\n            </div>\r\n         </div>\r\n         <!-- Fim Cabeçalho -->\r\n         <!-- Ínicio Área Filtros -->\r\n         <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-7\" style=\"margin-top: 50px;\">\r\n               <ol class=\"breadcrumb\">\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Indicadores</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Transformação</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item active\">\r\n                     <a>Desempenho de Projetos</a>\r\n                  </li>\r\n               </ol>\r\n            </div>\r\n            <div class=\"col-lg-3\">\r\n               <div class=\"title-action\">\r\n                  <h2>\r\n                     <i id=\"limpar_filtro\" class=\"text-muted fa fa-refresh\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Limpar Filtros\" style=\"cursor: pointer;\"></i> \r\n                     <i id=\"filtrar\"\r\n                        class=\"text-muted fa fa-filter\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Filtros\"\r\n                        style=\"cursor: pointer;\"></i>\r\n                  </h2>\r\n               </div>\r\n            </div>\r\n            <div class=\"col-lg-2\">\r\n            </div>\r\n         </div>\r\n         <!-- Ínicio Área Filtros -->\r\n         <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!-- Ínicio \"Seção 1\" -->\r\n            <div class=\"row\">\r\n               <!-- Ínicio \"Gráfico 1\" -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5>\r\n                           Desempenho de Projetos (Mês Atual)\r\n                        </h5>\r\n                        <div class=\"row\">\r\n                            <div class=\"ibox-content col-lg-12\">\r\n                                <div>\r\n                                    <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                    <div id=\"chart1\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Gráfico 1\" -->\r\n               <!-- Ínicio \"Insights 1\" -->\r\n            </div>\r\n            <div class=\"row\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox insight_classe\">\r\n                     <div class=\"ibox-title\">\r\n                        <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                     </div>\r\n                     \r\n                     <div class=\"ibox-content\">\r\n                        <ul id=\"result_insights_csl\">\r\n                        </ul>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Insights 1\" -->\r\n            </div>\r\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\r\n            <div class=\"ibox-content\" style=\"text-align: center;\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_sgm\" class=\"btn btn-white\">Abertura BU/VP</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 2\" -->\r\n            <div id=\"abertura_sgm\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" BU -->\r\n               \r\n                   <div class=\"col-lg-12\">\r\n                      <div class=\"ibox \">\r\n                         <div class=\"ibox-title\">\r\n                            <h5>\r\n                               Desempenho de Projetos (Mês Atual)\r\n                            </h5>\r\n                            <div class=\"row\">\r\n                                <div class=\"ibox-content col-lg-12\">\r\n                                    <div>\r\n                                        <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                        <div id=\"chart4\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                         </div>\r\n                      </div>\r\n                   </div>\r\n               \r\n               \r\n               <div class=\"row\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox insight_classe\">\r\n                     <div class=\"ibox-title\">\r\n                        <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                     </div>\r\n                     \r\n                     <div class=\"ibox-content\">\r\n                        <ul id=\"result_insights_crp\">\r\n                        </ul>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Insights 1\" -->\r\n                </div>\r\n              \r\n            </div>\r\n                       \r\n            <!-- Fim \"Seção 2\" -->\r\n            <div id=\"pai_btn_exp_hrq\" class=\"ibox-content\" style=\"text-align: center; display: none\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_hrq\" class=\"btn btn-white\">Abertura Hierarquia</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 3\" -->\r\n            <div id=\"abertura_hrq\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" Abertura -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                         <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-h31\">SERVB</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h51\">SERVC</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h71\">INFRACO</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h81\">SERV TIC/IOT</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h41\">VPE</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h21\">VPF</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h61\">VPG</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h11\">VPT</a></li>\r\n                        \r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio VPT -->\r\n                        <div role=\"tabpanel\" id=\"tab-h11\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                        <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPT' %}\r\n                                    <tr style=\"padding:0\">\r\n                                       <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                     <!--    <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPT -->\r\n                        <!-- Ínicio VPF -->\r\n                        <div role=\"tabpanel\" id=\"tab-h21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPF \" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                      <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPF' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                      <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPF -->\r\n                        <!-- Ínicio SERVB -->\r\n                        <div role=\"tabpanel\" id=\"tab-h31\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                           <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'SERVB' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                           <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVB -->\r\n                        <!-- Ínicio VPE -->\r\n                        <div role=\"tabpanel\" id=\"tab-h41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                        <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPE' %}\r\n                                    <tr style=\"padding:0\">\r\n                                         <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                           <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPE -->\r\n                        <!-- Ínicio SERVC -->\r\n                        <div role=\"tabpanel\" id=\"tab-h51\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                     <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'SERVC' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVC -->\r\n                        <!-- Ínicio VPG -->\r\n                        <div role=\"tabpanel\" id=\"tab-h61\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                      <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                           <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPG' %}\r\n                                    <tr style=\"padding:0\">\r\n                                         <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPG -->\r\n                        <!-- Ínicio INFRACO -->\r\n                        <div role=\"tabpanel\" id=\"tab-h71\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                             <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'INFRACO' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim INFRACO -->\r\n                        \r\n                          <!-- Ínicio Serv TIC/IOT -->\r\n                        <div role=\"tabpanel\" id=\"tab-h81\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico Serv TIC/IOT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                             <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                        <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'Serv TIC/IOT' %}\r\n                                    <tr style=\"padding:0\">\r\n                                         <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Serv TIC/IOT -->\r\n                        \r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Abertura -->\r\n            </div>\r\n            <!-- Fim \"Seção 3\" -->\r\n         </div>\r\n      </div>\r\n      <!-- Fim conteúdo -->\r\n   </div>\r\n   <!-- Mainly scripts -->\r\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\r\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\r\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\r\n   <!-- Custom and plugin javascript -->\r\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\r\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\r\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\r\n   <script src=\"/api/content/read/118/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/130/dataTables.bootstrap4.min.js\"></script>\r\n   <script>\r\n\r\n        $(document).ready(function() {\r\n            $('.dataTables-example').DataTable({\r\n                pageLength: 10,\r\n                responsive: true,\r\n                dom: '<\"html5buttons\"B>lTfgitp',\r\n                buttons: [],\r\n                columnDefs: [{\r\n                    targets: [0], // Índice da coluna a ser classificada\r\n                    type: 'currency', // Tipo de classificação personalizada\r\n                    render: function (data, type, row) {\r\n                        if (type === 'sort') {\r\n                            // Remove o símbolo \"R$\" e os separadores de milhar e decimal para classificação\r\n                            return data.replace(/[^0-9.-]/g, '');\r\n                        }\r\n                        return data; // Mantém o formato original para exibição\r\n                    }\r\n                },\r\n                    {\r\n                        targets: 'no-sort',\r\n                        orderable: false\r\n                    }],\r\n                language: {\r\n                    decimal: ',',\r\n                    thousands: '.',\r\n                    currency: {\r\n                        symbol: 'R$'\r\n                    }\r\n                }\r\n            });\r\n        });\r\n</script>\r\n   \r\n   <script>\r\n      // Função criada para inserir tempo de espera entre execuções\r\n          function sleep(ms) {\r\n                return new Promise(resolve => setTimeout(resolve, ms));\r\n             };\r\n             \r\n          async function carregando() {\r\n      \t  var carrega = document.getElementById(\"carregando\");\r\n                  carrega.style.display = \"block\";\r\n                  await sleep(10000);\r\n                  carrega.style.display = \"none\";\r\n                  \r\n              };  \r\n              \r\n      var base_ctt = 'teste';\r\n      \r\n      {% if params.prm_indicador == 'Base de Contratos' %}\r\n        base_ctt = ' Mensal - ' + context.params.ProdutoBaseContrato;\r\n        console.log(base_ctt);\r\n      {% else %}\r\n        base_ctt = ''\r\n      {% endif %}\r\n      \r\n      \r\n      var dadosNLP = Array(0);\r\n      var insights_final = Array(0);\r\n      \r\n      fetch('https://gaio.algartelecom.com.br/api/rest/pnaVxMEfqPVKHAzwmBbkkeB_wtmUQqJh/tmp_hom_processa_nlp/?filtro_api_id_nlp=all_')\r\n      .then(response => {\r\n        return response.json();\r\n      })\r\n      .then(data => {\r\n        dadosNLP = data;\r\n      \r\n      });\r\n      \r\n      let dia_um = 0;\r\n      \r\n      if(context.params.dia_mes == 1){\r\n        dia_um = 1;\r\n      }\r\n        \r\n      \r\n      \r\n      \r\n      \r\n      (async () => {\r\n        await sleep(4000);\r\n        \r\n        \r\n        \r\n        for (var i = 0; i < dadosNLP.length; i++) {\r\n            switch (dadosNLP[i].id_insight.substring(0, 2)) {\r\n              case '10':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_csl').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '20':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_crp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '21':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_emp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                } \r\n                break;\r\n              case '22':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_res').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '23':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_ope').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                    \r\n                break;\r\n              default:\r\n                console.log('Erro.');\r\n            }\r\n            \r\n            \r\n            \r\n            \r\n        }\r\n      \r\n      })();\r\n             \r\n        // Botão que leva ao indicador Venda Consolidado\r\n        $(\"#item_menu_venda_consolidada\").click(async function() {\r\n                  \r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(5000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n        });     \r\n             \r\n       // Botão que leva ao Menu\r\n        $(\"#side-bar-menu\").click(async function() {\r\n      \t// Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['all_'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                           await carregando();\r\n                  await sleep(5000);\r\n                  await dispatchEvent({ formFlowId: 1808, formType: 'openFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: 'all_' }]});\r\n              });\r\n       \r\n        // Botão que leva ao indicador Base de Contratos\r\n        $(\"#item_menu_base_contrato\").click(async function() {\r\n      \t  // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });  \r\n              });\r\n        \r\n        \r\n              \r\n              // Botão que leva ao indicador Base de Clientes\r\n              $(\"#item_menu_base_cliente\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                           { paramName:'insights', paramValue: 'all_' },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n      \t  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] }); \r\n             \r\n              });\r\n      \r\n        // Botão que leva ao indicador Ticket Medio\r\n              $(\"#item_menu_faturamento\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             \r\n              });\r\n              \r\n              \r\n               // Botão que leva ao indicador Ebit\r\n             $(\"#item_menu_ebit\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n           \r\n      \r\n              \r\n                // Botão que leva ao indicador Ebitda\r\n             $(\"#item_menu_ebitda\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n                // Botão que leva ao indicador Margem Contribuição\r\n             $(\"#item_menu_margem_contribuicao\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Margem Contribuição Mensal', 'Receita Liquida Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n               //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_receita-bruta\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Bruta Mensal','Receita Bruta'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             }); \r\n              \r\n              \r\n              \r\n                //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_receita-liquida\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             });\r\n             \r\n            //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_caixa\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Mensal','Fluxo de Caixa'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             }); \r\n              \r\n            //Gráfico Recebimento\r\n              $(\"#item_menu_recebimento\").click(async function() {\r\n                await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Recebimentos de Caixa Mensal','Recebimentos de Caixa'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n               //Gráfico Fluxo de Caixa Livre\r\n              $(\"#item_caixa_livre\").click(async function() {\r\n                await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Livre Mensal','Fluxo de Caixa Livre'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });  \r\n              \r\n              \r\n             // Botão que leva ao indicador Perda de Receita\r\n             $(\"#item_menu_perda_receita\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n                // Botão que leva ao indicador Desempenho Projetos\r\n             $(\"#item_menu_desempenho_projeto\").click(async function() {\r\n                 \r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3400, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n            // Botão que leva ao indicador CAPEX\r\n             $(\"#item_menu_capex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['CAPEX', 'CAPEX Mensal']}] });\r\n              });  \r\n              \r\n            // Botão que leva ao indicador OPEX\r\n             $(\"#item_menu_opex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['OPEX', 'OPEX Mensal']}]});\r\n              });\r\n          \r\n              \r\n        $(\"#btn_exp_sgm\").click(function() {\r\n           var secao2 = document.getElementById(\"abertura_sgm\");\r\n           var secao3 = document.getElementById(\"abertura_hrq\");\r\n           var btn_sgm = document.getElementById(\"btn_exp_sgm\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           var pai_btn_hrq = document.getElementById(\"pai_btn_exp_hrq\");\r\n           if (secao2.style.display === \"none\") {\r\n           \tsecao2.style.display = \"block\";\r\n           \tpai_btn_hrq.style.display = \"block\";\r\n           \tbtn_sgm.innerHTML = \"Esconder BU/VP\";\r\n           } else {\r\n           \tsecao2.style.display = \"none\";\r\n           \tbtn_sgm.innerHTML = \"Abertura Segmento\";\r\n           \tpai_btn_hrq.style.display = \"none\";\r\n           \tsecao3.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Detalhado\";\r\n           }\r\n          });\r\n              \r\n                          \r\n                          \r\n             \r\n              \r\n        $(\"#btn_exp_hrq\").click(function() {\r\n           var secao3 = document.getElementById(\"abertura_hrq\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           if (secao3.style.display === \"none\") {\r\n           \tsecao3.style.display = \"block\";\r\n           \tbtn_hrq.innerHTML = \"Esconder Detalhado\";\r\n           } else {\r\n           \tsecao3.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Detalhado\";\r\n           }\r\n          });\r\n              \r\n              \r\n        var options = {\r\n          series: [10, 20, 30, 20, 20],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         \r\n        responsive: [{\r\n          breakpoint: 480,\r\n          options: {\r\n            chart: {\r\n              width: 200\r\n            },\r\n            legend: {\r\n              position: 'bottom',\r\n              labels: ['ATRASADO', 'CONCLUIDO', 'EM ATENÇÃO', 'EM DIA'],\r\n              colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58']\r\n            }\r\n          }\r\n        }]\r\n        };\r\n        \r\n        \r\n        var options_chart1 = {\r\n          series: [{% for item in tmp_projetos_progresso_csl %}\r\n                      {{ item.Valor }},\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.COR }}',\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.COR }}',\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n        labels: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.Categoria }}',\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        \r\n        \r\n\r\n        \r\n         var options_chart3 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        \r\n         colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n\r\n        \r\n        var options_chart5 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPF' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n\r\n        \r\n        var options_chart7 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n\r\n        \r\n        var options_chart9 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPE' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n\r\n        var options_chart11 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVC' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        \r\n        \r\n        var options_chart13 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPG' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n      \r\n        var options_chart15 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n       \r\n        \r\n        \r\n        \r\n        var options_chart17 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVTIC/IOT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVTIC/IOT' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVTIC/IOT' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVTIC/IOT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n\r\n        var chart1 = new ApexCharts(document.querySelector(\"#chart1\"), options);\r\n        chart1.render();\r\n        \r\n        setTimeout(function() {\r\n          chart1.updateOptions(options_chart1)\r\n         }, 1);\r\n        \r\n        \r\n        \r\n        setTimeout(function() {\r\n          chart2.updateOptions(options_chart2)\r\n         }, 1);\r\n             \r\n        var chart3 = new ApexCharts(document.querySelector(\"#chart3\"), options);\r\n        chart3.render();\r\n        \r\n       \r\n        \r\n        \r\n        \r\n  \r\n        \r\n        var chart5 = new ApexCharts(document.querySelector(\"#chart5\"), options);\r\n        chart5.render();\r\n        \r\n        setTimeout(function() {\r\n          chart5.updateOptions(options_chart5)\r\n         }, 1);\r\n        \r\n        \r\n        \r\n       \r\n        \r\n        var chart7 = new ApexCharts(document.querySelector(\"#chart7\"), options);\r\n        chart7.render();\r\n        \r\n        setTimeout(function() {\r\n          chart7.updateOptions(options_chart7)\r\n         }, 1);\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        var chart9 = new ApexCharts(document.querySelector(\"#chart9\"), options);\r\n        chart9.render();\r\n        \r\n        setTimeout(function() {\r\n          chart9.updateOptions(options_chart9)\r\n         }, 1);\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        var chart11 = new ApexCharts(document.querySelector(\"#chart11\"), options);\r\n        chart11.render();\r\n        \r\n        setTimeout(function() {\r\n          chart11.updateOptions(options_chart11)\r\n         }, 1);\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        var chart13 = new ApexCharts(document.querySelector(\"#chart13\"), options);\r\n        chart13.render();\r\n        \r\n        setTimeout(function() {\r\n          chart13.updateOptions(options_chart13)\r\n         }, 1);\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        var chart15 = new ApexCharts(document.querySelector(\"#chart15\"), options);\r\n        chart15.render();\r\n        \r\n        setTimeout(function() {\r\n          chart15.updateOptions(options_chart15)\r\n         }, 1);\r\n        \r\n       \r\n         \r\n          var chart17 = new ApexCharts(document.querySelector(\"#chart17\"), options);\r\n        chart17.render();\r\n        \r\n        setTimeout(function() {\r\n          chart17.updateOptions(options_chart17)\r\n         }, 1);\r\n         \r\n         \r\n         \r\n        $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'uOlPDr'\r\n               })\r\n         }); \r\n       \r\n       \r\n       \r\n       \r\n        var empilha_bu = {\r\n          \r\n          series: [ \r\n        {\r\n          name: 'ATRASADO',\r\n          data: [{% for item in tmp_projetos_progresso_bu_aberto %}\r\n             {{ item.atrasado }},\r\n               {% endfor %}]\r\n        }, \r\n        {\r\n          name: 'CONCLUÍDO',\r\n          data: [{% for item in tmp_projetos_progresso_bu_aberto %}\r\n             {{ item.concluido }},\r\n               {% endfor %}]\r\n        },\r\n         \r\n        {\r\n          name: 'EM ATENÇÃO',\r\n          data: [{% for item in tmp_projetos_progresso_bu_aberto %}\r\n             {{ item.em_atencao }},\r\n               {% endfor %}]\r\n        }, \r\n        {\r\n          name: 'EM DIA',\r\n          data: [{% for item in tmp_projetos_progresso_bu_aberto %}\r\n             {{ item.em_dia }},\r\n               {% endfor %}]\r\n        },  \r\n              \r\n              \r\n              \r\n              \r\n        \r\n              \r\n       \r\n        \r\n        \r\n        \r\n        \r\n        ],\r\n          chart: {\r\n          type: 'bar',\r\n          height: 350,\r\n          stacked: true,\r\n          toolbar: {\r\n            show: false\r\n          },\r\n          zoom: {\r\n            enabled: true\r\n          }\r\n        },\r\n        responsive: [{\r\n          breakpoint: 480,\r\n          options: {\r\n            legend: {\r\n             position: 'bottom',\r\n              offsetX: -10,\r\n              offsetY: 0\r\n            }\r\n          }\r\n        }],\r\n        plotOptions: {\r\n          bar: {\r\n            horizontal: false,\r\n            borderRadius: 2,// contorno da barra\r\n            dataLabels: {\r\n              total: {\r\n                enabled: true,\r\n                style: {\r\n                  colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n                  fontSize: '9px',\r\n                  fontWeight: 700\r\n                }\r\n              }\r\n            }\r\n          },\r\n        },\r\n        xaxis: {\r\n            \r\n            \r\n          type: 'text',\r\n          categories: [{% for item in tmp_projetos_progresso_bu_aberto %}\r\n                  '{{ item.BU }}',\r\n                  {% endfor %}\r\n          ],\r\n          \r\n          \r\n          // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0},\r\n          \r\n          // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },   \r\n          \r\n          \r\n        },\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 10,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         }, \r\n         \r\n         \r\n        fill: {\r\n          colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n          opacity: 1\r\n        },\r\n        \r\n        yaxis: [\r\n          {\r\n          \r\n            grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         }, \r\n         \r\n         \r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\");\r\n           },\r\n         } \r\n         \r\n            \r\n          },\r\n        \r\n        ],\r\n        \r\n        dataLabels: {\r\n             \r\n         enabled:true,\r\n           style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n          \r\n           background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            },\r\n            \r\n            \r\n             offsetY: 0,// legenda centralida no grafico\r\n         formatter: function (value) {\r\n             return (value).toLocaleString(\"pt-BR\");\r\n           }\r\n           \r\n          \r\n           \r\n           \r\n          \r\n        },\r\n        \r\n        //remover o grid no grafico\r\n         grid: {\r\n      show: false,\r\n      axis: {\r\n        lines: {\r\n            show: false\r\n        }\r\n      },\r\n      yaxis: {\r\n        lines: {\r\n            show: false\r\n        }\r\n      }\r\n      },\r\n        \r\n        \r\n        \r\n        };\r\n        \r\n        \r\n        \r\n        \r\n        var chart4 = new ApexCharts(document.querySelector(\"#chart4\"), empilha_bu);\r\n        chart4.render();\r\n   </script>\r\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":-90.4938588154198,"y":674.9934828245272},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true},{"id":"hpNPXL","type":"table","appId":137,"label":"aux_base_desempenho_projetos","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-293.5372236508695,"y":306.9950057168239},"sourceId":null,"tableName":"aux_base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"WlYHzl","grid":{"h":101,"w":64,"x":0,"y":5,"hidden":true},"type":"report","appId":137,"label":"Desempenho de Projetos","limit":100,"width":1321,"height":601,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":true},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_projetos_progresso_bu","tmp_projetos_progresso_csl","tmp_projetos_risco_csl","tmp_projetos_risco_bu","tmp_projetos_detalhado"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\r\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\r\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\r\n\r\n<link href=\"/api/content/read/130/datatables.min.css\" rel=\"stylesheet\"> \r\n<style>\r\n   #btn_exp_sgm:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #btn_exp_hrq:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #logo_analytics {\r\n   width: 70%;\r\n   }\r\n   #btn_menu {\r\n   font-size: 140%;\r\n   color: #FFFFFF;\r\n   }\r\n   .labelDataRefDia{\r\n   display: none;\r\n   }\r\n   .hrq_real {\r\n   text-align: right;\r\n   }\r\n   .filtrarMes{\r\n   display: none;\r\n   color: black;\r\n   font-weight: 650;\r\n   text-decoration: underline;\r\n   cursor: pointer;\r\n   color:inherit;\r\n   }\r\n   .html5buttons {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0_length, #DataTables_Table_1_length, #DataTables_Table_2_length, #DataTables_Table_3_length {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0_paginate, #DataTables_Table_1_paginate, #DataTables_Table_2_paginate, #DataTables_Table_3_paginate {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0, #DataTables_Table_1, #DataTables_Table_2, #DataTables_Table_3 {\r\n   width: 100% !important;\r\n   }\r\n   .table.dataTable thead .sorting_asc:after {\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n   width: 24px;\r\n   }\r\n   .table.dataTable thead .sorting_desc:after {\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/decrescente.png\");\r\n   }\r\n   .table.dataTable thead .sorting:after {\r\n   opacity: 0.2;\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n   }\r\n   .table table-striped table-bordered table-hover dataTables-example dataTable no-footer {\r\n   width: 100%;\r\n   }\r\n   #result_insights_csl {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_crp {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_emp {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_ope {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_res {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #filtrarMesHrqCrp, #labelDataRefDiaHrqCrp {\r\n   display: block;\r\n   }\r\n   #carregando {\r\n   animation: rodar 1s infinite;\r\n   border: 6px solid #ededed;\r\n   border-radius: 50%;\r\n   border-top-color: #51d4db;\r\n   height: 30px;\r\n   width: 30px;\r\n   position: fixed;\r\n   margin:  25% 50% 0%;\r\n   z-index: 1;\r\n   }\r\n   @keyframes rodar {\r\n   to {\r\n   transform: rotate(1turn);\r\n   }\r\n   }\r\n   .percentual {\r\n   font-weight: 600;\r\n   display: inline-block; \r\n   }\r\n   #aviso_confidencial{\r\n   font-weight: 600;\r\n   font-size: 15px;\r\n   color: #090909;\r\n   margin-top: 15px;\r\n   margin-bottom: 15px;\r\n   border: 2px solid #c22c18;\r\n   text-align: center;\r\n   }\r\n   .insight_classe {\r\n   display: none;\r\n   }\r\n   .subtitulo_grafico{\r\n       text-align: center;\r\n   }\r\n</style>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<title>Portal Analytics</title>\r\n</head>\r\n<body>\r\n   <div id=\"carregando\" style=\"display: none\"></div>\r\n   <div id=\"wrapper\">\r\n      <!-- Ínicio menu -->\r\n      <nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a onclick=\"get_results()\">\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\">\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a onclick=\"get_results()\">\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li>\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a>Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a >Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a onclick=\"get_results()\">\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_atendimento_digital\">\r\n                        <a onclick=\"get_results()\" style=\"color: #676a6c;\"  href=\"https://gaio.algartelecom.com.br/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a >Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\">\r\n                  <a> \r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_margem_contribuicao\">\r\n                        <a onclick=\"get_results()\">Margem Contribuição</a>\r\n                     </li>\r\n                     <li id=\"item_menu_ebit\">\r\n                        <a onclick=\"get_results()\">Ebit</a>\r\n                     </li>\r\n                     <li id=\"item_menu_ebitda\">\r\n                        <a onclick=\"get_results()\">Ebitda</a>\r\n                     </li>\r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita (WIP)</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Bruta (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Líquida (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               \r\n               \r\n                <li id=\"side-bar-transformacao\" class=\"active\">\r\n                  <a> \r\n                  <i class=\"fa fa-rocket\"></i>\r\n                  <span class=\"nav-label\" >\r\n                  Transformação (WIP)\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-transformacao-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_desempenho_projeto\">\r\n                        <a onclick=\"get_results()\">Desempenho de Projetos (WIP)</a>\r\n                     </li>\r\n                    \r\n                  </ul>\r\n               </li>\r\n               \r\n               \r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-ed\">\r\n                  <a>\r\n                  <i class=\"fa fa-cloud-download\"></i>\r\n                  <span class=\"nav-label\">Tecnologia (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_evolucao_digital\">\r\n                        <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_pulse_check\">\r\n                              <a>Data Driven (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_turnover\">\r\n                              <a>Operações automatizadas (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_turnover\">\r\n                              <a>Novos negócios digitais (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_turnover\">\r\n                              <a>Mindset Digital (WIP)</a>\r\n                           </li>\r\n                        </ul>\r\n                  </ul>\r\n               </li>\r\n               \r\n             \r\n              \r\n               \r\n              \r\n               \r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>\r\n      <!-- Fim menu -->\r\n      <!-- Ínicio conteúdo -->\r\n      <div id=\"page-wrapper\" class=\"gray-bg\">\r\n         <div class=\"row border-bottom\">\r\n         </div>\r\n         <!-- Ínicio cabeçalho -->\r\n         <div class=\"col-lg-12 \">\r\n            <div class=\"row \" style=\"height: 86px;\">\r\n               <nav class=\"navbar navbar-static-top\" role=\"navigation\"\r\n                  style=\"margin-bottom: 10px; background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n                  <div class=\"navbar-header\">\r\n                     <a id=\"btn_menu\" class=\"navbar-minimalize\r\n                        minimalize-styl-2\" href=\"#\">\r\n                     <i class=\"fa fa-bars\"></i>\r\n                     </a>\r\n                     <a class=\"navbar-minimalize minimalize-styl-2\"\r\n                        href=\"#\"\r\n                        style=\"cursor: default; margin-top: 5px;\">\r\n                     <img src=\"/api/content/read/137/analytics_logo.png\" width=\"240px\">\r\n                     </a>\r\n                  </div>\r\n                  <h2 class=\"m-r-sm text-white welcome-message\"\r\n                     style=\"font-size: 24px; font-weight: 500;\">\r\n                     <strong style=\"color:#363636;font-size: 30px\">Portal Analytics</strong>\r\n                  </h2>\r\n                  <ul class=\"nav navbar-top-links navbar-right\">\r\n                     <li>\r\n                        <span class=\"m-r-sm text-muted\r\n                           welcome-message\">\r\n                        <img src=\"/api/content/read/137/logo_algartelecom.png\" height=\"50px\">\r\n                        </span>\r\n                     </li>\r\n                  </ul>\r\n               </nav>\r\n            </div>\r\n            <div id=\"aviso_confidencial\">&#60;&#60;&#60;\r\n               AS INFORMAÇÕES PUBLICADAS NESTE PORTAL SÃO CONFIDENCIAIS E NÃO PODEM SER DIVULGADAS NEM REPRODUZIDAS.\r\n               &#62;&#62;&#62;\r\n            </div>\r\n         </div>\r\n         <!-- Fim Cabeçalho -->\r\n         <!-- Ínicio Área Filtros -->\r\n         <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-7\" style=\"margin-top: 50px;\">\r\n               <ol class=\"breadcrumb\">\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Indicadores</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Transformação</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item active\">\r\n                     <a>Desempenho de Projetos</a>\r\n                  </li>\r\n               </ol>\r\n            </div>\r\n            <div class=\"col-lg-3\">\r\n               <div class=\"title-action\">\r\n                  <h2>\r\n                     <i id=\"limpar_filtro\" class=\"text-muted fa fa-refresh\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Limpar Filtros\" style=\"cursor: pointer;\"></i> \r\n                     <i id=\"filtrar\"\r\n                        class=\"text-muted fa fa-filter\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Filtros\"\r\n                        style=\"cursor: pointer;\"></i>\r\n                  </h2>\r\n               </div>\r\n            </div>\r\n            <div class=\"col-lg-2\">\r\n            </div>\r\n         </div>\r\n         <!-- Ínicio Área Filtros -->\r\n         <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!-- Ínicio \"Seção 1\" -->\r\n            <div class=\"row\">\r\n               <!-- Ínicio \"Gráfico 1\" -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5>\r\n                           Desempenho de Projetos (Mês Atual)\r\n                        </h5>\r\n                        <div class=\"row\">\r\n                            <div class=\"ibox-content col-lg-12\">\r\n                                <div>\r\n                                    <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                    <div id=\"chart1\"></div>\r\n                                </div>\r\n                            </div>\r\n                            <!-- <div class=\"ibox-content col-lg-6\">\r\n                                <div>\r\n                                    <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                    <div id=\"chart2\"></div>\r\n                                </div>\r\n                            </div> -->\r\n                        </div>\r\n                        \r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Gráfico 1\" -->\r\n               <!-- Ínicio \"Insights 1\" -->\r\n            </div>\r\n            <div class=\"row\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox insight_classe\">\r\n                     <div class=\"ibox-title\">\r\n                        <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                     </div>\r\n                     \r\n                     <div class=\"ibox-content\">\r\n                        <ul id=\"result_insights_csl\">\r\n                        </ul>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Insights 1\" -->\r\n            </div>\r\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\r\n            <div class=\"ibox-content\" style=\"text-align: center;\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_sgm\" class=\"btn btn-white\">Abertura BU/VP</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 2\" -->\r\n            <div id=\"abertura_sgm\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" BU -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                      \r\n                           <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-31\">SERVB</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-51\">SERVC</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-71\">INFRACO</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-81\">SERV TIC/IOT</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-41\">VPE</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-21\">VPF</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-61\">VPG</a></li>\r\n                           <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-11\">VPT</a></li>\r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio VPT -->\r\n                        <div role=\"tabpanel\" id=\"tab-11\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart3\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                       <!-- <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart4\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPT\" -->\r\n                                 <!-- Ínicio \"Insights VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPT\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPT -->\r\n                        <!-- Ínicio VPF -->\r\n                        <div role=\"tabpanel\" id=\"tab-21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPF\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart5\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                       <!-- <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart6\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPF\" -->\r\n                                 <!-- Ínicio \"Insights VPF\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPF\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPF -->\r\n                        <!-- Ínicio SERVB -->\r\n                        <div role=\"tabpanel\" id=\"tab-31\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart7\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                      <!--  <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart8\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico SERVB\" -->\r\n                                 <!-- Ínicio \"Insights SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights SERVB\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVB -->\r\n                        <!-- Ínicio VPE -->\r\n                        <div role=\"tabpanel\" id=\"tab-41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart9\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                      <!--  <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart10\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPE\" -->\r\n                                 <!-- Ínicio \"Insights VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPE\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPE -->\r\n                        <!-- Ínicio SERVC -->\r\n                        <div role=\"tabpanel\" id=\"tab-51\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart11\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <!-- <div class=\"ibox-content col-lg-6\">\r\n                                             <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart12\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico SERVC\" -->\r\n                                 <!-- Ínicio \"Insights SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights SERVC\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVC -->\r\n                        \r\n                        \r\n                        \r\n                         <!-- Ínicio SERV TIC/IOT -->\r\n                        <div role=\"tabpanel\" id=\"tab-81\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERV TIC/IOT \" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart17\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <!-- <div class=\"ibox-content col-lg-6\">\r\n                                             <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart12\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico SERV TIC/IOT \" -->\r\n                                 <!-- Ínicio \"Insights SERV TIC/IOT \" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights SERV TIC/IOT \" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERV TIC/IOT -->\r\n                        <!-- Ínicio VPG -->\r\n                        <div role=\"tabpanel\" id=\"tab-61\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart13\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                      <!--   <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart14\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPG\" -->\r\n                                 <!-- Ínicio \"Insights VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPG\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPG -->\r\n                        <!-- Ínicio INFRACO -->\r\n                        <div role=\"tabpanel\" id=\"tab-71\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-12\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart15\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <!-- <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart16\"></div>\r\n                                            </div>\r\n                                        </div> -->\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico INFRACO\" -->\r\n                                 <!-- Ínicio \"Insights INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights INFRACO\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim INFRACO -->\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" BU -->\r\n            </div>\r\n            <!-- Fim \"Seção 2\" -->\r\n            <div id=\"pai_btn_exp_hrq\" class=\"ibox-content\" style=\"text-align: center; display: none\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_hrq\" class=\"btn btn-white\">Abertura Hierarquia</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 3\" -->\r\n            <div id=\"abertura_hrq\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" Abertura -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                         <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-h31\">SERVB</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h51\">SERVC</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h71\">INFRACO</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h81\">SERV TIC/IOT</a></li>\r\n                         <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h41\">VPE</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h21\">VPF</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h61\">VPG</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h11\">VPT</a></li>\r\n                        \r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio VPT -->\r\n                        <div role=\"tabpanel\" id=\"tab-h11\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                        <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPT' %}\r\n                                    <tr style=\"padding:0\">\r\n                                       <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                     <!--    <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPT -->\r\n                        <!-- Ínicio VPF -->\r\n                        <div role=\"tabpanel\" id=\"tab-h21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPF \" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                      <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPF' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                      <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPF -->\r\n                        <!-- Ínicio SERVB -->\r\n                        <div role=\"tabpanel\" id=\"tab-h31\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                           <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'SERVB' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                           <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVB -->\r\n                        <!-- Ínicio VPE -->\r\n                        <div role=\"tabpanel\" id=\"tab-h41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                        <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPE' %}\r\n                                    <tr style=\"padding:0\">\r\n                                         <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                           <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPE -->\r\n                        <!-- Ínicio SERVC -->\r\n                        <div role=\"tabpanel\" id=\"tab-h51\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                     <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'SERVC' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVC -->\r\n                        <!-- Ínicio VPG -->\r\n                        <div role=\"tabpanel\" id=\"tab-h61\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                      <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                           <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'VPG' %}\r\n                                    <tr style=\"padding:0\">\r\n                                         <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPG -->\r\n                        <!-- Ínicio INFRACO -->\r\n                        <div role=\"tabpanel\" id=\"tab-h71\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                             <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                          <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'INFRACO' %}\r\n                                    <tr style=\"padding:0\">\r\n                                        <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim INFRACO -->\r\n                        \r\n                          <!-- Ínicio Serv TIC/IOT -->\r\n                        <div role=\"tabpanel\" id=\"tab-h81\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico Serv TIC/IOT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                             <div class=\"ibox-content\">\r\n                                           <div class=\"table-responsive\">\r\n\r\n                            <table id=\"mesNao\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n\r\n                                <thead style=\"padding:0\">\r\n                                    <tr style=\"padding:0\">\r\n                                       <th class=\"sticky\">Projeto</th>\r\n                                        <th class=\"sticky\">Progresso</th>\r\n                                        <th>Responsável</th>\r\n                                        <th>Sub Programa</th>\r\n                                        <th>BU</th>\r\n                                        <!--    <th>Data Fim</th> -->\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody id=\"dados_help\" style=\"padding:0\">\r\n\r\n\r\n                                    {% for item in tmp_projetos_detalhado %}\r\n                                        {% if item.BU  == 'Serv TIC/IOT' %}\r\n                                    <tr style=\"padding:0\">\r\n                                         <td>{{ item.PROJETO }}</td>\r\n                                        <td>{{ item.PROGRESSO }}</td>\r\n                                         <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                         <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                         <td>{{ item.BU }}</td>\r\n                                          <!--   <td>{{ item.DAT_FIM_PRJ }}</td> -->\r\n                                        \r\n\r\n                                    </tr>\r\n                                       {% else %}\r\n                                       {% endif %}\r\n                                   {% endfor %}\r\n\r\n\r\n\r\n                                </tbody>\r\n\r\n\r\n                            </table>\r\n                        </div>\r\n                                           \r\n                                           \r\n                                          \r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim Serv TIC/IOT -->\r\n                        \r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Abertura -->\r\n            </div>\r\n            <!-- Fim \"Seção 3\" -->\r\n         </div>\r\n      </div>\r\n      <!-- Fim conteúdo -->\r\n   </div>\r\n   <!-- Mainly scripts -->\r\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\r\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\r\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\r\n   <!-- Custom and plugin javascript -->\r\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\r\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\r\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\r\n   <script src=\"/api/content/read/118/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/130/dataTables.bootstrap4.min.js\"></script>\r\n   <script>\r\n\r\n        $(document).ready(function() {\r\n            $('.dataTables-example').DataTable({\r\n                pageLength: 10,\r\n                responsive: true,\r\n                dom: '<\"html5buttons\"B>lTfgitp',\r\n                buttons: [],\r\n                columnDefs: [{\r\n                    targets: [0], // Índice da coluna a ser classificada\r\n                    type: 'currency', // Tipo de classificação personalizada\r\n                    render: function (data, type, row) {\r\n                        if (type === 'sort') {\r\n                            // Remove o símbolo \"R$\" e os separadores de milhar e decimal para classificação\r\n                            return data.replace(/[^0-9.-]/g, '');\r\n                        }\r\n                        return data; // Mantém o formato original para exibição\r\n                    }\r\n                },\r\n                    {\r\n                        targets: 'no-sort',\r\n                        orderable: false\r\n                    }],\r\n                language: {\r\n                    decimal: ',',\r\n                    thousands: '.',\r\n                    currency: {\r\n                        symbol: 'R$'\r\n                    }\r\n                }\r\n            });\r\n        });\r\n</script>\r\n   \r\n   <script>\r\n      // Função criada para inserir tempo de espera entre execuções\r\n          function sleep(ms) {\r\n                return new Promise(resolve => setTimeout(resolve, ms));\r\n             };\r\n             \r\n          async function carregando() {\r\n      \t  var carrega = document.getElementById(\"carregando\");\r\n                  carrega.style.display = \"block\";\r\n                  await sleep(10000);\r\n                  carrega.style.display = \"none\";\r\n                  \r\n              };  \r\n              \r\n      var base_ctt = 'teste';\r\n      \r\n      {% if params.prm_indicador == 'Base de Contratos' %}\r\n        base_ctt = ' Mensal - ' + context.params.ProdutoBaseContrato;\r\n        console.log(base_ctt);\r\n      {% else %}\r\n        base_ctt = ''\r\n      {% endif %}\r\n      \r\n      \r\n      var dadosNLP = Array(0);\r\n      var insights_final = Array(0);\r\n      \r\n      fetch('https://gaio.algartelecom.com.br/api/rest/pnaVxMEfqPVKHAzwmBbkkeB_wtmUQqJh/tmp_hom_processa_nlp/?filtro_api_id_nlp=all_')\r\n      .then(response => {\r\n        return response.json();\r\n      })\r\n      .then(data => {\r\n        dadosNLP = data;\r\n      \r\n      });\r\n      \r\n      let dia_um = 0;\r\n      \r\n      if(context.params.dia_mes == 1){\r\n        dia_um = 1;\r\n      }\r\n        \r\n      \r\n      \r\n      \r\n      \r\n      (async () => {\r\n        await sleep(4000);\r\n        \r\n        \r\n        \r\n        for (var i = 0; i < dadosNLP.length; i++) {\r\n            switch (dadosNLP[i].id_insight.substring(0, 2)) {\r\n              case '10':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_csl').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '20':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_crp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '21':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_emp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                } \r\n                break;\r\n              case '22':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_res').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '23':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_ope').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                    \r\n                break;\r\n              default:\r\n                console.log('Erro.');\r\n            }\r\n            \r\n            \r\n            \r\n            \r\n        }\r\n      \r\n      })();\r\n             \r\n        // Botão que leva ao indicador Venda Consolidado\r\n        $(\"#item_menu_venda_consolidada\").click(async function() {\r\n                  \r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(5000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n        });     \r\n             \r\n       // Botão que leva ao Menu\r\n        $(\"#side-bar-menu\").click(async function() {\r\n      \t// Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['all_'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                           await carregando();\r\n                  await sleep(5000);\r\n                  await dispatchEvent({ formFlowId: 1808, formType: 'openFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: 'all_' }]});\r\n              });\r\n       \r\n        // Botão que leva ao indicador Base de Contratos\r\n        $(\"#item_menu_base_contrato\").click(async function() {\r\n      \t  // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });  \r\n              });\r\n        \r\n        \r\n              \r\n              // Botão que leva ao indicador Base de Clientes\r\n              $(\"#item_menu_base_cliente\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                           { paramName:'insights', paramValue: 'all_' },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n      \t  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] }); \r\n             \r\n              });\r\n      \r\n        // Botão que leva ao indicador Ticket Medio\r\n              $(\"#item_menu_faturamento\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             \r\n              });\r\n              \r\n              \r\n               // Botão que leva ao indicador Ebit\r\n             $(\"#item_menu_ebit\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n           \r\n      \r\n              \r\n                // Botão que leva ao indicador Ebitda\r\n             $(\"#item_menu_ebitda\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n                // Botão que leva ao indicador Margem Contribuição\r\n             $(\"#item_menu_margem_contribuicao\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Margem Contribuição Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n               //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_receita-bruta\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Bruta Mensal','Receita Bruta'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             }); \r\n              \r\n              \r\n              \r\n                //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_receita-liquida\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             }); \r\n              \r\n              \r\n              \r\n              \r\n             // Botão que leva ao indicador Perda de Receita\r\n             $(\"#item_menu_perda_receita\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n                // Botão que leva ao indicador Desempenho Projetos\r\n             $(\"#item_menu_desempenho_projeto\").click(async function() {\r\n                 \r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3400, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n              \r\n        $(\"#btn_exp_sgm\").click(function() {\r\n           var secao2 = document.getElementById(\"abertura_sgm\");\r\n           var secao3 = document.getElementById(\"abertura_hrq\");\r\n           var btn_sgm = document.getElementById(\"btn_exp_sgm\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           var pai_btn_hrq = document.getElementById(\"pai_btn_exp_hrq\");\r\n           if (secao2.style.display === \"none\") {\r\n           \tsecao2.style.display = \"block\";\r\n           \tpai_btn_hrq.style.display = \"block\";\r\n           \tbtn_sgm.innerHTML = \"Esconder BU/VP\";\r\n           } else {\r\n           \tsecao2.style.display = \"none\";\r\n           \tbtn_sgm.innerHTML = \"Abertura Segmento\";\r\n           \tpai_btn_hrq.style.display = \"none\";\r\n           \tsecao3.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Detalhado\";\r\n           }\r\n          });\r\n              \r\n                          \r\n                          \r\n             \r\n              \r\n        $(\"#btn_exp_hrq\").click(function() {\r\n           var secao3 = document.getElementById(\"abertura_hrq\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           if (secao3.style.display === \"none\") {\r\n           \tsecao3.style.display = \"block\";\r\n           \tbtn_hrq.innerHTML = \"Esconder Detalhado\";\r\n           } else {\r\n           \tsecao3.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Detalhado\";\r\n           }\r\n          });\r\n              \r\n              \r\n        var options = {\r\n          series: [10, 20, 30, 20, 20],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         \r\n        responsive: [{\r\n          breakpoint: 480,\r\n          options: {\r\n            chart: {\r\n              width: 200\r\n            },\r\n            legend: {\r\n              position: 'bottom',\r\n              labels: ['ATRASADO', 'CONCLUIDO', 'EM ATENÇÃO', 'EM DIA'],\r\n              colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58']\r\n            }\r\n          }\r\n        }]\r\n        };\r\n        \r\n        \r\n        var options_chart1 = {\r\n          series: [{% for item in tmp_projetos_progresso_csl %}\r\n                      {{ item.Valor }},\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.COR }}',\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.COR }}',\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n        labels: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.Categoria }}',\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        \r\n        \r\n        /*var options_chart2 = {\r\n          series: [{% for item in tmp_projetos_risco_csl %}\r\n                      {{ item.Valor }},\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_csl %}\r\n                      '{{ item.Categoria }}',\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n         var options_chart3 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        \r\n         colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n         /*var options_chart4 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        var options_chart5 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPF' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        /*var options_chart6 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPF' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        var options_chart7 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        /*var options_chart8 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        var options_chart9 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPE' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        /*var options_chart10 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPE' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        var options_chart11 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVC' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        /*var options_chart12 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'SERVC' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        var options_chart13 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPG' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        /*var options_chart14 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPG' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        var options_chart15 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        /*var options_chart16 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };*/\r\n        \r\n        \r\n        \r\n        var options_chart17 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVTIC/IOT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n       colors: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVTIC/IOT' %}\r\n                         '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors:[{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVTIC/IOT' %}\r\n                          '{{ item.COR }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },  \r\n        \r\n        \r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVTIC/IOT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n        \r\n\r\n        var chart1 = new ApexCharts(document.querySelector(\"#chart1\"), options);\r\n        chart1.render();\r\n        \r\n        setTimeout(function() {\r\n          chart1.updateOptions(options_chart1)\r\n         }, 1);\r\n        \r\n        /*var chart2 = new ApexCharts(document.querySelector(\"#chart2\"), options);\r\n        chart2.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart2.updateOptions(options_chart2)\r\n         }, 1);\r\n             \r\n        var chart3 = new ApexCharts(document.querySelector(\"#chart3\"), options);\r\n        chart3.render();\r\n        \r\n        setTimeout(function() {\r\n          chart3.updateOptions(options_chart3)\r\n         }, 1);\r\n        \r\n        /*var chart4 = new ApexCharts(document.querySelector(\"#chart4\"), options);\r\n        chart4.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart4.updateOptions(options_chart4)\r\n         }, 1);\r\n        \r\n        var chart5 = new ApexCharts(document.querySelector(\"#chart5\"), options);\r\n        chart5.render();\r\n        \r\n        setTimeout(function() {\r\n          chart5.updateOptions(options_chart5)\r\n         }, 1);\r\n        \r\n        /*var chart6 = new ApexCharts(document.querySelector(\"#chart6\"), options);\r\n        chart6.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart6.updateOptions(options_chart6)\r\n         }, 1);\r\n        \r\n        var chart7 = new ApexCharts(document.querySelector(\"#chart7\"), options);\r\n        chart7.render();\r\n        \r\n        setTimeout(function() {\r\n          chart7.updateOptions(options_chart7)\r\n         }, 1);\r\n        \r\n        /*var chart8 = new ApexCharts(document.querySelector(\"#chart8\"), options);\r\n        chart8.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart8.updateOptions(options_chart8)\r\n         }, 1);\r\n        \r\n        var chart9 = new ApexCharts(document.querySelector(\"#chart9\"), options);\r\n        chart9.render();\r\n        \r\n        setTimeout(function() {\r\n          chart9.updateOptions(options_chart9)\r\n         }, 1);\r\n        \r\n        /*var chart10 = new ApexCharts(document.querySelector(\"#chart10\"), options);\r\n        chart10.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart10.updateOptions(options_chart10)\r\n         }, 1);\r\n        \r\n        var chart11 = new ApexCharts(document.querySelector(\"#chart11\"), options);\r\n        chart11.render();\r\n        \r\n        setTimeout(function() {\r\n          chart11.updateOptions(options_chart11)\r\n         }, 1);\r\n        \r\n        /*var chart12 = new ApexCharts(document.querySelector(\"#chart12\"), options);\r\n        chart12.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart12.updateOptions(options_chart12)\r\n         }, 1);\r\n        \r\n        var chart13 = new ApexCharts(document.querySelector(\"#chart13\"), options);\r\n        chart13.render();\r\n        \r\n        setTimeout(function() {\r\n          chart13.updateOptions(options_chart13)\r\n         }, 1);\r\n        \r\n        /*var chart14 = new ApexCharts(document.querySelector(\"#chart14\"), options);\r\n        chart14.render();*/\r\n        \r\n        setTimeout(function() {\r\n          chart14.updateOptions(options_chart14)\r\n         }, 1);\r\n        \r\n        var chart15 = new ApexCharts(document.querySelector(\"#chart15\"), options);\r\n        chart15.render();\r\n        \r\n        setTimeout(function() {\r\n          chart15.updateOptions(options_chart15)\r\n         }, 1);\r\n        \r\n        /*var chart16 = new ApexCharts(document.querySelector(\"#chart16\"), options);\r\n        chart16.render();\r\n        \r\n        setTimeout(function() {\r\n          chart16.updateOptions(options_chart16)\r\n         }, 1);*/\r\n         \r\n          var chart17 = new ApexCharts(document.querySelector(\"#chart17\"), options);\r\n        chart17.render();\r\n        \r\n        setTimeout(function() {\r\n          chart17.updateOptions(options_chart17)\r\n         }, 1);\r\n         \r\n         \r\n         \r\n        $(\"#filtrar\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'uOlPDr'\r\n               })\r\n         }); \r\n       \r\n   </script>\r\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":-87.49473612750268,"y":566.9960834282014},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true},{"id":"kfeepL","grid":{"h":101,"w":64,"x":0,"y":5,"hidden":true},"type":"report","appId":137,"label":"backup-Desempenho de Projetos","limit":100,"width":1321,"height":601,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":true},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_projetos_progresso_bu","tmp_projetos_progresso_csl","tmp_projetos_risco_csl","tmp_projetos_risco_bu","tmp_projetos_detalhado"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\r\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\r\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\r\n<style>\r\n   #btn_exp_sgm:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #btn_exp_pdt:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #btn_view_mensal:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   }\r\n   #btn_view_diaria:hover {\r\n   color: white;\r\n   background-color: #014C56;\r\n   cursor: pointer;\r\n   text-align: center;\r\n   }\r\n   #logo_analytics {\r\n   width: 70%;\r\n   }\r\n   #btn_menu {\r\n   font-size: 140%;\r\n   color: #FFFFFF;\r\n   }\r\n   .labelDataRefDia{\r\n   display: none;\r\n   }\r\n   \r\n   .hrq_real {\r\n   text-align: right;\r\n   }\r\n   .filtrarMes{\r\n   display: none;\r\n   color: black;\r\n   font-weight: 650;\r\n   text-decoration: underline;\r\n   cursor: pointer;\r\n   color:inherit;\r\n   }\r\n   \r\n   .html5buttons {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0_length, #DataTables_Table_1_length, #DataTables_Table_2_length, #DataTables_Table_3_length {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0_paginate, #DataTables_Table_1_paginate, #DataTables_Table_2_paginate, #DataTables_Table_3_paginate {\r\n   display: none;\r\n   }\r\n   #DataTables_Table_0, #DataTables_Table_1, #DataTables_Table_2, #DataTables_Table_3 {\r\n   width: 100% !important;\r\n   }\r\n   .table.dataTable thead .sorting_asc:after {\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n   width: 24px;\r\n   }\r\n   .table.dataTable thead .sorting_desc:after {\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/decrescente.png\");\r\n   }\r\n   .table.dataTable thead .sorting:after {\r\n   opacity: 0.2;\r\n   content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n   }\r\n   .table table-striped table-bordered table-hover dataTables-example dataTable no-footer {\r\n   width: 100%;\r\n   }\r\n   #result_insights_csl {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_crp {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_emp {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_ope {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #result_insights_res {\r\n   display: block;\r\n   line-height: 1;\r\n   }\r\n   #filtrarMesHrqCrp, #labelDataRefDiaHrqCrp {\r\n   display: block;\r\n   }\r\n   #carregando {\r\n   animation: rodar 1s infinite;\r\n   border: 6px solid #ededed;\r\n   border-radius: 50%;\r\n   border-top-color: #51d4db;\r\n   height: 30px;\r\n   width: 30px;\r\n   position: fixed;\r\n   margin:  25% 50% 0%;\r\n   z-index: 1;\r\n   }\r\n   @keyframes rodar {\r\n   to {\r\n   transform: rotate(1turn);\r\n   }\r\n   }\r\n   .percentual {\r\n   font-weight: 600;\r\n   display: inline-block; \r\n   }\r\n   #aviso_confidencial{\r\n   font-weight: 600;\r\n   font-size: 15px;\r\n   color: #090909;\r\n   margin-top: 15px;\r\n   margin-bottom: 15px;\r\n   border: 2px solid #c22c18;\r\n   text-align: center;\r\n   }\r\n   #abertura_sgm {\r\n   display: none;\r\n   }\r\n   #abertura_hrq {\r\n   display: none;\r\n   }\r\n   .insight_classe {\r\n   display: none;\r\n   }\r\n   .subtitulo_grafico{\r\n       text-align: center;\r\n   }\r\n</style>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<title>Portal Analytics</title>\r\n</head>\r\n<body>\r\n   <div id=\"carregando\" style=\"display: none\"></div>\r\n   <div id=\"wrapper\">\r\n      <!-- Ínicio menu -->\r\n      <nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a onclick=\"get_results()\">\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\"  class=\"active\">\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a onclick=\"get_results()\">\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li>\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a>Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a >Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a onclick=\"get_results()\">\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_atendimento_digital\">\r\n                        <a onclick=\"get_results()\" style=\"color: #676a6c;\"  href=\"https://gaio.algartelecom.com.br/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a >Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\">\r\n                  <a> \r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_margem_contribuicao\">\r\n                        <a onclick=\"get_results()\">Margem Contribuição</a>\r\n                     </li>\r\n                     <li id=\"item_menu_ebit\">\r\n                        <a onclick=\"get_results()\">Ebit</a>\r\n                     </li>\r\n                     <li id=\"item_menu_ebitda\">\r\n                        <a onclick=\"get_results()\">Ebitda</a>\r\n                     </li>\r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita (WIP)</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Bruta (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Líquida (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-ed\">\r\n                  <a>\r\n                  <i class=\"fa fa-cloud-download\"></i>\r\n                  <span class=\"nav-label\">Tecnologia (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_evolucao_digital\">\r\n                        <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_pulse_check\">\r\n                              <a>Data Driven (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_turnover\">\r\n                              <a>Operações automatizadas (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_turnover\">\r\n                              <a>Novos negócios digitais (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_turnover\">\r\n                              <a>Mindset Digital (WIP)</a>\r\n                           </li>\r\n                        </ul>\r\n                  </ul>\r\n               </li>\r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>\r\n      <!-- Fim menu -->\r\n      <!-- Ínicio conteúdo -->\r\n      <div id=\"page-wrapper\" class=\"gray-bg\">\r\n         <div class=\"row border-bottom\">\r\n         </div>\r\n         <!-- Ínicio cabeçalho -->\r\n         <div class=\"col-lg-12 \">\r\n            <div class=\"row \" style=\"height: 86px;\">\r\n               <nav class=\"navbar navbar-static-top\" role=\"navigation\"\r\n                  style=\"margin-bottom: 10px; background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n                  <div class=\"navbar-header\">\r\n                     <a id=\"btn_menu\" class=\"navbar-minimalize\r\n                        minimalize-styl-2\" href=\"#\">\r\n                     <i class=\"fa fa-bars\"></i>\r\n                     </a>\r\n                     <a class=\"navbar-minimalize minimalize-styl-2\"\r\n                        href=\"#\"\r\n                        style=\"cursor: default; margin-top: 5px;\">\r\n                     <img src=\"/api/content/read/137/analytics_logo.png\" width=\"240px\">\r\n                     </a>\r\n                  </div>\r\n                  <h2 class=\"m-r-sm text-white welcome-message\"\r\n                     style=\"font-size: 24px; font-weight: 500;\">\r\n                     <strong style=\"color:#363636;font-size: 30px\">Portal Analytics</strong>\r\n                  </h2>\r\n                  <ul class=\"nav navbar-top-links navbar-right\">\r\n                     <li>\r\n                        <span class=\"m-r-sm text-muted\r\n                           welcome-message\">\r\n                        <img src=\"/api/content/read/137/logo_algartelecom.png\" height=\"50px\">\r\n                        </span>\r\n                     </li>\r\n                  </ul>\r\n               </nav>\r\n            </div>\r\n            <div id=\"aviso_confidencial\">&#60;&#60;&#60;\r\n               AS INFORMAÇÕES PUBLICADAS NESTE PORTAL SÃO CONFIDENCIAIS E NÃO PODEM SER DIVULGADAS NEM REPRODUZIDAS.\r\n               &#62;&#62;&#62;\r\n            </div>\r\n         </div>\r\n         <!-- Fim Cabeçalho -->\r\n         <!-- Ínicio Área Filtros -->\r\n         <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-7\" style=\"margin-top: 50px;\">\r\n               <ol class=\"breadcrumb\">\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Indicadores</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Transformação</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item active\">\r\n                     <a>Desempenho de Projetos</a>\r\n                  </li>\r\n               </ol>\r\n            </div>\r\n            <div class=\"col-lg-3\">\r\n               <div class=\"title-action\">\r\n                  <h2>\r\n                     <i id=\"limpar_filtro\" class=\"text-muted fa fa-refresh\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Limpar Filtros\" style=\"cursor: pointer;\"></i> \r\n                     <i id=\"filtrar\"\r\n                        class=\"text-muted fa fa-filter\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Filtros\"\r\n                        style=\"cursor: pointer;\"></i>\r\n                  </h2>\r\n               </div>\r\n            </div>\r\n            <div class=\"col-lg-2\">\r\n            </div>\r\n         </div>\r\n         <!-- Ínicio Área Filtros -->\r\n         <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!-- Ínicio \"Seção 1\" -->\r\n            <div class=\"row\">\r\n               <!-- Ínicio \"Gráfico 1\" -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5>\r\n                           Desempenho de Projetos (Mês Atual)\r\n                        </h5>\r\n                        <div class=\"row\">\r\n                            <div class=\"ibox-content col-lg-6\">\r\n                                <div>\r\n                                    <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                    <div id=\"chart1\"></div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"ibox-content col-lg-6\">\r\n                                <div>\r\n                                    <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                    <div id=\"chart2\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Gráfico 1\" -->\r\n               <!-- Ínicio \"Insights 1\" -->\r\n            </div>\r\n            <div class=\"row\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox insight_classe\">\r\n                     <div class=\"ibox-title\">\r\n                        <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                     </div>\r\n                     \r\n                     <div class=\"ibox-content\">\r\n                        <ul id=\"result_insights_csl\">\r\n                        </ul>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Insights 1\" -->\r\n            </div>\r\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\r\n            <div class=\"ibox-content\" style=\"text-align: center;\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_sgm\" class=\"btn btn-white\">Abertura BU/VP</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 2\" -->\r\n            <div id=\"abertura_sgm\" class=\"row\">\r\n               <!-- Ínicio \"Tabs\" BU -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                        <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-11\">VPT</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-21\">VPF</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-31\">SERVB</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-41\">VPE</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-51\">SERVC</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-61\">VPG</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-71\">INFRACO</a></li>\r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio VPT -->\r\n                        <div role=\"tabpanel\" id=\"tab-11\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart3\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart4\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPT\" -->\r\n                                 <!-- Ínicio \"Insights VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPT\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPT -->\r\n                        <!-- Ínicio VPF -->\r\n                        <div role=\"tabpanel\" id=\"tab-21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPF\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart5\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart6\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPF\" -->\r\n                                 <!-- Ínicio \"Insights VPF\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPF\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPF -->\r\n                        <!-- Ínicio SERVB -->\r\n                        <div role=\"tabpanel\" id=\"tab-31\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart7\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart8\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico SERVB\" -->\r\n                                 <!-- Ínicio \"Insights SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights SERVB\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVB -->\r\n                        <!-- Ínicio VPE -->\r\n                        <div role=\"tabpanel\" id=\"tab-41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart9\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart10\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPE\" -->\r\n                                 <!-- Ínicio \"Insights VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPE\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPE -->\r\n                        <!-- Ínicio SERVC -->\r\n                        <div role=\"tabpanel\" id=\"tab-51\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart11\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart12\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico SERVC\" -->\r\n                                 <!-- Ínicio \"Insights SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights SERVC\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVC -->\r\n                        <!-- Ínicio VPG -->\r\n                        <div role=\"tabpanel\" id=\"tab-61\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart13\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart14\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico VPG\" -->\r\n                                 <!-- Ínicio \"Insights VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights VPG\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPG -->\r\n                        <!-- Ínicio INFRACO -->\r\n                        <div role=\"tabpanel\" id=\"tab-71\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"row\">\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Progresso</h2>\r\n                                                <div id=\"chart15\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"ibox-content col-lg-6\">\r\n                                            <div>\r\n                                                <h2 class='subtitulo_grafico'>Risco</h2>\r\n                                                <div id=\"chart16\"></div>\r\n                                            </div>\r\n                                        </div>\r\n                                     </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                              <div class=\"row\">\r\n                                 <!-- Fim \"Gráfico INFRACO\" -->\r\n                                 <!-- Ínicio \"Insights INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox insight_classe\">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <ul id=\"result_insights_crp\">\r\n                                          </ul>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                                 <!-- Fim \"Insights INFRACO\" -->\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim INFRACO -->\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" BU -->\r\n            </div>\r\n            <!-- Fim \"Seção 2\" -->\r\n            <div id=\"pai_btn_exp_hrq\" class=\"ibox-content\" style=\"text-align: center; display: none\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_hrq\" class=\"btn btn-white\">Abertura Hierarquia</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 3\" -->\r\n            <div id=\"abertura_hrq\" class=\"row\">\r\n               <!-- Ínicio \"Tabs\" Abertura -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\">\r\n                        <li><a class=\"nav-link active show\" data-toggle=\"tab\" href=\"#tab-h11\">VPT</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h21\">VPF</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h31\">SERVB</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h41\">VPE</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h51\">SERVC</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h61\">VPG</a></li>\r\n                        <li><a class=\"nav-link\" data-toggle=\"tab\" href=\"#tab-h71\">INFRACO</a></li>\r\n                     </ul>\r\n                     <div class=\"tab-content\">\r\n                        <!-- Ínicio VPT -->\r\n                        <div role=\"tabpanel\" id=\"tab-h11\" class=\"tab-pane active show\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'VPT' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPT -->\r\n                        <!-- Ínicio VPF -->\r\n                        <div role=\"tabpanel\" id=\"tab-h21\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPT\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'VPF' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPF -->\r\n                        <!-- Ínicio SERVB -->\r\n                        <div role=\"tabpanel\" id=\"tab-h31\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVB\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'SERVB' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVB -->\r\n                        <!-- Ínicio VPE -->\r\n                        <div role=\"tabpanel\" id=\"tab-h41\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPE\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'VPE' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPE -->\r\n                        <!-- Ínicio SERVC -->\r\n                        <div role=\"tabpanel\" id=\"tab-h51\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico SERVC\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'SERVC' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim SERVC -->\r\n                        <!-- Ínicio VPG -->\r\n                        <div role=\"tabpanel\" id=\"tab-h61\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico VPG\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'VPG' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim VPG -->\r\n                        <!-- Ínicio INFRACO -->\r\n                        <div role=\"tabpanel\" id=\"tab-h71\" class=\"tab-pane\">\r\n                           <div class=\"panel-body\">\r\n                              <div class=\"row\">\r\n                                 <!-- Ínicio \"Gráfico INFRACO\" -->\r\n                                 <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox \">\r\n                                       <div class=\"ibox-title\">\r\n                                          <h5>\r\n                                             Desempenho de Projetos (Mês Atual)\r\n                                          </h5>\r\n                                       </div>\r\n                                       <div class=\"ibox-content\">\r\n                                          <table class=\"table table-striped table-bordered table-hover dataTables-example\" >\r\n                                             <thead>\r\n                                                <tr>\r\n                                                   <th>\r\n                                                       BU\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Sub-Programa\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Projeto\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Progresso\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Diretoria\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Gerência\r\n                                                   </th>\r\n                                                   <th>\r\n                                                       Coordenação\r\n                                                   </th>\r\n                                                </tr>\r\n                                             </thead>\r\n                                             <tbody>\r\n                                                {% for item in tmp_projetos_detalhado %}\r\n                                                    {% if item.BU  == 'INFRACO' %}\r\n                                                      <tr>\r\n                                                           <td>{{ item.BU }}</td>\r\n                                                           <td>{{ item.PROGRAMA }}</td>\r\n                                                           <td>{{ item.SUB_PROGRAMA }}</td>\r\n                                                           <td>{{ item.PROJETO }}</td>\r\n                                                           <td>{{ item.PROGRESSO }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_1 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_2 }}</td>\r\n                                                           <td>{{ item.HIERARQUIA_3 }}</td>\r\n                                                        </tr>\r\n                                                    {% else %}\r\n                                                    {% endif %}\r\n                                                {% endfor %}\r\n                                             </tbody>\r\n                                          </table>\r\n                                       </div>\r\n                                    </div>\r\n                                 </div>\r\n                              </div>\r\n                           </div>\r\n                        </div>\r\n                        <!-- Fim INFRACO -->\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Abertura -->\r\n            </div>\r\n            <!-- Fim \"Seção 3\" -->\r\n         </div>\r\n      </div>\r\n      <!-- Fim conteúdo -->\r\n   </div>\r\n   <!-- Mainly scripts -->\r\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\r\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\r\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\r\n   <!-- Custom and plugin javascript -->\r\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\r\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\r\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\r\n   <script>\r\n      // Função criada para inserir tempo de espera entre execuções\r\n          function sleep(ms) {\r\n                return new Promise(resolve => setTimeout(resolve, ms));\r\n             };\r\n             \r\n          async function carregando() {\r\n      \t  var carrega = document.getElementById(\"carregando\");\r\n                  carrega.style.display = \"block\";\r\n                  await sleep(10000);\r\n                  carrega.style.display = \"none\";\r\n                  \r\n              };  \r\n              \r\n      var base_ctt = 'teste';\r\n      \r\n      {% if params.prm_indicador == 'Base de Contratos' %}\r\n        base_ctt = ' Mensal - ' + context.params.ProdutoBaseContrato;\r\n        console.log(base_ctt);\r\n      {% else %}\r\n        base_ctt = ''\r\n      {% endif %}\r\n      \r\n      \r\n      var dadosNLP = Array(0);\r\n      var insights_final = Array(0);\r\n      \r\n      fetch('https://gaio.algartelecom.com.br/api/rest/pnaVxMEfqPVKHAzwmBbkkeB_wtmUQqJh/tmp_hom_processa_nlp/?filtro_api_id_nlp=all_')\r\n      .then(response => {\r\n        return response.json();\r\n      })\r\n      .then(data => {\r\n        dadosNLP = data;\r\n      \r\n      });\r\n      \r\n      let dia_um = 0;\r\n      \r\n      if(context.params.dia_mes == 1){\r\n        dia_um = 1;\r\n      }\r\n        \r\n      \r\n      \r\n      \r\n      \r\n      (async () => {\r\n        await sleep(4000);\r\n        \r\n        \r\n        \r\n        for (var i = 0; i < dadosNLP.length; i++) {\r\n            switch (dadosNLP[i].id_insight.substring(0, 2)) {\r\n              case '10':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_csl').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '20':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_crp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '21':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_emp').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                } \r\n                break;\r\n              case '22':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_res').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                break;\r\n              case '23':\r\n                if(dadosNLP[i].metrica.match(context.params.prm_indicador + base_ctt)){\r\n                    const texto = dadosNLP[i].nlp;\r\n                    const percentual = texto.replace(/(\\d+)%/g, '<span class=\"percentual\">$&</span>');\r\n                    const prefixo = percentual.replace(/R\\$\\s?(\\d+)\\s?mil/g, '<span class=\"percentual\">$&</span>');\r\n                    let insight_tratado = prefixo;\r\n                    if(dia_um == 1){\r\n                        insight_tratado = prefixo.replace('mês atual', 'mês anterior');\r\n                    }\r\n                        \r\n                    $('#result_insights_ope').append('<br><li id=\"insight\">' +  insight_tratado + '</li>');\r\n                }\r\n                    \r\n                break;\r\n              default:\r\n                console.log('Erro.');\r\n            }\r\n            \r\n            \r\n            \r\n            \r\n        }\r\n      \r\n      })();\r\n             \r\n        // Botão que leva ao indicador Venda Consolidado\r\n        $(\"#item_menu_venda_consolidada\").click(async function() {\r\n                  \r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(5000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n        });     \r\n             \r\n       // Botão que leva ao Menu\r\n        $(\"#side-bar-menu\").click(async function() {\r\n      \t// Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['all_'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                           await carregando();\r\n                  await sleep(5000);\r\n                  await dispatchEvent({ formFlowId: 1808, formType: 'openFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: 'all_' }]});\r\n              });\r\n       \r\n        // Botão que leva ao indicador Base de Contratos\r\n        $(\"#item_menu_base_contrato\").click(async function() {\r\n      \t  // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });  \r\n              });\r\n        \r\n        \r\n              \r\n              // Botão que leva ao indicador Base de Clientes\r\n              $(\"#item_menu_base_cliente\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                           { paramName:'insights', paramValue: 'all_' },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n      \t  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] }); \r\n             \r\n              });\r\n      \r\n        // Botão que leva ao indicador Ticket Medio\r\n              $(\"#item_menu_faturamento\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             \r\n              });\r\n              \r\n              \r\n               // Botão que leva ao indicador Ebit\r\n             $(\"#item_menu_ebit\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n           \r\n      \r\n              \r\n                // Botão que leva ao indicador Ebitda\r\n             $(\"#item_menu_ebitda\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n                // Botão que leva ao indicador Margem Contribuição\r\n             $(\"#item_menu_margem_contribuicao\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Margem Contribuição Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n               //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_receita-bruta\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Bruta Mensal','Receita Bruta'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             }); \r\n              \r\n              \r\n              \r\n                //  Botão que leva ao indicador Receita Liquida\r\n            $(\"#item_menu_receita-liquida\").click(async function() {\r\n                 await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                 params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                          { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                          { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                 await carregando();\r\n                 await sleep(10000);\r\n                 await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n             }); \r\n              \r\n              \r\n              \r\n              \r\n             // Botão que leva ao indicador Perda de Receita\r\n             $(\"#item_menu_perda_receita\").click(async function() {\r\n                  await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n                  params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                           { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                           { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                  await carregando();\r\n                  await sleep(10000);\r\n                  await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n              });\r\n              \r\n              \r\n              \r\n              \r\n              \r\n              \r\n        \r\n              \r\n                          \r\n                          \r\n             \r\n             \r\n             $(\"#btn_exp_sgm\").click(function() {\r\n               var secao2 = document.getElementById(\"abertura_sgm\");\r\n               var secao3 = document.getElementById(\"abertura_hrq\");\r\n               var btn_sgm = document.getElementById(\"btn_exp_sgm\");\r\n               var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n               var pai_btn_hrq = document.getElementById(\"pai_btn_exp_hrq\");\r\n               if (secao2.style.display === \"none\") {\r\n               \tsecao2.style.display = \"block\";\r\n               \tpai_btn_hrq.style.display = \"block\";\r\n               \tbtn_sgm.innerHTML = \"Esconder BU/VP\";\r\n               } else {\r\n               \tsecao2.style.display = \"none\";\r\n               \tbtn_sgm.innerHTML = \"Abertura BU/VP\";\r\n               \tpai_btn_hrq.style.display = \"none\";\r\n               \tsecao3.style.display = \"none\";\r\n               \tbtn_hrq.innerHTML = \"Abertura Detalhado\";\r\n               }\r\n              });\r\n              \r\n        $(\"#btn_exp_hrq\").click(function() {\r\n           var secao3 = document.getElementById(\"abertura_hrq\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           if (secao3.style.display === \"none\") {\r\n           \tsecao3.style.display = \"block\";\r\n           \tbtn_hrq.innerHTML = \"Esconder Detalhado\";\r\n           } else {\r\n           \tsecao3.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura Detalhado\";\r\n           }\r\n          });\r\n              \r\n              \r\n        var options = {\r\n          series: [10, 20, 30, 20, 20],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         \r\n        responsive: [{\r\n          breakpoint: 480,\r\n          options: {\r\n            chart: {\r\n              width: 200\r\n            },\r\n            legend: {\r\n              position: 'bottom',\r\n              labels: ['ATRASADO', 'CONCLUIDO', 'EM ATENÇÃO', 'EM DIA'],\r\n              colors: ['#ff4e33', '#6489fa', '#ffd633', '#239e58']\r\n            }\r\n          }\r\n        }]\r\n        };\r\n        \r\n        \r\n        var options_chart1 = {\r\n          series: [{% for item in tmp_projetos_progresso_csl %}\r\n                      {{ item.Valor }},\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        colors: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.COR }}',\r\n                    {% endfor %}],\r\n        legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.COR }}',\r\n                    {% endfor %}],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n        labels: [{% for item in tmp_projetos_progresso_csl %}\r\n                      '{{ item.Categoria }}',\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart2 = {\r\n          series: [{% for item in tmp_projetos_risco_csl %}\r\n                      {{ item.Valor }},\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_csl %}\r\n                      '{{ item.Categoria }}',\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart3 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart4 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPT' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPT' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart5 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPF' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart6 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPF' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPF' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart7 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart8 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'SERVB' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'SERVB' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart9 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPE' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart10 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPE' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart11 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPE' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPE' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart12 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'SERVC' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'SERVC' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart13 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'VPG' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart14 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'VPG' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'VPG' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart15 = {\r\n          series: [{% for item in tmp_projetos_progresso_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_progresso_bu %}\r\n                      {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n        \r\n        var options_chart16 = {\r\n          series: [{% for item in tmp_projetos_risco_bu %}\r\n                        {% if item.BU  == 'INFRACO' %}\r\n                          {{ item.Valor }},\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n          chart: {\r\n          height: 350,\r\n          type: 'donut',\r\n        },\r\n        labels: [{% for item in tmp_projetos_risco_bu %}\r\n                      {% if item.BU  == 'INFRACO' %}\r\n                          '{{ item.Categoria }}',\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}],\r\n        };\r\n\r\n        var chart1 = new ApexCharts(document.querySelector(\"#chart1\"), options);\r\n        chart1.render();\r\n        \r\n        setTimeout(function() {\r\n          chart1.updateOptions(options_chart1)\r\n         }, 1);\r\n        \r\n        var chart2 = new ApexCharts(document.querySelector(\"#chart2\"), options);\r\n        chart2.render();\r\n        \r\n        setTimeout(function() {\r\n          chart2.updateOptions(options_chart2)\r\n         }, 1);\r\n             \r\n        var chart3 = new ApexCharts(document.querySelector(\"#chart3\"), options);\r\n        chart3.render();\r\n        \r\n        setTimeout(function() {\r\n          chart3.updateOptions(options_chart3)\r\n         }, 1);\r\n        \r\n        var chart4 = new ApexCharts(document.querySelector(\"#chart4\"), options);\r\n        chart4.render();\r\n        \r\n        setTimeout(function() {\r\n          chart4.updateOptions(options_chart4)\r\n         }, 1);\r\n        \r\n        var chart5 = new ApexCharts(document.querySelector(\"#chart5\"), options);\r\n        chart5.render();\r\n        \r\n        setTimeout(function() {\r\n          chart5.updateOptions(options_chart5)\r\n         }, 1);\r\n        \r\n        var chart6 = new ApexCharts(document.querySelector(\"#chart6\"), options);\r\n        chart6.render();\r\n        \r\n        setTimeout(function() {\r\n          chart6.updateOptions(options_chart6)\r\n         }, 1);\r\n        \r\n        var chart7 = new ApexCharts(document.querySelector(\"#chart7\"), options);\r\n        chart7.render();\r\n        \r\n        setTimeout(function() {\r\n          chart7.updateOptions(options_chart7)\r\n         }, 1);\r\n        \r\n        var chart8 = new ApexCharts(document.querySelector(\"#chart8\"), options);\r\n        chart8.render();\r\n        \r\n        setTimeout(function() {\r\n          chart8.updateOptions(options_chart8)\r\n         }, 1);\r\n        \r\n        var chart9 = new ApexCharts(document.querySelector(\"#chart9\"), options);\r\n        chart9.render();\r\n        \r\n        setTimeout(function() {\r\n          chart9.updateOptions(options_chart9)\r\n         }, 1);\r\n        \r\n        var chart10 = new ApexCharts(document.querySelector(\"#chart10\"), options);\r\n        chart10.render();\r\n        \r\n        setTimeout(function() {\r\n          chart10.updateOptions(options_chart10)\r\n         }, 1);\r\n        \r\n        var chart11 = new ApexCharts(document.querySelector(\"#chart11\"), options);\r\n        chart11.render();\r\n        \r\n        setTimeout(function() {\r\n          chart11.updateOptions(options_chart11)\r\n         }, 1);\r\n        \r\n        var chart12 = new ApexCharts(document.querySelector(\"#chart12\"), options);\r\n        chart12.render();\r\n        \r\n        setTimeout(function() {\r\n          chart12.updateOptions(options_chart12)\r\n         }, 1);\r\n        \r\n        var chart13 = new ApexCharts(document.querySelector(\"#chart13\"), options);\r\n        chart13.render();\r\n        \r\n        setTimeout(function() {\r\n          chart13.updateOptions(options_chart13)\r\n         }, 1);\r\n        \r\n        var chart14 = new ApexCharts(document.querySelector(\"#chart14\"), options);\r\n        chart14.render();\r\n        \r\n        setTimeout(function() {\r\n          chart14.updateOptions(options_chart14)\r\n         }, 1);\r\n        \r\n        var chart15 = new ApexCharts(document.querySelector(\"#chart15\"), options);\r\n        chart15.render();\r\n        \r\n        setTimeout(function() {\r\n          chart15.updateOptions(options_chart15)\r\n         }, 1);\r\n        \r\n        var chart16 = new ApexCharts(document.querySelector(\"#chart16\"), options);\r\n        chart16.render();\r\n        \r\n        setTimeout(function() {\r\n          chart16.updateOptions(options_chart16)\r\n         }, 1);\r\n       \r\n   </script>\r\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":101.50012533029758,"y":565.9968980751355},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true},{"id":"slYcpf","type":"table","appId":137,"label":"DEPARA_COR_STATUS","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-90.01887180390935,"y":141.00660880292554},"sourceId":null,"tableName":"DEPARA_COR_STATUS","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cdcCvu","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"aux_base_desempenho_projetos","id":"WBcGLP","to":"DEPARA_COR_STATUS","raw":"","list":[{"id":"TqYAPU","andOr":"and","tableBy":"aux_base_desempenho_projetos","tableTo":"DEPARA_COR_STATUS","columnBy":"STA_ATS","columnTo":"STATUS","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"zimmJO","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"TZlmbG","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_base_desempenho_projetos","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"oWUrVH","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"YlyiEN","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"FNQItY","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"ppuAFw","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"NOM_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"newjSl","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"NOM_SUB_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"pZPFuM","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"PROJETO","columnLength":2,"databaseName":"bucket_137"},{"id":"ebiNAQ","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"DSC_TIT_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"BkyIxb","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"DSC_DTL_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"bAOTSY","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"FLG_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"ccdJvC","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"vIPDBc","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"PCN_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"loiPqL","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"STA_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"jPWepn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"DEPARA_COR_STATUS","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"zWjuHW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"DAT_FIM_PRJ","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"zimmJO","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"TZlmbG","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_base_desempenho_projetos","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"oWUrVH","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"YlyiEN","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"FNQItY","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"ppuAFw","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"NOM_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"newjSl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"NOM_SUB_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"pZPFuM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"PROJETO","columnLength":2,"databaseName":"bucket_137"},{"id":"ebiNAQ","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"DSC_TIT_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"BkyIxb","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"DSC_DTL_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"bAOTSY","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"FLG_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"ccdJvC","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"vIPDBc","type":"value","dataType":"Nullable(Int64)","tableName":"aux_base_desempenho_projetos","columnName":"PCN_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"loiPqL","type":"value","dataType":"Nullable(String)","tableName":"aux_base_desempenho_projetos","columnName":"STA_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"jPWepn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"DEPARA_COR_STATUS","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"CqOknp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_base_desempenho_projetos","columnName":"DAT_FIM_PRJ","columnLength":2,"databaseName":"bucket_137"},{"id":"jleUPV","type":"computed","alias":"MesRef","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"MesRef","computedId":"VWbkaa"},{"id":"BVITsn","type":"computed","alias":"MesVisual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"MesVisual","computedId":"MBqEod"}],"update":[],"computed":[{"type":"computed","alias":"MesRef","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"MesRef","computedId":"VWbkaa"},{"type":"computed","alias":"MesVisual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","columnName":"MesVisual","computedId":"MBqEod"}]},"created":false,"optimize":false,"position":{"x":-89.53251923062733,"y":308.9901700273402},"sourceId":null,"tableName":"aux_base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_desempenho_projetos","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ApRyrS","type":"table","appId":137,"label":"base_desempenho_projetos","client":"clickhouse","repoId":1,"shared":false,"position":{"x":85.49984333712803,"y":312.00025066059504},"sourceId":null,"tableName":"base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"vukNbY","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"SfpRhG","type":"value","alias":"BU","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"ZhTEoL","type":"value","alias":"PROGRAMA","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"NOM_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"CjTqpc","type":"value","alias":"SUB_PROGRAMA","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"NOM_SUB_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"HfrAcZ","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"PROJETO","columnLength":2,"databaseName":"bucket_137"},{"id":"TuSXsN","type":"value","alias":"PROGRESSO","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"STA_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"ECadIf","type":"value","alias":"HIERARQUIA_1","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"JxpBhx","type":"value","alias":"HIERARQUIA_2","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"MyGIRd","type":"value","alias":"HIERARQUIA_3","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"oazDho","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DAT_FIM_PRJ","columnLength":2,"databaseName":"bucket_137"}],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"mrnMiv","type":"value","andOr":"and","value":"prm_data_max_projeto","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"base_desempenho_projetos","valueType":"parameter","columnName":"MesRef","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"NKpxMp","type":"value","alias":"BU","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"ZsbMuP","type":"value","alias":"PROGRAMA","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"NOM_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"Lgeeho","type":"value","alias":"SUB_PROGRAMA","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"NOM_SUB_PRG","columnLength":2,"databaseName":"bucket_137"},{"id":"CsorDZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"PROJETO","columnLength":2,"databaseName":"bucket_137"},{"id":"iMpRNi","type":"value","alias":"PROGRESSO","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"STA_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"BVfcZl","type":"value","alias":"HIERARQUIA_1","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"JNZGLX","type":"value","alias":"HIERARQUIA_2","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"sLLTKb","type":"value","alias":"HIERARQUIA_3","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"RNgZWf","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DAT_FIM_PRJ","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":242.99984333712803,"y":431.00025066059504},"sourceId":null,"tableName":"base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_detalhado","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oYnixI","type":"table","appId":137,"label":"tmp_projetos_detalhado","client":"clickhouse","repoId":1,"shared":false,"position":{"x":389.499843337128,"y":431.00025066059504},"sourceId":null,"tableName":"tmp_projetos_detalhado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FXxIXT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"SUZRGA","type":"value","alias":"Categoria","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"STA_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"poAkVb","type":"value","alias":"BU","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"RINpSL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"COR","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"Nvvzie","type":"value","andOr":"and","value":"prm_data_max_projeto","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"base_desempenho_projetos","valueType":"parameter","columnName":"MesRef","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"EhlKix","type":"value","alias":"Categoria","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"STA_ATS","columnLength":2,"databaseName":"bucket_137"},{"id":"spAarT","type":"value","alias":"BU","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"RINpSL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"BGBogC","type":"count","alias":"Valor","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"PROJETO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":242.99984333712803,"y":83.00025066059504},"sourceId":null,"tableName":"base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_progresso","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"VeeKnd","type":"table","appId":137,"label":"tmp_projetos_progresso","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":389.499843337128,"y":83.00025066059504},"sourceId":null,"tableName":"tmp_projetos_progresso","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"lpLiii","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"xiwuiQ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"ysuXdO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"VnDYRZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"COR","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ysuXdO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"VnDYRZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"RtUoTQ","type":"sum","alias":"Valor","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Valor","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":535.999843337128,"y":156.00135212774933},"tableName":"tmp_projetos_progresso","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_progresso_csl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"JjUlAC","type":"table","appId":137,"label":"tmp_projetos_progresso_csl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":702.5005042174206,"y":151.00098497203118},"tableName":"tmp_projetos_progresso_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"WqLHAa","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"dREkrH","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"xFKZcN","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"BU","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"ysuXdO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"FzMfzT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"BU","columnLength":2,"databaseName":"bucket_137"},{"id":"hVBxqb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"COR","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ysuXdO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"EOfXdH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"BU","columnLength":2,"databaseName":"bucket_137"},{"id":"RnpmEm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"RtUoTQ","type":"sum","alias":"Valor","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_projetos_progresso","columnName":"Valor","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":535.999843337128,"y":25.000250660595043},"tableName":"tmp_projetos_progresso","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_progresso_bu","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OEVaes","type":"table","appId":137,"label":"tmp_projetos_progresso_bu","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":693.499843337128,"y":25.000250660595043},"tableName":"tmp_projetos_progresso_bu","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gOfyZf","type":"pivot","appId":137,"label":"Pivot","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"select":[],"limitBy":[]},"shared":false,"columns":[{"Categoria":"ATRASADO","columnName":"ATRASADO","transposeName":"atrasado"},{"Categoria":"EM DIA","columnName":"EM DIA","transposeName":"em_dia"}],"created":false,"position":{"x":694.4998120045536,"y":-106.99561343958564},"tableName":"tmp_projetos_progresso_bu","tableView":false,"temporary":false,"sourceType":"bucket","extraFields":["BU"],"resultTable":"tmp_projetos_progresso_bu_aberto","databaseName":"bucket_137","resultDatabase":"bucket_137","transposeColumn":"Categoria","dynamicTranspose":false,"extraFieldsPosition":"start","transposeAggregator":"sum","transposeColumnValue":"Valor","dynamicTransposeSnakeCase":false},{"id":"OVmBEV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"KzsGnE","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso_bu","columnName":"BU","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"suJkzQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso_bu","columnName":"BU","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"suJkzQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_progresso_bu","columnName":"BU","columnLength":2,"databaseName":"bucket_137"},{"id":"BTPINO","type":"computed","alias":"atrasado","content":"sum(case\nwhen Categoria = 'ATRASADO' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","distinct":false,"columnName":"atrasado","computedId":"rifSZR"},{"id":"rsvUoR","type":"computed","alias":"em_dia","content":"sum(case\nwhen Categoria = 'EM DIA' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","distinct":false,"columnName":"em_dia","computedId":"BCDySr"},{"id":"vfWdXn","type":"computed","alias":"concluido","content":"sum(case\nwhen Categoria = 'CONCLUÍDO' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","distinct":false,"columnName":"concluido","computedId":"eJzTic"},{"id":"ksNQCS","type":"computed","alias":"em_atencao","content":"sum(case\nwhen Categoria = 'EM ATENÇÃO' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","distinct":false,"columnName":"em_atencao","computedId":"eOBwTi"}],"update":[],"computed":[{"type":"computed","alias":"atrasado","content":"sum(case\nwhen Categoria = 'ATRASADO' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","columnName":"atrasado","computedId":"rifSZR"},{"type":"computed","alias":"em_dia","content":"sum(case\nwhen Categoria = 'EM DIA' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","columnName":"em_dia","computedId":"BCDySr"},{"type":"computed","alias":"concluido","content":"sum(case\nwhen Categoria = 'CONCLUÍDO' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","columnName":"concluido","computedId":"eJzTic"},{"type":"computed","alias":"em_atencao","content":"sum(case\nwhen Categoria = 'EM ATENÇÃO' THEN Valor\nELSE 0\nend)","dataType":"Nullable(Int64)","columnName":"em_atencao","computedId":"eOBwTi"}]},"created":false,"optimize":false,"position":{"x":862.4973680637514,"y":23.00234994307914},"tableName":"tmp_projetos_progresso_bu","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_progresso_bu_aberto","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ZtXcZF","type":"table","appId":137,"label":"tmp_projetos_progresso_bu_aberto","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":858.9730853186,"y":-107.99661608196604},"tableName":"tmp_projetos_progresso_bu_aberto","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eCmaiS","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"hcbezE","type":"value","alias":"Categoria","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"FLG_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"poAkVb","type":"value","alias":"BU","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"tcHjBC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"COR","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"OMTzpQ","type":"value","andOr":"and","value":"prm_data_max_projeto","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"base_desempenho_projetos","valueType":"parameter","columnName":"MesRef","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JQWREA","type":"value","alias":"Categoria","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"FLG_RSC_PRB","columnLength":2,"databaseName":"bucket_137"},{"id":"spAarT","type":"value","alias":"BU","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"DSC_TIP","columnLength":2,"databaseName":"bucket_137"},{"id":"NvMOwo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"BGBogC","type":"count","alias":"Valor","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_desempenho_projetos","columnName":"PROJETO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":242.99984333712803,"y":315.00025066059504},"sourceId":null,"tableName":"base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_risco","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XHvpka","type":"table","appId":137,"label":"tmp_projetos_risco","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":389.499843337128,"y":315.00025066059504},"sourceId":null,"tableName":"tmp_projetos_risco","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"aUqOdD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"kYosyc","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_projetos_risco","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"sVPZrL","type":"value","dataType":"Nullable(String)","tableName":"tmp_projetos_risco","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"OwCcJn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"COR","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"PVAOaP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"OwCcJn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"llVuGn","type":"sum","alias":"Valor","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"Valor","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":535.999843337128,"y":257.00025066059504},"tableName":"tmp_projetos_risco","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_risco_csl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XNrPCh","type":"table","appId":137,"label":"tmp_projetos_risco_csl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":693.499843337128,"y":257.00025066059504},"tableName":"tmp_projetos_risco_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"iJVSHE","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"kYosyc","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_projetos_risco","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"cKEHBU","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"BU","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"sVPZrL","type":"value","dataType":"Nullable(String)","tableName":"tmp_projetos_risco","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"FQbWLC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"BU","columnLength":2,"databaseName":"bucket_137"},{"id":"Kzucxc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"COR","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"PVAOaP","type":"value","dataType":"Nullable(String)","tableName":"tmp_projetos_risco","columnName":"Categoria","columnLength":2,"databaseName":"bucket_137"},{"id":"XnNOLg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"BU","columnLength":2,"databaseName":"bucket_137"},{"id":"MsKssA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"COR","columnLength":null,"databaseName":"bucket_137"},{"id":"llVuGn","type":"sum","alias":"Valor","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_projetos_risco","columnName":"Valor","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":535.999843337128,"y":373.00025066059504},"tableName":"tmp_projetos_risco","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_projetos_risco_bu","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WpzeUG","type":"table","appId":137,"label":"tmp_projetos_risco_bu","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":693.499843337128,"y":373.00025066059504},"tableName":"tmp_projetos_risco_bu","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"oqBMKC","source":"XHvpka","target":"aUqOdD"},{"id":"qWBLqq","source":"aUqOdD","target":"XNrPCh"},{"id":"CFVDWb","source":"XHvpka","target":"iJVSHE"},{"id":"MffsdS","source":"iJVSHE","target":"WpzeUG"},{"id":"dwxYAj","source":"VeeKnd","target":"lpLiii"},{"id":"XvsJni","source":"lpLiii","target":"JjUlAC"},{"id":"apymjd","source":"VeeKnd","target":"WqLHAa"},{"id":"rDLoWs","source":"WqLHAa","target":"OEVaes"},{"id":"PoWdny","source":"ApRyrS","target":"FXxIXT"},{"id":"uHFSuP","source":"FXxIXT","target":"VeeKnd"},{"id":"rayVfq","source":"ApRyrS","target":"eCmaiS"},{"id":"Pqbkyr","source":"eCmaiS","target":"XHvpka"},{"id":"kecKZo","source":"OEVaes","target":"gOfyZf"},{"id":"zhmsLj","source":"gOfyZf","target":"ZtXcZF"},{"id":"uEdCwX","source":"OEVaes","target":"OVmBEV"},{"id":"Hhhcyw","source":"OVmBEV","target":"ZtXcZF"},{"id":"omEjUj","source":"hpNPXL","target":"cdcCvu"},{"id":"AkqnBW","source":"slYcpf","target":"cdcCvu"},{"id":"ZPXrNU","source":"cdcCvu","target":"ApRyrS"},{"id":"qjypnR","source":"ApRyrS","target":"vukNbY"},{"id":"OVEGjg","source":"vukNbY","target":"oYnixI"}]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":true,"onDestroy":"resetFlow","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"rALJQiMiwvVkKnrEaHsimGoPpjBiMHYY","flowDescription":"","locked":"no","created":"2023-07-12 11:24:33","updated":"2023-09-15 17:20:32"},{"flowId":"2414","appId":137,"flowName":"CARGA - Forecast de Venda","workflow":{"nodes":[{"id":"KMEZFC","type":"table","appId":137,"label":"forecast_atacado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":24.450091305589893,"y":291.63734682011625},"tableName":"forecast_atacado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jYIGTo","type":"table","appId":137,"label":"base_orcado_raw","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":12.659749364473134,"y":503.8523078966116},"sourceId":null,"tableName":"base_orcado_raw","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OUMIha","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"Nhylwf","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_raw","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"nVpMYf","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"SLdcIK","type":"value","andOr":"and","value":"VENDAS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"base_orcado_raw","valueType":"value","columnName":"metrica","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"XjZggO","type":"value","alias":"","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(Date)","distinct":false,"operator":"=","fieldType":"value","tableName":"base_orcado_raw","valueType":"computed","columnName":"mes_ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"tPuQKT","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"base_orcado_raw","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"jKCFyt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_raw","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"grxRzr","type":"sum","alias":"orcado","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_orcado_raw","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":90.9754005668884,"y":506.0074165455053},"sourceId":null,"tableName":"base_orcado_raw","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_ocd_best","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"RjvFNX","type":"table","appId":137,"label":"tmp_ocd_best","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":168.974519393165,"y":504.00726968321806},"sourceId":null,"tableName":"tmp_ocd_best","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dqlUPL","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":24.05903641395629,"y":188.82783735398468},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wEAxYO","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"bWtQfr","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"QHbkKc","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"kJBXMB","type":"value","andOr":"and","value":"IOT","dataType":"Nullable(String)","operator":"like","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DSC_LNH_NGC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"jeqwGc","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"razgDd","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":111.05913041167942,"y":73.83144060003937},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_forecast_iot","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"KadImx","type":"table","appId":137,"label":"tmp_aux_forecast_iot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":237.05800243900148,"y":74.83140926746498},"sourceId":null,"tableName":"tmp_aux_forecast_iot","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eHzJER","type":"sourceRaw","appId":137,"label":"SQL","query":"select TAB.anomes,\r\n       TAB.DIAS_UTEIS_CORRIDOS,\r\n       'RESIDENCIAL' AS SEGMENTO,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0.5 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'MM') AS anomes,\r\n             SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0.5 \r\n                      WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                      ELSE 1 \r\n                 END) AS DIAS_UTEIS_CORRIDOS\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n     \tAND trunc(A.dat_dia, 'mm') = trunc(sysdate-1,'mm')\r\n        and A.dat_dia <= sysdate-1\r\n        and a.dsc_frd like 'DIA %TIL'\r\n      GROUP BY TRUNC(DAT_DIA,'MM')) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'mm') = tab.anomes\r\n  AND a.dsc_frd like 'DIA %TIL'\r\nGROUP BY TAB.anomes,\r\n         TAB.DIAS_UTEIS_CORRIDOS\r\nUNION ALL \r\nselect TAB.anomes,\r\n       TAB.DIAS_UTEIS_CORRIDOS,\r\n       'EMPRESARIAL' AS SEGMENTO,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'MM') AS anomes,\r\n             SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                      WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                      ELSE 1 \r\n                 END) AS DIAS_UTEIS_CORRIDOS\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n     \tAND trunc(A.dat_dia, 'mm') = trunc(sysdate-1,'mm')\r\n        and A.dat_dia <= sysdate-1\r\n        and a.dsc_frd like 'DIA %TIL'\r\n      GROUP BY TRUNC(DAT_DIA,'MM')) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'mm') = tab.anomes\r\n  AND a.dsc_frd like 'DIA %TIL'\r\nGROUP BY TAB.anomes,\r\n         TAB.DIAS_UTEIS_CORRIDOS","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":24.535334933611058,"y":378.46466506638893},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"resultTable":"tmp_dias_uteis","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"mPhrmB","type":"table","appId":137,"label":"tmp_dias_uteis","client":"clickhouse","repoId":1,"shared":false,"position":{"x":180.00029372457448,"y":381},"sourceId":7,"tableName":"tmp_dias_uteis","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dFgSTJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"LyntyN","to":"tmp_dias_uteis","raw":"","list":[{"id":"ieAPpS","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"tmp_dias_uteis","columnBy":"DATA_REF","columnTo":"ANOMES","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"STrblH","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"tmp_dias_uteis","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"IND_SAP_PLANEJAMENTO","id":"jKZSzV","to":"tmp_ocd_best","raw":"","list":[{"id":"ugqppv","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"tmp_ocd_best","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"IND_SAP_PLANEJAMENTO","id":"sGIXSs","to":"forecast_atacado","raw":"","list":[{"id":"MxQMGM","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"forecast_atacado","columnBy":"DATA_REF","columnTo":"MesRef","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"vmZJfx","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"forecast_atacado","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"nbLyTV","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"bBMadN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"tCyAdE","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_dias_uteis","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"IxSumh","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_dias_uteis","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"PAtBNY","type":"value","andOr":"and","value":"Venda Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"BMMopn","type":"value","alias":"","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","distinct":false,"operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"addDays(addMonths(toStartOfMonth(today()), 1),-1)","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"nbvEnx","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"bBMadN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"DxTXuE","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_dias_uteis","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"gvjptJ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_dias_uteis","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"},{"id":"OCTZmk","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"wKntSR","type":"computed","alias":"FORECAST","content":" (REAL/ DIAS_UTEIS_CORRIDOS)* QTD","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST","computedId":"DupfQf","columnLength":2},{"id":"xtGvED","type":"max","alias":"orcado","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_ocd_best","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"},{"id":"kAQFBh","type":"max","alias":"PrevisaoAtacado","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_atacado","columnName":"PrevisaoAtacado","columnLength":1,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"FORECAST","content":" (REAL/ DIAS_UTEIS_CORRIDOS)* QTD","dataType":"Nullable(Float64)","columnName":"FORECAST","computedId":"DupfQf","columnLength":2}]},"created":false,"optimize":false,"position":{"x":335,"y":323},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_fore_best","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WbKAvw","type":"table","appId":137,"label":"tmp_fore_best","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":455.49999999999994,"y":320.99985313771276},"sourceId":null,"tableName":"tmp_fore_best","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"WpCwXE","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"PhvZZg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fore_best","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"CtjaXx","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fore_best","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"taUIMR","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fore_best","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"LTnXzi","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fore_best","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"},{"id":"DLazSV","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fore_best","columnName":"PrevisaoAtacado","columnLength":1,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"gTsWHr","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fore_best","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"cTCYuc","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fore_best","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"nrQyVx","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fore_best","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"YpMdTJ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_fore_best","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"},{"id":"KbkBel","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fore_best","columnName":"PrevisaoAtacado","columnLength":1,"databaseName":"bucket_137"},{"id":"PZBkjq","type":"computed","alias":"produtividade_diaria_best","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN toFloat64(PrevisaoAtacado)\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)\n    WHEN SEGMENTO = 'OPERADORAS'  THEN toFloat64(PrevisaoAtacado)\n    ELSE 0\nEND","dataType":"Nullable(Float64)","distinct":false,"columnName":"produtividade_diaria_best","computedId":"TKDSit","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"produtividade_diaria_best","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN toFloat64(PrevisaoAtacado)\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)\n    WHEN SEGMENTO = 'OPERADORAS'  THEN toFloat64(PrevisaoAtacado)\n    ELSE 0\nEND","dataType":"Nullable(Float64)","columnName":"produtividade_diaria_best","computedId":"TKDSit","columnLength":2}]},"created":false,"optimize":false,"position":{"x":751.2485715566299,"y":492.2066937030837},"sourceId":null,"tableName":"tmp_fore_best","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_forecast_historica","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NnZWjC","type":"table","appId":137,"label":"tmp_base_forecast_historica","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":866.7794162023432,"y":491.4557865076215},"sourceId":null,"tableName":"tmp_base_forecast_historica","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hnCLUg","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GFhogK","type":"computed","alias":"data","content":"today()","dataType":"Nullable(Date)","distinct":false,"columnName":"data","computedId":"hNKwwm"},{"id":"GJCDqb","type":"computed","alias":"CORPORATIVO","content":"SUM(case \nwhen SEGMENTO = 'CORPORATIVO' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"CORPORATIVO","computedId":"rfIWmf","columnLength":2},{"id":"MaOnnG","type":"computed","alias":"EMPRESARIAL","content":"SUM(case \nwhen SEGMENTO = 'EMPRESARIAL' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"EMPRESARIAL","computedId":"KsdNlq","columnLength":2},{"id":"syjAak","type":"computed","alias":"RESIDENCIAL","content":"SUM(case \nwhen SEGMENTO = 'RESIDENCIAL' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"RESIDENCIAL","computedId":"znomIp","columnLength":2},{"id":"iTUraS","type":"computed","alias":"OPERADORAS","content":"SUM(case \nwhen SEGMENTO = 'OPERADORAS' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"OPERADORAS","computedId":"aeqLvL","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"CORPORATIVO","content":"SUM(case \nwhen SEGMENTO = 'CORPORATIVO' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","columnName":"CORPORATIVO","computedId":"rfIWmf","columnLength":2},{"type":"computed","alias":"EMPRESARIAL","content":"SUM(case \nwhen SEGMENTO = 'EMPRESARIAL' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","columnName":"EMPRESARIAL","computedId":"KsdNlq","columnLength":2},{"type":"computed","alias":"RESIDENCIAL","content":"SUM(case \nwhen SEGMENTO = 'RESIDENCIAL' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","columnName":"RESIDENCIAL","computedId":"znomIp","columnLength":2},{"type":"computed","alias":"OPERADORAS","content":"SUM(case \nwhen SEGMENTO = 'OPERADORAS' THEN produtividade_diaria_best\nELSE 0 END)","dataType":"Nullable(Float64)","columnName":"OPERADORAS","computedId":"aeqLvL","columnLength":2},{"type":"computed","alias":"data","content":"today()","dataType":"Nullable(Date)","columnName":"data","computedId":"hNKwwm"}]},"created":false,"optimize":false,"position":{"x":979.3066320662078,"y":493.708508094008},"sourceId":null,"tableName":"tmp_base_forecast_historica","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"aux_forecast_hist","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"tddrCd","type":"table","appId":137,"label":"aux_forecast_hist","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1064.8011888934352,"y":495.9612296803945},"sourceId":null,"tableName":"aux_forecast_hist","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UaTcQW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VcXpeV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fore_best","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"bwsSRU","type":"computed","alias":"VENDA_FORECAST","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND","dataType":"Nullable(Int64)","distinct":false,"columnName":"VENDA_FORECAST","computedId":"zBOOOh","columnLength":2},{"id":"rjoGLC","type":"computed","alias":"percentual_orcado","content":"round(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND/orcado*100,0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"percentual_orcado","computedId":"XsMhfw"}],"update":[],"computed":[{"type":"computed","alias":"VENDA_FORECAST","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND","dataType":"Nullable(Int64)","columnName":"VENDA_FORECAST","computedId":"zBOOOh","columnLength":2},{"type":"computed","alias":"percentual_orcado","content":"round(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND/orcado*100,0)","dataType":"Nullable(Int64)","columnName":"percentual_orcado","computedId":"XsMhfw"}]},"created":false,"optimize":false,"position":{"x":556.5008077425798,"y":323},"sourceId":null,"tableName":"tmp_fore_best","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tbl_vnd_forecast_best","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OBQdny","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AHzBBX","type":"computed","alias":"TOTAL","content":"'CONSOLIDADO'","dataType":"Nullable(String)","distinct":false,"columnName":"TOTAL","computedId":"TeNtUB"},{"id":"qbhucR","type":"computed","alias":"VENDA_FORECAST","content":"SUM(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"VENDA_FORECAST","computedId":"BPvIRv","columnLength":2},{"id":"NRPMqu","type":"computed","alias":"percentual_orcado","content":"round(sum(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND)/sum(orcado)*100,0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"percentual_orcado","computedId":"ICrCEz"}],"update":[],"computed":[{"type":"computed","alias":"TOTAL","content":"'CONSOLIDADO'","dataType":"Nullable(String)","columnName":"TOTAL","computedId":"TeNtUB"},{"type":"computed","alias":"VENDA_FORECAST","content":"SUM(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND)","dataType":"Nullable(Int64)","columnName":"VENDA_FORECAST","computedId":"BPvIRv","columnLength":2},{"type":"computed","alias":"percentual_orcado","content":"round(sum(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND)/sum(orcado)*100,0)","dataType":"Nullable(Int64)","columnName":"percentual_orcado","computedId":"ICrCEz"}]},"created":false,"optimize":false,"position":{"x":556.5008077425798,"y":195.9906742447606},"sourceId":null,"tableName":"tmp_fore_best","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_fore_csl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"PFJkIl","type":"table","appId":137,"label":"tmp_fore_csl","client":"clickhouse","repoId":1,"shared":false,"position":{"x":648.3857385041047,"y":197.69614803350217},"sourceId":null,"tableName":"tmp_fore_csl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"CnLKWM","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_fore_csl","columnName":"TOTAL","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Int64)","tableName":"tmp_fore_csl","columnName":"VENDA_FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"VENDA_FORECAST"},{"dataType":"Nullable(Int64)","tableName":"tmp_fore_csl","columnName":"percentual_orcado","columnLength":null,"databaseName":"bucket_137","targetColumn":"percentual_orcado"}]},"shared":false,"created":false,"position":{"x":740.5011748982979,"y":194.99427237079783},"sourceId":null,"tableName":"tmp_fore_csl","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tbl_vnd_forecast_best","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"JlbiAB","type":"table","appId":137,"label":"tbl_vnd_forecast_best","client":"clickhouse","repoId":1,"shared":false,"position":{"x":745.3892306230616,"y":319.6472890552062},"sourceId":null,"tableName":"tbl_vnd_forecast_best","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jvCcUG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HNUGjd","type":"computed","alias":"TIP_MTC","content":"'Forecast Vendas'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"UsfGSt"},{"id":"MpzJEZ","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_fore_best","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"HvnjeT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_fore_best","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"nPKISh","type":"computed","alias":"FORECAST_VENDA","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_VENDA","computedId":"VNMhIC","columnLength":2},{"id":"GPeRYU","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_fore_best","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"FORECAST_VENDA","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS' THEN PrevisaoAtacado/1\n    ELSE 0\nEND","dataType":"Nullable(Int64)","columnName":"FORECAST_VENDA","computedId":"VNMhIC","columnLength":2},{"type":"computed","alias":"TIP_MTC","content":"'Forecast Vendas'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"UsfGSt"}]},"created":false,"optimize":false,"position":{"x":456.4934646282179,"y":455.0096929109574},"sourceId":null,"tableName":"tmp_fore_best","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"TEAIZP","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"ozHzeK","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_fore_best","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HNUGjd","type":"computed","alias":"TIP_MTC","content":"'Forecast Vendas'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"UsfGSt"},{"id":"ozHzeK","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"tmp_fore_best","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"TWSUUC","type":"computed","alias":"SEGMENTO_NOVO","content":"'CONSOLIDADO'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_NOVO","computedId":"nEwZIY"},{"id":"nPKISh","type":"computed","alias":"FORECAST_VENDA","content":"SUM(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS'  THEN PrevisaoAtacado/1\n    ELSE 0\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_VENDA","computedId":"VNMhIC","columnLength":2},{"id":"GPeRYU","type":"sum","alias":"orcado","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_fore_best","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"FORECAST_VENDA","content":"SUM(CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN PrevisaoAtacado/1\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\n    WHEN SEGMENTO = 'OPERADORAS'  THEN PrevisaoAtacado/1\n    ELSE 0\nEND)","dataType":"Nullable(Int64)","columnName":"FORECAST_VENDA","computedId":"VNMhIC","columnLength":2},{"type":"computed","alias":"TIP_MTC","content":"'Forecast Vendas'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"UsfGSt"},{"type":"computed","alias":"SEGMENTO_NOVO","content":"'CONSOLIDADO'","dataType":"Nullable(String)","columnName":"SEGMENTO_NOVO","computedId":"nEwZIY"}]},"created":false,"optimize":false,"position":{"x":338.4847997532716,"y":453.00771027007966},"sourceId":null,"tableName":"tmp_fore_best","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_insight_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"YrJRzY","type":"table","appId":137,"label":"tmp_forecast_insight_aux","client":"clickhouse","repoId":1,"shared":false,"position":{"x":455.4867823941489,"y":570.0163017138829},"sourceId":null,"tableName":"tmp_forecast_insight_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"xUviaC","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_forecast_insight_aux","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"tmp_forecast_insight_aux","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"tmp_forecast_insight_aux","columnName":"SEGMENTO_NOVO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Int64)","tableName":"tmp_forecast_insight_aux","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(Int64)","tableName":"tmp_forecast_insight_aux","columnName":"orcado","columnLength":2,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":560.4893524841756,"y":570.0122630009839},"sourceId":null,"tableName":"tmp_forecast_insight_aux","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"oryEaW","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"position":{"x":563.1163981401949,"y":454.222677062585},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"UGQxiI","source":"wEAxYO","target":"KadImx"},{"id":"UCEzsm","source":"hnCLUg","target":"tddrCd"},{"id":"IhslNM","source":"xUviaC","target":"oryEaW"},{"id":"rScbaQ","type":"manual","label":"","source":"UaTcQW","target":"OBQdny"},{"id":"NhzgZe","source":"PFJkIl","target":"CnLKWM"},{"id":"aivLZh","source":"CnLKWM","target":"JlbiAB"},{"id":"gFfCzY","type":"manual","label":"","source":"jvCcUG","target":"TEAIZP"},{"id":"OLyYEA","source":"YrJRzY","target":"xUviaC"},{"id":"xXCIKC","source":"NnZWjC","target":"hnCLUg"},{"id":"kjCGKH","source":"WbKAvw","target":"WpCwXE"},{"id":"GtjmPC","source":"WpCwXE","target":"NnZWjC"},{"id":"ggVqIE","source":"jYIGTo","target":"OUMIha"},{"id":"TjjWss","source":"OUMIha","target":"RjvFNX"},{"id":"YLWuue","source":"dqlUPL","target":"dFgSTJ"},{"id":"WJqbkQ","source":"mPhrmB","target":"dFgSTJ"},{"id":"qyjEnj","source":"RjvFNX","target":"dFgSTJ"},{"id":"qWApsV","source":"KMEZFC","target":"dFgSTJ"},{"id":"SVwKEO","source":"dFgSTJ","target":"WbKAvw"},{"id":"CepTbF","source":"dqlUPL","target":"wEAxYO"},{"id":"ylpdjD","source":"eHzJER","target":"mPhrmB"},{"id":"sqqhgc","source":"WbKAvw","target":"jvCcUG"},{"id":"QZWwKd","source":"jvCcUG","target":"oryEaW"},{"id":"koegsp","source":"WbKAvw","target":"TEAIZP"},{"id":"NJOvPi","source":"TEAIZP","target":"YrJRzY"},{"id":"HPYTgH","source":"WbKAvw","target":"UaTcQW"},{"id":"HrPsCC","source":"UaTcQW","target":"JlbiAB"},{"id":"TqzObB","source":"WbKAvw","target":"OBQdny"},{"id":"GtrSEc","source":"OBQdny","target":"PFJkIl"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"dGpEUvkmbQDWjfVrE_mSmXAencaAGdrf","flowDescription":"Processo que efetua a carga das informações de Forecast de Vendas","locked":"no","created":"2023-04-13 10:09:23","updated":"2023-09-08 09:08:23"},{"flowId":"3489","appId":137,"flowName":"Highlight 2.01","workflow":{"nodes":[{"id":"gximIv","grid":{"h":123,"w":64,"x":0,"y":0,"hidden":false},"type":"report","appId":137,"label":"Highlight 2.01","limit":100,"width":1473,"height":733,"layout":{"lg":{"h":123,"w":64,"x":0,"y":0,"height":733,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":0,"height":290,"hidden":false}},"tables":["tmp_men_venda","tmp_men_contratos","tmp_men_clientes","tmp_men_churn_fisico","tmp_men_perda_receita","tmp_men_migracoes_entrantes","tmp_men_migracoes_saintes","tmp_men_caixa","tmp_men_receita_liquida","tmp_men_opex","tmp_men_capex","tmp_ticket_medio","tmp_csl_dia","tbl_vnd_forecast_best","tmp_base_highlight_vnd","tmp_highlight_vnd","tmp_base_highlight_prd","tmp_highlight_prd","tmp_recebimento_caixa_mes","tmp_recebimento_caixa_ano","tmp_recebimento_caixa_dia","tmp_recebimento_caixa_plus","tmp_vnd_tic_iot_highlight","base_forecast_highlight_TIC"],"content":" ","created":false,"project":{"html":"<!DOCTYPE html>\r\n<html lang=\"pt-br\">\r\n<head>\r\n    <title>Highlights</title>\r\n    \r\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css\" integrity=\"sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh\" crossorigin=\"anonymous\">\r\n    \r\n    <script src=\"https://code.jquery.com/jquery-3.4.1.slim.min.js\" integrity=\"sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js\" integrity=\"sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js\" integrity=\"sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ\" crossorigin=\"anonymous\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe\" crossorigin=\"anonymous\"></script>\r\n    <meta charset=\"utf-8\">\r\n</head>\r\n<body>\r\n    <div style=\"border:solid;border-color:#50E1BC\">\r\n    \r\n\r\n        <div style=\"background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n            <div class=\"container-fluid\">\r\n                <div class=\"row\">\r\n               \r\n                <div class=\"col-3\" style=\"text-align:left;margin: auto;\">\r\n                    <img\r\n                    src=\"/api/content/read/137/analytics_logo.png\"\r\n                    width=\"148px\">\r\n                </div>\r\n\r\n                <div class=\"col-6\"><h4 style=\"text-align:center; font-size: 30px;margin:auto\">\r\n                    KPI's Corporativos\r\n                    \r\n                    </h4></div>\r\n                \r\n                <div class=\"col-3\" style=\"font-size: 12px;margin: auto; text-align:right\"><img\r\n                        src=\"/api/content/read/137/logo_algartelecom.png\"\r\n                        height=\"40px\"></div>\r\n               \r\n             </div>\r\n            </div>\r\n\r\n\r\n\r\n            \r\n        </div>\r\n\r\n</div>\r\n<div style=\"padding-top:6px\"></div>\r\n<div style=\"border:solid;border-color:#50E1BC\">\r\n    \r\n\r\n        <div style=\"background-image: linear-gradient(#6BE1BC, #6BE1BC);\">\r\n            <div class=\"container-fluid\">\r\n                <div class=\"row\">\r\n               \r\n                <!--<div class=\"col-6\" style=\"text-align:left;margin: auto;\" id=\"dataAtual\"><h5>Atualizado em (D-1): {{params.prm_status_highlight}}</h5></div>\r\n-->\r\n                <div class=\"col-3\"><h4 style=\"text-align:center\"></h4></div>\r\n                <div class=\"col-6\" style=\"text-align:center;margin: auto;\" ><h5 id=\"dataAtual\">Atualização:  {{params.prm_status_highlight}} (indicadores D-1)</h5></div>\r\n\r\n                <div class=\"col-3\" style=\"font-size: 12px;margin: auto;text-align:right\"><p style=\"margin: auto;\">Legenda: \r\n                    <strong style=\"color:green\"> ● </strong> Atingido &nbsp;\r\n                    <strong style=\"color:#EEAD00\"> ● </strong> Desvio &le; 5% &nbsp;\r\n                    <strong style=\"color:red\"> ● </strong> Desvio &ge; 5% </p></div>\r\n               \r\n             </div>\r\n            </div>\r\n\r\n\r\n\r\n            \r\n        </div>\r\n    \r\n        <div class=\"container-fluid\" style=\"padding-top: 6px;\">\r\n\r\n            <div class=\"row\" >\r\n                <div class=\"col-4\" style=\"border-right: solid #50E1BC;\">\r\n                    <div id=\"div-border\">\r\n                    <!--<div style=\"background-image: linear-gradient(#A0E1BC, #A0E1BC);\">-->\r\n                    <div>\r\n                        <h4 style=\"text-align:center;\">Vendas (R$ mil)</h4></div>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-sm w-100\">\r\n                                <table>\r\n                                    <tr>\r\n                                        <td class=\"vlr_real\">{{ (tmp_base_highlight_vnd[0].REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"line-height: 1;\">Real <br> <small> (diário)</small></td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td class=\"vlr_forecast\">{{ (tmp_base_highlight_vnd[0].FORECAST_VENDA_/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"line-height: 1;\">Forecast <br><small>(mensal)</small></td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td class=\"vlr_orcado \">{{ (tmp_base_highlight_vnd[0].ORCADO/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"line-height: 1;\">Orçado <br><small>(mensal)</small></td>\r\n                                    </tr>\r\n                                    <tr>      \r\n                                        {% if tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL >= 100 %}                                  \r\n                                        <td class=\"vlr_forecast_percentual\" style=\"color:green\">{{ (tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n                                        {% elif tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL < 95 %}                                  \r\n                                        <td class=\"vlr_forecast_percentual\" style=\"color:red\">{{ (tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n\r\n                                        {% else %}\r\n                                        <td class=\"vlr_forecast_percentual\" style=\"color:#EEAD00\">{{ (tmp_base_highlight_vnd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n\r\n                                        {% endif %}\r\n                                        <td class=\"label\" style=\"line-height: 1;\">% Orçado<br> <small>(Forecast x Orçado)</small></td>\r\n                                    </tr>\r\n\r\n                                </table>\r\n                            </div>\r\n                            <div class=\"col-sm w-100\">\r\n                                <div id=\"graficoVenda\"></div>\r\n                            </div>\r\n                            \r\n                        </div>\r\n                        <div class=\"container-fluid\">\r\n                            <div class=\"row\">\r\n                        <table class=\"table table-sm\">\r\n                        <thead class=\"table\">\r\n                        <tr>\r\n                        <th scope=\"col\"></th>\r\n                        <th scope=\"col\" style=\"text-align:center\">Varejo</th>\r\n                        <th scope=\"col\" style=\"text-align:center\">&nbsp;MPE&nbsp;</th>\r\n                        <th scope=\"col\" style=\"text-align:center\">Corporativo</th>\r\n                        <th scope=\"col\" style=\"text-align:center\">Atacado</th>\r\n                        <th scope=\"col\" style=\"text-align:center;border-left: 2px solid #DEE2E6;\">*TIC<small style=\"padding:2.5px\">+</small>IoT</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr>\r\n                        <th scope=\"row\" style=\"vertical-align: middle;\">Real <br> <small> (diário)</small></th>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n                        <td style=\"text-align:center;vertical-align: middle;border-left: 2px solid #DEE2E6;\">{% for item in base_forecast_highlight_TIC %}\r\n                            {% if item.Produto == 'TIC/IoT' %}\r\n                               {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}</td>\r\n\r\n                        </tr>\r\n                        <tr>\r\n                        <th scope=\"row\" >% Orçado<br> <small>(Forecast&nbsp;x&nbsp;Orçado)</small></th>\r\n                        {% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                                {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n                                {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n        \r\n                                {% else %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n                                {% endif %}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}\r\n                        \r\n                        {% for item in tmp_base_highlight_vnd %}\r\n                            {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                                {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n                                {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n        \r\n                                {% else %}\r\n                                <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                    maximumFractionDigits: 0}) }}%</td>\r\n                                {% endif %}\r\n                            {% else %}\r\n                            {% endif %}\r\n                        {% endfor %}\r\n                    </td>\r\n                    {% for item in tmp_base_highlight_vnd %}\r\n                    {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                        {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                        <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}%</td>\r\n                        {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                        <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n\r\n                        {% else %}\r\n                        <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                            maximumFractionDigits: 0}) }}%</td>\r\n                        {% endif %}\r\n                    {% else %}\r\n                    {% endif %}\r\n                {% endfor %}\r\n                {% for item in tmp_base_highlight_vnd %}\r\n                {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                    {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n                    <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                maximumFractionDigits: 0}) }}%</td>\r\n                    {% elif item.FORECAST_PERCENTUAL <95  %}\r\n                    <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n\r\n                    {% else %}\r\n                    <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                    {% endif %}\r\n                {% else %}\r\n                {% endif %}\r\n            {% endfor %}\r\n            \r\n            {% for item in base_forecast_highlight_TIC %}\r\n                {% if item.Produto == 'TIC/IoT' %}\r\n                    {% if item.FORECAST_PERCENTUAL >= 100 %}\r\n            <td style=\"text-align:center;vertical-align: middle;color:green;border-left: 2px solid #DEE2E6;\">\r\n                    {{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                 {% elif  item.FORECAST_PERCENTUAL < 95 %}\r\n                 <td style=\"text-align:center;vertical-align: middle;color:red;border-left: 2px solid #DEE2E6;\">\r\n                    {{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                  {% else %}   \r\n                  <td style=\"text-align:center;vertical-align: middle;color:#EEAD00;border-left: 2px solid #DEE2E6;\">\r\n                    {{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                  {% endif %}\r\n            {% else %}\r\n            {% endif %}\r\n            {% endfor %}\r\n                        </tr>\r\n                        \r\n                        </tbody>\r\n                        </table>\r\n                        <p class=\"label\" style=\"font-size:13px;padding:0;margin:0;margin-top:-15px\"><small>*Resultados de TIC + IoT estão contidos nos Segmentos de Negócios</small></p>\r\n                                \r\n                            \r\n                        </div>\r\n                        </div>\r\n                </div>\r\n\r\n                </div>\r\n                <div class=\"col-4\" style=\"border-right: solid #50E1BC;\">\r\n                    <!--<div style=\"background-image: linear-gradient(#A0E1BC, #A0E1BC);\">-->\r\n                        <div>\r\n                        <h4 style=\"text-align:center\">Perda de Receita (R$ mil)</h4></div>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-sm w-100\" >\r\n                                <table>\r\n                                    <tr style=\"padding-top:10.05px;padding-bottom:10.05px\">\r\n                                        <td class=\"vlr_real\" style=\"padding-top:10.05px;padding-bottom:10.05px\">{{ (tmp_base_highlight_prd[0].REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"padding-top:10.05px;padding-bottom:10.05px;line-height: 1\">Real  <br> <small> (diário)</small></td>\r\n                                    </tr>\r\n                                   \r\n                                    <tr style=\"padding-top:10.05px;padding-bottom:10.05px\">\r\n                                        <td class=\"vlr_orcado\" style=\"padding-top:10.05px;padding-bottom:10.05px\">{{ (tmp_base_highlight_prd[0].ORCADO/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0}) }}</td>\r\n                                        <td class=\"label\" style=\"padding-top:10.05px;padding-bottom:10.05px;line-height: 1\">Orçado<br> <small>(mensal)</small></td>\r\n                                    </tr>\r\n                                    <tr style=\"padding-top:10.05px;padding-bottom:10.05px\">\r\n                                        \r\n                                        {% if tmp_base_highlight_prd[0].FORECAST_PERCENTUAL >= 105%}\r\n                                        <td class=\"vlr_forecast_percentual desvioPrd\" style=\"padding-top:10.05px;padding-bottom:10.05px;color:red\">{{ (tmp_base_highlight_prd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n                                        {% elif tmp_base_highlight_prd[0].FORECAST_PERCENTUAL >100 %}\r\n                                        <td class=\"vlr_forecast_percentual desvioPrd\" style=\"padding-top:10.05px;padding-bottom:10.05px;color:#EEAD00\">{{ (tmp_base_highlight_prd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n                                        {% else %}\r\n                                        <td class=\"vlr_forecast_percentual desvioPrd\" style=\"padding-top:10.05px;padding-bottom:10.05px;color:green\">{{ (tmp_base_highlight_prd[0].FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n\r\n                                        {% endif%}\r\n                                        <td class=\"label\" style=\"padding-top:10.05px;padding-bottom:10.05px;line-height: 1\">% Orçado<br><small>(Real x Orçado)</small></td>\r\n                                    </tr>\r\n\r\n                                </table>\r\n                            </div>\r\n                            <div class=\"col-sm w-100\">\r\n                                <div id=\"graficoPerda\"></div>\r\n                            </div>\r\n                            \r\n                        \r\n                    </div>\r\n                    <div class=\"container-fluid\">\r\n                        <div class=\"row\">\r\n                    <table class=\"table table-sm\">\r\n                    <thead class=\"table\">\r\n                    <tr>\r\n                    <th scope=\"col\"></th>\r\n                    <th scope=\"col\" style=\"text-align:center\">Varejo</th>\r\n                    <th scope=\"col\" style=\"text-align:center\">&nbsp;MPE&nbsp;</th>\r\n                    <th scope=\"col\" style=\"text-align:center\">Corporativo</th>\r\n                    <th scope=\"col\" style=\"text-align:center\">Atacado</th>\r\n                    </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                    <tr>\r\n                    <th scope=\"row\" style=\"vertical-align: middle;\">Real  <br> <small> (diário)</small></th>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    <td style=\"text-align:center;vertical-align: middle;\">{% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                           {{ (item.REAL/1000).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                    maximumFractionDigits: 0}) }}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}</td>\r\n                    </tr>\r\n                    <tr>\r\n                    <th scope=\"row\">% Orçado<br> <small>(Real&nbsp;x&nbsp;Orçado)</small></th>\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'RESIDENCIAL' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'EMPRESARIAL' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'CORPORATIVO' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    {% for item in tmp_base_highlight_prd %}\r\n                        {% if item.SEGMENTO == 'OPERADORAS' %}\r\n                            {% if item.FORECAST_PERCENTUAL >= 105 %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:red\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                        maximumFractionDigits: 0}) }}%</td>\r\n                            {% elif item.FORECAST_PERCENTUAL < 100  %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:green\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n\r\n                            {% else %}\r\n                            <td style=\"text-align:center;vertical-align: middle;color:#EEAD00\">{{ (item.FORECAST_PERCENTUAL).toLocaleString('pt-BR', {minimumFractionDigits: 0,\r\n                                maximumFractionDigits: 0}) }}%</td>\r\n                            {% endif %}\r\n                        {% else %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                    \r\n                    </tbody>\r\n                    </table>\r\n                            \r\n                        \r\n                    </div>\r\n                </div>\r\n                </div>\r\n                <div class=\"col-4\">\r\n                    <!--<div style=\"background-image: linear-gradient(#A0E1BC, #A0E1BC);\">-->\r\n                    <div>\r\n                        <h4 style=\"text-align:center\">Recebimentos de Caixa (R$ MM)</h4></div>\r\n                        <div class=\"container-fluid\" >\r\n                            <div style=\"padding-top:25px\"></div>\r\n                        <div class=\"row\" >\r\n<table class=\"table table-striped\">\r\n  <thead class=\"table table-borderless\">\r\n    <tr>\r\n      <th scope=\"col\" style=\"text-align:left;vertical-align: top;\">Posição de Caixa</th>\r\n      <th scope=\"col\" style=\"text-align:center\">Diário<br> <small>&nbsp;</small></th>\r\n      <th scope=\"col\" style=\"text-align:center\">{{ tmp_recebimento_caixa_dia[0].mes }}/{{tmp_recebimento_caixa_plus[0].ano_2}} <br><small>(acum)</small></th>\r\n      <th scope=\"col\" style=\"text-align:center\">{{tmp_recebimento_caixa_plus[0].ano}}<br> <small>(acum YTD)</small></th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <th scope=\"row\">Previsto <br> <small>(Revisão)</small></th>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_dia[0].ORCADO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_mes[0].ORCADO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_ano[0].ORCADO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\" style=\"vertical-align: middle;\">Real </th>\r\n      <td style=\"text-align:center;vertical-align: middle; color: #576575\">{{ (tmp_recebimento_caixa_dia[0].REAL | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_mes[0].REAL | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_ano[0].REAL | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n    </tr>\r\n    \r\n    <tr>\r\n      <th scope=\"row\">Desvio abs.<br><small>(Real x Previsto)</small></th>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_dia[0].ABS | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_mes[0].ABS | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n      <td style=\"text-align:center;vertical-align: middle;color: #576575\"> {{ (tmp_recebimento_caixa_ano[0].ABS | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}</td>\r\n    </tr>\r\n    \r\n    <tr>\r\n      <th scope=\"row\">% Previsto<br><small>(Real x Previsto)</small></th>\r\n      {% if tmp_recebimento_caixa_dia[0].DESVIO < -5 %}\r\n        <td class=\"desvioCx\" style=\"color:red ; text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_dia[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% elif tmp_recebimento_caixa_dia[0].DESVIO >= 0 %}\r\n        <td class=\"desvioCx\" style=\"color:green;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_dia[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% else %}\r\n        <td class=\"desvioCx\" style=\"color:#EEAD00;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_dia[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% endif %}\r\n\r\n      {% if tmp_recebimento_caixa_mes[0].DESVIO < -5 %}\r\n        <td class=\"desvioCx\" style=\"color:red;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_mes[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% elif tmp_recebimento_caixa_mes[0].DESVIO >= 0 %}\r\n        <td class=\"desvioCx\" style=\"color:green;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_mes[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% else %}\r\n        <td class=\"desvioCx\" style=\"color:#EEAD00;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_mes[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% endif %}\r\n      \r\n      {% if tmp_recebimento_caixa_ano[0].DESVIO < -5 %}\r\n        <td class=\"desvioCx\" style=\"color:red;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_ano[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% elif tmp_recebimento_caixa_ano[0].DESVIO >= 0 %}\r\n        <td class=\"desvioCx\" style=\"color:green;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_ano[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% else %}\r\n        <td class=\"desvioCx\" style=\"color:#EEAD00;text-align:center;vertical-align: middle;\">{{ (tmp_recebimento_caixa_ano[0].DESVIO | round).toLocaleString('pt-BR', {minimumFractionDigits: 0,maximumFractionDigits: 0}) }}%</td>\r\n      {% endif %}\r\n      \r\n    </tr>\r\n  </tbody>\r\n</table>\r\n                            \r\n                        \r\n                    </div>\r\n                </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n            </div>\r\n         \r\n         \r\n         \r\n         <!-- CARROUSEL -->\r\n<div style=\"padding-top:6px\"></div>\r\n<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ\" crossorigin=\"anonymous\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe\" crossorigin=\"anonymous\"></script>\r\n<div style=\"border:solid;border-color:#50E1BC\">\r\n   \r\n    <div style=\"background-image: linear-gradient(#6BE1BC, #6BE1BC); text-align:center;\"><h4>Principais Notícias da Companhia</h4></div>\r\n    \r\n   \r\n          <div class=\"row mx-auto my-auto justify-content-center\">\r\n        <div id=\"recipeCarousel\" class=\"carousel slide carousel-fade\" data-bs-ride=\"carousel\" data-bs-interval=\"10000\">\r\n            <div class=\"carousel-inner\" role=\"listbox\">\r\n                <div class=\"carousel-item active\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\" >\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_5.png\" class=\"img-fluid\">\r\n                            </div>\r\n                            <!--<div class=\"card-img-overlay\">1</div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_6.png\" class=\"img-fluid\">\r\n                            </div>\r\n                            <!--<div class=\"card-img-overlay\">2</div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\" style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_7.png\" class=\"img-fluid\">\r\n                            </div>\r\n                           <!-- <div class=\"card-img-overlay\">3/div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_8.png\" class=\"img-fluid\">\r\n                            </div>\r\n                           <!-- <div class=\"card-img-overlay\">4</div>-->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <!-- Slot 5 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_5.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n               \r\n                <!-- Slot 6 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_6.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n             \r\n                <!-- Slot 7 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_7.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n               \r\n                <!-- Slot 8  \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_8.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>-->\r\n               \r\n                <!-- Slot 9 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_9.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                -->\r\n                <!-- Slot 10 \r\n                <div class=\"carousel-item\">\r\n                    <div class=\"col-md-3\">\r\n                        <div class=\"card\">\r\n                            <div class=\"card-img\"  style=\"width:100%\">\r\n                                <img src=\"/api/content/read/137/highlight_pov_10.png\" class=\"img-fluid\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                -->\r\n            </div>\r\n            <a class=\"carousel-control-prev bg-transparent w-aut\" href=\"#recipeCarousel\" role=\"button\" data-bs-slide=\"prev\">\r\n                <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n            </a>\r\n            <a class=\"carousel-control-next bg-transparent w-aut\" href=\"#recipeCarousel\" role=\"button\" data-bs-slide=\"next\">\r\n                <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n            </a>\r\n        </div>\r\n       \r\n        </div>\r\n        <div style=\"padding-bottom:6px\"></div>\r\n         \r\n    \r\n    <!--<h5 class=\"mt-2 fw-light\">advances one slide at a time</h5>-->\r\n</div>\r\n\r\n<!-- FIM CARROUSEL -->\r\n       </div>\r\n\r\n\r\n  <script>\r\n      // GRAFICOS DE LINHAS\r\n         var optionsLineChart= {\r\n         series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_highlight_vnd %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         chart: {\r\n         height: 150,\r\n         type: 'area',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         dataLabels: {\r\n         enabled: false\r\n         \r\n         },\r\n         \r\n         yaxis: {\r\n            tickAmount: 3,\r\n             \r\n         labels: {\r\n             show: true,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: 0,\r\n                   maximumFractionDigits: 0});\r\n           },\r\n           style: {\r\n            fontSize: '9px',\r\n            fontWeight: 'light',\r\n          }\r\n         },\r\n         \r\n          axisBorder: {\r\n              show: true,\r\n              color: '#000000',\r\n              offsetX: 0,\r\n              offsetY: 0\r\n          },\r\n          axisTicks: {\r\n              show: true,\r\n              borderType: 'solid',\r\n              color: '#000000',\r\n              width: 3,\r\n              offsetX: 0,\r\n              offsetY: 0\r\n          },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         width: 3\r\n         },\r\n         \r\n         /*colors: ['#008FFB', '#00E396'],*/\r\n         colors: ['#00E396'],\r\n          dataLabels: {\r\n            enabled: false,\r\n         },\r\n         grid: {\r\n         show: true,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n            \r\n            \r\n             lines: {\r\n                 show: false\r\n             }\r\n             \r\n         }\r\n         },\r\n         markers: {\r\n            size: 5\r\n         },\r\n         markers: {\r\n            size: 0,\r\n        },\r\n         xaxis: {\r\n\r\n             tickAmount: 5,\r\n             tickPlacement: 'between',\r\n            labels: {\r\n              style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 400,\r\n                  cssClass: 'apexcharts-xaxis-label',\r\n              }\r\n            }, \r\n         categories: [{% for item in tmp_highlight_vnd %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         \r\n         }\r\n         };\r\n      \r\n      // GRÁFICO VENDA MENSAL\r\n      var optionsVenda = {\r\n      series: [\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_highlight_vnd %}\r\n             {{ item.REAL_ACU }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n        \r\n      categories: [{% for item in tmp_highlight_vnd %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              \r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            },\r\n            chart: {\r\n    height: '180px',\r\n    width:'200px'\r\n},\r\ntitle: {\r\n    text: \"Evolução Diária \",\r\n    align: 'center',\r\n    margin: 10,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    floating: false,\r\n    style: {\r\n      fontSize:  '14px',\r\n      fontWeight:  'bold',\r\n      fontFamily:  undefined,\r\n      color:  '#263238'\r\n    },\r\n},\r\nyaxis: {\r\n      labels: {\r\n    formatter: function (value) {\r\n        return (value/1000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n    }\r\n  },\r\n  show: false,\r\n  \r\n}        \r\n            \r\n      };\r\n      \r\n      var chartgraficoVenda = new ApexCharts(document.querySelector(\"#graficoVenda\"), optionsLineChart);\r\n      chartgraficoVenda.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoVenda.updateOptions(optionsVenda)\r\n      }, 1);\r\n      \r\n      // GRÁFICO Perda MENSAL\r\n      var optionsPerda = {\r\n      series: [\r\n      {\r\n       name: \"Real\",\r\n       data: [{% for item in tmp_highlight_prd %}\r\n             {{ item.REAL_ACU }},\r\n               {% endfor %}]\r\n      \r\n      }],\r\n      xaxis: {\r\n        \r\n      categories: [{% for item in tmp_highlight_prd %}\r\n              '{{ item.DIA }}',\r\n              {% endfor %}],\r\n              // Altera a linha do eixo X    \r\n              axisBorder: {\r\n                  show: true,\r\n                  color: '#000000',\r\n                  height: 1,\r\n                  width: '100%',\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              // Altera a divisão da linha do eixo X  \r\n              axisTicks: {\r\n                  show: true,\r\n                  borderType: 'solid',\r\n                  color: '#000000',\r\n                  height: 6,\r\n                  offsetX: 0,\r\n                  offsetY: 0\r\n              },\r\n              \r\n            },\r\n                \r\n        grid: {\r\n                show: true,\r\n               \r\n            },\r\n            chart: {\r\n    height: '180',\r\n    width:'200px'\r\n},\r\ntitle: {\r\n    text: \"Evolução Diária\",\r\n    align: 'center',\r\n    margin: 10,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    floating: false,\r\n    style: {\r\n      fontSize:  '14px',\r\n      fontWeight:  'bold',\r\n      fontFamily:  undefined,\r\n      color:  '#263238'\r\n    },\r\n},\r\n\r\n\r\nyaxis: {\r\n      labels: {\r\n    formatter: function (value) {\r\n        return (value/1000).toLocaleString(\"pt-BR\", \r\n             {minimumFractionDigits: 0,\r\n              maximumFractionDigits: 0});\r\n    }\r\n  },\r\n  show: false,\r\n  \r\n}\r\n            \r\n            \r\n      };\r\n      \r\n      var chartgraficoPerda = new ApexCharts(document.querySelector(\"#graficoPerda\"), optionsLineChart);\r\n      chartgraficoPerda.render();\r\n      \r\n      setTimeout(function() {\r\n      chartgraficoPerda.updateOptions(optionsPerda)\r\n      }, 1);\r\n      \r\n  </script>\r\n\r\n</body>\r\n</html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"\n.vlr_real {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 24px;\n}\n\n.vlr_forecast {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n  \n    font-size: 24px;\n}\n\n.vlr_orcado {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 24px;\n}\n\n.vlr_forecast_percentual {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 24px;\n}\n\n.label{\n    color: #454545;\n    font-weight: 500;\n   \n    \n    font-size: 15px;\n}\n\n.titulo_segmento {\n    \n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 16px;\n}\n\n.label_valor_segmento {\n    color: #2C694B;\n    font-weight: 700;\n    text-align: center;\n   \n    font-size: 16px;\n}\n.desvio,.desvioPrd,.desvioCx{text-align: center;}\n\n\n\ntd{font-weight: 700;\n    color: #576575;\n    font-size:18px;\n}\n\n\n\n/* Carrousel\n*/\n\n/*\n.card-img{\n    height:200px ;\n    \n}*/\n\n\n@media (max-width: 767px) {\n    .carousel-inner .carousel-item > div {\n        display: none;\n    }\n    .carousel-inner .carousel-item > div:first-child {\n        display: block;\n    }\n}\n\n.carousel-inner .carousel-item.active,\n.carousel-inner .carousel-item-next,\n.carousel-inner .carousel-item-prev {\n    display: flex;\n}\n\n/* medium and up screens */\n@media (min-width: 768px) {\n    \n    .carousel-inner .carousel-item-end.active,\n    .carousel-inner .carousel-item-next {\n      transform: translateX(25%);\n    }\n    \n    .carousel-inner .carousel-item-start.active, \n    .carousel-inner .carousel-item-prev {\n      transform: translateX(-25%);\n    }\n}\n\n.carousel-inner .carousel-item-end,\n.carousel-inner .carousel-item-start { \n  transform: translateX(0);\n}","script":"////////get date (DADOS)\r\nvar data = new Date();\r\n\r\nvar dia = String(data.getDate()).padStart(2, '0');\r\n\r\nvar mes = String(data.getMonth() + 1).padStart(2, '0');\r\n\r\nvar ano = data.getFullYear();\r\n\r\ndataAtual = dia + '/' + mes + '/' + ano;\r\n\r\nconsole.log(context.params.prm_status_highlight)\r\n\r\nif (dataAtual == context.params.prm_status_highlight) {\r\n   \r\n} else {\r\n   document.getElementById(\"dataAtual\").innerHTML += ' Em Processamento'\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n//////////Carrousel\r\nlet items = document.querySelectorAll('.carousel .carousel-item')\r\n\r\nitems.forEach((el) => {\r\n    const minPerSlide = 4\r\n    let next = el.nextElementSibling\r\n    for (var i=1; i<minPerSlide; i++) {\r\n        if (!next) {\r\n            // wrap carousel by using first child\r\n        \tnext = items[0]\r\n      \t}\r\n        let cloneChild = next.cloneNode(true)\r\n        el.appendChild(cloneChild.children[0])\r\n        next = next.nextElementSibling\r\n    }\r\n})\r\n\r\nvar myCarousel = document.querySelector('#carousel')\r\nvar carousel = new bootstrap.Carousel(myCarousel,{\r\n    interval: 100,\r\n    wrap: false\r\n})"},"noSpeech":true,"position":{"x":429.16343715276264,"y":220.42657123543665},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":30,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"_pMmmcGvgBnGCWHFxGtAolkbgkZnnygt","flowDescription":"","locked":"no","created":"2023-07-18 16:28:13","updated":"2023-09-08 09:08:23"},{"flowId":"3583","appId":137,"flowName":"Golden Hammer","workflow":{"nodes":[{"id":"JmBsFB","grid":{"h":109,"w":64,"x":0,"y":1,"hidden":false},"type":"report","appId":137,"label":"Golden Hammer","limit":100,"width":1892,"height":649,"layout":{"lg":{"h":109,"w":64,"x":0,"y":1,"height":649,"hidden":false},"md":{"h":50,"i":"3508JmBsFB","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"3508JmBsFB","w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":[],"content":" ","created":false,"project":{"html":"<html>\n    <head>\n        <title>Módulo Golden Hammer</title>\n        <script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n    </head>\n    <body id=\"gh-body\">\n        <div>\n            <h1 id=\"gh-titulo\">Módulo Golden Hammer</h1>\n        </div>\n        <hr>\n        <div>\n            <table>\n                <tr class=\"gh-linha\">\n                    <td class=\"gh-bloco\">\n                    </td>\n                    <td class=\"gh-bloco\">\n                        <h2 class=\"gh-titulo-ind\">Vendas</h2>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Corporativo: </td>\n                                    <td><input id=\"gh-venda-corporativo\"></td>   \n                                </tr>\n                            </table>\n                        </span>\n                        <br>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Corporativo TIC: </td>\n                                    <td><input id=\"gh-venda-corporativo_tic\"></td>   \n                                </tr>\n                            </table>\n                        </span>\n                        <br>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Corporativo IoT: </td>\n                                    <td><input id=\"gh-venda-corporativo_iot\"></td>   \n                                </tr>\n                            </table>\n                        </span>\n                        <br>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Empresarial: </td>\n                                    <td><input id=\"gh-venda-empresarial\"></td>  \n                                </tr>\n                            </table>\n                        </span>\n                        <br>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Atacado: </td>\n                                    <td><input id=\"gh-venda-atacado\"></td>  \n                                </tr>\n                                \n                            </table>\n                        </span>\n                        <span>\n                        <br>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Varejo: </td>\n                                    <td><input id=\"gh-venda-varejo\"></td>  \n                                </tr>\n                            </table>\n                        </span>\n                    </td>\n                    <td class=\"gh-bloco\">\n                    </td>\n                    <td class=\"gh-bloco\">\n                        <h2 class=\"gh-titulo-ind\">Perda de Receita</h2>\n                        <span>\n                            <table>\n                                <tr>\n                                   <td class=\"gh-table\">Corporativo: </td>\n                                    <td><input id=\"gh-perda-corporativo\"></td> \n                                </tr>\n                            </table>\n                        </span>\n                        <br>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Empresarial: </td>\n                                    <td><input id=\"gh-perda-empresarial\"></td> \n                                </tr>\n                            </table>\n                        </span>\n                        <br>\n                        <span>\n                            <table>\n                                <tr>\n                                    <td class=\"gh-table\">Atacado: </td>\n                                    <td><input id=\"gh-perda-atacado\"></td>\n                                </tr>\n                                \n                            </table>\n                        </span>\n                        <span>\n                        <br>\n                            <table>\n                                <tr>\n                                   <td class=\"gh-table\">Varejo: </td>\n                                    <td><input id=\"gh-perda-varejo\"></td> \n                                </tr>\n                            </table>\n                        </span>\n                    </td>\n                    <td class=\"gh-bloco\">\n                    </td>\n                </tr>\n            </table>\n            <br>\n            <br>\n            <div id=\"gh-btn-div\">\n                <button id=\"gh-submeter\" onClick=\"enviarGH()\">Submeter</button>\n            </div>\n        </div>\n        <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\n    </body>\n</html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#gh-body {\n    background-color: #B8A054;\n}\n#gh-titulo {\n    text-align: center;\n    font-size: 50px;\n    font-weight: 500;\n}\n.gh-table {\n    width: 100px;\n    padding-right: 50px;\n}\n.gh-titulo-ind {\n    text-align: center;\n}\n.gh-bloco {\n    width: 20%;\n    align-items: center;\n}\ntable {\n    width: 100%;\n}\n#gh-submeter {\n    text-align: center;\n}\n#gh-btn-div {\n    text-align: center;\n}","script":"/*\nUse the following code to access the data from the table\nReference: window.context = { params: {}, tableName1: [], tableName2: [] };\n\nExample of parameters: context.params.paramName;\nExample of tables: context.tableName\n*/\n\n\nvar prm_gh_venda_corporativo = context.params.prm_gh_venda_corporativo;\nvar prm_gh_venda_corporativo_tic = context.params.prm_gh_venda_corporativo_tic;\nvar prm_gh_venda_corporativo_iot = context.params.prm_gh_venda_corporativo_iot;\nvar prm_gh_venda_empresarial = context.params.prm_gh_venda_empresarial;\nvar prm_gh_venda_atacado = context.params.prm_gh_venda_atacado;\nvar prm_gh_venda_varejo = context.params.prm_gh_venda_varejo;\nvar prm_gh_perda_corporativo = context.params.prm_gh_perda_corporativo;\nvar prm_gh_perda_empresarial = context.params.prm_gh_perda_empresarial;\nvar prm_gh_perda_atacado = context.params.prm_gh_perda_atacado;\nvar prm_gh_perda_varejo = context.params.prm_gh_perda_varejo;\n$(\"#gh-venda-corporativo\").val(prm_gh_venda_corporativo);\n$(\"#gh-venda-corporativo_tic\").val(prm_gh_venda_corporativo_tic);\n$(\"#gh-venda-corporativo_iot\").val(prm_gh_venda_corporativo_iot);\n$(\"#gh-venda-empresarial\").val(prm_gh_venda_empresarial);\n$(\"#gh-venda-atacado\").val(prm_gh_venda_atacado);\n$(\"#gh-venda-varejo\").val(prm_gh_venda_varejo);\n$(\"#gh-perda-corporativo\").val(prm_gh_perda_corporativo);\n$(\"#gh-perda-empresarial\").val(prm_gh_perda_empresarial);\n$(\"#gh-perda-atacado\").val(prm_gh_perda_atacado);\n$(\"#gh-perda-varejo\").val(prm_gh_perda_varejo);\n\nfunction enviarGH() {\n    var venda_corporativo = document.getElementById(\"gh-venda-corporativo\").value;\n    var venda_corporativo_tic = document.getElementById(\"gh-venda-corporativo_tic\").value;\n    var venda_corporativo_iot = document.getElementById(\"gh-venda-corporativo_iot\").value;\n    var venda_empresarial = document.getElementById(\"gh-venda-empresarial\").value;\n    var venda_atacado = document.getElementById(\"gh-venda-atacado\").value;\n    var venda_varejo = document.getElementById(\"gh-venda-varejo\").value;\n    var perda_corporativo = document.getElementById(\"gh-perda-corporativo\").value;\n    var perda_empresarial = document.getElementById(\"gh-perda-empresarial\").value;\n    var perda_atacado = document.getElementById(\"gh-perda-atacado\").value;\n    var perda_varejo = document.getElementById(\"gh-perda-varejo\").value;\n    console.log(venda_corporativo);\n    dispatchEvent({ formFlowId: 3585, formType: 'loadFlow',\n        params:[{ paramName:'prm_gh_venda_corporativo', paramValue: [venda_corporativo] },\n                { paramName:'prm_gh_venda_corporativo_tic', paramValue: [venda_corporativo_tic] },\n                { paramName:'prm_gh_venda_corporativo_iot', paramValue: [venda_corporativo_iot] },\n                { paramName:'prm_gh_venda_empresarial', paramValue: [venda_empresarial] },\n                { paramName:'prm_gh_venda_atacado', paramValue: [venda_atacado] },\n                { paramName:'prm_gh_venda_varejo', paramValue: [venda_varejo] },\n                { paramName:'prm_gh_perda_corporativo', paramValue: [perda_corporativo] },\n                { paramName:'prm_gh_perda_empresarial', paramValue: [perda_empresarial] },\n                { paramName:'prm_gh_perda_atacado', paramValue: [perda_atacado] },\n                { paramName:'prm_gh_perda_varejo', paramValue: [perda_varejo] }\n                ]});\n\n}\n\n"},"noSpeech":true,"position":{"x":-33.1486933189716,"y":-55.8775366715551},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[]},"cron":null,"options":{"folder":"Golden Hammer","reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"ckuCmDRNGLDBkraRmf_KQAQhxMRcMkdl","flowDescription":"","locked":"no","created":"2023-07-24 13:50:12","updated":"2023-09-08 09:08:23"},{"flowId":"3601","appId":137,"flowName":"DASHBOARD INTERNO - Dashboard Diária","workflow":{"nodes":[{"id":"ScVKdk","type":"table","appId":137,"label":"historico_validacao","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":56,"y":155},"sourceId":null,"tableName":"historico_validacao","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"XdGFQq","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"zrMJEv","type":"value","dataType":"Nullable(Date)","tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"},{"id":"jHJASn","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"caFpPJ","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"RQAwAc","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"OYPyfw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PjHnMi","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"},{"id":"YvJQmE","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"hXHRSw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DiferencaAbs","columnLength":2,"databaseName":"bucket_137"},{"id":"MBDBlq","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DifrerencaPercentual","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"iCqzjR","type":"value","andOr":"and","value":"prm_gh_view_data","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"historico_validacao","valueType":"parameter","columnName":"DataReferencia","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"rAnaRF","type":"value","andOr":"and","value":"prm_gh_view_indicador","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"historico_validacao","valueType":"parameter","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"eBoQht","type":"value","andOr":"and","value":"prm_gh_view_segmento","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"historico_validacao","valueType":"parameter","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"XYWfUI","type":"value","andOr":"and","value":"prm_gh_view_produto","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"historico_validacao","valueType":"parameter","columnName":"PRODUTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fghnkv","type":"value","dataType":"Nullable(Date)","tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"},{"id":"jHJASn","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"caFpPJ","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"RQAwAc","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"OYPyfw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PjHnMi","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"},{"id":"YvJQmE","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"hXHRSw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DiferencaAbs","columnLength":2,"databaseName":"bucket_137"},{"id":"MBDBlq","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DifrerencaPercentual","columnLength":2,"databaseName":"bucket_137"},{"id":"MmDQFy","type":"max","alias":"MaxData","dataType":"Nullable(Date)","distinct":false,"tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":189,"y":33},"sourceId":null,"tableName":"historico_validacao","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_visao_validacao_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qmhcRL","type":"table","appId":137,"label":"tmp_visao_validacao_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":367.5,"y":33},"sourceId":null,"tableName":"tmp_visao_validacao_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rPiqvl","grid":{"h":55,"w":64,"x":0,"y":30,"hidden":false},"type":"report","appId":137,"label":"Diário","width":1875,"client":"clickhouse","height":325,"layout":{"lg":{"h":55,"w":64,"x":0,"y":30,"height":325,"hidden":false},"md":{"h":50,"i":"3601rPiqvl","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"3601rPiqvl","w":64,"x":0,"y":1,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[{"id":"uuWKKr","type":"value","order":"asc","dataType":"Nullable(Date)","fieldType":"","tableName":"tmp_visao_validacao_aux","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"}],"group":[],"limit":50,"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"","operator":"="}],"select":[{"id":"uuWKKr","type":"value","dataType":"Nullable(Date)","fieldType":"","tableName":"tmp_visao_validacao_aux","columnName":"DataReferencia","formatDate":"DD/MMM","formatType":"date","separators":"dotComma","columnLength":null,"databaseName":"bucket_137","formatDecimalSize":2},{"id":"LsSTxH","type":"sum","alias":"sum_PORTAL","title":"Banco Portal","dataType":"Nullable(Float64)","fieldType":"","tableName":"tmp_visao_validacao_aux","textAlign":"right","columnName":"PORTAL","formatType":"decimal","separators":"dotComma","columnLength":2,"databaseName":"bucket_137","formatDecimalSize":0},{"id":"gIfbCa","type":"sum","alias":"sum_REFERENCIA","title":"Referência","dataType":"Nullable(Float64)","fieldType":"","tableName":"tmp_visao_validacao_aux","textAlign":"right","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"}],"limitBy":[]},"shared":false,"created":false,"position":{"x":555.5,"y":33},"settings":{"type":"column","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardHtml":false,"cardRows":1,"cardType":"freeStyle","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":false,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":true,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"cardColumns":6,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"card","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"cardHtmlCode":"","interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":true,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"tmp_visao_validacao_aux","tableView":false,"temporary":false,"reportType":"chart","sourceType":"bucket","databaseName":"bucket_137"},{"id":"GmwKyU","type":"reportPreview","label":"Preview","created":false,"position":{"x":666.5,"y":33},"reportId":"rPiqvl","reportType":"column"},{"id":"VmIBDO","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ULJtxQ","type":"max","alias":"DataReferencia","dataType":"Nullable(Date)","distinct":false,"tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":189,"y":283},"sourceId":null,"tableName":"historico_validacao","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"max_data_gh_validacao","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oERcoE","type":"table","appId":137,"label":"max_data_gh_validacao","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":367.5,"y":283},"sourceId":null,"tableName":"max_data_gh_validacao","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"llSPMu","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":555.5,"y":283},"tableName":"max_data_gh_validacao","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_gh_view_data_max","columnName":"DataReferencia"}]},{"id":"TQkkul","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"DjMrdf","type":"value","order":"asc","dataType":"Nullable(Date)","tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"},{"id":"uyzNKQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"gchCCr","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"hcdzoV","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"xbHfwL","type":"value","order":"asc","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"MmVRgz","type":"value","order":"asc","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"},{"id":"qiLupy","type":"value","order":"asc","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"Mkhaxr","type":"value","order":"asc","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DiferencaAbs","columnLength":2,"databaseName":"bucket_137"},{"id":"RhXksN","type":"value","order":"asc","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DifrerencaPercentual","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"zrMJEv","type":"value","dataType":"Nullable(Date)","tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"},{"id":"jHJASn","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"caFpPJ","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"RQAwAc","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"OYPyfw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PjHnMi","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"},{"id":"YvJQmE","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"hXHRSw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DiferencaAbs","columnLength":2,"databaseName":"bucket_137"},{"id":"MBDBlq","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DifrerencaPercentual","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fghnkv","type":"value","dataType":"Nullable(Date)","tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"},{"id":"jHJASn","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"caFpPJ","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"RQAwAc","type":"value","dataType":"Nullable(String)","tableName":"historico_validacao","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"OYPyfw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PjHnMi","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"},{"id":"YvJQmE","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"hXHRSw","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DiferencaAbs","columnLength":2,"databaseName":"bucket_137"},{"id":"MBDBlq","type":"value","dataType":"Nullable(Float64)","tableName":"historico_validacao","columnName":"DifrerencaPercentual","columnLength":2,"databaseName":"bucket_137"},{"id":"MmDQFy","type":"max","alias":"MaxData","dataType":"Nullable(Date)","distinct":false,"tableName":"historico_validacao","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":189,"y":155},"sourceId":null,"tableName":"historico_validacao","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_visao_validacao_completa_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GSquWf","type":"table","appId":137,"label":"tmp_visao_validacao_completa_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":367.5,"y":155},"sourceId":null,"tableName":"tmp_visao_validacao_completa_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JxGxWs","grid":{"h":92,"w":64,"x":0,"y":85,"hidden":false},"type":"report","appId":137,"forms":[],"label":"Tabela Dia","width":1875,"client":"clickhouse","height":547,"layout":{"lg":{"h":92,"w":64,"x":0,"y":85,"height":547,"hidden":false},"md":{"h":50,"i":"3601JxGxWs","w":64,"x":0,"y":23,"height":290,"hidden":false},"sm":{"h":50,"i":"3601JxGxWs","w":64,"x":0,"y":23,"height":290,"hidden":false}},"repoId":1,"schema":{"join":[],"sort":[{"id":"nCbguF","type":"value","alias":"DataReferencia","order":"asc","title":"Data","dataType":"Nullable(Date)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"DataReferencia","fontWeight":"400","formatDate":"DD/MM","formatType":"date","localOrder":"asc","separators":"dotComma","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"=","formatDecimalSize":2},{"id":"IPglPo","type":"value","alias":"TIP_MTC","order":"asc","title":"Indicador","dataType":"Nullable(String)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"TIP_MTC","fontWeight":"400","localOrder":"asc","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"JmrDGh","type":"value","alias":"SEGMENTO","order":"asc","title":"Segmento","dataType":"Nullable(String)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"SEGMENTO","fontWeight":"400","localOrder":"asc","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"LJOxsf","type":"value","alias":"PRODUTO","order":"asc","title":"Produto","dataType":"Nullable(String)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"PRODUTO","fontWeight":"400","localOrder":"asc","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"}],"group":[],"filter":[{"list":[{"id":"PRsjPd","andOr":"and","value":"prm_gh_view_data_max","dataType":"Nullable(Date)","operator":"=","tableName":"tmp_visao_validacao_completa_aux","valueType":"parameter","columnName":"DataReferencia","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"select":[{"id":"nCbguF","type":"value","title":"Data","dataType":"Nullable(Date)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"DataReferencia","fontWeight":"400","formatDate":"DD/MM","formatType":"date","separators":"dotComma","filterValue":"","columnLength":null,"databaseName":"bucket_137","filterOperator":"=","formatDecimalSize":2},{"id":"IPglPo","type":"value","title":"Indicador","dataType":"Nullable(String)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"TIP_MTC","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"JmrDGh","type":"value","title":"Segmento","dataType":"Nullable(String)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"SEGMENTO","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"LJOxsf","type":"value","title":"Produto","dataType":"Nullable(String)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"PRODUTO","fontWeight":"400","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"like"},{"id":"pHXjcS","type":"sum","alias":"sum_PORTAL","title":"Banco Portal","dataType":"Nullable(Float64)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"PORTAL","fontWeight":"400","formatType":"decimal","separators":"dotComma","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"=","formatDecimalSize":0},{"id":"BAbzhZ","type":"sum","alias":"sum_REFERENCIA","title":"Referência","dataType":"Nullable(Float64)","fontSize":14,"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"REFERENCIA","fontWeight":"400","formatType":"decimal","separators":"dotComma","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"=","formatDecimalSize":0},{"id":"vtDHdD","type":"sum","alias":"sum_DiferencaAbs","title":"Diferença","condType":"background","dataType":"Nullable(Float64)","fontSize":14,"condRules":[{"id":"epudbK","icon":"","color":"#9EEF81","operator":"between","reference":"-5000","extraReference":"5000"},{"id":"SGJIYL","icon":"","color":"#FCB4A2","operator":"<","reference":"5000","extraReference":""},{"id":"eBGfds","icon":"","color":"#FCB4A2","operator":">","reference":"5000","extraReference":""}],"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"DiferencaAbs","fontWeight":"400","formatType":"decimal","separators":"dotComma","filterValue":"","columnLength":2,"databaseName":"bucket_137","condColumnName":"sum_DiferencaAbs","filterOperator":"=","formatDecimalSize":0},{"id":"bUoAIY","type":"sum","alias":"sum_DifrerencaPercentual","title":"% Diferença","condType":"background","dataType":"Nullable(Float64)","fontSize":14,"condRules":[{"id":"aCpkbK","icon":"","color":"#FCB4A2","operator":">","reference":"101","extraReference":""},{"id":"rrdSqV","icon":"","color":"#FCB4A2","operator":"<","reference":"99","extraReference":""},{"id":"IBnexZ","icon":"","color":"#9EEF81","operator":"between","reference":"99","extraReference":"101"}],"fieldType":"","fontColor":"","tableName":"tmp_visao_validacao_completa_aux","textAlign":"center","columnName":"DifrerencaPercentual","fontWeight":"400","formatType":"none","separators":"dotComma","filterValue":"","columnLength":2,"databaseName":"bucket_137","formatSuffix":"%","condColumnName":"sum_DifrerencaPercentual","filterOperator":"=","formatDecimalSize":2}],"limitBy":[]},"shared":false,"created":false,"formType":"modal","position":{"x":555.5,"y":155},"settings":{"type":"column","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":false,"cardHtml":false,"cardRows":1,"cardType":"freeStyle","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":10,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":true,"showLegend":false,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"center","transposed":false,"cardColumns":6,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"clean","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"cardHtmlCode":"","interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":false,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":null,"tableName":"tmp_visao_validacao_completa_aux","tableView":false,"temporary":false,"reportType":"table","sourceType":"bucket","databaseName":"bucket_137","formOnFirstColumn":false},{"id":"rHdxbL","type":"reportPreview","label":"Preview","position":{"x":666.5,"y":155},"reportId":"JxGxWs","reportType":"table"},{"id":"DvLXUP","grid":{"h":30,"w":64,"x":0,"y":0,"hidden":false},"type":"report","appId":137,"label":"Cabeçalho","limit":100,"width":1875,"height":175,"layout":{"lg":{"h":30,"w":64,"x":0,"y":0,"height":175,"hidden":false},"md":{"h":50,"i":"3601DvLXUP","w":64,"x":0,"y":2,"height":290,"hidden":false},"sm":{"h":50,"i":"3601DvLXUP","w":64,"x":0,"y":2,"height":290,"hidden":false}},"tables":[],"content":" ","created":false,"project":{"html":"<head>\n    <script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\n</head>\n<body>\n    <div id='cabecalho'>\n        <div>\n            <h1>Validação Diária</h1>\n        </div>\n        <div id='filtrar'>Filtrar</div>\n        <div><br><br>\n                <span><b>Data:</b> {{ params.prm_gh_view_data }} </span>\n                <span><b> / Indicador:</b> {{ params.prm_gh_view_indicador }} </span>\n                <span><b> / Segmento:</b> {{ params.prm_gh_view_segmento }} </span>\n                <span><b> / Produto:</b> {{ params.prm_gh_view_produto }} </span>\n        </div>\n    </div>\n    <script>\n        $(\"#filtrar\").click(function () {\n           dispatchEvent(\n               {\n                   formId: 'UyXiiA'\n               })\n         });  \n    </script>\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#filtrar, #limpar_filtro {\n    background-color: #bababa;\n    display: inline-block;\n    padding: 10px;\n    border-radius: 5px;\n    margin-left: 30px;\n    font-weight: 500;\n}\n#cabecalho {\n    background-color: #0FC925;\n    padding: 10px;\n    width: auto;\n    text-align: center;\n    color: #303030;\n}","script":"/*\nUse the following code to access the data from the table\nReference: window.context = { params: {}, tableName1: [], tableName2: [] };\n\nExample of parameters: context.params.paramName;\nExample of tables: context.tableName\n*/"},"noSpeech":true,"position":{"x":56,"y":39},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[{"id":"SzKLsq","source":"qmhcRL","target":"rPiqvl"},{"id":"BgzREP","source":"rPiqvl","target":"GmwKyU"},{"id":"CErXJi","source":"ScVKdk","target":"XdGFQq"},{"id":"xECDEc","source":"XdGFQq","target":"qmhcRL"},{"id":"KQXqci","source":"ScVKdk","target":"VmIBDO"},{"id":"Lgxhfw","source":"VmIBDO","target":"oERcoE"},{"id":"SJMXXM","source":"oERcoE","target":"llSPMu"},{"id":"eUiEQs","source":"ScVKdk","target":"TQkkul"},{"id":"vNDidB","source":"TQkkul","target":"GSquWf"},{"id":"rCxKZF","source":"GSquWf","target":"JxGxWs"},{"id":"LHTRCD","source":"JxGxWs","target":"rHdxbL"}]},"cron":null,"options":{"folder":"Golden Hammer","reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"OPmkLIryAxEKVWkurNxRnNKsHZExrFFJ","flowDescription":"","locked":"no","created":"2023-07-25 10:28:58","updated":"2023-09-08 09:08:23"},{"flowId":"3812","appId":137,"flowName":"VALIDAÇÃO HIGHLIGHT x ANALY x PORTAL","workflow":{"nodes":[{"id":"efWGVK","type":"table","appId":137,"label":"tmp_valicacao_valores_final","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":85,"y":619},"sourceId":null,"tableName":"tmp_valicacao_valores_final","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LmGNIa","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ENtDla","type":"value","dataType":"Nullable(String)","tableName":"tmp_valicacao_valores_final","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"},{"id":"JLJwdG","type":"value","dataType":"Nullable(String)","tableName":"tmp_valicacao_valores_final","columnName":"Segmento","columnLength":2,"databaseName":"bucket_137"},{"id":"REFebS","type":"value","alias":"REAL_PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_valicacao_valores_final","columnName":"REAL_MIL","columnLength":2,"databaseName":"bucket_137"},{"id":"TeajlK","type":"value","alias":"ORCADO_PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_valicacao_valores_final","columnName":"ORCADO_MIL","columnLength":2,"databaseName":"bucket_137"},{"id":"pHoNvp","type":"value","alias":"FORECAST_PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_valicacao_valores_final","columnName":"FORECAST_MIL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":250.5,"y":619},"sourceId":null,"tableName":"tmp_valicacao_valores_final","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_export_portal","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"JbWGwY","type":"table","appId":137,"label":"tabela_export_portal","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":417.5,"y":619},"sourceId":null,"tableName":"tabela_export_portal","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fIUEKG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"RITmJa","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tabela_export_portal","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"ZvDtCM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_export_portal","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"qzeDfc","type":"value","dataType":"Nullable(String)","tableName":"tabela_export_portal","columnName":"Indicador","columnLength":2,"databaseName":"bucket_137"},{"id":"bHoSuf","type":"sum","alias":"REAL_PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_export_portal","columnName":"REAL_PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"qISmxj","type":"sum","alias":"ORCADO_PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_export_portal","columnName":"ORCADO_PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"yaJUOF","type":"sum","alias":"FORECAST_PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_export_portal","columnName":"FORECAST_PORTAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":581,"y":619},"sourceId":null,"tableName":"tabela_export_portal","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_export_portal_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"HjrBAy","type":"table","appId":137,"label":"tabela_export_portal_consolidado","client":"clickhouse","repoId":1,"shared":false,"position":{"x":753,"y":619},"sourceId":null,"tableName":"tabela_export_portal_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IOcbVn","type":"table","appId":137,"label":"tmp_base_highlight_prd","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":85,"y":497},"sourceId":null,"tableName":"tmp_base_highlight_prd","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"tRbPzb","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZOOIeL","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_highlight_prd","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"KCMIGq","type":"computed","alias":"REAL_HIGHLIGHT","content":"REAL/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_HIGHLIGHT","computedId":"wMordR","columnLength":2},{"id":"KaoFIO","type":"computed","alias":"ORCADO_HIGHLIGHT","content":"ORCADO/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_HIGHLIGHT","computedId":"WdEcrs","columnLength":2},{"id":"FqryUP","type":"computed","alias":"FORECAST_HIGHLIGHT","content":"0","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_HIGHLIGHT","computedId":"wkCUUT","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_HIGHLIGHT","content":"REAL/1000","dataType":"Nullable(Float64)","columnName":"REAL_HIGHLIGHT","computedId":"wMordR","columnLength":2},{"type":"computed","alias":"ORCADO_HIGHLIGHT","content":"ORCADO/1000","dataType":"Nullable(Float64)","columnName":"ORCADO_HIGHLIGHT","computedId":"WdEcrs","columnLength":2},{"type":"computed","alias":"FORECAST_HIGHLIGHT","content":"0","dataType":"Nullable(Float64)","columnName":"FORECAST_HIGHLIGHT","computedId":"wkCUUT","columnLength":2}]},"created":false,"optimize":false,"position":{"x":250.5,"y":497},"sourceId":null,"tableName":"tmp_base_highlight_prd","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"tabela_export_highlight_perda","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"VwzvdI","type":"table","appId":137,"label":"tabela_export_highlight_perda","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":417.5,"y":497},"sourceId":null,"tableName":"tabela_export_highlight_perda","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cUNINv","grid":{"h":81,"w":63,"x":0,"y":1,"hidden":false},"type":"report","appId":137,"label":"Validação","limit":100,"width":1317,"height":481,"layout":{"lg":{"h":81,"w":63,"x":0,"y":1,"height":481,"hidden":false},"md":{"h":50,"i":"3812cUNINv","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"3812cUNINv","w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tabela_export_analy","tabela_export_highlight_venda","tabela_export_highlight_perda","tabela_export_highlight_tic","tabela_export_portal","tabela_export_portal_consolidado"],"content":" ","created":false,"project":{"html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\">\r\n  <title>Tabelas lado a lado</title>\r\n</head>\r\n<body style=\" overflow-x: hidden;\">\r\n  <div>\r\n    <div class=\"row\">\r\n      <div class=\"col-md-6\">\r\n        <div class=\"card\">\r\n          <div class=\"card-header\">\r\n            <h2 class=\"card-title\">Portal x Analy</h2>\r\n          </div>\r\n          <div class=\"card-body\">\r\n            <table class=\"table table-bordered\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Valores</th>\r\n                  <th>Portal REAL</th>\r\n                  <th>Analy REAL</th>\r\n                  <th>Portal ORÇADO</th>\r\n                  <th>Analy ORÇADO</th>\r\n                  <th>Portal FORECAST</th>\r\n                  <th>Analy FORECAST</th>\r\n                  <th>Status</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td style=\"background-color: yellow\">Consolidado perda</td>\r\n                  <td>{{ tabela_export_portal_consolidado[0].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[0].REAL_ANALY | round }}</td>\r\n                  <td>{{ tabela_export_portal_consolidado[0].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[0].ORCADO_ANALY | round }}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n                  {% if (tabela_export_portal_consolidado[0].REAL_PORTAL | round ) == (tabela_export_analy[0].REAL_ANALY | round ) and (tabela_export_portal_consolidado[0].ORCADO_PORTAL | round ) == (tabela_export_analy[0].ORCADO_ANALY | round ) %}\r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Corporativo perda</td>\r\n                  <td>{{ tabela_export_portal[0].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[1].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[0].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[1].ORCADO_ANALY | round }}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n                  {% if (tabela_export_portal[0].REAL_PORTAL | round) == (tabela_export_analy[1].REAL_ANALY | round) and (tabela_export_portal[0].ORCADO_PORTAL | round ) == (tabela_export_analy[1].ORCADO_ANALY | round ) %}\r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Empresarial perda</td>\r\n                  <td>{{ tabela_export_portal[1].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[2].REAL_ANALY | round }}</td>\r\n                  <td>{{ tabela_export_portal[1].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[2].ORCADO_ANALY | round }}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n                    {% if (tabela_export_portal[1].REAL_PORTAL | round ) == (tabela_export_analy[2].REAL_ANALY | round) and (tabela_export_portal[1].ORCADO_PORTAL | round) == ( tabela_export_analy[2].ORCADO_ANALY | round ) %}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Operadoras perda</td>\r\n                  <td>{{ tabela_export_portal[2].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[3].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[2].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[3].ORCADO_ANALY | round }}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n                 {% if (tabela_export_portal[2].REAL_PORTAL | round ) == (tabela_export_analy[3].REAL_ANALY | round) and ( tabela_export_portal[2].ORCADO_PORTAL | round ) == ( tabela_export_analy[3].ORCADO_ANALY | round ) %}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Residencial perda</td>\r\n                  <td>{{ tabela_export_portal[3].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[4].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[3].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[4].ORCADO_ANALY | round }}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n                  {% if (tabela_export_portal[3].REAL_PORTAL | round) == (tabela_export_analy[4].REAL_ANALY | round) and (tabela_export_portal[3].ORCADO_PORTAL | round) == (tabela_export_analy[4].ORCADO_ANALY | round ) %}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td style=\"background-color: yellow\">Consolidado venda</td>\r\n                  <td>{{ tabela_export_portal_consolidado[1].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[5].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal_consolidado[1].ORCADO_PORTAL | round}}</td>\r\n                  <td>{{ tabela_export_analy[5].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal_consolidado[1].FORECAST_PORTAL | round}}</td>\r\n                  <td>{{ tabela_export_analy[5].FORECAST_ANALY | round}}</td>\r\n                 {% if (tabela_export_portal_consolidado[1].REAL_PORTAL | round) == (tabela_export_analy[5].REAL_ANALY | round) and (tabela_export_portal_consolidado[1].ORCADO_PORTAL | round) == (tabela_export_analy[5].ORCADO_ANALY | round) and (tabela_export_portal_consolidado[1].FORECAST_PORTAL | round) == (tabela_export_analy[5].FORECAST_ANALY | round) %}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Corporativo venda</td>\r\n                  <td>{{ tabela_export_portal[4].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[6].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[4].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[6].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[4].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[6].FORECAST_ANALY | round}}</td>\r\n                  {% if (tabela_export_portal[4].REAL_PORTAL | round) == (tabela_export_analy[6].REAL_ANALY | round) and (tabela_export_portal[4].ORCADO_PORTAL | round) == (tabela_export_analy[6].ORCADO_ANALY | round) and (tabela_export_portal[4].FORECAST_PORTAL | round) == (tabela_export_analy[6].FORECAST_ANALY | round)%}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Empresarial venda</td>\r\n                  <td>{{ tabela_export_portal[5].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[7].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[5].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[7].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[5].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[7].FORECAST_ANALY | round}}</td>\r\n                   {% if (1) == (1) and (1) == (1) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Operadoras venda</td>\r\n                  <td>{{ tabela_export_portal[6].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[8].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[6].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[8].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[6].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[8].FORECAST_ANALY | round}}</td>\r\n                  {% if (tabela_export_portal[6].REAL_PORTAL | round) == (tabela_export_analy[8].REAL_ANALY | round) and (tabela_export_portal[6].ORCADO_PORTAL | round) == (tabela_export_analy[8].ORCADO_ANALY | round) and (tabela_export_portal[6].FORECAST_PORTAL | round) == (tabela_export_analy[8].FORECAST_ANALY | round) %}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td>Residencial venda</td>\r\n                  <td>{{ tabela_export_portal[7].REAL_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[9].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[7].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[9].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_portal[7].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_analy[9].FORECAST_ANALY | round}}</td>\r\n                  {% if (tabela_export_portal[7].REAL_PORTAL | round) == (tabela_export_analy[9].REAL_ANALY | round) and (tabela_export_portal[7].ORCADO_PORTAL | round) == (tabela_export_analy[9].ORCADO_ANALY | round) and (tabela_export_portal[7].FORECAST_PORTAL | round) == (tabela_export_analy[9].FORECAST_ANALY | round)%}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n                <tr>\r\n                  <td style=\"background-color: yellow\">TIC IOT</td>\r\n                  <td>{{ tabela_export_analy[10].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_analy[10].REAL_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_analy[10].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_analy[10].ORCADO_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_analy[10].FORECAST_ANALY | round}}</td>\r\n                  <td>{{ tabela_export_analy[10].FORECAST_ANALY | round}}</td>\r\n                  {% if (tabela_export_analy[10].REAL_ANALY | round) == (tabela_export_analy[10].REAL_ANALY | round) and (tabela_export_analy[10].ORCADO_ANALY | round) == (tabela_export_analy[10].ORCADO_ANALY | round) and (tabela_export_analy[10].FORECAST_ANALY) == (tabela_export_analy[10].FORECAST_ANALY)%}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-md-6\">\r\n        <div class=\"card\">\r\n          <div class=\"card-header\">\r\n            <h2 class=\"card-title\">Portal x Highlight</h2>\r\n          </div>\r\n          <div class=\"card-body\">\r\n            <table class=\"table table-bordered\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Valores</th>\r\n                  <th>Portal REAL</th>\r\n                  <th>Highlight REAL</th>\r\n                  <th>Portal ORÇADO</th>\r\n                  <th>Highlight ORÇADO</th>\r\n                   <th>Portal FORECAST</th>\r\n                  <th>Highlight FORECAST</th>\r\n                  <th>Status</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n            <tr>\r\n              <td style=\"background-color: yellow\">Consolidado perda</td>\r\n              <td>{{ tabela_export_portal_consolidado[0].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_perda[0].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal_consolidado[0].ORCADO_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_perda[0].ORCADO_HIGHLIGHT | round}}</td>\r\n              <td>0</td>\r\n              <td>0</td>\r\n              {% if (tabela_export_portal_consolidado[0].REAL_PORTAL | round) == (tabela_export_highlight_perda[0].REAL_HIGHLIGHT | round) and (tabela_export_portal_consolidado[0].ORCADO_PORTAL | round) == (tabela_export_highlight_perda[0].ORCADO_HIGHLIGHT | round) %}     \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Corporativo perda</td>\r\n              <td>{{ tabela_export_portal[0].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_perda[1].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[0].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_perda[1].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n              {% if (tabela_export_portal[0].REAL_PORTAL | round ) == (tabela_export_highlight_perda[1].REAL_HIGHLIGHT | round) and (tabela_export_portal[0].ORCADO_PORTAL | round ) == (tabela_export_highlight_perda[1].ORCADO_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Empresarial perda</td>\r\n              <td>{{ tabela_export_portal[1].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_perda[2].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[1].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_perda[2].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n              {% if (tabela_export_portal[1].REAL_PORTAL | round) == ( tabela_export_highlight_perda[2].REAL_HIGHLIGHT | round) and (tabela_export_portal[1].ORCADO_PORTAL | round ) == (tabela_export_highlight_perda[2].ORCADO_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Operadoras perda</td>\r\n              <td>{{ tabela_export_portal[2].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_perda[3].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[2].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_perda[3].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n               {% if (tabela_export_portal[2].REAL_PORTAL | round) == (tabela_export_highlight_perda[3].REAL_HIGHLIGHT | round) and (tabela_export_portal[2].ORCADO_PORTAL | round) == (tabela_export_highlight_perda[3].ORCADO_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Residencial perda</td>\r\n              <td>{{ tabela_export_portal[3].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_perda[4].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[3].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_perda[4].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>0</td>\r\n                  <td>0</td>\r\n               {% if (tabela_export_portal[3].REAL_PORTAL | round ) == (tabela_export_highlight_perda[4].REAL_HIGHLIGHT | round) and (tabela_export_portal[3].ORCADO_PORTAL | round) == (tabela_export_highlight_perda[4].ORCADO_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td style=\"background-color: yellow\">Consolidado venda</td>\r\n               <td>{{ tabela_export_portal_consolidado[1].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_venda[0].REAL_HIGHLIGHT | round}}</td>\r\n               <td>{{ tabela_export_portal_consolidado[1].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[0].ORCADO_HIGHLIGHT | round}}</td>\r\n                 <td>{{ tabela_export_portal_consolidado[1].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[0].FORECAST_HIGHLIGHT | round}}</td>\r\n               {% if (tabela_export_portal_consolidado[1].REAL_PORTAL | round) == ( tabela_export_highlight_venda[0].REAL_HIGHLIGHT | round) and (tabela_export_portal_consolidado[1].ORCADO_PORTAL | round ) == (tabela_export_highlight_venda[0].ORCADO_HIGHLIGHT | round) and (tabela_export_portal_consolidado[1].FORECAST_PORTAL | round) == (tabela_export_highlight_venda[0].FORECAST_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Corporativo venda</td>\r\n              <td>{{ tabela_export_portal[4].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_venda[1].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[4].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[1].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>{{ tabela_export_portal[4].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[1].FORECAST_HIGHLIGHT | round}}</td>\r\n                           {% if (tabela_export_portal[4].REAL_PORTAL | round) == (tabela_export_highlight_venda[1].REAL_HIGHLIGHT | round) and (tabela_export_portal[4].ORCADO_PORTAL | round) == (tabela_export_highlight_venda[1].ORCADO_HIGHLIGHT | round) and (tabela_export_portal[4].FORECAST_PORTAL | round ) == ( tabela_export_highlight_venda[1].FORECAST_HIGHLIGHT | round) %}           \r\n         \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Empresarial venda</td>\r\n               <td>{{ tabela_export_portal[5].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_venda[2].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[5].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[2].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>{{ tabela_export_portal[5].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[2].FORECAST_HIGHLIGHT | round}}</td>\r\n                   {% if (tabela_export_portal[5].REAL_PORTAL | round) == (tabela_export_highlight_venda[2].REAL_HIGHLIGHT | round) and (tabela_export_portal[5].ORCADO_PORTAL | round) == (tabela_export_highlight_venda[2].ORCADO_HIGHLIGHT | round) and (tabela_export_portal[5].FORECAST_PORTAL | round ) == ( tabela_export_highlight_venda[2].FORECAST_HIGHLIGHT | round) %}           \r\n         \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Operadoras venda</td>\r\n               <td>{{ tabela_export_portal[6].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_venda[3].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[6].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[3].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>{{ tabela_export_portal[6].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[3].FORECAST_HIGHLIGHT | round}}</td>\r\n             {% if (tabela_export_portal[6].REAL_PORTAL | round) == (tabela_export_highlight_venda[3].REAL_HIGHLIGHT | round) and (tabela_export_portal[6].ORCADO_PORTAL | round) == (tabela_export_highlight_venda[3].ORCADO_HIGHLIGHT | round) and (tabela_export_portal[6].FORECAST_PORTAL | round ) == ( tabela_export_highlight_venda[3].FORECAST_HIGHLIGHT | round) %}           \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td>Residencial venda</td>\r\n               <td>{{ tabela_export_portal[7].REAL_PORTAL | round }}</td>\r\n              <td>{{ tabela_export_highlight_venda[4].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_portal[7].ORCADO_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[4].ORCADO_HIGHLIGHT | round}}</td>\r\n                  <td>{{ tabela_export_portal[7].FORECAST_PORTAL | round }}</td>\r\n                  <td>{{ tabela_export_highlight_venda[4].FORECAST_HIGHLIGHT | round}}</td>\r\n              {% if (tabela_export_portal[7].REAL_PORTAL | round) == (tabela_export_highlight_venda[4].REAL_HIGHLIGHT | round) and (tabela_export_portal[7].ORCADO_PORTAL | round) == (tabela_export_highlight_venda[4].ORCADO_HIGHLIGHT | round) and (tabela_export_portal[7].FORECAST_PORTAL | round ) == ( tabela_export_highlight_venda[4].FORECAST_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n            <tr>\r\n              <td style=\"background-color: yellow\">TIC IOT</td>\r\n              <td>{{ tabela_export_analy[10].REAL_ANALY | round}}</td>\r\n              <td>{{ tabela_export_highlight_tic[0].REAL_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_analy[10].ORCADO_ANALY | round}}</td>\r\n              <td>{{ tabela_export_highlight_tic[0].ORCADO_HIGHLIGHT | round}}</td>\r\n              <td>{{ tabela_export_analy[10].FORECAST_ANALY | round}}</td>\r\n              <td>{{ tabela_export_highlight_tic[0].FORECAST_HIGHLIGHT | round}}</td>\r\n               {% if (tabela_export_analy[10].REAL_ANALY | round) == (tabela_export_highlight_tic[0].REAL_HIGHLIGHT | round) and (tabela_export_analy[10].ORCADO_ANALY | round) == ( tabela_export_highlight_tic[0].ORCADO_HIGHLIGHT | round) and (tabela_export_analy[10].FORECAST_ANALY | round) == (tabela_export_highlight_tic[0].FORECAST_HIGHLIGHT | round) %}          \r\n                    <td style=\"background-color:#6FC930\">status</td>\r\n                  {%else%}\r\n                    <td style=\"background-color:red\">status</td>\r\n                  {%endif%}\r\n            </tr>\r\n          </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"","script":"/*\nUse the following code to access the data from the table\nReference: window.context = { params: {}, tableName1: [], tableName2: [] };\n\nExample of parameters: context.params.paramName;\nExample of tables: context.tableName\n*/"},"noSpeech":true,"position":{"x":85,"y":381},"cardStyle":true,"reportType":"staticContent","assetsCoverWidth":true},{"id":"FmxpmO","type":"table","appId":137,"label":"tmp_aux_prepara_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":85,"y":265},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OxTaqD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"fYHrPb","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"NWOCAW","type":"value","andOr":"and","value":"João Paulo","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_aux_prepara_sgm_alerta","valueType":"value","columnName":"nome","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"IxaKeh","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"GLMeke","type":"computed","alias":"SEGMENTO_","content":"case when  isNull(SEGMENTO) then 'CONSOLIDADO'\nelse SEGMENTO\nend","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_","computedId":"tWpumx"},{"id":"FXTJBR","type":"computed","alias":"REAL_ANALY","content":"REAL/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ANALY","computedId":"lJcczy","columnLength":2},{"id":"MJcgqn","type":"computed","alias":"ORCADO_ANALY","content":"ORCADO_TRATADO/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_ANALY","computedId":"AbhqyL","columnLength":2},{"id":"xZooTc","type":"computed","alias":"FORECAST_ANALY","content":"FORECAST_VENDA/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_ANALY","computedId":"mYYSbT","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO_","content":"case when  isNull(SEGMENTO) then 'CONSOLIDADO'\nelse SEGMENTO\nend","dataType":"Nullable(String)","columnName":"SEGMENTO_","computedId":"tWpumx"},{"type":"computed","alias":"REAL_ANALY","content":"REAL/1000","dataType":"Nullable(Float64)","columnName":"REAL_ANALY","computedId":"lJcczy","columnLength":2},{"type":"computed","alias":"ORCADO_ANALY","content":"ORCADO_TRATADO/1000","dataType":"Nullable(Float64)","columnName":"ORCADO_ANALY","computedId":"AbhqyL","columnLength":2},{"type":"computed","alias":"FORECAST_ANALY","content":"FORECAST_VENDA/1000","dataType":"Nullable(Float64)","columnName":"FORECAST_ANALY","computedId":"mYYSbT","columnLength":2}]},"created":false,"optimize":false,"position":{"x":250.5,"y":265},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_export_analy","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qEGRSK","type":"table","appId":137,"label":"tabela_export_analy","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":417.5,"y":265},"sourceId":null,"tableName":"tabela_export_analy","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"tynTtT","type":"table","appId":137,"label":"tmp_base_highlight_vnd","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":85,"y":149},"sourceId":null,"tableName":"tmp_base_highlight_vnd","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"xyEuGs","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uUHNJN","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_highlight_vnd","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"KCMIGq","type":"computed","alias":"REAL_HIGHLIGHT","content":"REAL/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_HIGHLIGHT","computedId":"wMordR","columnLength":2},{"id":"KaoFIO","type":"computed","alias":"ORCADO_HIGHLIGHT","content":"ORCADO/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_HIGHLIGHT","computedId":"WdEcrs","columnLength":2},{"id":"SotJOu","type":"computed","alias":"FORECAST_HIGHLIGHT","content":"FORECAST_VENDA_/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_HIGHLIGHT","computedId":"wEHWgL","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_HIGHLIGHT","content":"REAL/1000","dataType":"Nullable(Float64)","columnName":"REAL_HIGHLIGHT","computedId":"wMordR","columnLength":2},{"type":"computed","alias":"ORCADO_HIGHLIGHT","content":"ORCADO/1000","dataType":"Nullable(Float64)","columnName":"ORCADO_HIGHLIGHT","computedId":"WdEcrs","columnLength":2},{"type":"computed","alias":"FORECAST_HIGHLIGHT","content":"FORECAST_VENDA_/1000","dataType":"Nullable(Float64)","columnName":"FORECAST_HIGHLIGHT","computedId":"wEHWgL","columnLength":2}]},"created":false,"optimize":false,"position":{"x":250.5,"y":149},"sourceId":null,"tableName":"tmp_base_highlight_vnd","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_export_highlight_venda","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"bpubWq","type":"table","appId":137,"label":"tabela_export_highlight_venda","client":"clickhouse","repoId":1,"shared":false,"position":{"x":417.5,"y":149},"sourceId":null,"tableName":"tabela_export_highlight_venda","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"aUAABZ","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":85,"y":33},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"nJlzTA","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jJvUQb","type":"computed","alias":"REAL_HIGHLIGHT","content":"REAL/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_HIGHLIGHT","computedId":"JZIlCm","columnLength":2},{"id":"zqyyum","type":"computed","alias":"ORCADO_HIGHLIGHT","content":"ORCADO/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_HIGHLIGHT","computedId":"oOhxRs","columnLength":2},{"id":"vYuKJp","type":"computed","alias":"FORECAST_HIGHLIGHT","content":"FORECAST/1000","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_HIGHLIGHT","computedId":"IBghOk","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_HIGHLIGHT","content":"REAL/1000","dataType":"Nullable(Float64)","columnName":"REAL_HIGHLIGHT","computedId":"JZIlCm","columnLength":2},{"type":"computed","alias":"ORCADO_HIGHLIGHT","content":"ORCADO/1000","dataType":"Nullable(Float64)","columnName":"ORCADO_HIGHLIGHT","computedId":"oOhxRs","columnLength":2},{"type":"computed","alias":"FORECAST_HIGHLIGHT","content":"FORECAST/1000","dataType":"Nullable(Float64)","columnName":"FORECAST_HIGHLIGHT","computedId":"IBghOk","columnLength":2}]},"created":false,"optimize":false,"position":{"x":250.5,"y":33},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_export_highlight_tic","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"hFJCXq","type":"table","appId":137,"label":"tabela_export_highlight_tic","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":417.5,"y":33},"sourceId":null,"tableName":"tabela_export_highlight_tic","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"lNXIPC","source":"FmxpmO","target":"OxTaqD"},{"id":"nTnSrf","source":"OxTaqD","target":"qEGRSK"},{"id":"KryTaz","source":"IOcbVn","target":"tRbPzb"},{"id":"sauPgG","source":"tRbPzb","target":"VwzvdI"},{"id":"YzmyEO","source":"aUAABZ","target":"nJlzTA"},{"id":"oiGJge","source":"nJlzTA","target":"hFJCXq"},{"id":"xqBehC","source":"efWGVK","target":"LmGNIa"},{"id":"ybEmdc","source":"LmGNIa","target":"JbWGwY"},{"id":"uxNoyI","source":"tynTtT","target":"xyEuGs"},{"id":"OYIdzX","source":"xyEuGs","target":"bpubWq"},{"id":"GifgDm","source":"JbWGwY","target":"fIUEKG"},{"id":"RovRse","source":"fIUEKG","target":"HjrBAy"}]},"cron":null,"options":{"folder":"ANALY DIÁRIO","reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"wYpheMpGhVQIiWTvasxIqioUlXiDKLfJ","flowDescription":"","locked":"no","created":"2023-08-10 10:13:55","updated":"2023-09-08 09:08:23"},{"flowId":"3843","appId":137,"flowName":"ATUALIZA_CAIXA","workflow":{"nodes":[{"id":"Eiqmiq","grid":{"h":81,"w":64,"x":0,"y":1,"hidden":false},"type":"report","appId":137,"label":"RECEBIMENTOS","limit":100,"width":1338,"height":481,"layout":{"lg":{"h":81,"w":64,"x":0,"y":1,"height":481,"hidden":false},"md":{"h":50,"i":"3812GveeyW","w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"i":"3812GveeyW","w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":[],"content":" ","created":false,"project":{"html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n<meta charset=\"UTF-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<title>RECEBIMENTOS DE CAIXA</title>\r\n<style>\r\n body {\r\n    font-family: Arial, sans-serif;\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: #f4f4f4;\r\n  }\r\n\r\n  .container {\r\n    max-width: 800px;\r\n    margin: 20px auto;\r\n    padding: 20px;\r\n    background-color: #fff;\r\n    border-radius: 5px;\r\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);\r\n  }\r\n\r\n  h1 {\r\n    text-align: center;\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  table {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n  }\r\n\r\n  table, th, td {\r\n    border: 1px solid #ddd;\r\n    padding: 10px;\r\n    text-align: center;\r\n  }\r\n\r\n  th {\r\n    background-color: #f2f2f2;\r\n  }\r\n\r\n  tr:nth-child(even) {\r\n    background-color: #f2f2f2;\r\n  }\r\n\r\n  input[type=\"number\"] {\r\n    width: 100%;\r\n    padding: 8px;\r\n    border: 1px solid #ccc;\r\n    border-radius: 4px;\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  label {\r\n    font-weight: bold;\r\n  }\r\n  .warning {\r\n    color: red;\r\n    font-weight: bold;\r\n    text-align: center;\r\n    margin-top: 10px;\r\n  }\r\n  #saveButton {\r\n    background-color: #4CAF50;\r\n    border: none;\r\n    color: white;\r\n    padding: 10px 20px;\r\n    text-align: center;\r\n    text-decoration: none;\r\n    display: inline-block;\r\n    font-size: 16px;\r\n    border-radius: 5px;\r\n    cursor: pointer;\r\n    transition: background-color 0.3s ease;\r\n  }\r\n\r\n  #saveButton:hover {\r\n    background-color: #45a049;\r\n  }\r\n\r\n  .difference-column {\r\n    width: 100px;\r\n  }\r\n\r\n  .table-container {\r\n    overflow-x: auto;\r\n  }\r\n \r\n</style>\r\n</head>\r\n<body>\r\n    <div class=\"container\">\r\n      <h1>RECEBIMENTOS DE CAIXA</h1>\r\n      <form>\r\n        <div class=\"table-container\">\r\n          <table>\r\n            <tr>\r\n              <th></th>\r\n              <th>Previsto</th>\r\n              <th>Real</th>\r\n              <th>Diferença (%)</th>\r\n            </tr>\r\n            <tr>\r\n              <td>Diário</td>\r\n              <td><input type=\"number\" id=\"previstoDiario\" name=\"previstoDiario\"></td>\r\n              <td><input type=\"number\" id=\"realDiario\" name=\"realDiario\"></td>\r\n              <td class=\"difference-column\" id=\"differenceDiario\"></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Mensal</td>\r\n              <td><input type=\"number\" id=\"previstoMensal\" name=\"previstoMensal\"></td>\r\n              <td><input type=\"number\" id=\"realMensal\" name=\"realMensal\"></td>\r\n              <td class=\"difference-column\" id=\"differenceMensal\"></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Anual</td>\r\n              <td><input type=\"number\" id=\"previstoAnual\" name=\"previstoAnual\"></td>\r\n              <td><input type=\"number\" id=\"realAnual\" name=\"realAnual\"></td>\r\n              <td class=\"difference-column\" id=\"differenceAnual\"></td>\r\n            </tr>\r\n          </table>\r\n        </div>\r\n        <br>\r\n       \r\n        <div style=\"text-align:center\"><button type=\"button\" id=\"saveButton\">Salvar</button></div>\r\n       \r\n      </form>\r\n      <div class=\"warning\" id=\"warningMessage\"></div>\r\n    </div>\r\n   \r\n    <script>\r\n \r\n      document.addEventListener(\"DOMContentLoaded\", function() {\r\n        const saveButton = document.getElementById(\"saveButton\");\r\n        const warningMessage = document.getElementById(\"warningMessage\");\r\n        const differenceDiario = document.getElementById(\"differenceDiario\");\r\n        const differenceMensal = document.getElementById(\"differenceMensal\");\r\n        const differenceAnual = document.getElementById(\"differenceAnual\");\r\n \r\n        saveButton.addEventListener(\"click\", function() {\r\n          const previstoDiario = parseFloat(document.getElementById(\"previstoDiario\").value);\r\n          const realDiario = parseFloat(document.getElementById(\"realDiario\").value);\r\n          const previstoMensal = parseFloat(document.getElementById(\"previstoMensal\").value);\r\n          const realMensal = parseFloat(document.getElementById(\"realMensal\").value);\r\n          const previstoAnual = parseFloat(document.getElementById(\"previstoAnual\").value);\r\n          const realAnual = parseFloat(document.getElementById(\"realAnual\").value);\r\n \r\n          if (\r\n            isNaN(previstoDiario) || isNaN(realDiario) ||\r\n            isNaN(previstoMensal) || isNaN(realMensal) ||\r\n            isNaN(previstoAnual) || isNaN(realAnual)\r\n          ) {\r\n            warningMessage.textContent = \"Por favor, insira valores válidos.\";\r\n            return;\r\n          }else{\r\n              console.log(\"PASSA VARIAVEIS PARA PARAMETRO\");\r\n              \r\n              \r\n          }\r\n \r\n          const calculateDifference = (real, previsto) => ((real - previsto) / previsto) * 100;\r\n \r\n          const differenceDiarioPercent = calculateDifference(realDiario, previstoDiario);\r\n          const differenceMensalPercent = calculateDifference(realMensal, previstoMensal);\r\n          const differenceAnualPercent = calculateDifference(realAnual, previstoAnual);\r\n \r\n          differenceDiario.textContent = differenceDiarioPercent.toFixed(2) + \"%\";\r\n          differenceMensal.textContent = differenceMensalPercent.toFixed(2) + \"%\";\r\n          differenceAnual.textContent = differenceAnualPercent.toFixed(2) + \"%\";\r\n           \r\n          const warningText = \"Dados salvos com sucesso!\";\r\n         \r\n          dispatchEvent(\r\n                {\r\n                    formFlowId: 3843,\r\n                    formType: 'loadFlow',\r\n                    params: [{\r\n                            paramName: 'CAIXA_DIA_REAL',\r\n                            paramValue: realDiario\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_DIA_PREVISTO',\r\n                            paramValue: previstoDiario\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_MES_REAL',\r\n                            paramValue: realMensal\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_MES_PREVISTO',\r\n                            paramValue: previstoMensal\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_ANO_REAL',\r\n                            paramValue: realAnual\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_ANO_PREVISTO',\r\n                            paramValue: previstoAnual\r\n                        }\r\n                       \r\n                        ]\r\n\r\n                    \r\n                });\r\n                /*dispatchEvent(\r\n                {\r\n                    //ID Dashboard - Adiciona CAIXA\r\n                    formFlowId: 3843,\r\n                    formType: 'openFlow',\r\n                    params: [{}]\r\n                });*/\r\n          \r\n          \r\n          warningMessage.textContent = warningText;\r\n          \r\n        });\r\n        \r\n      });\r\n      \r\n      /*\r\n      $(\"#saveButton\").click(async function () {\r\n            data = data;\r\n            segmento = $(\"#get_segmento\").val();\r\n            indicador = $(\"#get_indicador\").val();\r\n            orcado = $(\"#get_orcado\").val();\r\n            \r\n            if (!orcado || !indicador || !segmento) {\r\n                alert(\"Por favor, preencha todos os campos\");\r\n                event.preventDefault(); // Impede o envio do formulário\r\n\r\n            }\r\n            else{ \r\n           \r\n\r\n            await dispatchEvent(\r\n                {\r\n                    //ID Prepara dados - Adiciona\r\n                    formFlowId: 2615,\r\n                    formType: 'loadFlow',\r\n                    params: [\r\n                        {\r\n                            paramName: 'CAIXA_DIA_REAL',\r\n                            paramValue: realDiario\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_DIA_PREVISTO',\r\n                            paramValue: previstoDiario\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_MES_REAL',\r\n                            paramValue: realMensal\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_MES_PREVISTO',\r\n                            paramValue: previstoMensal\r\n                        },\r\n                        {\r\n                        \r\n                            paramName: 'CAIXA_ANO_REAL',\r\n                            paramValue: realAnual\r\n                        },\r\n                        {\r\n                            paramName: 'CAIXA_ANO_PREVISTO',\r\n                            paramValue: previstoAnual\r\n                        }\r\n                        }]\r\n\r\n                });\r\n            await dispatchEvent(\r\n                {\r\n                    //ID Dashboard - Adiciona Forecast\r\n                    formFlowId: 2615,\r\n                    formType: 'openFlow',\r\n                    params: [{}]\r\n                });\r\n      */\r\n      \r\n      \r\n      \r\n    </script>\r\n  </body>\r\n  </html>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"","script":"/*\nUse the following code to access the data from the table\nReference: window.context = { params: {}, tableName1: [], tableName2: [] };\n\nExample of parameters: context.params.paramName;\nExample of tables: context.tableName\n*/"},"noSpeech":true,"position":{"x":-41.006902527499975,"y":220.0085914438031},"cardStyle":true,"reportType":"staticContent","assetsCoverWidth":true},{"id":"xKHHNR","type":"update","appId":137,"label":"Update","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"update":[{"value":"CAIXA_DIA_REAL","dataType":"Nullable(Float64)","tableName":"recebimento_caixa","valueType":"parameter","columnName":"dia_real","columnLength":2,"databaseName":"bucket_137"},{"value":"CAIXA_DIA_PREVISTO","dataType":"Nullable(Float64)","tableName":"recebimento_caixa","valueType":"parameter","columnName":"dia_orcado","columnLength":2,"databaseName":"bucket_137"},{"value":"CAIXA_MES_REAL","dataType":"Nullable(Float64)","tableName":"recebimento_caixa","valueType":"parameter","columnName":"mes_real","columnLength":2,"databaseName":"bucket_137"},{"value":"CAIXA_MES_PREVISTO","dataType":"Nullable(Float64)","tableName":"recebimento_caixa","valueType":"parameter","columnName":"mes_orcado","columnLength":2,"databaseName":"bucket_137"},{"value":"CAIXA_ANO_REAL","dataType":"Nullable(Float64)","tableName":"recebimento_caixa","valueType":"parameter","columnName":"ano_real","columnLength":2,"databaseName":"bucket_137"},{"value":"CAIXA_ANO_PREVISTO","dataType":"Nullable(Float64)","tableName":"recebimento_caixa","valueType":"parameter","columnName":"ano_orcado","columnLength":2,"databaseName":"bucket_137"}],"computed":[]},"created":false,"position":{"x":53,"y":219},"tableName":"recebimento_caixa","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"hVIuUJ","type":"table","appId":137,"label":"recebimento_caixa","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":211.5,"y":219},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HvsdQq","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UiaZlx","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"recebimento_caixa","columnName":"ano","columnLength":2,"databaseName":"bucket_137"},{"id":"VTIIni","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"lkCOOq","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"diario","columnLength":null,"databaseName":"bucket_137"},{"id":"VTzcBe","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"recebimento_caixa","columnName":"ano_2","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":347.5,"y":33},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_plus","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OzWsCY","type":"table","appId":137,"label":"tmp_recebimento_caixa_plus","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":511.5,"y":33},"tableName":"tmp_recebimento_caixa_plus","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YSTLKN","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"YhOjfp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"AzDPKE","type":"computed","alias":"REAL","content":"round(mes_real+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"cBIqXh","columnLength":2},{"id":"QJIXRA","type":"computed","alias":"ORCADO","content":"round(mes_orcado+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"ggIXfb","columnLength":2},{"id":"DbxBfR","type":"computed","alias":"DESVIO","content":"((mes_real - mes_orcado )/mes_orcado) *100\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"DESVIO","computedId":"BFEihu","columnLength":2},{"id":"lgGVBL","type":"computed","alias":"ABS","content":"round(((mes_real - mes_orcado )),0)\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"ABS","computedId":"kDyCgD"}],"update":[],"computed":[{"type":"computed","alias":"REAL","content":"round(mes_real+0.01,0)","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"cBIqXh","columnLength":2},{"type":"computed","alias":"ORCADO","content":"round(mes_orcado+0.01,0)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"ggIXfb","columnLength":2},{"type":"computed","alias":"DESVIO","content":"((mes_real - mes_orcado )/mes_orcado) *100\n","dataType":"Nullable(Float64)","columnName":"DESVIO","computedId":"BFEihu","columnLength":2},{"type":"computed","alias":"ABS","content":"round(((mes_real - mes_orcado )),0)\n\n","dataType":"Nullable(Int64)","columnName":"ABS","computedId":"kDyCgD"}]},"created":false,"optimize":false,"position":{"x":347.5,"y":155},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"LYCkNA","type":"table","appId":137,"label":"tmp_recebimento_caixa_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":511.5,"y":155},"tableName":"tmp_recebimento_caixa_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NYFSba","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZfEqVq","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"jOTfTR","type":"computed","alias":"REAL","content":"round(ano_real+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"KpimSz","columnLength":2},{"id":"HDUKyt","type":"computed","alias":"ORCADO","content":"round(ano_orcado+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"kmLSVR","columnLength":2},{"id":"WsYivt","type":"computed","alias":"DESVIO","content":"(((ano_real - ano_orcado)/ano_orcado))*100\n\n\n\n\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"DESVIO","computedId":"PXcOFc","columnLength":2},{"id":"OVYJSp","type":"computed","alias":"ABS","content":"round(((ano_real - ano_orcado)),0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ABS","computedId":"UBaUto"}],"update":[],"computed":[{"type":"computed","alias":"DESVIO","content":"(((ano_real - ano_orcado)/ano_orcado))*100\n\n\n\n\n","dataType":"Nullable(Float64)","columnName":"DESVIO","computedId":"PXcOFc","columnLength":2},{"type":"computed","alias":"REAL","content":"round(ano_real+0.01,0)","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"KpimSz","columnLength":2},{"type":"computed","alias":"ORCADO","content":"round(ano_orcado+0.01,0)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"kmLSVR","columnLength":2},{"type":"computed","alias":"ABS","content":"round(((ano_real - ano_orcado)),0)","dataType":"Nullable(Int64)","columnName":"ABS","computedId":"UBaUto"}]},"created":false,"optimize":false,"position":{"x":347.5,"y":283},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_ano","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"snublL","type":"table","appId":137,"label":"tmp_recebimento_caixa_ano","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":511.5,"y":283},"tableName":"tmp_recebimento_caixa_ano","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pxGHVD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"OUoJtZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"MZsvoL","type":"computed","alias":"REAL","content":"dia_real+0.01\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"YTlgJf","columnLength":2},{"id":"ORFdPt","type":"computed","alias":"ORCADO","content":"dia_orcado+0.01","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"FdVopM","columnLength":2},{"id":"eUifSy","type":"computed","alias":"DESVIO","content":"((REAL - ORCADO)/ORCADO)*100\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"DESVIO","computedId":"dxjNta","columnLength":2},{"id":"zetjoH","type":"computed","alias":"ABS","content":"round(((dia_real - dia_orcado)),0)\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"ABS","computedId":"zzHVlE"}],"update":[],"computed":[{"type":"computed","alias":"REAL","content":"dia_real+0.01\n","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"YTlgJf","columnLength":2},{"type":"computed","alias":"ORCADO","content":"dia_orcado+0.01","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"FdVopM","columnLength":2},{"type":"computed","alias":"DESVIO","content":"((REAL - ORCADO)/ORCADO)*100\n\n","dataType":"Nullable(Int64)","columnName":"DESVIO","computedId":"dxjNta","columnLength":2},{"type":"computed","alias":"ABS","content":"round(((dia_real - dia_orcado)),0)\n\n","dataType":"Nullable(Int64)","columnName":"ABS","computedId":"zzHVlE"}]},"created":false,"optimize":false,"position":{"x":347.5,"y":405},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vZxGLR","type":"table","appId":137,"label":"tmp_recebimento_caixa_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":511.5,"y":405},"tableName":"tmp_recebimento_caixa_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"FXwplg","source":"xKHHNR","target":"hVIuUJ"},{"id":"UQSPUT","source":"hVIuUJ","target":"HvsdQq"},{"id":"iaOqsm","source":"HvsdQq","target":"OzWsCY"},{"id":"YgBdVH","source":"hVIuUJ","target":"YSTLKN"},{"id":"wdgPxZ","source":"YSTLKN","target":"LYCkNA"},{"id":"ZOGdbS","source":"hVIuUJ","target":"NYFSba"},{"id":"fqeTaq","source":"NYFSba","target":"snublL"},{"id":"ZfJJtL","source":"hVIuUJ","target":"pxGHVD"},{"id":"KsBJmV","source":"pxGHVD","target":"vZxGLR"}]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":0,"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"iHQolGfNDBwiknoRfNNk_OXuiGkliwvX","flowDescription":"","locked":"no","created":"2023-08-10 23:22:46","updated":"2023-09-11 08:24:28"},{"flowId":"2615","appId":137,"flowName":"RECEBIMENTO CAIXA CSV","workflow":{"nodes":[{"id":"wdRqTm","type":"group","label":"Parallel","created":false,"position":{"x":404.5,"y":267.5}},{"id":"wSsKUL","type":"fileImport","appId":137,"label":"recebimentos_caixa.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"IkmEFY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"mes","alternativeName":"mes"},{"id":"ceqWQf","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"dia_real","columnLength":2,"alternativeName":"dia_real"},{"id":"VZOWNT","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"dia_orcado","columnLength":2,"alternativeName":"dia_orcado"},{"id":"QXcNiF","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"mes_real","columnLength":2,"alternativeName":"mes_real"},{"id":"TMpHVy","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"mes_orcado","columnLength":2,"alternativeName":"mes_orcado"},{"id":"uXrLMv","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"ano_real","columnLength":2,"alternativeName":"ano_real"},{"id":"VkbBQh","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"ano_orcado","columnLength":2,"alternativeName":"ano_orcado"},{"id":"wOoWSi","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"ano","columnLength":2,"alternativeName":"ano"},{"id":"wAjIyA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"diario","alternativeName":"diario"},{"id":"rxRate","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"ano_2","columnLength":2,"alternativeName":"ano_2"}],"created":false,"fileName":"recebimentos_caixa.csv","position":{"x":88.0026435211702,"y":263.0043207060685},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"recebimento_caixa","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"comma"},{"id":"bLzata","type":"update","appId":137,"label":"Update","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"update":[{"value":"Setembro","dataType":"Nullable(String)","tableName":"recebimento_caixa","valueType":"value","columnName":"mes","columnLength":null,"databaseName":"bucket_137"}],"computed":[]},"created":false,"position":{"x":161.49397864622344,"y":390.0045527309042},"tableName":"recebimento_caixa","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"lPgGmo","type":"table","appId":137,"label":"recebimento_caixa","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":243.5,"y":263},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"huFBPH","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","parent":"wdRqTm","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZfEqVq","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"jOTfTR","type":"computed","alias":"REAL","content":"round(ano_real+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"KpimSz","columnLength":2},{"id":"HDUKyt","type":"computed","alias":"ORCADO","content":"round(ano_orcado+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"kmLSVR","columnLength":2},{"id":"WsYivt","type":"computed","alias":"DESVIO","content":"(((ano_real - ano_orcado)/ano_orcado))*100\n\n\n\n\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"DESVIO","computedId":"PXcOFc","columnLength":2},{"id":"OVYJSp","type":"computed","alias":"ABS","content":"round(((ano_real - ano_orcado)),0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ABS","computedId":"UBaUto"}],"update":[],"computed":[{"type":"computed","alias":"DESVIO","content":"(((ano_real - ano_orcado)/ano_orcado))*100\n\n\n\n\n","dataType":"Nullable(Float64)","columnName":"DESVIO","computedId":"PXcOFc","columnLength":2},{"type":"computed","alias":"REAL","content":"round(ano_real+0.01,0)","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"KpimSz","columnLength":2},{"type":"computed","alias":"ORCADO","content":"round(ano_orcado+0.01,0)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"kmLSVR","columnLength":2},{"type":"computed","alias":"ABS","content":"round(((ano_real - ano_orcado)),0)","dataType":"Nullable(Int64)","columnName":"ABS","computedId":"UBaUto"}]},"created":false,"optimize":false,"position":{"x":404.5,"y":74},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_ano","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"IRtglG","type":"table","appId":137,"label":"tmp_recebimento_caixa_ano","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":593.5,"y":74},"tableName":"tmp_recebimento_caixa_ano","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OpFWAc","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"wdRqTm","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"OUoJtZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"MZsvoL","type":"computed","alias":"REAL","content":"dia_real+0.01\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"YTlgJf","columnLength":2},{"id":"ORFdPt","type":"computed","alias":"ORCADO","content":"dia_orcado+0.01","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"FdVopM","columnLength":2},{"id":"eUifSy","type":"computed","alias":"DESVIO","content":"((REAL - ORCADO)/ORCADO)*100\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"DESVIO","computedId":"dxjNta","columnLength":2},{"id":"zetjoH","type":"computed","alias":"ABS","content":"round(((dia_real - dia_orcado)),0)\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"ABS","computedId":"zzHVlE"}],"update":[],"computed":[{"type":"computed","alias":"REAL","content":"dia_real+0.01\n","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"YTlgJf","columnLength":2},{"type":"computed","alias":"ORCADO","content":"dia_orcado+0.01","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"FdVopM","columnLength":2},{"type":"computed","alias":"DESVIO","content":"((REAL - ORCADO)/ORCADO)*100\n\n","dataType":"Nullable(Int64)","columnName":"DESVIO","computedId":"dxjNta","columnLength":2},{"type":"computed","alias":"ABS","content":"round(((dia_real - dia_orcado)),0)\n\n","dataType":"Nullable(Int64)","columnName":"ABS","computedId":"zzHVlE"}]},"created":false,"optimize":false,"position":{"x":404.5,"y":324},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"hKoYtA","type":"table","appId":137,"label":"tmp_recebimento_caixa_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":593.5,"y":324},"tableName":"tmp_recebimento_caixa_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NuKCXY","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"wdRqTm","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UiaZlx","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"recebimento_caixa","columnName":"ano","columnLength":2,"databaseName":"bucket_137"},{"id":"VTIIni","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"lkCOOq","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"diario","columnLength":null,"databaseName":"bucket_137"},{"id":"VTzcBe","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"recebimento_caixa","columnName":"ano_2","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":404.5,"y":440},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_plus","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SxzUey","type":"table","appId":137,"label":"tmp_recebimento_caixa_plus","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":593.5,"y":440},"tableName":"tmp_recebimento_caixa_plus","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pacflx","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","parent":"wdRqTm","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"YhOjfp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"recebimento_caixa","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"AzDPKE","type":"computed","alias":"REAL","content":"round(mes_real+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"cBIqXh","columnLength":2},{"id":"QJIXRA","type":"computed","alias":"ORCADO","content":"round(mes_orcado+0.01,0)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"ggIXfb","columnLength":2},{"id":"DbxBfR","type":"computed","alias":"DESVIO","content":"((mes_real - mes_orcado )/mes_orcado) *100\n","dataType":"Nullable(Float64)","distinct":false,"columnName":"DESVIO","computedId":"BFEihu","columnLength":2},{"id":"lgGVBL","type":"computed","alias":"ABS","content":"round(((mes_real - mes_orcado )),0)\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"ABS","computedId":"kDyCgD"}],"update":[],"computed":[{"type":"computed","alias":"REAL","content":"round(mes_real+0.01,0)","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"cBIqXh","columnLength":2},{"type":"computed","alias":"ORCADO","content":"round(mes_orcado+0.01,0)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"ggIXfb","columnLength":2},{"type":"computed","alias":"DESVIO","content":"((mes_real - mes_orcado )/mes_orcado) *100\n","dataType":"Nullable(Float64)","columnName":"DESVIO","computedId":"BFEihu","columnLength":2},{"type":"computed","alias":"ABS","content":"round(((mes_real - mes_orcado )),0)\n\n","dataType":"Nullable(Int64)","columnName":"ABS","computedId":"kDyCgD"}]},"created":false,"optimize":false,"position":{"x":404.5,"y":202},"tableName":"recebimento_caixa","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimento_caixa_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"aMIPPo","type":"table","appId":137,"label":"tmp_recebimento_caixa_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":593.5,"y":202},"tableName":"tmp_recebimento_caixa_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"ZOGdbS","source":"lPgGmo","target":"huFBPH"},{"id":"fqeTaq","source":"huFBPH","target":"IRtglG"},{"id":"KsBJmV","source":"OpFWAc","target":"hKoYtA"},{"id":"ZfJJtL","source":"lPgGmo","target":"OpFWAc"},{"id":"UQSPUT","source":"lPgGmo","target":"NuKCXY"},{"id":"iaOqsm","source":"NuKCXY","target":"SxzUey"},{"id":"vwiIBa","source":"wSsKUL","target":"lPgGmo"},{"id":"YgBdVH","source":"lPgGmo","target":"pacflx"},{"id":"wdgPxZ","source":"pacflx","target":"aMIPPo"},{"id":"ZWqwOZ","source":"bLzata","target":"lPgGmo"}]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":0,"cronBase":{},"isWindow":true,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"JPDTPETnVTSiIqsyGzBZqyKBcMsejdYd","flowDescription":"","locked":"no","created":"2023-05-05 14:25:11","updated":"2023-09-08 09:08:23"},{"flowId":"2643","appId":137,"flowName":"CARREGA EMAIL","workflow":{"nodes":[{"id":"neafQe","type":"fileImport","appId":137,"label":"email_trigger_portal.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"EseRYR","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"nome","alternativeName":"nome"},{"id":"MiSXHx","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"email","alternativeName":"email"},{"id":"tIiGtY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"visao","alternativeName":"visao"},{"id":"JArdFQ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"indicador","alternativeName":"indicador"},{"id":"NeRBaT","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"horario","alternativeName":"horario"},{"id":"qqndMr","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"flag_de_acesso","columnLength":2,"alternativeName":"flag_de_acesso"},{"id":"hgzpgS","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"ativo","columnLength":2,"alternativeName":"ativo"}],"created":false,"fileName":"email_trigger_portal.csv","position":{"x":104.01130839611696,"y":147.99001336446813},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"teste_mail","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"ZnwYmE","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"created":false,"position":{"x":290,"y":149.00000000000003},"tableName":"teste_mail","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"pfXNEN","source":"neafQe","target":"ZnwYmE"}]},"cron":null,"options":{"folder":"ANALY DIÁRIO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"nLWaupXIrwBuYkfZEiQvgVIgloZAOQGK","flowDescription":"","locked":"no","created":"2023-05-10 00:57:26","updated":"2023-09-08 09:08:23"},{"flowId":"3889","appId":137,"flowName":"Portal Analytics - Bases Sem Segmento","workflow":{"nodes":[{"id":"NNMhLN","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"3888","repoId":1,"created":false,"position":{"x":56.999263979334685,"y":123.008552240879}},{"id":"WlYHzl","grid":{"h":50,"w":64,"x":0,"y":1,"hidden":false},"type":"report","appId":137,"label":"Bases sem Segmento","limit":10000,"width":1321,"height":290,"layout":{"lg":{"h":101,"w":64,"x":0,"y":5,"height":601,"hidden":false},"md":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false},"sm":{"h":50,"w":64,"x":0,"y":1,"height":290,"hidden":false}},"tables":["tmp_nivel_1","tmp_base_sem_segmento_nivel_2","tmp_base_sem_segmento_csl","tmp_base_sem_segmento_nivel_1","tmp_base_sem_segmento_nivel_1_dia","tmp_base_sem_segmento_nivel_2_dia","tmp_base_sem_segmento_nivel_3","tmp_base_sem_segmento_nivel_3_total","tmp_base_sem_segmento_nivel_3_2_total","tmp_base_sem_segmento_nivel_3_2"],"content":" ","created":false,"project":{"html":"<link href=\"/api/content/read/23/bootstrap.min.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/font_awesome.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/animate.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/style.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/bootstrap_chosen.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/23/toastr.min.css\" rel=\"stylesheet\">\r\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n<script src=\"https://code.jquery.com/jquery-3.6.1.min.js\" integrity=\"sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=\" crossorigin=\"anonymous\"></script>\r\n<link href=\"/api/content/read/23/footable.core.css\" rel=\"stylesheet\">\r\n<link href=\"/api/content/read/137/datatables.min.css\" rel=\"stylesheet\">\r\n\r\n   <style>\r\n      #btn_exp_sgm:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_hrq:hover, #btn_exp_hrq_2:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_produto:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_exp_pdt:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_view_mensal:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      }\r\n      #btn_view_diaria:hover {\r\n      color: white;\r\n      background-color: #014C56;\r\n      cursor: pointer;\r\n      text-align: center;\r\n      }\r\n      #logo_analytics {\r\n      width: 70%;\r\n      }\r\n      #btn_menu {\r\n      font-size: 140%;\r\n      color: #FFFFFF;\r\n      }\r\n      .labelDataRefDia{\r\n      display: none;\r\n      }\r\n      #visao_diaria {\r\n      display: inline-block\r\n      }\r\n      .hrq_real {\r\n      text-align: right;\r\n      }\r\n      .filtrarMes, .filtrarMesNivel2{\r\n          color: black;\r\n          font-weight: 650;\r\n          text-decoration: underline;\r\n          cursor: pointer;\r\n          color:inherit;\r\n      }\r\n      #btn_exp_hrq, #btn_exp_hrq_2 {\r\n      display: block;\r\n      }\r\n      #abertura_hrq {\r\n      display: block;\r\n      }\r\n      .html5buttons {\r\n      display: none;\r\n      }\r\n      .filtrarMesNivel2, .labelDataRefDiaNivel2 {\r\n          display: none;\r\n      }\r\n      #DataTables_Table_0_length, #DataTables_Table_1_length, #DataTables_Table_2_length, #DataTables_Table_3_length {\r\n      display: none;\r\n      }\r\n      #DataTables_Table_0_paginate, #DataTables_Table_1_paginate, #DataTables_Table_2_paginate, #DataTables_Table_3_paginate {\r\n      display: none;\r\n      }\r\n      #DataTables_Table_0, #DataTables_Table_1, #DataTables_Table_2, #DataTables_Table_3 {\r\n      width: 100% !important;\r\n      }\r\n      .table.dataTable thead .sorting_asc:after {\r\n      content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n      width: 24px;\r\n      }\r\n      .table.dataTable thead .sorting_desc:after {\r\n      content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/decrescente.png\");\r\n      }\r\n      .table.dataTable thead .sorting:after {\r\n      opacity: 0.2;\r\n      content: url(\"https://gaio.algartelecom.com.br/api/content/read/137/crescente.png\");\r\n      }\r\n      .table table-striped table-bordered table-hover dataTables-example dataTable no-footer {\r\n      width: 100%;\r\n      }\r\n      .table table-striped table-bordered table-hover dataTables-example dataTable no-footer{\r\n          width: 100% !important; \r\n      }\r\n      #result_insights_csl {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_crp {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_emp {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_ope {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      #result_insights_res {\r\n          display: block;\r\n          line-height: 1;\r\n      }\r\n      /*#filtrarMesHrqCrp, #labelDataRefDiaHrqCrp, #filtrarMesHrq {\r\n          display: block;\r\n      }*/\r\n      #labelDataRefDiacsl, #filtrarMesDia_Csl {\r\n          display: none;\r\n      }\r\n      .filtrarMes, .labelDataRefDia{\r\n         display: block;\r\n      }\r\n      #carregando {\r\n            animation: rodar 1s infinite;\r\n            border: 6px solid #ededed;\r\n            border-radius: 50%;\r\n            border-top-color: #51d4db;\r\n            height: 30px;\r\n            width: 30px;\r\n            position: fixed;\r\n            margin:  25% 50% 0%;\r\n            z-index: 1;\r\n        }\r\n        \r\n        @keyframes rodar {\r\n            to {\r\n                transform: rotate(1turn);\r\n            }\r\n        }\r\n        .percentual {\r\n            font-weight: 600;\r\n            display: inline-block; \r\n        }\r\n        #aviso_confidencial{\r\n            font-weight: 600;\r\n            font-size: 15px;\r\n            color: #090909;\r\n            margin-top: 15px;\r\n            margin-bottom: 15px;\r\n            /*background-color: #c22c18;*/\r\n            border: 2px solid #c22c18;\r\n            text-align: center;\r\n        }\r\n        .hrq_nivel_1 {\r\n          display: {{params.prm_hrq1_sem_segmento}};\r\n          width: 500px !important;\r\n          }\r\n          .hrq_nivel_2 {\r\n          display: {{params.prm_hrq2_sem_segmento}};\r\n          }\r\n          .hrq_nivel_3 {\r\n          display: {{params.prm_hrq3_sem_segmento}};\r\n          }\r\n   </style>\r\n   <meta charset=\"utf-8\">\r\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n   <title>Portal Analytics</title>\r\n</head>\r\n<body>\r\n    <div id=\"carregando\" style=\"display: none\"></div>\r\n   <div id=\"wrapper\">\r\n      <!-- Ínicio menu -->\r\n      <nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a onclick=\"get_results()\">\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\"  class=\"{% if params.prm_indicador_pai_sem_segmento == 'Negócio' %}\r\n                                              active\r\n                                            {% else %}\r\n                                             \r\n                                            {% endif %}\" >\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a onclick=\"get_results()\">\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a onclick=\"get_results()\">\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li><!--\r\n                              <a  target=\"_blank\" href=\"http://spotfirehom.algartelecom.com.br/spotfire/wp/OpenAnalysis?file=200d4235-9a88-4887-8a6d-e69fb53583ff\" id=\"item_menu_venda_digital\">\r\n                              Digital\r\n                              </a>-->\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a>Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a >Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a onclick=\"get_results()\">\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_atendimento_digital\">\r\n                        <a onclick=\"get_results()\" style=\"color: #676a6c;\"  href=\"https://gaio.algartelecom.com.br/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                    </li>\r\n                     \r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a >Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     \r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\"   class=\"{% if params.prm_indicador_pai_sem_segmento == 'Financeiro' %}\r\n                                              active\r\n                                            {% else %}\r\n                                             \r\n                                            {% endif %}\" >\r\n                  <a> \r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                      <li id=\"item_menu_margem_contribuicao\">\r\n                        <a onclick=\"get_results()\">Margem Contribuição</a>\r\n                     </li>\r\n                      <li id=\"item_menu_ebit\">\r\n                        <a onclick=\"get_results()\">Ebit</a>\r\n                     </li>\r\n                      <li id=\"item_menu_ebitda\">\r\n                        <a onclick=\"get_results()\">Ebitda</a>\r\n                     </li> \r\n   \r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Bruta\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a onclick=\"get_results()\">\r\n                              Receita Líquida\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_caixa_livre\">\r\n                        <a>Caixa Livre (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex</a>\r\n                     </li>\r\n                      \r\n                    \r\n                     \r\n                     \r\n                  </ul>\r\n               </li>\r\n               \r\n                <li id=\"side-bar-transformacao\">\r\n                  <a> \r\n                  <i class=\"fa fa-rocket\"></i>\r\n                  <span class=\"nav-label\" >\r\n                  Transformação (WIP)\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-transformacao-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"item_menu_desempenho_projeto\">\r\n                        <a onclick=\"get_results()\">Desempenho de Projetos (WIP)</a>\r\n                     </li>\r\n                    \r\n                  </ul>\r\n               </li>\r\n               \r\n               \r\n               \r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               \r\n\r\n               <li id=\"side-bar-ed\">\r\n                <a>\r\n                <i class=\"fa fa-cloud-download\"></i>\r\n                <span class=\"nav-label\">Tecnologia (WIP)</span>\r\n                </a>\r\n                <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                   collapse\">\r\n                <li id=\"item_menu_evolucao_digital\">\r\n                    <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                \r\n                            \r\n                            <li id=\"item_menu_pulse_check\">\r\n                                <a>Data Driven (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Operações automatizadas (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Novos negócios digitais (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Mindset Digital (WIP)</a>\r\n                            </li>\r\n                        </ul>\r\n                </ul>\r\n            </li>\r\n\r\n\r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>\r\n      <!-- Fim menu -->\r\n\t  \r\n      <!-- Ínicio conteúdo -->\r\n      <div id=\"page-wrapper\" class=\"gray-bg\">\r\n         <div class=\"row border-bottom\">\r\n         </div>\r\n         <!-- Ínicio cabeçalho -->\r\n         <div class=\"col-lg-12 \">\r\n            <div class=\"row \" style=\"height: 86px;\">\r\n               <nav class=\"navbar navbar-static-top\" role=\"navigation\"\r\n                  style=\"margin-bottom: 10px; background-image: linear-gradient(#50E1BC, #50E1BC);\">\r\n                  <div class=\"navbar-header\">\r\n                     <a id=\"btn_menu\" class=\"navbar-minimalize\r\n                        minimalize-styl-2\" href=\"#\">\r\n                     <i class=\"fa fa-bars\"></i>\r\n                     </a>\r\n                     <a class=\"navbar-minimalize minimalize-styl-2\"\r\n                        href=\"#\"\r\n                        style=\"cursor: default; margin-top: 5px;\">\r\n                     <img src=\"/api/content/read/137/analytics_logo.png\" width=\"240px\">\r\n                     </a>\r\n                  </div>\r\n                  <h2 class=\"m-r-sm text-white welcome-message\"\r\n                     style=\"font-size: 24px; font-weight: 500;\">\r\n                     <strong style=\"color:#363636;font-size: 30px\">Portal Analytics</strong>\r\n                  </h2>\r\n                  <ul class=\"nav navbar-top-links navbar-right\">\r\n                     <li>\r\n                        <span class=\"m-r-sm text-muted\r\n                           welcome-message\">\r\n                            <img src=\"/api/content/read/137/logo_algartelecom.png\" height=\"50px\">\r\n                            <!--\r\n                        <img\r\n                           src=\"/api/content/read/22/logo_algar.png\"\r\n                           height=\"34px\">-->\r\n                        </span>\r\n                     </li>\r\n                  </ul>\r\n               </nav>\r\n            </div>\r\n            <div id=\"aviso_confidencial\">&#60;&#60;&#60;\r\n               AS INFORMAÇÕES PUBLICADAS NESTE PORTAL SÃO CONFIDENCIAIS E NÃO PODEM SER DIVULGADAS NEM REPRODUZIDAS.\r\n               &#62;&#62;&#62;\r\n            </div>\r\n         </div>\r\n         <!-- Fim Cabeçalho -->\r\n\t\t \r\n\t\t <!-- Ínicio Área Filtros -->\r\n         <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-7\" style=\"margin-top: 50px;\">\r\n               <ol class=\"breadcrumb\">\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>Indicadores</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item\">\r\n                     <a>{{params.prm_indicador_pai_sem_segmento}}</a>\r\n                  </li>\r\n                  <li class=\"breadcrumb-item active\">\r\n                     <a>{{params.prm_indicador_sem_segmento}}</a>\r\n                  </li>\r\n               </ol>\r\n               <span>Linha de Negócio Filtrada: {{params.ProdutoBaseContrato}}</span>\r\n            </div>\r\n            <div class=\"col-lg-3\">\r\n               <div class=\"title-action\">\r\n                  <h2>\r\n                     <i id=\"limpar_filtro\" class=\"text-muted fa fa-refresh\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Limpar Filtros\" style=\"cursor: pointer;\"></i> \r\n                     <i id=\"filtrar\"\r\n                        class=\"text-muted fa fa-filter\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Filtros\"\r\n                        style=\"cursor: pointer;\"></i>\r\n                  </h2>\r\n               </div>\r\n            </div>\r\n            <div class=\"col-lg-2\">\r\n            </div>\r\n         </div>\r\n         <!-- Ínicio Área Filtros -->\r\n\t\t \r\n         <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!-- Ínicio \"Seção 1\" -->\r\n            <div class=\"row\">\r\n               <!-- Ínicio \"Gráfico 1\" -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5>\r\n                           {{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})\r\n                           <span style=\"color: #D3D3D3\">\r\n                                * 2023 considera Revisão Orçamento\r\n                           </span>\r\n                           <div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\">\r\n                              <span class=\"btn btn-white\" id=\"btn_view_mensal\" style=\"display:none\">Ver Mensal</span>\r\n                              <a class=\"btn btn-white\" id=\"btn_view_diaria\" style=\"display:block\"><span>Ver Diário</span></a>\r\n                           </div>\r\n                        </h5>\r\n                        <div class='filtrarMes' id=\"filtrarMesDia_Csl\">Filtrar Mês</div>\r\n                        <div class=\"labelDataRefDia\" id=\"labelDataRefDiacsl\">\r\n                            <h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento}}</h6>\r\n                        </div>\r\n                     </div>\r\n                     <div class=\"ibox-content\">\r\n                        <div id=\"grafMes\" style=\"display:block\">\r\n                           <div id=\"graficoConsolidadoMensal\"></div>\r\n                        </div>\r\n                        <div id=\"grafDia\" style=\"display:none\">\r\n                           <div id=\"graficoConsolidadoDiario\"></div>\r\n                        </div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Gráfico 1\" -->\r\n               <!-- Ínicio \"Insights 1\" -->\r\n            <!--</div>\r\n            <div class=\"row\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"ibox \">\r\n                     <div class=\"ibox-title\">\r\n                        <h5><span style=\"margin-right: 5px;\" class=\"fa fa-lightbulb-o\"></span>Insights</h5>\r\n                     </div>\r\n                     <div class=\"ibox-content\">\r\n                        <ul id=\"result_insights_csl\"></ul>\r\n                     </div>\r\n                  </div>\r\n               </div>-->\r\n               <!-- Fim \"Insights 1\" -->\r\n            </div>\r\n            <!-- Fim \"Seção 1\" -->\t\t\t\t\t\t\r\n            <div class=\"ibox-content\" style=\"text-align: center;\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_sgm\" class=\"btn btn-white\">Abertura {{params.prm_nome_botao1_sem_segmento}}</span>\r\n               </div>\r\n            </div>\r\n            <!-- Ínicio \"Seção 2\" -->\r\n            <div id=\"abertura_sgm\" class=\"row\" style=\"display: none;\">\r\n               <!-- Ínicio \"Tabs\" Segmento -->\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\" id=\"tabs_nivel_1\"></ul>\r\n                     <div class=\"tab-content\"  id=\"tabs_conteudo_nivel_1\">\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Segmento -->\r\n            </div>\r\n            <!-- Fim \"Seção 2\" -->\r\n            <div id=\"pai_btn_exp_hrq\" class=\"ibox-content\" style=\"text-align: center; display: none\">\r\n               <div class=\"btn-group\">\r\n                  <span id=\"btn_exp_hrq\" class=\"btn btn-white\">Abertura {{params.prm_nome_botao2_sem_segmento}}</span>\r\n                  {% if params.prm_indicador_sem_segmento == 'OPEX' %}\r\n                                              <span id=\"btn_exp_hrq_2\" class=\"btn btn-white\">Abertura {{params.prm_nome_botao3_sem_segmento}}</span>\r\n                                            {% else %}\r\n                                             \r\n                                            {% endif %}\r\n                  \r\n               </div>\r\n            </div>\r\n            \r\n            <!-- Ínicio \"Tabs\" Hierarquia -->\r\n            <div id=\"abertura_hrq\" class=\"row\" style=\"display: none;\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\" id=\"tabs_nivel_2\"></ul>\r\n                     <div class=\"tab-content\"  id=\"tabs_conteudo_nivel_2\">\r\n\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Hierarquia -->\r\n            </div>\r\n            \r\n            <div id=\"abertura_hrq_2\" class=\"row\" style=\"display: none;\">\r\n               <div class=\"col-lg-12\">\r\n                  <div class=\"tabs-container\">\r\n                     <ul class=\"nav nav-tabs\" role=\"tablist\" id=\"tabs_nivel_2_2\"></ul>\r\n                     <div class=\"tab-content\"  id=\"tabs_conteudo_nivel_2_2\">\r\n\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <!-- Fim \"Tabs\" Hierarquia -->\r\n            </div>\r\n      </div>\r\n      </div>\r\n      <!-- Fim conteúdo -->\r\n   </div>\r\n   <!-- Mainly scripts -->\r\n   <script src=\"/api/content/read/23/jquery_3.1.1.min.js\"></script>\r\n   <script src=\"/api/content/read/23/popper.min.js\"></script>\r\n   <script src=\"/api/content/read/23/bootstrap.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.metismenu.js\"></script>\r\n   <script src=\"/api/content/read/23/jquery.slimscroll.min.js\"></script>\r\n   <!-- Custom and plugin javascript -->\r\n   <script src=\"/api/content/read/23/inspinia.js\"></script>\r\n   <script src=\"/api/content/read/23/pace.min.js\"></script>\r\n   <script src=\"https://cdn.jsdelivr.net/npm/apexcharts\"></script>\r\n   <script src=\"/api/content/read/137/datatables.min.js\"></script>\r\n   <script src=\"/api/content/read/137/datatables.bootstrap4.min.js\"></script>\r\n   <script>\r\n   \r\n   // GRAFICOS DE LINHAS\r\n         var optionsLineChart= {\r\n         series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_dia %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         chart: {\r\n         height: 350,\r\n         type: 'area',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#008FFB', '#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         dataLabels: {\r\n         enabled: false\r\n         \r\n         },\r\n         \r\n         yaxis: {\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor_sem_segmento/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: {{params.prm_escala_decimais_sem_segmento/1}},\r\n                   maximumFractionDigits: {{params.prm_escala_decimais_sem_segmento/1}}});\r\n           },\r\n         },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         width: 3\r\n         },\r\n         /*colors: ['#008FFB', '#00E396'],*/\r\n         colors: ['#00E396'],\r\n          dataLabels: {\r\n            enabled: false,\r\n         },\r\n         grid: {\r\n         show: true,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         }\r\n         },\r\n         markers: {\r\n            size: 5\r\n         },\r\n         xaxis: {\r\n         categories: [{% for item in tmp_csl_dia %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         \r\n         }\r\n         }; \r\n   \r\n   var optionsBarChart = {\r\n         series: [{\r\n           name: \"Orçado\",\r\n           data: [{% for item in tmp_csl_mes %}\r\n                 {{ item.ORCADO }},\r\n                   {% endfor %}]\r\n         \r\n         },\r\n         {\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_csl_mes %}\r\n                 {{ item.REAL }},\r\n                   {% endfor %}]\r\n         \r\n         }],\r\n         \r\n         chart: {\r\n         height: 350,\r\n         type: 'bar',\r\n         zoom: {\r\n           enabled: false\r\n         },\r\n         toolbar: {\r\n             show: false\r\n         }\r\n         },\r\n         \r\n         legend: {\r\n         show: true,\r\n         position: 'bottom',\r\n         horizontalAlign: 'center', \r\n         fontSize: '14px',\r\n         fontFamily: 'Helvetica, Arial',\r\n         fontWeight: 400,\r\n         markers: {\r\n            width: 12,\r\n            height: 12,\r\n            strokeWidth: 0,\r\n            strokeColor: '#fff',\r\n            fillColors: ['#008FFB', '#00E396'],\r\n            radius: 12,\r\n         },\r\n         itemMargin: {\r\n            horizontal: 5,\r\n            vertical: 0\r\n         },\r\n         onItemClick: {\r\n            toggleDataSeries: true\r\n         },\r\n         onItemHover: {\r\n            highlightDataSeries: true\r\n         },\r\n         },\r\n         \r\n         dataLabels: {\r\n         enabled: true,\r\n         style: {\r\n                  fontSize: '9px',\r\n                  fontWeight: 'bold',\r\n                  colors: ['black'],\r\n          },\r\n         background: {\r\n              enabled: false,\r\n              foreColor: '#000',\r\n              borderRadius: 2,\r\n              padding: 4,\r\n              opacity: 0.9,\r\n              borderWidth: 1,\r\n              borderColor: '#fff'\r\n            }, \r\n          offsetY: -15,\r\n         formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor_sem_segmento/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: {{params.prm_escala_decimais_sem_segmento/1}},\r\n                   maximumFractionDigits: {{params.prm_escala_decimais_sem_segmento/1}}});\r\n           },\r\n         },\r\n         plotOptions: {\r\n            bar: {\r\n              horizontal: false,\r\n              borderRadius: 2,\r\n              dataLabels: {\r\n                position: 'top',\r\n                \r\n                  \r\n              },\r\n            },\r\n            \r\n         },\r\n         \r\n         yaxis: {\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         labels: {\r\n             show: false,\r\n             formatter: function (value) {\r\n             return (value/{{params.prm_escala_valor_sem_segmento/1}}).toLocaleString(\"pt-BR\", \r\n                  {minimumFractionDigits: {{params.prm_escala_decimais_sem_segmento/1}},\r\n                   maximumFractionDigits: {{params.prm_escala_decimais_sem_segmento/1}}});\r\n           },\r\n         },\r\n         },\r\n         stroke: {\r\n         curve: 'straight',\r\n         colors: [\"transparent\"],\r\n         width: 2\r\n         },\r\n         fill: {\r\n         colors: ['#008FFB', '#00E396'],\r\n         opacity: 1\r\n         },\r\n         grid: {\r\n         show: false,\r\n         axis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         },\r\n         yaxis: {\r\n             lines: {\r\n                 show: false\r\n             }\r\n         }\r\n         },\r\n         xaxis: {\r\n         categories: [{% for item in tmp_csl_mes %}\r\n                 '{{ item.DIA }}',\r\n               {% endfor %}],\r\n         grid: {\r\n             show: false,\r\n             stokeDashArray: 0,\r\n         },\r\n         }\r\n         };\r\n   \r\n   \r\n    \r\n   \r\n   const lista = [{% for item in  tmp_nivel_1 %}\r\n                '{{item.DSC_NVL_1}}',\r\n            {% endfor %}]\r\n   \r\n   \r\n   async function* asyncGenerator() {\r\n      var j = 0;\r\n      while (j < lista.length) {\r\n        yield j++;\r\n      }\r\n    }\r\n\r\n(async function () {\r\n  for await (let i of asyncGenerator()) {\r\n    if(i == 0){\r\n           \r\n           //tabs_nivel_1 -> Outras TABS\r\n           $('#tabs_nivel_1').append('<li><a class=\"nav-link active show\" id=\"aba-'+ i + '\" data-toggle=\"tab\" href=\"#tab-' + i + '1\">' + lista[i] + '</a></li>');\r\n           $('#tabs_conteudo_nivel_1').append('<div role=\"tabpanel\" id=\"tab-' + i + '1\" class=\"tab-pane active show\"><div class=\"panel-body\"><div class=\"row\"><div class=\"col-lg-12\"><div class=\"ibox \"><div class=\"ibox-title\"><h5>{{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})<div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\"><span class=\"btn btn-white\" id=\"btn_view_mensal_' + i + '\" style=\"display:none\">Ver Mensal</span><span class=\"btn btn-white\" id=\"btn_view_diaria_' + i + '\" style=\"display:block\">Ver Diário</span></div></h5><div class=\"filtrarMesNivel2\" id=\"filtrarMesDia' + i + '\">Filtrar Mês</div><div class=\"labelDataRefDiaNivel2\" id=\"labelDataRefDia' + i + '\"><h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento}}</h6></div></div><div class=\"ibox-content\"><div id=\"grafMes' + i + '\"style=\"display:block\"><div id=\"graficoMensal' + i + '\"></div></div><div id=\"grafDia' + i + '\"style=\"display:none\"><div id=\"graficoDia' + i + '\"></div></div></div></div></div></div></div></div>');\r\n           //tabs_nivel_2 -> Outras TABS\r\n           $('#tabs_nivel_2').append('<li><a class=\"nav-link active show\" id=\"abah-'+ i + '\" data-toggle=\"tab\" href=\"#tabh-' + i + '\">' + lista[i] + '</a></li>');\r\n           var tabela = '';\r\n           for(var j = 0;j<context.tmp_base_sem_segmento_nivel_3.length;j++){\r\n               if(context.tmp_base_sem_segmento_nivel_3[j].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '<tr><td class=\"hrq_nivel_1\">' + context.tmp_base_sem_segmento_nivel_3[j].DSC_NVL_1 + '</td><td class=\"hrq_nivel_2\">' + context.tmp_base_sem_segmento_nivel_3[j].DSC_NVL_2 + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3[j].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3[j].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3[j].REAL/context.tmp_base_sem_segmento_nivel_3[j].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tr>'\r\n                    \r\n                   \r\n               }\r\n           }\r\n           \r\n           for(var k = 0;k<context.tmp_base_sem_segmento_nivel_3_total.length;k++){\r\n               if(context.tmp_base_sem_segmento_nivel_3_total[k].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '</tbody><tfoot style=\"font-weight: 700\"><td>Total</td><td class=\"hrq_nivel_1\"></td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_total[i].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_total[i].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3_total[i].REAL/context.tmp_base_sem_segmento_nivel_3_total[i].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tfoot>';\r\n               }\r\n               \r\n           }\r\n           \r\n           \r\n           \r\n           \r\n           \r\n           $('#tabs_conteudo_nivel_2').append('<div role=\"tabpanel\" id=\"tabh-' + i + '\" class=\"tab-pane active show\"><div class=\"panel-body\"><div class=\"row\"><div class=\"col-lg-12\"><div class=\"ibox \"><div class=\"ibox-title\"><h5>{{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})</h5><div class=\"filtrarMes\" id=\"filtrarMesHrq' + i + '\">Filtrar Mês</div><div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\"><h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento_mensal}}</h6></div></div><div class=\"ibox-content\"><table class=\"table table-striped table-bordered table-hover dataTables-example\" ><thead><tr><th class=\"hrq_nivel_1\">' + context.params.prm_nivel1_sem_segmento + '</th><th class=\"hrq_nivel_2\">' + context.params.prm_nivel2_sem_segmento + '</th><th>Real</th><th>Orçado</th><th>Consecução</th></tr></thead><tbody>' + tabela + '</table></div>');\r\n        \r\n        $('#tabs_nivel_2_2').append('<li><a class=\"nav-link active show\" id=\"abahh-'+ i + '\" data-toggle=\"tab\" href=\"#tabhh-' + i + '\">' + lista[i] + '</a></li>');\r\n           var tabela = '';\r\n           for(var j = 0;j<context.tmp_base_sem_segmento_nivel_3_2.length;j++){\r\n               if(context.tmp_base_sem_segmento_nivel_3_2[j].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '<tr><td class=\"hrq_nivel_2\">' + context.tmp_base_sem_segmento_nivel_3_2[j].DSC_NVL_2 + '</td><td class=\"hrq_nivel_3\">' + context.tmp_base_sem_segmento_nivel_3_2[j].DSC_NVL_3 + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2[j].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2[j].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3_2[j].REAL/context.tmp_base_sem_segmento_nivel_3_2[j].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tr>'\r\n                    \r\n                   \r\n               }\r\n           }\r\n           \r\n           for(var k = 0;k<context.tmp_base_sem_segmento_nivel_3_2_total.length;k++){\r\n               if(context.tmp_base_sem_segmento_nivel_3_2_total[k].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '</tbody><tfoot style=\"font-weight: 700\"><td>Total</td><td></td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2_total[i].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2_total[i].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3_2_total[i].REAL/context.tmp_base_sem_segmento_nivel_3_2_total[i].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tfoot>';\r\n               }\r\n               \r\n           }\r\n           \r\n           \r\n           \r\n           \r\n           \r\n           $('#tabs_conteudo_nivel_2_2').append('<div role=\"tabpanel\" id=\"tabhh-' + i + '\" class=\"tab-pane active show\"><div class=\"panel-body\"><div class=\"row\"><div class=\"col-lg-12\"><div class=\"ibox \"><div class=\"ibox-title\"><h5>{{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})</h5><div class=\"filtrarMes\" id=\"filtrarMesHrq' + i + '\">Filtrar Mês</div><div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\"><h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento_mensal}}</h6></div></div><div class=\"ibox-content\"><table class=\"table table-striped table-bordered table-hover dataTables-example\" ><thead><tr><th class=\"hrq_nivel_2\">' + context.params.prm_nivel2_sem_segmento + '</th><th class=\"hrq_nivel_3\">' + context.params.prm_nivel3_sem_segmento + '</th><th>Real</th><th>Orçado</th><th>Consecução</th></tr></thead><tbody>' + tabela + '</table></div>');\r\n          \r\n        $(\"#filtrarMesDia\" + i).click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'EeQqCE'\r\n               })\r\n           });\r\n           \r\n           $(\"#filtrarMesHrq\" + i).click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'sECwEu'\r\n               })\r\n           }); \r\n           \r\n           var array = context.tmp_base_sem_segmento_nivel_2\r\n           var array_dia = context.tmp_base_sem_segmento_nivel_2_dia\r\n           \r\n           array_filtrado = array.filter(array_filtro => (array_filtro.DSC_NVL_1 == lista[i]));\r\n           array_filtrado_dia = array_dia.filter(array_filtro_dia => (array_filtro_dia.DSC_NVL_1 == lista[i]));\r\n           \r\n           var categoria = Array(0);\r\n           var categoria_dia = Array(0);\r\n           \r\n           for(var j = 0; j < array_filtrado.length; j++) {\r\n               categoria[j] = array_filtrado[j].Mes_Ref_Visual;\r\n           }\r\n           for(var j = 0; j < array_filtrado_dia.length; j++) {\r\n               categoria_dia[j] = array_filtrado_dia[j].Dia;\r\n           }\r\n           \r\n           \r\n           var realizado = Array(0);\r\n           var realizado_dia = Array(0);\r\n           \r\n           for(var j = 0; j < array_filtrado.length; j++) {\r\n               realizado[j] = array_filtrado[j].REAL;\r\n           }\r\n           for(var j = 0; j < array_filtrado_dia.length; j++) {\r\n               realizado_dia[j] = array_filtrado_dia[j].REAL_ACU;\r\n           }\r\n           \r\n           var orcado = Array(0);\r\n           var orcado_dia = Array(0);\r\n           \r\n           for(var j = 0; j < array_filtrado.length; j++) {\r\n               orcado[j] = array_filtrado[j].ORCADO;\r\n           }\r\n           for(var j = 0; j < array_filtrado_dia.length; j++) {\r\n               orcado_dia[j] = array_filtrado_dia[j].ORCADO;\r\n           }\r\n           \r\n           var optionsGraficoMensal = {\r\n                 series: [\r\n                 {\r\n                     \r\n                   name: \"Orçado\",\r\n                   data: orcado\r\n                 \r\n                 },\r\n                 {\r\n                   name: \"Real\",\r\n                   data: realizado\r\n                 \r\n                 }],\r\n                             \r\n        \r\n                 xaxis: {\r\n                 categories: categoria,\r\n                        // Altera a linha do eixo X    \r\n                        axisBorder: {\r\n                            show: true,\r\n                            color: '#000000',\r\n                            height: 1,\r\n                            width: '100%',\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                        // Altera a divisão da linha do eixo X  \r\n                        axisTicks: {\r\n                            show: true,\r\n                            borderType: 'solid',\r\n                            color: '#000000',\r\n                            height: 6,\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                      },\r\n                          \r\n                  grid: {\r\n                          show: true,\r\n                         \r\n                      }\r\n                 };\r\n                 \r\n                 var chartMensal = new ApexCharts(document.querySelector(\"#graficoMensal\" + i), optionsBarChart);\r\n                 \r\n                 await chartMensal.render();\r\n                 \r\n                 \r\n                 await chartMensal.updateOptions(optionsGraficoMensal)\r\n                \r\n                $(\"#btn_view_diaria_\" + i).click(function() {\r\n                   var grafDia = document.getElementById(\"grafDia\" + i);\r\n                   var grafMes = document.getElementById(\"grafMes\" + i);\r\n                   var labelData = document.getElementById(\"labelDataRefDia\" + i);\r\n                   var filtro = document.getElementById(\"filtrarMesDia\" + i);\r\n                   var btn_view_diaria = document.getElementById(\"btn_view_diaria_\" + i);\r\n                   var btn_view_mensal = document.getElementById(\"btn_view_mensal_\" + i);\r\n                   console.log(filtro);\r\n    \r\n                   \r\n                   if (grafDia.style.display === \"none\") {\r\n                   \tgrafDia.style.display = \"block\";\r\n                   \tbtn_view_diaria.style.display = \"none\";\r\n                   \tgrafMes.style.display = \"none\";\r\n                   \tbtn_view_mensal.style.display = \"block\";\r\n                   \tlabelData.style.display = \"block\";\r\n                   \tfiltro.style.display = \"block\";\r\n                   } else {\r\n                   \tgrafDia.style.display = \"none\";\r\n                   \tbtn_view_diaria.style.display = \"block\";\r\n                   \tgrafMes.style.display = \"block\";\r\n                   \tbtn_view_mensal.style.display = \"none\";\r\n                   \tlabelData.style.display = \"none\";\r\n                   \tfiltro.style.display = \"none\";\r\n                   }\r\n                });\r\n                \r\n                $(\"#btn_view_mensal_\" + i).click(function() {\r\n                   var grafDia = document.getElementById(\"grafDia\" + i);\r\n                   var grafMes = document.getElementById(\"grafMes\" + i);\r\n                   var labelData = document.getElementById(\"labelDataRefDia\" + i);\r\n                   var filtro = document.getElementById(\"filtrarMesDia\" + i);\r\n                   var btn_view_diaria = document.getElementById(\"btn_view_diaria_\" + i);\r\n                   var btn_view_mensal = document.getElementById(\"btn_view_mensal_\" + i);\r\n\r\n                   \r\n                   if (grafMes.style.display === \"none\") {\r\n                   \tgrafMes.style.display = \"block\";\r\n                   \tbtn_view_mensal.style.display = \"none\";\r\n                   \tgrafDia.style.display = \"none\";\r\n                   \tbtn_view_diaria.style.display = \"block\";\r\n                   \tlabelData.style.display = \"none\";\r\n                   \tfiltro.style.display = \"none\";\r\n                   } else {\r\n                   \tgrafMes.style.display = \"none\";\r\n                   \tbtn_view_mensal.style.display = \"block\";\r\n                   \tgrafDia.style.display = \"block\";\r\n                   \tbtn_view_diaria.style.display = \"none\";\r\n                   \tlabelData.style.display = \"block\";\r\n                   \tfiltro.style.display = \"block\";\r\n                   }\r\n                });\r\n                \r\n                \r\n                var optionsGraficoDia = {\r\n                 series: [\r\n                 {\r\n                   name: \"Real\",\r\n                   data: realizado_dia\r\n                 \r\n                 }],\r\n                             \r\n        \r\n                 xaxis: {\r\n                 categories: categoria_dia,\r\n                        // Altera a linha do eixo X    \r\n                        axisBorder: {\r\n                            show: true,\r\n                            color: '#000000',\r\n                            height: 1,\r\n                            width: '100%',\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                        // Altera a divisão da linha do eixo X  \r\n                        axisTicks: {\r\n                            show: true,\r\n                            borderType: 'solid',\r\n                            color: '#000000',\r\n                            height: 6,\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                      },\r\n                          \r\n                  grid: {\r\n                          show: true,\r\n                         \r\n                      }\r\n                 };\r\n                 \r\n                 var chartDia = new ApexCharts(document.querySelector(\"#graficoDia\" + i), optionsLineChart);\r\n                 await chartDia.render();\r\n                 \r\n                 \r\n                 await chartDia.updateOptions(optionsGraficoDia)\r\n         \r\n    }\r\n        else {\r\n           //tabs_nivel_1 -> Outras TABS\r\n           $('#tabs_nivel_1').append('<li><a class=\"nav-link\" id=\"aba-'+ i + '\" data-toggle=\"tab\" href=\"#tab-' + i + '1\">' + lista[i] + '</a></li>');\r\n           $('#tabs_conteudo_nivel_1').append('<div role=\"tabpanel\" id=\"tab-' + i + '1\" class=\"tab-pane\"><div class=\"panel-body\"><div class=\"row\"><div class=\"col-lg-12\"><div class=\"ibox \"><div class=\"ibox-title\"><h5>{{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})<div id=\"visao_diaria\" class=\"btn-group\" style=\"margin-left: 20px;\"><span class=\"btn btn-white\" id=\"btn_view_mensal_' + i + '\" style=\"display:none\">Ver Mensal</span><span class=\"btn btn-white\" id=\"btn_view_diaria_' + i + '\" style=\"display:block\">Ver Diário</span></div></h5><div class=\"filtrarMesNivel2\" id=\"filtrarMesDia' + i + '\">Filtrar Mês</div><div class=\"labelDataRefDiaNivel2\" id=\"labelDataRefDia'+ i + '\"><h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento}}</h6></div></div><div class=\"ibox-content\"><div id=\"grafMes' + i + '\"style=\"display:block\"><div id=\"graficoMensal' + i + '\"></div></div><div id=\"grafDia' + i + '\"style=\"display:none\"><div id=\"graficoDia' + i + '\"></div></div></div></div></div></div></div></div>');\r\n           //tabs_nivel_2 -> Outras TABS\r\n           $('#tabs_nivel_2').append('<li><a class=\"nav-link\" id=\"abah-'+ i + '\" data-toggle=\"tab\" href=\"#tabh-' + i + '\">' + lista[i] + '</a></li>');\r\n           var tabela = '';\r\n           for(var j = 0;j<context.tmp_base_sem_segmento_nivel_3.length;j++){\r\n               if(context.tmp_base_sem_segmento_nivel_3[j].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '<tr><td class=\"hrq_nivel_1\">' + context.tmp_base_sem_segmento_nivel_3[j].DSC_NVL_1 + '</td><td class=\"hrq_nivel_2\">' + context.tmp_base_sem_segmento_nivel_3[j].DSC_NVL_2 + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3[j].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3[j].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3[j].REAL/context.tmp_base_sem_segmento_nivel_3[j].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tr>'\r\n               }\r\n           }\r\n           \r\n           for(var k = 0;k<context.tmp_base_sem_segmento_nivel_3_total.length;k++){\r\n               if(context.tmp_base_sem_segmento_nivel_3_total[k].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '</tbody><tfoot style=\"font-weight: 700\"><td>Total</td><td class=\"hrq_nivel_1\"><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_total[i].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_total[i].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3_total[i].REAL/context.tmp_base_sem_segmento_nivel_3_total[i].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tfoot>';\r\n               }\r\n               \r\n           }\r\n           \r\n           $('#tabs_conteudo_nivel_2').append('<div role=\"tabpanel\" id=\"tabh-' + i + '\" class=\"tab-pane\"><div class=\"panel-body\"><div class=\"row\"><div class=\"col-lg-12\"><div class=\"ibox \"><div class=\"ibox-title\"><h5>{{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})</h5><div class=\"filtrarMes\" id=\"filtrarMesHrq' + i + '\">Filtrar Mês</div><div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\"><h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento_mensal}}</h6></div></div><div class=\"ibox-content\"><table class=\"table table-striped table-bordered table-hover dataTables-example\" ><thead><tr><th class=\"hrq_nivel_1\">' + context.params.prm_nivel1_sem_segmento + '</th><th class=\"hrq_nivel_2\">' + context.params.prm_nivel2_sem_segmento + '</th><th>Real</th><th>Orçado</th><th>Consecução</th></tr></thead><tbody>' + tabela + '</tbody></table></div>');\r\n            //tabs_nivel_2_2 -> Outras TABS\r\n           $('#tabs_nivel_2_2').append('<li><a class=\"nav-link\" id=\"abahh-'+ i + '\" data-toggle=\"tab\" href=\"#tabhh-' + i + '\">' + lista[i] + '</a></li>');\r\n           var tabela = '';\r\n           for(var j = 0;j<context.tmp_base_sem_segmento_nivel_3_2.length;j++){\r\n               if(context.tmp_base_sem_segmento_nivel_3_2[j].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '<tr><td class=\"hrq_nivel_2\">' + context.tmp_base_sem_segmento_nivel_3_2[j].DSC_NVL_2 + '</td><td class=\"hrq_nivel_3\">' + context.tmp_base_sem_segmento_nivel_3_2[j].DSC_NVL_3 + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2[j].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2[j].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3_2[j].REAL/context.tmp_base_sem_segmento_nivel_3_2[j].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tr>'\r\n               }\r\n           }\r\n           \r\n           for(var k = 0;k<context.tmp_base_sem_segmento_nivel_3_2_total.length;k++){\r\n               if(context.tmp_base_sem_segmento_nivel_3_2_total[k].DSC_NVL_1 == lista[i]){\r\n                   tabela = tabela + '</tbody><tfoot style=\"font-weight: 700\"><td>Total</td><td></td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2_total[i].REAL).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + (context.tmp_base_sem_segmento_nivel_3_2_total[i].ORCADO).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + '</td><td class=\"hrq_real\">' + ((context.tmp_base_sem_segmento_nivel_3_2_total[i].REAL/context.tmp_base_sem_segmento_nivel_3_2_total[i].ORCADO)*100).toLocaleString(\"pt-BR\",{minimumFractionDigits: 0, maximumFractionDigits: 0}) + ' %</td></tfoot>';\r\n               }\r\n               \r\n           }\r\n           \r\n           $('#tabs_conteudo_nivel_2_2').append('<div role=\"tabpanel\" id=\"tabhh-' + i + '\" class=\"tab-pane\"><div class=\"panel-body\"><div class=\"row\"><div class=\"col-lg-12\"><div class=\"ibox \"><div class=\"ibox-title\"><h5>{{params.prm_indicador_sem_segmento}} ({{params.prm_escala_texto_sem_segmento}})</h5><div class=\"filtrarMes\" id=\"filtrarMesHrq' + i + '\">Filtrar Mês</div><div class=\"labelDataRefDia\" id=\"labelDataRefDiaHrqCrp\"><h6>Exibindo: {{params.prm_filtro_mes_base_sem_segmento_mensal}}</h6></div></div><div class=\"ibox-content\"><table class=\"table table-striped table-bordered table-hover dataTables-example\" ><thead><tr><th class=\"hrq_nivel_2\">' + context.params.prm_nivel2_sem_segmento + '</th><th class=\"hrq_nivel_3\">' + context.params.prm_nivel3_sem_segmento + '</th><th>Real</th><th>Orçado</th><th>Consecução</th></tr></thead><tbody>' + tabela + '</tbody></table></div>');\r\n        \r\n          \r\n        $(\"#filtrarMesDia\" + i).click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'EeQqCE'\r\n               })\r\n           });\r\n           \r\n           $(\"#filtrarMesHrq\" + i).click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'sECwEu'\r\n               })\r\n           });  \r\n        \r\n        }\r\n          \r\n        contador = i;       \r\n                   \r\n        $(\"#aba-\" + i).click(async function() {\r\n           var array = context.tmp_base_sem_segmento_nivel_2\r\n           var array_dia = context.tmp_base_sem_segmento_nivel_2_dia\r\n           \r\n           array_filtrado = array.filter(array_filtro => (array_filtro.DSC_NVL_1 == lista[i]));\r\n           array_filtrado_dia = array_dia.filter(array_filtro_dia => (array_filtro_dia.DSC_NVL_1 == lista[i]));\r\n           \r\n           var categoria = Array(0);\r\n           var categoria_dia = Array(0);\r\n           \r\n           for(var j = 0; j < array_filtrado.length; j++) {\r\n               categoria[j] = array_filtrado[j].Mes_Ref_Visual;\r\n           }\r\n           for(var j = 0; j < array_filtrado_dia.length; j++) {\r\n               categoria_dia[j] = array_filtrado_dia[j].Dia;\r\n           }\r\n           \r\n           \r\n           var realizado = Array(0);\r\n           var realizado_dia = Array(0);\r\n           \r\n           for(var j = 0; j < array_filtrado.length; j++) {\r\n               realizado[j] = array_filtrado[j].REAL;\r\n           }\r\n           for(var j = 0; j < array_filtrado_dia.length; j++) {\r\n               realizado_dia[j] = array_filtrado_dia[j].REAL_ACU;\r\n           }\r\n           \r\n           var orcado = Array(0);\r\n           var orcado_dia = Array(0);\r\n           \r\n           for(var j = 0; j < array_filtrado.length; j++) {\r\n               orcado[j] = array_filtrado[j].ORCADO;\r\n           }\r\n           for(var j = 0; j < array_filtrado_dia.length; j++) {\r\n               orcado_dia[j] = array_filtrado_dia[j].ORCADO;\r\n           }\r\n           \r\n           \r\n           \r\n           \r\n           var optionsGraficoMensal = {\r\n                 series: [\r\n                 {\r\n                     \r\n                   name: \"Orçado\",\r\n                   data: orcado\r\n                 \r\n                 },\r\n                 {\r\n                   name: \"Real\",\r\n                   data: realizado\r\n                 \r\n                 }],\r\n                             \r\n        \r\n                 xaxis: {\r\n                 categories: categoria,\r\n                        // Altera a linha do eixo X    \r\n                        axisBorder: {\r\n                            show: true,\r\n                            color: '#000000',\r\n                            height: 1,\r\n                            width: '100%',\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                        // Altera a divisão da linha do eixo X  \r\n                        axisTicks: {\r\n                            show: true,\r\n                            borderType: 'solid',\r\n                            color: '#000000',\r\n                            height: 6,\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                      },\r\n                          \r\n                  grid: {\r\n                          show: true,\r\n                         \r\n                      }\r\n                 };\r\n                 \r\n                 var chartMensal = new ApexCharts(document.querySelector(\"#graficoMensal\" + i), optionsBarChart);\r\n                 console.log(\"#graficoMensal\" + i);\r\n                 await chartMensal.render();\r\n                 \r\n                 \r\n                 await chartMensal.updateOptions(optionsGraficoMensal)\r\n                \r\n                $(\"#btn_view_diaria_\" + i).click(function() {\r\n                   var grafDia = document.getElementById(\"grafDia\" + i);\r\n                   var grafMes = document.getElementById(\"grafMes\" + i);\r\n                   var labelData = document.getElementById(\"labelDataRefDia\" + i);\r\n                   var filtro = document.getElementById(\"filtrarMesDia\" + i);\r\n                   var btn_view_diaria = document.getElementById(\"btn_view_diaria_\" + i);\r\n                   var btn_view_mensal = document.getElementById(\"btn_view_mensal_\" + i);\r\n \r\n                   \r\n                   if (grafDia.style.display === \"none\") {\r\n                   \tgrafDia.style.display = \"block\";\r\n                   \tbtn_view_diaria.style.display = \"none\";\r\n                   \tgrafMes.style.display = \"none\";\r\n                   \tbtn_view_mensal.style.display = \"block\";\r\n                   \tlabelData.style.display = \"block\";\r\n                   \tfiltro.style.display = \"block\";\r\n                   } else {\r\n                   \tgrafDia.style.display = \"none\";\r\n                   \tbtn_view_diaria.style.display = \"block\";\r\n                   \tgrafMes.style.display = \"block\";\r\n                   \tbtn_view_mensal.style.display = \"none\";\r\n                   \tlabelData.style.display = \"none\";\r\n                   \tfiltro.style.display = \"none\";\r\n                   }\r\n                });\r\n                \r\n                $(\"#btn_view_mensal_\" + i).click(function() {\r\n                   var grafDia = document.getElementById(\"grafDia\" + i);\r\n                   var grafMes = document.getElementById(\"grafMes\" + i);\r\n                   var labelData = document.getElementById(\"labelDataRefDia\" + i);\r\n                   var filtro = document.getElementById(\"filtrarMesDia\" + i);\r\n                   var btn_view_diaria = document.getElementById(\"btn_view_diaria_\" + i);\r\n                   var btn_view_mensal = document.getElementById(\"btn_view_mensal_\" + i);\r\n\r\n                   \r\n                   if (grafMes.style.display === \"none\") {\r\n                   \tgrafMes.style.display = \"block\";\r\n                   \tbtn_view_mensal.style.display = \"none\";\r\n                   \tgrafDia.style.display = \"none\";\r\n                   \tbtn_view_diaria.style.display = \"block\";\r\n                   \tlabelData.style.display = \"none\";\r\n                   \tfiltro.style.display = \"none\";\r\n                   } else {\r\n                   \tgrafMes.style.display = \"none\";\r\n                   \tbtn_view_mensal.style.display = \"block\";\r\n                   \tgrafDia.style.display = \"block\";\r\n                   \tbtn_view_diaria.style.display = \"none\";\r\n                   \tlabelData.style.display = \"block\";\r\n                   \tfiltro.style.display = \"block\";\r\n                   }\r\n                });\r\n                \r\n                \r\n                var optionsGraficoDia = {\r\n                 series: [\r\n                 {\r\n                   name: \"Real\",\r\n                   data: realizado_dia\r\n                 \r\n                 }],\r\n                             \r\n        \r\n                 xaxis: {\r\n                 categories: categoria_dia,\r\n                        // Altera a linha do eixo X    \r\n                        axisBorder: {\r\n                            show: true,\r\n                            color: '#000000',\r\n                            height: 1,\r\n                            width: '100%',\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                        // Altera a divisão da linha do eixo X  \r\n                        axisTicks: {\r\n                            show: true,\r\n                            borderType: 'solid',\r\n                            color: '#000000',\r\n                            height: 6,\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                      },\r\n                          \r\n                  grid: {\r\n                          show: true,\r\n                         \r\n                      }\r\n                 };\r\n                 \r\n                 var chartDia = new ApexCharts(document.querySelector(\"#graficoDia\" + i), optionsLineChart);\r\n                 await chartDia.render();\r\n                 \r\n                 \r\n                 await chartDia.updateOptions(optionsGraficoDia)\r\n                \r\n          });           \r\n                   \r\n           \r\n    \r\n  }\r\n})();\r\n   \r\n   \r\n   \r\n\r\n   \r\n   \r\n    \r\n   var optionsGraficoMensalCsl = {\r\n                 series: [\r\n                 {\r\n                     \r\n                   name: \"Orçado\",\r\n                   data: [{% for item in tmp_base_sem_segmento_nivel_1 %}\r\n                              {{ item.ORCADO }},\r\n                            {% endfor %}]\r\n                 \r\n                 },\r\n                 {\r\n                   name: \"Real\",\r\n                   data: [{% for item in tmp_base_sem_segmento_nivel_1 %}\r\n                              {{ item.REAL }},\r\n                            {% endfor %}]\r\n                 \r\n                 }],\r\n                             \r\n        \r\n                 xaxis: {\r\n                 categories: [{% for item in tmp_base_sem_segmento_nivel_1 %}\r\n                              '{{ item.Mes_Ref_Visual }}',\r\n                            {% endfor %}],\r\n                        // Altera a linha do eixo X    \r\n                        axisBorder: {\r\n                            show: true,\r\n                            color: '#000000',\r\n                            height: 1,\r\n                            width: '100%',\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                        // Altera a divisão da linha do eixo X  \r\n                        axisTicks: {\r\n                            show: true,\r\n                            borderType: 'solid',\r\n                            color: '#000000',\r\n                            height: 6,\r\n                            offsetX: 0,\r\n                            offsetY: 0\r\n                        },\r\n                      },\r\n                          \r\n                  grid: {\r\n                          show: true,\r\n                         \r\n                      }\r\n                 };\r\n                 \r\n                 var chartConsolidadoMensal = new ApexCharts(document.querySelector(\"#graficoConsolidadoMensal\"), optionsBarChart);\r\n                 chartConsolidadoMensal.render();\r\n                 \r\n                 setTimeout(function() {\r\n                  chartConsolidadoMensal.updateOptions(optionsGraficoMensalCsl)\r\n                 }, 1);\r\n                \r\n                 \r\n                 \r\n                 \r\n                \r\n   \r\n   // GRÁFICO CONSOLIDADO - DIÁRIO\r\n         var optionsConsolidadoDiario = {\r\n          series: [{\r\n           name: \"Real\",\r\n           data: [{% for item in tmp_base_sem_segmento_nivel_1_dia %}\r\n                      {{ item.REAL_ACU }},\r\n                   {% endfor %}]\r\n         \r\n          }],\r\n          xaxis: {\r\n          categories: [{% for item in tmp_base_sem_segmento_nivel_1_dia %}\r\n                  '{{ item.Dia }}',\r\n                  {% endfor %}],\r\n                // Altera a linha do eixo X    \r\n                axisBorder: {\r\n                    show: true,\r\n                    color: '#000000',\r\n                    height: 1,\r\n                    width: '100%',\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                // Altera a divisão da linha do eixo X  \r\n                axisTicks: {\r\n                    show: true,\r\n                    borderType: 'solid',\r\n                    color: '#000000',\r\n                    height: 6,\r\n                    offsetX: 0,\r\n                    offsetY: 0\r\n                },\r\n                  }\r\n          };\r\n         \r\n         var chartConsolidadoDiario = new ApexCharts(document.querySelector(\"#graficoConsolidadoDiario\"), optionsLineChart);\r\n         chartConsolidadoDiario.render();\r\n         \r\n         setTimeout(function() {\r\n          chartConsolidadoDiario.updateOptions(optionsConsolidadoDiario)\r\n         }, 1);\r\n   \r\n\t\t// Função criada para inserir tempo de espera entre execuções\r\n      function sleep(ms) {\r\n            return new Promise(resolve => setTimeout(resolve, ms));\r\n         };\r\n         \r\n      async function carregando() {\r\n\t\t\t  var carrega = document.getElementById(\"carregando\");\r\n              carrega.style.display = \"block\";\r\n              await sleep(10000);\r\n              carrega.style.display = \"none\";\r\n              \r\n          };  \r\n          \r\nvar base_ctt = 'teste';\r\n\r\n{% if params.prm_indicador_sem_segmento == 'Base de Contratos' %}\r\n    base_ctt = ' Mensal - ' + context.params.ProdutoBaseContrato;\r\n    console.log(base_ctt);\r\n{% else %}\r\n    base_ctt = ''\r\n{% endif %}\r\n\r\n\r\nvar dadosNLP = Array(0);\r\nvar insights_final = Array(0);\r\n\r\nfetch('https://gaio.algartelecom.com.br/api/rest/pnaVxMEfqPVKHAzwmBbkkeB_wtmUQqJh/tmp_hom_processa_nlp/?filtro_api_id_nlp=all_')\r\n.then(response => {\r\n    return response.json();\r\n})\r\n.then(data => {\r\n    dadosNLP = data;\r\n\r\n});\r\n\r\nlet dia_um = 0;\r\n\r\nif(context.params.dia_mes == 1){\r\n    dia_um = 1;\r\n}\r\n    \r\n\r\n$(document).ready(function(){\r\n              $('.dataTables-example').DataTable({\r\n                  pageLength: 100,\r\n                  responsive: true,\r\n                  dom: '<\"html5buttons\"B>lTfgitp',\r\n                  buttons: [\r\n                      { extend: 'copy'},\r\n                      {extend: 'csv'},\r\n                      {extend: 'excel', title: 'ExampleFile'},\r\n                      {extend: 'pdf', title: 'ExampleFile'},\r\n         \r\n                      {extend: 'print',\r\n                       customize: function (win){\r\n                              $(win.document.body).addClass('white-bg');\r\n                              $(win.document.body).css('font-size', '10px');\r\n         \r\n                              $(win.document.body).find('table')\r\n                                      .addClass('compact')\r\n                                      .css('font-size', 'inherit');\r\n                      }\r\n                      }\r\n                  ]\r\n         \r\n              });\r\n         \r\n          });\r\n\r\n\r\n\r\n         \r\n    // Botão que leva ao indicador Venda Consolidado\r\n          $(\"#item_menu_venda_consolidada\").click(async function() {\r\n              \r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Venda', 'Venda Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(5000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });     \r\n         \r\n\t  // Botão que leva ao Menu\r\n\t\t  $(\"#side-bar-menu\").click(async function() {\r\n\t\t\t// Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['all_'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n                       await carregando();\r\n              await sleep(5000);\r\n              await dispatchEvent({ formFlowId: 1808, formType: 'openFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: 'all_' }]});\r\n          });\r\n\t  \r\n\t\t  // Botão que leva ao indicador Base de Contratos\r\n\t\t  $(\"#item_menu_base_contrato\").click(async function() {\r\n\t\t\t  // Chama processo de carregamento dos dados, filtrando os dados via parâmetro\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Contratos', 'Base de Contratos Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'Banda Larga' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });  \r\n          });\r\n\t\t  \r\n\t\t  \r\n          \r\n          // Botão que leva ao indicador Base de Clientes\r\n          $(\"#item_menu_base_cliente\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Base de Clientes', 'Base de Clientes Mensal'] },\r\n                       { paramName:'insights', paramValue: 'all_' },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n\t\t\t  await  dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] }); \r\n         \r\n          });\r\n\r\n\t\t  // Botão que leva ao indicador Ticket Medio\r\n          $(\"#item_menu_faturamento\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Faturamento Bruto Mensal', 'Ticket Medio', 'Base de Contratos TM', 'Faturamento Bruto Mensal TM'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         \r\n          });\r\n          \r\n          \r\n           // Botão que leva ao indicador Ebit\r\n         $(\"#item_menu_ebit\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebit Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n       \r\n\r\n          \r\n            // Botão que leva ao indicador Ebitda\r\n         $(\"#item_menu_ebitda\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Ebitda Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n          \r\n            // Botão que leva ao indicador Margem Contribuição\r\n         $(\"#item_menu_margem_contribuicao\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Margem Contribuição Mensal', 'Receita Liquida Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n          \r\n          \r\n           //  Botão que leva ao indicador Receita Liquida\r\n        $(\"#item_menu_receita-bruta\").click(async function() {\r\n             await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n             params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Bruta Mensal','Receita Bruta'] },\r\n                      { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                      { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n             await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         }); \r\n         \r\n        //  Botão que leva ao indicador Receita Liquida\r\n        $(\"#item_menu_caixa\").click(async function() {\r\n             await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n             params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Mensal','Fluxo de Caixa'] },\r\n                      { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                      { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n             await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         }); \r\n          \r\n        //Gráfico Recebimento\r\n      $(\"#item_menu_recebimento\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Recebimentos de Caixa Mensal','Recebimentos de Caixa'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n      });\r\n      \r\n       //Gráfico Fluxo de Caixa Livre\r\n      $(\"#item_caixa_livre\").click(async function() {\r\n        await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow', \r\n          params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Fluxo de Caixa Livre Mensal','Fluxo de Caixa Livre'] },\r\n                   { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                   { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n          await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n      });  \r\n          \r\n            //  Botão que leva ao indicador Receita Liquida\r\n        $(\"#item_menu_receita-liquida\").click(async function() {\r\n             await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n             params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Receita Líquida Mensal','Receita Líquida'] },\r\n                      { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                      { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n             await carregando();\r\n             await sleep(10000);\r\n             await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n         }); \r\n          \r\n          \r\n          \r\n          \r\n         // Botão que leva ao indicador Perda de Receita\r\n         $(\"#item_menu_perda_receita\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Perda de Receita', 'Perda de Receita Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n\t\t  // Botão que leva ao indicador Churn Físico\r\n          $(\"#item_menu_churn_fisico\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Churn Físico', 'Churn Físico Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n\t\t  // Botão que leva ao indicador Migrações Entrantes\r\n          $(\"#item_menu_migracoes_entrantes\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Entrante', 'Migração Entrante Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n\t\t  // Botão que leva ao indicador Migrações Saintes\r\n          $(\"#item_menu_migracoes_saintes\").click(async function() {\r\n              await dispatchEvent({ formFlowId: 2002, formType: 'loadFlow',\r\n              params: [{ paramName:'PRM_TIP_MTC', paramValue: ['Migração Sainte', 'Migração Sainte Mensal'] },\r\n                       { paramName:'Mes_Ref', paramValue: 'all_' },\r\n                       { paramName:'ProdutoBaseContrato', paramValue: 'all_' }]});\r\n              await carregando();\r\n              await sleep(10000);\r\n              await dispatchEvent({ formFlowId: 2005, formType: 'openFlow', params: [{}] });\r\n          });\r\n          \r\n          \r\n          \r\n            // Botão que leva ao indicador Desempenho Projetos\r\n             $(\"#item_menu_desempenho_projeto\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3400, formType: 'openFlow', params: [{}] });\r\n              });\r\n          \r\n          // Botão que leva ao indicador CAPEX\r\n             $(\"#item_menu_capex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['CAPEX', 'CAPEX Mensal']}], formReload: true });\r\n              });\r\n          // Botão que leva ao indicador OPEX\r\n             $(\"#item_menu_opex\").click(async function() {\r\n\r\n                  await carregando();\r\n                  await sleep(2000);\r\n                  await dispatchEvent({ formFlowId: 3889, formType: 'openFlow', params: [{paramName:'prm_tip_mtc_sem_segmento', paramValue: ['OPEX', 'OPEX Mensal']}], formReload: true });\r\n              });\r\n          \r\n\t\t  \r\n          \r\n                      \r\n                      \r\n         \r\n         \r\n         $(\"#btn_exp_sgm\").click(function() {\r\n           var area_segmento = document.getElementById(\"abertura_sgm\");\r\n           var area_hierarquia = document.getElementById(\"abertura_hrq\");\r\n           var area_hierarquia2 = document.getElementById(\"abertura_hrq_2\");\r\n      \r\n           var btn_sgm = document.getElementById(\"btn_exp_sgm\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           var btn_hrq2 = document.getElementById(\"btn_exp_hrq_2\");\r\n           var pai_btn_hrq = document.getElementById(\"pai_btn_exp_hrq\");\r\n           if (area_segmento.style.display === \"none\") {\r\n           \tarea_segmento.style.display = \"block\";\r\n           \tpai_btn_hrq.style.display = \"block\";\r\n           \tbtn_sgm.innerHTML = \"Esconder \" + context.params.prm_nome_botao1_sem_segmento;\r\n           } else {\r\n           \tarea_segmento.style.display = \"none\";\r\n           \tbtn_sgm.innerHTML = \"Abertura \"  + context.params.prm_nome_botao1_sem_segmento;;\r\n           \tpai_btn_hrq.style.display = \"none\";\r\n           \tarea_hierarquia.style.display = \"none\";\r\n           \tarea_hierarquia2.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura \" + context.params.prm_nome_botao2_sem_segmento;\r\n           \tbtn_hrq2.innerHTML = \"Abertura \" + context.params.prm_nome_botao3_sem_segmento;\r\n           }\r\n          });\r\n          \r\n          \r\n          $(\"#btn_exp_pdt\").click(function() {\r\n           dispatchEvent({ formFlowId: 1694, formType: 'loadFlow', params: []  });\r\n          });\r\n          \r\n          $(\"#btn_exp_hrq\").click(function() {\r\n          var area_hierarquia = document.getElementById(\"abertura_hrq\");\r\n          var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n          var area_hrq_2 = document.getElementById(\"abertura_hrq_2\");\r\n          var btn_hrq_2 = document.getElementById(\"btn_exp_hrq_2\");\r\n          \r\n          if (context.params.prm_indicador_sem_segmento === 'OPEX') {\r\n            area_hrq_2.style.display = \"none\";\r\n            btn_hrq_2.innerHTML = \"Abertura \" + context.params.prm_nome_botao3_sem_segmento;\r\n          }\r\n          \r\n           \r\n           if (area_hierarquia.style.display === \"none\") {\r\n           \t    area_hierarquia.style.display = \"block\";\r\n           \t    btn_hrq.innerHTML = \"Esconder \" + context.params.prm_nome_botao2_sem_segmento;\r\n           } else {\r\n           \t    area_hierarquia.style.display = \"none\";\r\n           \t    btn_hrq.innerHTML = \"Abertura \" + context.params.prm_nome_botao2_sem_segmento;\r\n           }\r\n          });\r\n          \r\n          $(\"#btn_exp_hrq_2\").click(function() {\r\n           var area_hrq_2 = document.getElementById(\"abertura_hrq_2\");\r\n           var btn_hrq_2 = document.getElementById(\"btn_exp_hrq_2\");\r\n           \r\n           var area_hierarquia = document.getElementById(\"abertura_hrq\");\r\n           var btn_hrq = document.getElementById(\"btn_exp_hrq\");\r\n           \r\n           \tarea_hierarquia.style.display = \"none\";\r\n           \tbtn_hrq.innerHTML = \"Abertura \" + context.params.prm_nome_botao2_sem_segmento;\r\n           \r\n           \r\n           if (area_hrq_2.style.display === \"none\") {\r\n           \tarea_hrq_2.style.display = \"block\";\r\n           \tbtn_hrq_2.innerHTML = \"Esconder \" + context.params.prm_nome_botao3_sem_segmento;\r\n           } else {\r\n           \tarea_hrq_2.style.display = \"none\";\r\n           \tbtn_hrq_2.innerHTML = \"Abertura \" + context.params.prm_nome_botao3_sem_segmento;\r\n           }\r\n          });\r\n          \r\n          // Inicio consolidado\r\n          $(\"#btn_view_diaria\").click(function() {\r\n           var grafDia = document.getElementById(\"grafDia\");\r\n           var grafMes = document.getElementById(\"grafMes\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacsl\");\r\n           var filtro = document.getElementById(\"filtrarMesDia_Csl\");\r\n           var btn_view_diaria = document.getElementById(\"btn_view_diaria\");\r\n           var btn_view_mensal = document.getElementById(\"btn_view_mensal\");\r\n           if (grafDia.style.display === \"none\") {\r\n           \tgrafDia.style.display = \"block\";\r\n           \tbtn_view_diaria.style.display = \"none\";\r\n           \tgrafMes.style.display = \"none\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tbtn_view_mensal.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDia.style.display = \"none\";\r\n           \tbtn_view_diaria.style.display = \"block\";\r\n           \tgrafMes.style.display = \"block\";\r\n           \tbtn_view_mensal.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal\").click(function() {\r\n           var grafDia = document.getElementById(\"grafDia\");\r\n           var grafMes = document.getElementById(\"grafMes\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacsl\");\r\n           var filtro = document.getElementById(\"filtrarMesDia_Csl\");\r\n           var btn_view_diaria = document.getElementById(\"btn_view_diaria\");\r\n           var btn_view_mensal = document.getElementById(\"btn_view_mensal\");\r\n           if (grafMes.style.display === \"none\") {\r\n           \tgrafDia.style.display = \"none\";\r\n           \tbtn_view_diaria.style.display = \"block\";\r\n           \tgrafMes.style.display = \"block\";\r\n           \tbtn_view_mensal.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDia.style.display = \"block\";\r\n           \tbtn_view_diaria.style.display = \"none\";\r\n           \tgrafMes.style.display = \"none\";\r\n           \tbtn_view_mensal.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim consolidado\r\n         \r\n         // Inicio Corporativo\r\n         /*$(\"#btn_view_diaria_crp\").click(function() {\r\n           var grafDiaCorp = document.getElementById(\"grafDiaCorp\");\r\n           var grafMesCorp = document.getElementById(\"grafMesCorp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacrp\");\r\n           var filtro = document.getElementById(\"filtrarMescrp\");\r\n           var btn_view_diaria_crp = document.getElementById(\"btn_view_diaria_crp\");\r\n           var btn_view_mensal_crp = document.getElementById(\"btn_view_mensal_crp\");\r\n           if (grafDiaCorp.style.display === \"none\") {\r\n           \tgrafDiaCorp.style.display = \"block\";\r\n           \tbtn_view_diaria_crp.style.display = \"none\";\r\n           \tgrafMesCorp.style.display = \"none\";\r\n           \tbtn_view_mensal_crp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaCorp.style.display = \"none\";\r\n           \tbtn_view_diaria_crp.style.display = \"block\";\r\n           \tgrafMesCorp.style.display = \"block\";\r\n           \tbtn_view_mensal_crp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });*/\r\n         \r\n         $(\"#btn_view_mensal_crp\").click(function() {\r\n           var grafDiaCorp = document.getElementById(\"grafDiaCorp\");\r\n           var grafMesCorp = document.getElementById(\"grafMesCorp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiacrp\");\r\n           var filtro = document.getElementById(\"filtrarMescrp\");\r\n           var btn_view_diaria_crp = document.getElementById(\"btn_view_diaria_crp\");\r\n           var btn_view_mensal_crp = document.getElementById(\"btn_view_mensal_crp\");\r\n           if (grafMesCorp.style.display === \"none\") {\r\n           \tgrafDiaCorp.style.display = \"none\";\r\n           \tbtn_view_diaria_crp.style.display = \"block\";\r\n           \tgrafMesCorp.style.display = \"block\";\r\n           \tbtn_view_mensal_crp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaCorp.style.display = \"block\";\r\n           \tbtn_view_diaria_crp.style.display = \"none\";\r\n           \tgrafMesCorp.style.display = \"none\";\r\n           \tbtn_view_mensal_crp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Corporativo\r\n         \r\n         \r\n         // Inicio Empresarial\r\n          $(\"#btn_view_diaria_emp\").click(function() {\r\n           var grafDiaEmp = document.getElementById(\"grafDiaEmp\");\r\n           var grafMesEmp = document.getElementById(\"grafMesEmp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaemp\");\r\n           var filtro = document.getElementById(\"filtrarMesemp\");\r\n           var btn_view_diaria_emp = document.getElementById(\"btn_view_diaria_emp\");\r\n           var btn_view_mensal_emp = document.getElementById(\"btn_view_mensal_emp\");\r\n           if (grafDiaEmp.style.display === \"none\") {\r\n           \tgrafDiaEmp.style.display = \"block\";\r\n           \tbtn_view_diaria_emp.style.display = \"none\";\r\n           \tgrafMesEmp.style.display = \"none\";\r\n           \tbtn_view_mensal_emp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaEmp.style.display = \"none\";\r\n           \tbtn_view_diaria_emp.style.display = \"block\";\r\n           \tgrafMesEmp.style.display = \"block\";\r\n           \tbtn_view_mensal_emp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_emp\").click(function() {\r\n           var grafDiaEmp = document.getElementById(\"grafDiaEmp\");\r\n           var grafMesEmp = document.getElementById(\"grafMesEmp\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaemp\");\r\n           var filtro = document.getElementById(\"filtrarMesemp\");\r\n           var btn_view_diaria_emp = document.getElementById(\"btn_view_diaria_emp\");\r\n           var btn_view_mensal_emp = document.getElementById(\"btn_view_mensal_emp\");\r\n           if (grafMesEmp.style.display === \"none\") {\r\n           \tgrafDiaEmp.style.display = \"none\";\r\n           \tbtn_view_diaria_emp.style.display = \"block\";\r\n           \tgrafMesEmp.style.display = \"block\";\r\n           \tbtn_view_mensal_emp.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaEmp.style.display = \"block\";\r\n           \tbtn_view_diaria_emp.style.display = \"none\";\r\n           \tgrafMesEmp.style.display = \"none\";\r\n           \tbtn_view_mensal_emp.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Empresarial\r\n         \r\n         // Inicio Atacado\r\n          $(\"#btn_view_diaria_ata\").click(function() {\r\n           var grafDiaAta = document.getElementById(\"grafDiaAta\");\r\n           var grafMesAta = document.getElementById(\"grafMesAta\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaata\");\r\n           var filtro = document.getElementById(\"filtrarMesata\");\r\n           var btn_view_diaria_ata = document.getElementById(\"btn_view_diaria_ata\");\r\n           var btn_view_mensal_ata = document.getElementById(\"btn_view_mensal_ata\");\r\n           if (grafDiaAta.style.display === \"none\") {\r\n           \tgrafDiaAta.style.display = \"block\";\r\n           \tbtn_view_diaria_ata.style.display = \"none\";\r\n           \tgrafMesAta.style.display = \"none\";\r\n           \tbtn_view_mensal_ata.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaAta.style.display = \"none\";\r\n           \tbtn_view_diaria_ata.style.display = \"block\";\r\n           \tgrafMesAta.style.display = \"block\";\r\n           \tbtn_view_mensal_ata.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_ata\").click(function() {\r\n           var grafDiaAta = document.getElementById(\"grafDiaAta\");\r\n           var grafMesAta = document.getElementById(\"grafMesAta\");\r\n           var labelData = document.getElementById(\"labelDataRefDiaata\");\r\n           var filtro = document.getElementById(\"filtrarMesata\");\r\n           var btn_view_diaria_ata = document.getElementById(\"btn_view_diaria_ata\");\r\n           var btn_view_mensal_ata = document.getElementById(\"btn_view_mensal_ata\");\r\n           if (grafMesAta.style.display === \"none\") {\r\n           \tgrafDiaAta.style.display = \"none\";\r\n           \tbtn_view_diaria_ata.style.display = \"block\";\r\n           \tgrafMesAta.style.display = \"block\";\r\n           \tbtn_view_mensal_ata.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaAta.style.display = \"block\";\r\n           \tbtn_view_diaria_ata.style.display = \"none\";\r\n           \tgrafMesAta.style.display = \"none\";\r\n           \tbtn_view_mensal_ata.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Atacado\r\n         \r\n         \r\n         // Inicio Varejo\r\n          $(\"#btn_view_diaria_vrj\").click(function() {\r\n           var grafDiaVar = document.getElementById(\"grafDiaVar\");\r\n           var grafMesVar = document.getElementById(\"grafMesVar\");\r\n           var labelData = document.getElementById(\"labelDataRefDiares\");\r\n           var filtro = document.getElementById(\"filtrarMesres\");\r\n           var btn_view_diaria_vrj = document.getElementById(\"btn_view_diaria_vrj\");\r\n           var btn_view_mensal_vrj = document.getElementById(\"btn_view_mensal_vrj\");\r\n           if (grafDiaVar.style.display === \"none\") {\r\n           \tgrafDiaVar.style.display = \"block\";\r\n           \tbtn_view_diaria_vrj.style.display = \"none\";\r\n           \tgrafMesVar.style.display = \"none\";\r\n           \tbtn_view_mensal_vrj.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           } else {\r\n           \tgrafDiaVar.style.display = \"none\";\r\n           \tbtn_view_diaria_vrj.style.display = \"block\";\r\n           \tgrafMesVar.style.display = \"block\";\r\n           \tbtn_view_mensal_vrj.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           }\r\n          });\r\n         \r\n         $(\"#btn_view_mensal_vrj\").click(function() {\r\n           var grafDiaVar = document.getElementById(\"grafDiaVar\");\r\n           var grafMesVar = document.getElementById(\"grafMesVar\");\r\n           var labelData = document.getElementById(\"labelDataRefDiares\");\r\n           var filtro = document.getElementById(\"filtrarMesres\");\r\n           var btn_view_diaria_vrj = document.getElementById(\"btn_view_diaria_vrj\");\r\n           var btn_view_mensal_vrj = document.getElementById(\"btn_view_mensal_vrj\");\r\n           if (grafMesVar.style.display === \"none\") {\r\n           \tgrafDiaVar.style.display = \"none\";\r\n           \tbtn_view_diaria_vrj.style.display = \"block\";\r\n           \tgrafMesVar.style.display = \"block\";\r\n           \tbtn_view_mensal_vrj.style.display = \"none\";\r\n           \tlabelData.style.display = \"none\";\r\n           \tfiltro.style.display = \"none\";\r\n           } else {\r\n           \tgrafDiaVar.style.display = \"block\";\r\n           \tbtn_view_diaria_vrj.style.display = \"none\";\r\n           \tgrafMesVar.style.display = \"none\";\r\n           \tbtn_view_mensal_vrj.style.display = \"block\";\r\n           \tlabelData.style.display = \"block\";\r\n           \tfiltro.style.display = \"block\";\r\n           }\r\n          });\r\n         // Fim Varejo\r\n         \r\n         \r\n        $(\"#filtrarMesDia_Csl\").click(function () {\r\n           dispatchEvent(\r\n               {\r\n                   formId: 'EeQqCE'\r\n               })\r\n           })  \r\n         \r\n         \r\n   </script>\r\n</body>","libs":[{"url":"","async":false}],"event":"\n              const dispatchEvent = () => {\n                  let event = new CustomEvent('change', { detail: '' })\n                  window.parent.document.dispatchEvent(event)\n              }\n        ","style":"#container {\r\n    display: inline-block;\r\n    padding: 0 200px 200px;\r\n    background: #ddd;\r\n}\r\n\r\na { cursor: pointer; }\r\n\r\n.cursor-wait {\r\n\tcursor: wait !important;\r\n}","script":"cursor_wait = function()\n{\n    // switch to cursor wait for the current element over\n    var elements = $(':hover');\n    if (elements.length)\n    {\n        // get the last element which is the one on top\n        elements.last().addClass('cursor-wait');\n    }\n    // use .off() and a unique event name to avoid duplicates\n    $('html').\n    off('mouseover.cursorwait').\n    on('mouseover.cursorwait', function(e)\n    {\n        // switch to cursor wait for all elements you'll be over\n        $(e.target).addClass('cursor-wait');\n    });\n}\n\nremove_cursor_wait = function()\n{\n    $('html').off('mouseover.cursorwait'); // remove event handler\n    $('.cursor-wait').removeClass('cursor-wait'); // get back to default\n}\n\nget_results = function(){\n    \n    cursor_wait();\n    \n    /*\n    $.ajax({\n        type: \"POST\",\n        url: \"myfile.php\",\n\n        data: { var : something },\n\n        success: function(data)\n        {\n            remove_cursor_wait();\n        }\n    });\n    */\n    \n    // simulation of a 3 sec ajax call\n    setTimeout(remove_cursor_wait, 3000);\n}"},"noSpeech":true,"position":{"x":267.5857863755036,"y":123.48603784820692},"cardStyle":false,"reportType":"staticContent","assetsCoverWidth":true}],"edges":[{"id":"ZuReTJ","type":"manual","label":"","source":"NNMhLN","target":"WlYHzl"}]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":true,"onDestroy":"resetFlow","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"infoPub","flowKey":"xKYAOHXsyibdiKEZpEEtVKuRQboffICw","flowDescription":"","locked":"no","created":"2023-08-14 09:52:08","updated":"2023-09-20 14:25:17"},{"flowId":"2640","appId":137,"flowName":"Carregar recebimentos consolidado","workflow":{"nodes":[{"id":"SIrkSJ","type":"cloudStorage","appId":137,"label":"Carregar recebimentos consolidado","client":"s3","parent":"hqYLbI","repoId":1,"columns":[],"created":false,"fileData":{"filePath":"source/modelo_recebimentos_csv/CONSOLIDADO/recebimentos_CONSOLIDADO.csv"},"position":{"x":66,"y":120},"sourceId":8,"insertMode":false,"sourceType":"source","resultTable":"recebimentos_consolidado","fileFormatType":"CSVWithNames","resultDatabase":"bucket_137","schemaInference":"schemaInference"},{"id":"BIfIYR","type":"table","appId":137,"label":"recebimentos_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":258.5,"y":120},"sourceId":8,"tableName":"recebimentos_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NCiQgx","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"UYcaWQ","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"vJZXSq","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"recebimentos_consolidado","columnName":"DATA","columnLength":null,"databaseName":"bucket_137"},{"id":"XNTLhx","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"recebimentos_consolidado","columnName":"RECEBIMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"GjyxVi","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"day","columnLength":2,"databaseName":"bucket_137"},{"id":"nOHvgG","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"week","columnLength":2,"databaseName":"bucket_137"},{"id":"cZgqgg","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"month","columnLength":2,"databaseName":"bucket_137"},{"id":"cGnhQf","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"year","columnLength":2,"databaseName":"bucket_137"},{"id":"ErUeeJ","type":"value","dataType":"Nullable(String)","tableName":"recebimentos_consolidado","columnName":"year_month","columnLength":null,"databaseName":"bucket_137"},{"id":"ahNBcS","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"dayofweek","columnLength":2,"databaseName":"bucket_137"},{"id":"VUbwuT","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"isbizday","columnLength":2,"databaseName":"bucket_137"},{"id":"JwtStH","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"isafter_d20_bizday","columnLength":2,"databaseName":"bucket_137"},{"id":"bkdxxo","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"rank_d20_bizday","columnLength":2,"databaseName":"bucket_137"},{"id":"pKsVcG","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"due_day","columnLength":2,"databaseName":"bucket_137"},{"id":"GHKviH","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado","columnName":"outlier_day","columnLength":2,"databaseName":"bucket_137"},{"id":"uuQqwa","type":"computed","alias":"recebimento_real","content":"case\n    when RECEBIMENTO is null then 0\n    else RECEBIMENTO*1000\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"recebimento_real","computedId":"QrVTep","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"recebimento_real","content":"case\n    when RECEBIMENTO is null then 0\n    else RECEBIMENTO*1000\nend","dataType":"Nullable(Float64)","columnName":"recebimento_real","computedId":"QrVTep","columnLength":2}]},"created":false,"optimize":false,"position":{"x":437,"y":120},"sourceId":8,"tableName":"recebimentos_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"recebimentos_consolidado_tratado","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"CMTziX","type":"table","appId":137,"label":"recebimentos_consolidado_tratado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":637.5,"y":120},"sourceId":8,"tableName":"recebimentos_consolidado_tratado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HfCKAk","type":"cloudStorage","appId":137,"label":"Carregar recebimentos consolidado","client":"s3","parent":"hqYLbI","repoId":1,"columns":[],"created":false,"fileData":{"filePath":"source/modelo_recebimentos_csv/FORECAST_CONSOLIDADO/previsao_consolidado_*.csv"},"position":{"x":66,"y":260},"sourceId":8,"insertMode":false,"sourceType":"source","resultTable":"projecao_consolidado","fileFormatType":";","resultDatabase":"bucket_137","schemaInference":"schemaInference"},{"id":"CItcsA","type":"table","appId":137,"label":"projecao_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":258.5,"y":260},"sourceId":8,"tableName":"projecao_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rNYmRw","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"UYcaWQ","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"NLCuAk","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"projecao_consolidado","columnName":"DATA","columnLength":null,"databaseName":"bucket_137"},{"id":"KnlgHV","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"day","columnLength":2,"databaseName":"bucket_137"},{"id":"KDOfoZ","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"week","columnLength":2,"databaseName":"bucket_137"},{"id":"rbcXTJ","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"month","columnLength":2,"databaseName":"bucket_137"},{"id":"qnQqTK","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"year","columnLength":2,"databaseName":"bucket_137"},{"id":"EJODyS","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"dayofweek","columnLength":2,"databaseName":"bucket_137"},{"id":"LAcLnf","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"isbizday","columnLength":2,"databaseName":"bucket_137"},{"id":"vFqaLc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"isafter_d20_bizday","columnLength":2,"databaseName":"bucket_137"},{"id":"gYhdiv","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"rank_d20_bizday","columnLength":2,"databaseName":"bucket_137"},{"id":"BZDESb","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"due_day","columnLength":2,"databaseName":"bucket_137"},{"id":"wgfMQw","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"projecao_consolidado","columnName":"outlier_day","columnLength":2,"databaseName":"bucket_137"},{"id":"wXsQey","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"projecao_consolidado","columnName":"PREDICTED","columnLength":2,"databaseName":"bucket_137"},{"id":"tWwAMx","type":"value","dataType":"Nullable(Float64)","tableName":"projecao_consolidado","columnName":"PREDICTED_PLUS_ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"QrewVy","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"projecao_consolidado","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":437,"y":260},"sourceId":8,"tableName":"projecao_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"projecao_consolidados_tratados","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pmltsb","type":"table","appId":137,"label":"projecao_consolidados_tratados","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":637.5,"y":260},"sourceId":8,"tableName":"projecao_consolidados_tratados","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RmKVnn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"projecao_consolidados_tratados","id":"GFQzfs","to":"recebimentos_consolidado_tratado","raw":"","list":[{"id":"nICQxh","andOr":"and","tableBy":"projecao_consolidados_tratados","tableTo":"recebimentos_consolidado_tratado","columnBy":"DATA","columnTo":"DATA","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"vmyovq","type":"value","dataType":"Nullable(Date)","tableName":"projecao_consolidados_tratados","columnName":"DATA","columnLength":null,"databaseName":"bucket_137"},{"id":"ErOYrf","type":"value","dataType":"Nullable(Float64)","tableName":"projecao_consolidados_tratados","columnName":"PREDICTED","columnLength":2,"databaseName":"bucket_137"},{"id":"IalqZa","type":"value","dataType":"Nullable(Float64)","tableName":"projecao_consolidados_tratados","columnName":"PREDICTED_PLUS_ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"HTIzrr","type":"value","dataType":"Nullable(Float64)","tableName":"recebimentos_consolidado_tratado","columnName":"recebimento_real","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":813,"y":190},"sourceId":8,"tableName":"projecao_consolidados_tratados","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_recebimentos","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GLpqhI","type":"table","appId":137,"label":"forecast_recebimentos","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":955.5,"y":190},"sourceId":8,"tableName":"forecast_recebimentos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pfIqNV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"XgqXBO","type":"computed","alias":"ANO","andOr":"and","value":"toYear(today())","content":"toYear(toStartOfYear(DATA))","dataType":"Nullable(String)","distinct":false,"operator":"=","fieldType":"computed","valueType":"computed","columnName":"ANO","computedId":"NlUWbb","extraValue":""}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jglPVH","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"forecast_recebimentos","columnName":"DATA","columnLength":null,"databaseName":"bucket_137"},{"id":"EqOGDu","type":"computed","alias":"DIA","content":"toDayOfYear(DATA)","dataType":"Nullable(String)","distinct":false,"columnName":"DIA","computedId":"WJqmtX"},{"id":"enmdvw","type":"computed","alias":"MES","content":"toMonth(toStartOfMonth(DATA))","dataType":"Nullable(String)","distinct":false,"columnName":"MES","computedId":"JmAbWK"},{"id":"isWylf","type":"computed","alias":"ANO","content":"toYear(toStartOfYear(DATA))","dataType":"Nullable(String)","distinct":false,"columnName":"ANO","computedId":"NlUWbb"},{"id":"SJKgcU","type":"computed","alias":"REAL","content":"case when recebimento_real is null then 0\nelse recebimento_real\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"Ornclh","columnLength":2},{"id":"hZiwpf","type":"computed","alias":"ORCADO","content":"case when PREDICTED_PLUS_ORCADO is null then 0\nelse PREDICTED_PLUS_ORCADO\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"sgUFoJ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ANO","content":"toYear(toStartOfYear(DATA))","dataType":"Nullable(String)","columnName":"ANO","computedId":"NlUWbb"},{"type":"computed","alias":"MES","content":"toMonth(toStartOfMonth(DATA))","dataType":"Nullable(String)","columnName":"MES","computedId":"JmAbWK"},{"type":"computed","alias":"DIA","content":"toDayOfYear(DATA)","dataType":"Nullable(String)","columnName":"DIA","computedId":"WJqmtX"},{"type":"computed","alias":"REAL","content":"case when recebimento_real is null then 0\nelse recebimento_real\nend","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"Ornclh","columnLength":2},{"type":"computed","alias":"ORCADO","content":"case when PREDICTED_PLUS_ORCADO is null then 0\nelse PREDICTED_PLUS_ORCADO\nend","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"sgUFoJ","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1098,"y":190},"sourceId":8,"tableName":"forecast_recebimentos","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_recebimentos_moldados","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"tMFXFb","type":"table","appId":137,"label":"tmp_recebimentos_moldados","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1258.5,"y":190},"sourceId":8,"tableName":"tmp_recebimentos_moldados","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"anmQLI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"glXamS","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"YXdzqA","type":"value","alias":"MES","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_recebimentos_moldados","columnName":"MES","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"LIUawO","type":"value","andOr":"and","value":"toStartOfMonth(today())","dataType":"Nullable(Date)","operator":">=","fieldType":"value","tableName":"tmp_recebimentos_moldados","valueType":"computed","columnName":"DATA","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"gKHJOb","type":"value","alias":"MES","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_recebimentos_moldados","columnName":"MES","columnLength":null,"databaseName":"bucket_137"},{"id":"CQLnZi","type":"computed","alias":"REAL_","content":"sum(round(REAL/1000000,0))","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_","computedId":"WLQHJU"},{"id":"aAxqls","type":"computed","alias":"ORCADO_","content":"sum(round(ORCADO/1000000,0))","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_","computedId":"ZmDDwK"}],"update":[],"computed":[{"type":"computed","alias":"REAL_","content":"sum(round(REAL/1000000,0))","dataType":"Nullable(Int64)","columnName":"REAL_","computedId":"WLQHJU"},{"type":"computed","alias":"ORCADO_","content":"sum(round(ORCADO/1000000,0))","dataType":"Nullable(Int64)","columnName":"ORCADO_","computedId":"ZmDDwK"}]},"created":false,"optimize":false,"position":{"x":1447.5,"y":68},"sourceId":8,"tableName":"tmp_recebimentos_moldados","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"recebimento_caixa_mes","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"yWSjWL","type":"table","appId":137,"label":"recebimento_caixa_mes","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1623,"y":68},"sourceId":8,"tableName":"recebimento_caixa_mes","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wHSIip","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","parent":"glXamS","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"lfETZT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_recebimentos_moldados","columnName":"ANO","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"hSeqBG","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_recebimentos_moldados","columnName":"ANO","columnLength":null,"databaseName":"bucket_137"},{"id":"CQLnZi","type":"computed","alias":"REAL_","content":"round(sum(REAL)/1000000,0)\n\n","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_","computedId":"WLQHJU"},{"id":"aAxqls","type":"computed","alias":"ORCADO_","content":"sum(round(ORCADO/1000000,0))","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_","computedId":"ZmDDwK"}],"update":[],"computed":[{"type":"computed","alias":"REAL_","content":"round(sum(REAL)/1000000,0)\n\n","dataType":"Nullable(Int64)","columnName":"REAL_","computedId":"WLQHJU"},{"type":"computed","alias":"ORCADO_","content":"sum(round(ORCADO/1000000,0))","dataType":"Nullable(Int64)","columnName":"ORCADO_","computedId":"ZmDDwK"}]},"created":false,"optimize":false,"position":{"x":1447.5,"y":190},"sourceId":8,"tableName":"tmp_recebimentos_moldados","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"recebimento_caixa_ano","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"QxLNBI","type":"table","appId":137,"label":"recebimento_caixa_ano","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1623,"y":190},"sourceId":8,"tableName":"recebimento_caixa_ano","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rTauPY","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"glXamS","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"zhhFiz","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_recebimentos_moldados","columnName":"DATA","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"uyvevh","type":"value","andOr":"and","value":"today()-1","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"tmp_recebimentos_moldados","valueType":"computed","columnName":"DATA","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GQIqoy","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_recebimentos_moldados","columnName":"DATA","columnLength":null,"databaseName":"bucket_137"},{"id":"LKjbzj","type":"computed","alias":"ORCADO_","content":"sum(round(ORCADO/1000000,0))","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_","computedId":"vnlMKa","columnLength":2},{"id":"VcoJdg","type":"computed","alias":"REAL_","content":"sum(round(REAL/1000000,0))","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_","computedId":"yuwxiK","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO_","content":"sum(round(ORCADO/1000000,0))","dataType":"Nullable(Float64)","columnName":"ORCADO_","computedId":"vnlMKa","columnLength":2},{"type":"computed","alias":"REAL_","content":"sum(round(REAL/1000000,0))","dataType":"Nullable(Float64)","columnName":"REAL_","computedId":"yuwxiK","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1447.5,"y":312},"sourceId":8,"tableName":"tmp_recebimentos_moldados","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"recebimento_caixa_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fxPDVt","type":"table","appId":137,"label":"recebimento_caixa_dia","client":"clickhouse","repoId":1,"shared":false,"position":{"x":1623,"y":312},"sourceId":8,"tableName":"recebimento_caixa_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hqYLbI","type":"group","label":"Parallel","created":false,"position":{"x":66,"y":212.5}},{"id":"UYcaWQ","type":"group","label":"Parallel","created":false,"position":{"x":437,"y":200.5}},{"id":"glXamS","type":"group","label":"Parallel","created":false,"position":{"x":1447.5,"y":200.5}}],"edges":[{"id":"ilVzTR","source":"anmQLI","target":"yWSjWL"},{"id":"bWFtId","source":"BIfIYR","target":"NCiQgx"},{"id":"XdFjMI","source":"RmKVnn","target":"GLpqhI"},{"id":"MtSfXI","source":"CMTziX","target":"RmKVnn"},{"id":"aSlqTn","source":"pmltsb","target":"RmKVnn"},{"id":"TaEpah","source":"SIrkSJ","target":"BIfIYR"},{"id":"nIiIAZ","source":"CItcsA","target":"rNYmRw"},{"id":"VdHCWz","source":"NCiQgx","target":"CMTziX"},{"id":"MKLQVc","source":"rNYmRw","target":"pmltsb"},{"id":"tJAdCX","source":"HfCKAk","target":"CItcsA"},{"id":"MljYQa","source":"GLpqhI","target":"pfIqNV"},{"id":"xaLonQ","source":"pfIqNV","target":"tMFXFb"},{"id":"nBZDVR","source":"tMFXFb","target":"anmQLI"},{"id":"jJmVid","source":"tMFXFb","target":"wHSIip"},{"id":"nKvmiT","source":"wHSIip","target":"QxLNBI"},{"id":"yrZGJz","source":"tMFXFb","target":"rTauPY"},{"id":"kGTHYH","source":"rTauPY","target":"fxPDVt"}]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"DAdXXJFfNDUSwHHOXJSVRYsIoTJuu_yk","flowDescription":"","locked":"no","created":"2023-05-09 15:37:23","updated":"2023-09-08 09:08:23"},{"flowId":"2596","appId":137,"flowName":" CARGA - Histórico Forecast Venda","workflow":{"nodes":[{"id":"nQZLbF","type":"table","appId":137,"label":"aux_forecast_hist","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":213,"y":33},"sourceId":null,"tableName":"aux_forecast_hist","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"szhTrm","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"aux_forecast_hist","columnName":"data","columnLength":null,"databaseName":"bucket_137","targetColumn":"data"},{"dataType":"Nullable(Float64)","tableName":"aux_forecast_hist","columnName":"CORPORATIVO","columnLength":2,"databaseName":"bucket_137","targetColumn":"CORPORATIVO"},{"dataType":"Nullable(Float64)","tableName":"aux_forecast_hist","columnName":"EMPRESARIAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"EMPRESARIAL"},{"dataType":"Nullable(Float64)","tableName":"aux_forecast_hist","columnName":"RESIDENCIAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"RESIDENCIAL"},{"dataType":"Nullable(Float64)","tableName":"aux_forecast_hist","columnName":"OPERADORAS","columnLength":2,"databaseName":"bucket_137","targetColumn":"OPERADORAS"}]},"shared":false,"created":false,"position":{"x":329.99833937355737,"y":-102.9944854669076},"sourceId":null,"tableName":"aux_forecast_hist","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FORECAST_HIST","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"nLiIPD","type":"table","appId":137,"label":"BASE_FORECAST_HIST","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":440.9984960364294,"y":33},"sourceId":null,"tableName":"BASE_FORECAST_HIST","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"PSejCh","source":"nQZLbF","target":"szhTrm"},{"id":"IbvpnI","source":"szhTrm","target":"nLiIPD"}]},"cron":"0 16 * * *","options":{"folder":"CARGAS","reload":0,"cronBase":{"every":3,"current":"0 16 * * *","dayValues":[],"hourValues":[16],"monthValues":[],"minuteValues":[0],"dayOfMonthValues":[]},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"NMYgtDHxznmYUqTALpquBCOrEZWLmsex","flowDescription":"Processo que efetua o armazenamento da informação de Forecast de Vendas no GAIO.","locked":"no","created":"2023-05-04 08:52:46","updated":"2023-09-08 09:08:23"},{"flowId":"2556","appId":137,"flowName":"ETL - Highlight 2","workflow":{"nodes":[{"id":"kDstpk","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"2553","repoId":1,"created":false,"position":{"x":22,"y":33}},{"id":"JHqcZc","type":"flow","appId":137,"label":"Flow","client":"clickhouse","flowId":"2555","repoId":1,"created":false,"position":{"x":116,"y":33}}],"edges":[{"id":"EJTPqR","type":"manual","label":"","source":"kDstpk","target":"JHqcZc"}]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"qfLzuNtIyERpIjxJWhZMdfbcrnqsyGMA","flowDescription":"","locked":"no","created":"2023-04-28 11:50:16","updated":"2023-09-08 09:08:23"},{"flowId":"2555","appId":137,"flowName":"ETL - Highlight 1","workflow":{"nodes":[{"id":"SzKzGo","type":"table","appId":137,"label":"tmp_base_aux_highlight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":70,"y":164},"sourceId":null,"tableName":"tmp_base_aux_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"Ieohfp","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GMCwGi","type":"computed","alias":"Data","content":"max(concat(\ncase when toDayOfMonth(today()) > 9 then toString(toDayOfMonth(today())) else concat('0',toString(toDayOfMonth(today()))) end\n,'/',\ncase when toMonth(today()) > 9 then toString(toMonth(today())) else concat('0',toString(toMonth(today()))) end,'/',\ntoString(toYear(today()))\n\n))","dataType":"Nullable(String)","distinct":false,"columnName":"Data","computedId":"VytpLV"}],"update":[],"computed":[{"type":"computed","alias":"Data","content":"max(concat(\ncase when toDayOfMonth(today()) > 9 then toString(toDayOfMonth(today())) else concat('0',toString(toDayOfMonth(today()))) end\n,'/',\ncase when toMonth(today()) > 9 then toString(toMonth(today())) else concat('0',toString(toMonth(today()))) end,'/',\ntoString(toYear(today()))\n\n))","dataType":"Nullable(String)","columnName":"Data","computedId":"VytpLV"}]},"created":false,"optimize":false,"position":{"x":68.00288259684373,"y":386.9950494532466},"sourceId":null,"tableName":"tmp_base_aux_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"status_highlight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"PMXhpP","type":"table","appId":137,"label":"status_highlight","client":"clickhouse","repoId":1,"shared":false,"position":{"x":258.00281993169506,"y":388.0022246127816},"sourceId":null,"tableName":"status_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"lFHIFC","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":461.9852100594785,"y":387.9881572522912},"tableName":"status_highlight","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_status_highlight","columnName":"Data"}]},{"id":"gmQvgG","type":"builder","appId":137,"label":"Números Perda Receita","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"SIUDrw","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_aux_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"ZAkVjx","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_aux_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"HGZDLl","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"byHuLG","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"NnmFkC","type":"computed","alias":"FORECAST_VENDA_","content":"'0'","dataType":"Nullable(String)","distinct":false,"columnName":"FORECAST_VENDA_","computedId":"CfkDbz"},{"id":"GAhVVz","type":"computed","alias":"FORECAST_PERCENTUAL","content":"case \nwhen ORCADO is NULL OR ORCADO = 0 then 0\nelse  ROUND((REAL/ORCADO)*100,0)\nend","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_PERCENTUAL","computedId":"rGOnET"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"hBlQcj","type":"value","andOr":"and","value":"Perda de Receita","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_aux_highlight","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VolBXc","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_aux_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gscdOQ","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zzfery","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"JcoYPn","type":"computed","alias":"FORECAST_VENDA_","content":"'0'","dataType":"Nullable(String)","distinct":false,"columnName":"FORECAST_VENDA_","computedId":"CfkDbz"},{"id":"qYaIRw","type":"computed","alias":"FORECAST_PERCENTUAL","content":"case \nwhen ORCADO is NULL OR ORCADO = 0 then 0\nelse  ROUND((REAL/ORCADO)*100,0)\nend","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_PERCENTUAL","computedId":"rGOnET"}],"update":[],"computed":[{"type":"computed","alias":"FORECAST_PERCENTUAL","content":"case \nwhen ORCADO is NULL OR ORCADO = 0 then 0\nelse  ROUND((REAL/ORCADO)*100,0)\nend","dataType":"Nullable(Int64)","columnName":"FORECAST_PERCENTUAL","computedId":"rGOnET"},{"type":"computed","alias":"FORECAST_VENDA_","content":"'0'","dataType":"Nullable(String)","columnName":"FORECAST_VENDA_","computedId":"CfkDbz"}]},"created":false,"optimize":false,"position":{"x":226.32382208066565,"y":165.09900492573675},"sourceId":null,"tableName":"tmp_base_aux_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_highlight_prd","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"FQcPZW","type":"table","appId":137,"label":"tmp_base_highlight_prd","client":"clickhouse","repoId":1,"shared":false,"position":{"x":375.3234549249476,"y":165.8874445602483},"sourceId":null,"tableName":"tmp_base_highlight_prd","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"XUkbMg","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":70,"y":39},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eLLSAH","type":"builder","appId":137,"label":"Números Venda Aux","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_base_aux_highlight","id":"PTagOw","to":"forecast_insight","raw":"","list":[{"id":"DiYdPy","andOr":"and","tableBy":"tmp_base_aux_highlight","tableTo":"forecast_insight","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"kNEujx","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_aux_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"ZAkVjx","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_aux_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"HGZDLl","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"byHuLG","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"QTSfHU","type":"computed","alias":"FORECAST_VENDA_","content":"CASE WHEN FORECAST_VENDA is not NULL then FORECAST_VENDA\nelse 0\nend","dataType":"Nullable(Int64)","columnName":"FORECAST_VENDA_","computedId":"HzQDlr"},{"id":"SysaPt","type":"computed","alias":"FORECAST_PERCENTUAL","content":"case when FORECAST_VENDA is not NULL then ROUND((FORECAST_VENDA/ORCADO)*100)\nelse 0\nend","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_PERCENTUAL","computedId":"mwMOaH"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"hBlQcj","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_base_aux_highlight","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VolBXc","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_aux_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gscdOQ","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zzfery","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_base_aux_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"uibpRG","type":"computed","alias":"FORECAST_VENDA_","content":"CASE WHEN FORECAST_VENDA is not NULL then FORECAST_VENDA\nelse 0\nend","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_VENDA_","computedId":"HzQDlr"},{"id":"HwkxFk","type":"computed","alias":"FORECAST_PERCENTUAL","content":"case when FORECAST_VENDA is not NULL then ROUND((FORECAST_VENDA/ORCADO)*100)\nelse 0\nend","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_PERCENTUAL","computedId":"mwMOaH"}],"update":[],"computed":[{"type":"computed","alias":"FORECAST_PERCENTUAL","content":"case when FORECAST_VENDA is not NULL then ROUND((FORECAST_VENDA/ORCADO)*100)\nelse 0\nend","dataType":"Nullable(Int64)","columnName":"FORECAST_PERCENTUAL","computedId":"mwMOaH"},{"type":"computed","alias":"FORECAST_VENDA_","content":"CASE WHEN FORECAST_VENDA is not NULL then FORECAST_VENDA\nelse 0\nend","dataType":"Nullable(Int64)","columnName":"FORECAST_VENDA_","computedId":"HzQDlr"}]},"created":false,"optimize":false,"position":{"x":224,"y":39},"sourceId":null,"tableName":"tmp_base_aux_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_highlight_vnd","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"EVKomJ","type":"table","appId":137,"label":"tmp_base_highlight_vnd","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":378,"y":39},"sourceId":null,"tableName":"tmp_base_highlight_vnd","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"McQlxA","source":"PMXhpP","target":"lFHIFC"},{"id":"JiHYaG","source":"SzKzGo","target":"eLLSAH"},{"id":"oUPfzB","source":"XUkbMg","target":"eLLSAH"},{"id":"QHEMCA","source":"eLLSAH","target":"EVKomJ"},{"id":"LQrVTV","source":"SzKzGo","target":"Ieohfp"},{"id":"NfYhpk","source":"Ieohfp","target":"PMXhpP"},{"id":"EipYUg","source":"SzKzGo","target":"gmQvgG"},{"id":"Admuaq","source":"gmQvgG","target":"FQcPZW"}]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"rjNBbSkOaqLGJfczurltSeGgntAxUtOQ","flowDescription":"","locked":"no","created":"2023-04-28 11:50:08","updated":"2023-09-08 09:08:23"},{"flowId":"2553","appId":137,"flowName":"ETL - Highlight","workflow":{"nodes":[{"id":"SFizsz","type":"insertRow","appId":137,"label":"Inserção Linha","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[{"value":"2023-09-01","dataType":"Nullable(DateTime)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"value":"Venda","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"value":"CORPORATIVO","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"value":"N/A","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"value":"N/A","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"value":"N/A","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"value":"N/A","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"value":"1","dataType":"Nullable(Float64)","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"computed":[]},"created":false,"position":{"x":-146.96772254479603,"y":278.55924623482144},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"lgyonH","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-18.971733114317814,"y":280.5591835696726},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pTnSEN","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"bSYeSi","type":"computed","alias":"DIA","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"DIA","computedId":"FfxItY"},{"id":"yBeNHj","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"rbCnkw","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"OivHoM","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"ncwhFZ","type":"value","andOr":"and","value":["Perda de Receita","Venda"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"rJcjkp","type":"computed","alias":"DIA","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"DIA","computedId":"FfxItY"},{"id":"yBeNHj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"rbCnkw","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"RHFrMY","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"FfxItY"}]},"created":false,"optimize":false,"position":{"x":241,"y":286},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_highlight_base","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"VdAexA","type":"table","appId":137,"label":"tmp_highlight_base","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":390.5,"y":286},"sourceId":null,"tableName":"tmp_highlight_base","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pBRlGA","type":"builder","appId":137,"label":"Gráfico Venda","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"wXShYz","type":"value","alias":"","order":"asc","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"ETlkyq","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"tRCPvC","type":"value","dataType":"Nullable(String)","tableName":"tmp_highlight_base","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"yxvumF","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_highlight_base","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"iqwGbD","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"VHvEdc","type":"sum","alias":"REAL","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PyAssM","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY TIP_MTC ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_ACU","computedId":"zXYpvD"}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY TIP_MTC ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Int64)","columnName":"REAL_ACU","computedId":"zXYpvD"}]},"created":false,"optimize":false,"position":{"x":546.4998746697024,"y":33.00382257407543},"sourceId":null,"tableName":"tmp_highlight_base","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_highlight_vnd","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NlqmUp","type":"table","appId":137,"label":"tmp_highlight_vnd","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":692.5,"y":155},"sourceId":null,"tableName":"tmp_highlight_vnd","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"scigMF","type":"builder","appId":137,"label":"Gráfico Perda de Receita","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"RivrJn","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"tRCPvC","type":"value","dataType":"Nullable(String)","tableName":"tmp_highlight_base","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"yxvumF","type":"value","andOr":"and","value":"Perda de Receita","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tmp_highlight_base","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jWVNAG","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"},{"id":"VHvEdc","type":"sum","alias":"REAL","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"PyAssM","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY TIP_MTC ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_ACU","computedId":"zXYpvD"}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY TIP_MTC ORDER BY DIA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Int64)","columnName":"REAL_ACU","computedId":"zXYpvD"}]},"created":false,"optimize":false,"position":{"x":555.499592676533,"y":205.00263193624875},"sourceId":null,"tableName":"tmp_highlight_base","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_highlight_prd","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"hBWgpZ","type":"table","appId":137,"label":"tmp_highlight_prd","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":692.5,"y":289},"sourceId":null,"tableName":"tmp_highlight_prd","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QYujmx","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"LCtdDP","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_highlight_base","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"StiafZ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_highlight_base","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"fdKVVW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_highlight_base","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"wIpIXw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_highlight_base","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VMCGrE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_highlight_base","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"wIpIXw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_highlight_base","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"rIfibe","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_highlight_base","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":548.4998120045536,"y":368.0015352961452},"sourceId":null,"tableName":"tmp_highlight_base","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_segmento_highlight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vFyyyK","type":"table","appId":137,"label":"tmp_segmento_highlight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":692.5,"y":417},"sourceId":null,"tableName":"tmp_segmento_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"Myljqv","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"Ejovqs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"DUaNYU","type":"value","andOr":"and","value":["Venda Mensal","Venda"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"JbFEfO","type":"value","andOr":"and","value":"2023-08-01 00:00:00","dataType":"Nullable(DateTime)","operator":"between","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"2023-08-31 00:00:00","columnLength":2,"databaseName":"bucket_137"},{"id":"PlsiYj","type":"value","andOr":"and","value":"CORPORATIVO","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"RsDGbs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"eaJfRQ","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"DVoFaF","type":"sum","alias":"sum_TAXA_INSTALACAO","dataType":"Nullable(Int64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":-15.969007180345995,"y":393.557679606102},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_validacao_tmp","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"cHlVTW","type":"table","appId":137,"label":"tmp_validacao_tmp","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":133.0291441977651,"y":394.5576482735275},"sourceId":null,"tableName":"tmp_validacao_tmp","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kHbJaM","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":390.5,"y":33},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"lHGFwr","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"DsRrLY","type":"computed","alias":"metrica","content":"CASE\nwhen tip_mtc = 'Perda de Receita Mensal' then 'Perda de Receita'\nwhen tip_mtc = 'Venda Mensal' then 'Venda'\nelse ''\nend","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"GByVUa"},{"id":"aSvmxR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"IIXUbQ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"DDWZfL","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"base_orcado_portal_sgm","valueType":"computed","columnName":"mes_ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"mbfzbM","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"base_orcado_portal_sgm","valueType":"value","columnName":"tip_mtc","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"cOUfsm","type":"computed","alias":"metrica","content":"CASE\nwhen tip_mtc = 'Perda de Receita Mensal' then 'Perda de Receita'\nwhen tip_mtc = 'Venda Mensal' then 'Venda'\nelse ''\nend","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"GByVUa"},{"id":"HpZWzI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"eaytnt","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"CASE\nwhen tip_mtc = 'Perda de Receita Mensal' then 'Perda de Receita'\nwhen tip_mtc = 'Venda Mensal' then 'Venda'\nelse ''\nend","dataType":"Nullable(String)","columnName":"metrica","computedId":"GByVUa"}]},"created":false,"optimize":false,"position":{"x":539.5000939977232,"y":-62.99699207285869},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_orcado_highlight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oEmomF","type":"table","appId":137,"label":"tmp_orcado_highlight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":692.5,"y":33},"sourceId":null,"tableName":"tmp_orcado_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"oypHMG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_segmento_highlight","id":"RYeVdh","to":"tmp_orcado_highlight","raw":"","list":[{"id":"rTZFHn","andOr":"and","tableBy":"tmp_segmento_highlight","tableTo":"tmp_orcado_highlight","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"bWjaqe","andOr":"and","tableBy":"tmp_segmento_highlight","tableTo":"tmp_orcado_highlight","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MpZGny","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_segmento_highlight","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IniCtP","type":"value","dataType":"Nullable(String)","tableName":"tmp_segmento_highlight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"wYVrCu","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_segmento_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"dwZynP","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_orcado_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":840,"y":201},"sourceId":null,"tableName":"tmp_segmento_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_aux_highlight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"YluZUf","type":"table","appId":137,"label":"forecast_tic_iot_final","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":121.01030841697414,"y":495.98445904310313},"sourceId":7,"tableName":"forecast_tic_iot_final","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ddGAto","type":"builder","appId":137,"label":"Consulta TIC_IOT_VENDA","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"gzlaqE","type":"computed","alias":"Produto","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"Produto","computedId":"joSnek"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"OivHoM","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"forecast_tic_iot_final","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VSwuuE","type":"computed","alias":"Produto","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"Produto","computedId":"joSnek"},{"id":"auqyah","type":"computed","alias":"REAL","content":"SUM(REAL_IOT)+SUM(REAL_TIC)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"lofJYA","columnLength":2},{"id":"LzGFDI","type":"computed","alias":"FORECAST","content":"sum(IOT) + sum(TIC)","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST","computedId":"FrLvea","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"Produto","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"Produto","computedId":"joSnek"},{"type":"computed","alias":"FORECAST","content":"sum(IOT) + sum(TIC)","dataType":"Nullable(Float64)","columnName":"FORECAST","computedId":"FrLvea","columnLength":2},{"type":"computed","alias":"REAL","content":"SUM(REAL_IOT)+SUM(REAL_TIC)","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"lofJYA","columnLength":2}]},"created":false,"optimize":false,"position":{"x":241.99759719235675,"y":495.99420347373814},"sourceId":null,"tableName":"forecast_tic_iot_final","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_vnd_tic_iot_highlight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ERQywc","type":"table","appId":137,"label":"tmp_vnd_tic_iot_highlight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":395.9955919075959,"y":496.99417214116374},"sourceId":null,"tableName":"tmp_vnd_tic_iot_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rMoObY","type":"table","appId":137,"label":"base_orcado_portal_sgm_pdt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":117.51272102520184,"y":706.984051719636},"tableName":"base_orcado_portal_sgm_pdt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JPIcrm","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"XByTgQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_sgm_pdt","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"FBnGWj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_sgm_pdt","columnName":"produto","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"xxQCtp","type":"value","andOr":"and","value":["Venda Mensal","VENDAS EXPANSAO TIC"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_sgm_pdt","valueType":"value","columnName":"tip_mtc","extraValue":[],"columnLength":null,"databaseName":"bucket_137"},{"id":"RFxWZh","type":"value","andOr":"and","value":["IOT","IoT","TIC","TIC Dados","TIC TI"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_sgm_pdt","valueType":"value","columnName":"produto","extraValue":[],"columnLength":null,"databaseName":"bucket_137"},{"id":"kjzHaN","type":"value","andOr":"and","value":["CORPORATIVO","EMPRESARIAL","EXPANSAO TIC"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_sgm_pdt","valueType":"value","columnName":"segmento","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"GCoLrJ","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"base_orcado_portal_sgm_pdt","valueType":"computed","columnName":"mes_ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"XByTgQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_sgm_pdt","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"FBnGWj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_portal_sgm_pdt","columnName":"produto","columnLength":null,"databaseName":"bucket_137"},{"id":"ZozVEO","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm_pdt","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":239.51171838282144,"y":707.9840203870617},"tableName":"base_orcado_portal_sgm_pdt","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_orcado_tic_iot","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"KFrGig","type":"table","appId":137,"label":"base_orcado_tic_iot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":395.5096504329118,"y":709.983957721913},"tableName":"base_orcado_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DeqXGB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"PXZTHc","type":"computed","alias":"negocio","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"negocio","computedId":"yffBSY"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"hMyBQd","type":"computed","alias":"negocio","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"negocio","computedId":"yffBSY"},{"id":"XWoUuC","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_tic_iot","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"negocio","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"negocio","computedId":"yffBSY"}]},"created":false,"optimize":false,"position":{"x":516.5086791231058,"y":708.9839890544874},"tableName":"base_orcado_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_orcado_tic","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"lceDUd","type":"table","appId":137,"label":"tmp_orcado_tic","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":640.5076138155766,"y":706.9840517196363},"tableName":"tmp_orcado_tic","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VXcSdV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_vnd_tic_iot_highlight","id":"bQHxsO","to":"tmp_orcado_tic","raw":"","list":[{"id":"nWFFPk","andOr":"and","tableBy":"tmp_vnd_tic_iot_highlight","tableTo":"tmp_orcado_tic","columnBy":"Produto","columnTo":"negocio","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ceDMmB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_vnd_tic_iot_highlight","columnName":"Produto","columnLength":null,"databaseName":"bucket_137"},{"id":"jbzyuh","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_vnd_tic_iot_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"vrVyeb","type":"value","dataType":"Nullable(Float64)","tableName":"tmp_vnd_tic_iot_highlight","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137"},{"id":"fsRYvK","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_orcado_tic","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"SaCvmn","type":"computed","alias":"FORECAST_PERCENTUAL","content":"case when FORECAST is not NULL then ROUND((FORECAST/ORCADO)*100)\nelse 0\nend","dataType":"Nullable(Int64)","distinct":false,"columnName":"FORECAST_PERCENTUAL","computedId":"ejymOo","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"FORECAST_PERCENTUAL","content":"case when FORECAST is not NULL then ROUND((FORECAST/ORCADO)*100)\nelse 0\nend","dataType":"Nullable(Int64)","columnName":"FORECAST_PERCENTUAL","computedId":"ejymOo","columnLength":2}]},"created":false,"optimize":false,"position":{"x":638.9907980237144,"y":499.99407814344056},"sourceId":null,"tableName":"tmp_vnd_tic_iot_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_forecast_highlight_TIC","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fdKOxs","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":775.989325392718,"y":498.9941094760149},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"KKwxND","type":"delete","appId":137,"label":"Delete","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"SkmCLO","type":"value","andOr":"and","value":"CONSOLIDADO","dataType":"Nullable(String)","operator":"=","tableName":"tmp_base_aux_highlight","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":1287.0328237211968,"y":581.0176969056118},"sourceId":null,"tableName":"tmp_base_aux_highlight","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"SzKzGo","type":"table","appId":137,"label":"tmp_base_aux_highlight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":987,"y":215},"sourceId":null,"tableName":"tmp_base_aux_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JUDQWF","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"DsBDuT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_aux_highlight","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"XMVdCK","type":"computed","alias":"SGM","content":"'CONSOLIDADO'","dataType":"Nullable(String)","distinct":false,"columnName":"SGM","computedId":"PObCXR"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"DsBDuT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_aux_highlight","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"TRpuKp","type":"computed","alias":"SGM","content":"'CONSOLIDADO'","dataType":"Nullable(String)","distinct":false,"columnName":"SGM","computedId":"PObCXR"},{"id":"wphZGL","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_aux_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"rQcmYA","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_aux_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"SGM","content":"'CONSOLIDADO'","dataType":"Nullable(String)","columnName":"SGM","computedId":"PObCXR"}]},"created":false,"optimize":false,"position":{"x":978.9886181727394,"y":527.0201935644947},"sourceId":null,"tableName":"tmp_base_aux_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_csl_highlight","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GULipC","type":"table","appId":137,"label":"tmp_base_csl_highlight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1105.487296412154,"y":523.0198998399202},"sourceId":null,"tableName":"tmp_base_csl_highlight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HxnVav","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_base_csl_highlight","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"tmp_base_csl_highlight","columnName":"SGM","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"tmp_base_csl_highlight","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"tmp_base_csl_highlight","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO"}]},"shared":false,"created":false,"position":{"x":1390.996181580532,"y":465.0124098632712},"sourceId":null,"tableName":"tmp_base_csl_highlight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_aux_highlight","databaseName":"bucket_137","resultDatabase":"bucket_137"}],"edges":[{"id":"SiTNxj","source":"lceDUd","target":"VXcSdV"},{"id":"HtbFni","source":"VXcSdV","target":"fdKOxs"},{"id":"yWblYy","type":"manual","label":"","source":"pTnSEN","target":"QYujmx"},{"id":"sTZZRO","type":"manual","label":"","source":"QYujmx","target":"oypHMG"},{"id":"hohoDQ","type":"manual","label":"","source":"scigMF","target":"oypHMG"},{"id":"ojjKGy","type":"manual","label":"","source":"KKwxND","target":"HxnVav"},{"id":"wpBHfH","type":"manual","label":"","source":"JUDQWF","target":"KKwxND"},{"id":"qWrYQA","source":"VdAexA","target":"pBRlGA"},{"id":"OGjSZb","source":"pBRlGA","target":"NlqmUp"},{"id":"IUapKb","source":"VdAexA","target":"scigMF"},{"id":"yEElyY","source":"scigMF","target":"hBWgpZ"},{"id":"ifwMMZ","source":"VdAexA","target":"QYujmx"},{"id":"hyYOdW","source":"QYujmx","target":"vFyyyK"},{"id":"OZbLdB","source":"vFyyyK","target":"oypHMG"},{"id":"YzjKeN","source":"oEmomF","target":"oypHMG"},{"id":"QpeKdW","source":"oypHMG","target":"SzKzGo"},{"id":"yBHnyC","type":"manual","label":"","source":"lHGFwr","target":"oypHMG"},{"id":"RkPNRw","type":"manual","label":"","source":"pTnSEN","target":"scigMF"},{"id":"xJxVRi","type":"manual","label":"","source":"pBRlGA","target":"oypHMG"},{"id":"hGedXP","type":"manual","label":"","source":"pTnSEN","target":"lHGFwr"},{"id":"mDnNcq","type":"manual","label":"","source":"pTnSEN","target":"pBRlGA"},{"id":"qPEPjs","source":"SzKzGo","target":"JUDQWF"},{"id":"dlKvqk","source":"JUDQWF","target":"GULipC"},{"id":"eyKtCr","source":"GULipC","target":"HxnVav"},{"id":"xarkHp","source":"HxnVav","target":"SzKzGo"},{"id":"aoDQCo","source":"KKwxND","target":"SzKzGo"},{"id":"vkzWcI","type":"manual","label":"","source":"oypHMG","target":"JUDQWF"},{"id":"JftAtd","source":"lgyonH","target":"pTnSEN"},{"id":"NvrtpO","source":"pTnSEN","target":"VdAexA"},{"id":"oOYCDU","source":"YluZUf","target":"ddGAto"},{"id":"MSbHXF","source":"ddGAto","target":"ERQywc"},{"id":"jBytIJ","source":"rMoObY","target":"JPIcrm"},{"id":"ypAdiC","source":"JPIcrm","target":"KFrGig"},{"id":"NeCqYw","source":"KFrGig","target":"DeqXGB"},{"id":"RrDwHW","source":"DeqXGB","target":"lceDUd"},{"id":"jEHraj","source":"ERQywc","target":"VXcSdV"},{"id":"rFRWmb","source":"kHbJaM","target":"lHGFwr"},{"id":"NiDhRz","source":"lHGFwr","target":"oEmomF"},{"id":"dodkIX","source":"lgyonH","target":"Myljqv"},{"id":"oCSDqB","source":"Myljqv","target":"cHlVTW"},{"id":"JYtriH","source":"SFizsz","target":"lgyonH"}]},"cron":null,"options":{"folder":"HIGHLIGHT","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"lKPNADjVrBmvxfoCRZYbfDGBAehHoVom","flowDescription":"","locked":"no","created":"2023-04-28 10:34:49","updated":"2023-09-08 09:08:23"},{"flowId":"2548","appId":137,"flowName":"ACIONA TRIGGER MSG","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"koSeiU","url":"https://graph.microsoft.com/v1.0/users/{{id_final}}/teamwork/installedApps","body":"{\r\n   \"teamsApp@odata.bind\":\"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/0c249069-a50a-4aea-b247-f3bedf048bca\"\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"Authorization","value":"Bearer {{get_token}}"}],"options":{},"timeout":0,"position":{"x":171.99506828201152,"y":102.0109414276334},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":false},{"id":"OoRddn","url":"https://smba.trafficmanager.net/emea/v3/conversations/19:{{id_final}}_26e8b898-c240-44ca-bfdb-baae3b03ece7@unq.gbl.spaces/activities","body":"{\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo dos indicadores d-1:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd_tic_iot}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"Nota: Forecast considera produtividade diária e Best Guess para Corporativo/Atacado.\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Perda de Receita (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"spacing\": \"Medium\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                      \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ata_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                         \r\n                     ]\r\n                 },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"Authorization","value":"Bearer {{token_bot}}"}],"options":{},"timeout":0,"position":{"x":283,"y":33},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":false}],"edges":[{"id":"LoMjfX","source":"FwxqMi","target":"koSeiU"},{"id":"wnzbiy","source":"FwxqMi","target":"OoRddn"},{"id":"TYEbif","type":"manual","label":"","source":"koSeiU","target":"OoRddn"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"PmiNPJiBXArJgpOuSCIBqFQOkuZHMaUZ","flowDescription":"","locked":"no","created":"2023-04-27 16:30:12","updated":"2023-09-08 09:08:23"},{"flowId":"2677","appId":137,"flowName":"ExecutarGPT","workflow":{"nodes":[{"id":"FkxiBF","type":"flow","appId":137,"label":"Gerar Cálculo","client":"clickhouse","flowId":"2739","repoId":1,"created":false,"position":{"x":357.98878293836884,"y":172.9945794646308}},{"id":"kFXfNQ","type":"flow","appId":137,"label":"Processar Resultado","client":"clickhouse","flowId":"2740","repoId":1,"created":false,"position":{"x":515.9838323916152,"y":173.9945481320564}}],"edges":[{"id":"YtpNSx","type":"manual","label":"","source":"FkxiBF","target":"kFXfNQ"}]},"cron":null,"options":{"folder":"IANALYTICS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"VXhTmzcUjKRQWubpYTlleXTzIjGSDdRm","flowDescription":"","locked":"no","created":"2023-05-15 14:22:52","updated":"2023-09-08 09:08:23"},{"flowId":"2672","appId":137,"flowName":"cria_max_row_id_input","workflow":{"nodes":[{"id":"csFCIw","type":"insertRow","appId":137,"label":"Inserção Linha","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[{"value":"0","dataType":"Nullable(Int64)","tableName":"max_row_id_input","valueType":"value","columnName":"max_row_id_input","columnLength":null,"databaseName":"bucket_137"}],"computed":[]},"created":false,"position":{"x":53.5,"y":167},"tableName":"max_row_id_input","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"TXpRDQ","type":"create","appId":137,"label":"cria max_row_id_input","client":"clickhouse","repoId":1,"shared":false,"columns":[{"default":"","dataType":"Nullable(Int64)","columnName":"max_row_id_input","isFunction":false}],"created":false,"position":{"x":53.5,"y":39},"tableName":"max_row_id_input","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"max_row_id_input","databaseName":"bucket_137","columnsBackup":[]},{"id":"QxtXFt","type":"table","appId":137,"label":"max_row_id_input","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":210.5,"y":103},"tableName":"max_row_id_input","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"AVgIEF","source":"TXpRDQ","target":"QxtXFt"},{"id":"tKKZeW","source":"csFCIw","target":"QxtXFt"}]},"cron":null,"options":{"folder":"DATA INPUT CSV","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"hzKBKGsKcCvMKRKNlvmhUFclamxzMVDq","flowDescription":"","locked":"no","created":"2023-05-15 09:56:23","updated":"2023-09-08 09:08:23"},{"flowId":"2671","appId":137,"flowName":"max_id_tabela","workflow":{"nodes":[{"id":"gnXhZi","type":"query","appId":137,"label":"SQL Query","query":"ALTER TABLE\n  bucket_137.max_row_id_input\nUPDATE\n  max_row_id_input = {{row_id_input}}\nwhere\n  max_row_id_input is not null","client":"clickhouse","repoId":1,"tables":[],"created":false,"position":{"x":65,"y":65},"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[]},"cron":null,"options":{"folder":"DATA INPUT CSV","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"jdKxnAIrOmRrFvrMXo_UI_KrfoZTMfSB","flowDescription":"","locked":"no","created":"2023-05-15 09:53:10","updated":"2023-09-08 09:08:23"},{"flowId":"2670","appId":137,"flowName":"cria_tabela","workflow":{"nodes":[{"id":"DpxHNt","type":"query","appId":137,"label":"SQL Query","query":"{{nova_tabela_input}}","client":"clickhouse","repoId":1,"tables":[],"created":false,"position":{"x":65,"y":65},"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[]},"cron":null,"options":{"folder":"DATA INPUT CSV","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"kBIllgRvMHJSzzuyuAsEbthjslnIlsam","flowDescription":"","locked":"no","created":"2023-05-15 09:52:27","updated":"2023-09-08 09:08:23"},{"flowId":"2669","appId":137,"flowName":"prepara_tabela","workflow":{"nodes":[{"id":"aAtbpO","type":"query","appId":137,"label":"SQL Query","query":"{{novos_dados_input}}","client":"clickhouse","repoId":1,"tables":[],"created":false,"position":{"x":65,"y":65},"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[]},"cron":null,"options":{"folder":"DATA INPUT CSV","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"cwkItoeADQdfKOtHalVsmeEvICAbrHEr","flowDescription":"","locked":"no","created":"2023-05-15 09:51:40","updated":"2023-09-08 09:08:23"},{"flowId":"2668","appId":137,"flowName":"inserir_dados","workflow":{"nodes":[{"id":"AQEBBn","type":"query","appId":137,"label":"SQL Query","query":"ALTER TABLE\r\n  bucket_115.healthcheck\r\nUPDATE\r\n{{coluna}}='{{valor_input}}'\r\nwhere\r\n  row_id='{{row_id}}'","client":"clickhouse","repoId":1,"tables":[],"created":false,"position":{"x":65,"y":65},"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[]},"cron":null,"options":{"folder":"DATA INPUT CSV","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"enKLHXwlaEiQJFnfuRwVpiHumxtIKDrX","flowDescription":"","locked":"no","created":"2023-05-15 09:43:40","updated":"2023-09-08 09:08:23"},{"flowId":"2725","appId":137,"flowName":"ExportacaoS3","workflow":{"nodes":[{"id":"KGNtqR","type":"table","appId":137,"label":"base_log_acesso","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":209.00253793852548,"y":190.99680407741235},"sourceId":null,"tableName":"base_log_acesso","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UyiDiX","type":"externalOutput","appId":137,"label":"base_log_acesso","client":"s3","repoId":1,"shared":false,"created":false,"filePath":"gaio/logs_gaio/log_portal_analytics.csv","position":{"x":368.0003759908927,"y":192.99674141226356},"sourceId":8,"operation":"insert","tableName":"base_log_acesso","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_log_acesso","databaseName":"bucket_137","excludeFields":[],"resultDatabase":""}],"edges":[{"id":"FQdncG","source":"KGNtqR","target":"UyiDiX"}]},"cron":"0 20 * * *","options":{"reload":0,"cronBase":{"every":3,"current":"0 20 * * *","dayValues":[],"hourValues":[20],"monthValues":[],"minuteValues":[0],"dayOfMonthValues":[]},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":37,"flowStart":1,"flowType":"dataPrep","flowKey":"XXQWpzK_igGmDiLTuCOKSggSGcSlQCCQ","flowDescription":"","locked":"no","created":"2023-05-18 10:47:57","updated":"2023-09-08 09:08:23"},{"flowId":"2738","appId":137,"flowName":"GerarBaseGPT","workflow":{"nodes":[{"id":"gKetGs","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":88.5,"y":33},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qEBUoD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"QTJukw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"AIbrTK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"ocJQXQ","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"ELkLkR"},{"id":"UZuQBW","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"LtaYRE","type":"value","andOr":"and","value":"CONSOLIDADO","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"forecast_insight","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QTJukw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"AIbrTK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"dKKBlQ","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"ELkLkR"},{"id":"UZuQBW","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"ANO_MES","computedId":"ELkLkR"}]},"created":false,"optimize":false,"position":{"x":259.5,"y":33},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_venda_gpt","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"JtIuaM","type":"table","appId":137,"label":"tmp_forecast_venda_gpt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":409.5001253302976,"y":34.99993733485121},"sourceId":null,"tableName":"tmp_forecast_venda_gpt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cppKlb","type":"table","appId":137,"label":"TAXA_INSTALACAO_INSIGHT","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":88.5,"y":149},"sourceId":null,"tableName":"TAXA_INSTALACAO_INSIGHT","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HAsYvT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"Lqlgwc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"RaQcMk","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"VVsWpY"},{"id":"yAnwcl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oXOqgC","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"TAXA_INSTALACAO_INSIGHT","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"ANO_MES","computedId":"VVsWpY"}]},"created":false,"optimize":false,"position":{"x":259.5,"y":149},"sourceId":null,"tableName":"TAXA_INSTALACAO_INSIGHT","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_taxa_instalacao_gpt","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vJhdiN","type":"table","appId":137,"label":"tmp_taxa_instalacao_gpt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":413.5,"y":149},"sourceId":null,"tableName":"tmp_taxa_instalacao_gpt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jxuaPV","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":88.5,"y":384},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":88.5,"y":268},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"ZFYaBD","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"FeQJxc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"WfJZYF","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"iODQEb","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"rRMeNG","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"cAHgub","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"lKeDss","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"hNbYcs"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"msDaHH","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal","Base de Clientes Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AXuLzU","type":"value","alias":"INDICADOR","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"cAHgub","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"vzzWaP","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"hNbYcs"},{"id":"AVrYmK","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"cgFMki","type":"computed","alias":"ORCADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"LShYQN","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"ANO_MES","computedId":"hNbYcs"}]},"created":false,"position":{"x":259.5,"y":326},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","sourceType":"bucket","resultTable":"BASE_GPT","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qBLRuJ","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_taxa_instalacao_gpt","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"INDICADOR"},{"dataType":"Nullable(String)","tableName":"tmp_taxa_instalacao_gpt","columnName":"ANO_MES","columnLength":null,"databaseName":"bucket_137","targetColumn":"ANO_MES"},{"dataType":"Nullable(String)","tableName":"tmp_taxa_instalacao_gpt","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Int64)","tableName":"tmp_taxa_instalacao_gpt","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":532.4992480182148,"y":148.99890335989642},"sourceId":null,"tableName":"tmp_taxa_instalacao_gpt","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_GPT","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"mfYFkF","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_forecast_venda_gpt","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"INDICADOR"},{"dataType":"Nullable(String)","tableName":"tmp_forecast_venda_gpt","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"tmp_forecast_venda_gpt","columnName":"ANO_MES","columnLength":null,"databaseName":"bucket_137","targetColumn":"ANO_MES"},{"dataType":"Nullable(Int64)","tableName":"tmp_forecast_venda_gpt","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":698.4931694987832,"y":35.99890335989639},"sourceId":null,"tableName":"tmp_forecast_venda_gpt","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_GPT","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"GeFgKm","type":"table","appId":137,"label":"analy_responde_tic_iot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":92.17344109891884,"y":-77.79929158822841},"tableName":"analy_responde_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"MNomWp","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"cPiIxq","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"veunxF","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"jKnSHN","type":"computed","alias":"ANO_MES","order":"asc","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"vylobZ"}],"group":[{"id":"fpdNkd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"qiteEo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ZxueMb","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"vylobZ"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fpdNkd","type":"value","alias":"TIP_MTC","dataType":"Nullable(String)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"qiteEo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"DQUFhi","type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"ANO_MES","computedId":"vylobZ"},{"id":"uEHiNs","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"grsNIP","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"analy_responde_tic_iot","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"ANO_MES","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"ANO_MES","computedId":"vylobZ"}]},"created":false,"optimize":false,"position":{"x":248.29450569098643,"y":-78.92035618029601},"tableName":"analy_responde_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"analy_responde_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ioXawf","type":"table","appId":137,"label":"analy_responde_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":404.415570283054,"y":-78.920356180296},"tableName":"analy_responde_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TOFDkZ","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"analy_responde_aux","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"INDICADOR"},{"dataType":"Nullable(String)","tableName":"analy_responde_aux","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"analy_responde_aux","columnName":"ANO_MES","columnLength":null,"databaseName":"bucket_137","targetColumn":"ANO_MES"},{"dataType":"Nullable(Float64)","tableName":"analy_responde_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"analy_responde_aux","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO"}]},"shared":false,"created":false,"position":{"x":828.3829812734973,"y":-75.73042774878908},"tableName":"analy_responde_aux","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_GPT","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"tjvTDx","type":"table","appId":137,"label":"BASE_GPT","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":413.5,"y":326},"sourceId":null,"tableName":"BASE_GPT","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ufBArw","type":"externalOutput","appId":137,"label":"BASE_GPT","client":"s3","repoId":1,"shared":false,"created":false,"filePath":"analy/database/portal_analytics/indicadores.csv","position":{"x":527.5043814403967,"y":326.9999686674256},"sourceId":8,"operation":"insert","tableName":"BASE_GPT","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_GPT","databaseName":"bucket_137","excludeFields":[],"resultDatabase":""}],"edges":[{"id":"YiVPKz","source":"tjvTDx","target":"ufBArw"},{"id":"LzLglv","source":"ustfRF","target":"kSIbMZ"},{"id":"VkVqKU","source":"kSIbMZ","target":"tjvTDx"},{"id":"MLPIwY","source":"jxuaPV","target":"kSIbMZ"},{"id":"lDitah","source":"gKetGs","target":"qEBUoD"},{"id":"KQLsJQ","source":"qEBUoD","target":"JtIuaM"},{"id":"XZcOlz","source":"cppKlb","target":"HAsYvT"},{"id":"kZnUwM","source":"HAsYvT","target":"vJhdiN"},{"id":"HXrGln","source":"JtIuaM","target":"mfYFkF"},{"id":"urlhHC","source":"mfYFkF","target":"tjvTDx"},{"id":"LYGgMm","source":"vJhdiN","target":"qBLRuJ"},{"id":"Mufcrl","source":"qBLRuJ","target":"tjvTDx"},{"id":"ImvldM","type":"manual","label":"","source":"kSIbMZ","target":"qBLRuJ"},{"id":"LrJRiF","type":"manual","label":"","source":"qBLRuJ","target":"mfYFkF"},{"id":"NzklKq","source":"GeFgKm","target":"MNomWp"},{"id":"nHdztk","source":"MNomWp","target":"ioXawf"},{"id":"xlfhuC","source":"ioXawf","target":"TOFDkZ"},{"id":"anJLxZ","source":"TOFDkZ","target":"tjvTDx"},{"id":"VudTLC","type":"manual","label":"","source":"mfYFkF","target":"TOFDkZ"}]},"cron":null,"options":{"folder":"IANALYTICS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"otcNcrKxQOuBcCRfHPDyt_sdjeNxErwF","flowDescription":"","locked":"no","created":"2023-05-19 14:48:12","updated":"2023-09-08 09:08:23"},{"flowId":"2739","appId":137,"flowName":"GerarCalculoGPT","workflow":{"nodes":[{"id":"JaWWWw","type":"query","appId":137,"label":"Update Resultado","query":"ALTER TABLE\n  bucket_137.tb_resultado_gpt\nUPDATE\n  RESULTADO = ({{prm_query}}),\n  QUERY = ('{{prm_query_string}}'),\n  PERGUNTA = ('{{prm_pergunta_nlp}}')\nwhere\n  QUERY IS NOT NULL","client":"clickhouse","repoId":1,"tables":[],"created":false,"position":{"x":222.99558210701113,"y":150.00379124150106},"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[]},"cron":null,"options":{"folder":"IANALYTICS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"cjOUqxdx_kiXnQROdPLhsDCZMGPFgwEq","flowDescription":"","locked":null,"created":"2023-05-19 14:50:46","updated":"2023-09-08 09:08:23"},{"flowId":"2740","appId":137,"flowName":"ProcessarResultado","workflow":{"nodes":[{"id":"UFYGYF","type":"table","appId":137,"label":"tb_resultado_gpt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":222.99558210701113,"y":241.0063605126012},"sourceId":null,"tableName":"tb_resultado_gpt","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TOGpsE","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"qLqtQR","type":"value","dataType":"Nullable(String)","tableName":"tb_resultado_gpt","columnName":"RESULTADO","columnLength":null,"databaseName":"bucket_137"},{"id":"JtkqCj","type":"value","dataType":"Nullable(String)","tableName":"tb_resultado_gpt","columnName":"PERGUNTA","columnLength":null,"databaseName":"bucket_137"},{"id":"GuhZPb","type":"value","dataType":"Nullable(String)","tableName":"tb_resultado_gpt","columnName":"QUERY","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":391.49558210701105,"y":150.00379124150106},"sourceId":null,"tableName":"tb_resultado_gpt","tableView":false,"temporary":false,"insertMode":true,"sourceType":"bucket","resultTable":"log_gpt","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"iObyDt","type":"table","appId":137,"label":"log_gpt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":532.495582107011,"y":150.00379124150106},"sourceId":null,"tableName":"log_gpt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pNCgfG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JBOtVs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tb_resultado_gpt","columnName":"RESULTADO","columnLength":null,"databaseName":"bucket_137"},{"id":"wGItYo","type":"computed","alias":"RESULT","content":"concat(\ncase\nwhen upper(PERGUNTA) LIKE '%VEND%' THEN 'R$ '\nwhen upper(PERGUNTA) LIKE '%PERD%' THEN 'R$ '\nELSE '# ' END\n,\ncase when toFloat64(RESULTADO) >= 1000000 then \nconcat(\n  toString(\n    intDiv(round(toFloat64(RESULTADO)/1000,0) AS x, 1000)\n  ),\n  '.',\n  toString(x % 1000)\n)\nelse toString(round(toFloat64(RESULTADO)/1000,0))\nend\n\n,' mil')","dataType":"Nullable(String)","distinct":false,"columnName":"RESULT","computedId":"aeYmoz"}],"update":[],"computed":[{"type":"computed","alias":"RESULT","content":"concat(\ncase\nwhen upper(PERGUNTA) LIKE '%VEND%' THEN 'R$ '\nwhen upper(PERGUNTA) LIKE '%PERD%' THEN 'R$ '\nELSE '# ' END\n,\ncase when toFloat64(RESULTADO) >= 1000000 then \nconcat(\n  toString(\n    intDiv(round(toFloat64(RESULTADO)/1000,0) AS x, 1000)\n  ),\n  '.',\n  toString(x % 1000)\n)\nelse toString(round(toFloat64(RESULTADO)/1000,0))\nend\n\n,' mil')","dataType":"Nullable(String)","columnName":"RESULT","computedId":"aeYmoz"}]},"created":false,"optimize":false,"position":{"x":362.49345260384615,"y":372.0021757563417},"sourceId":null,"tableName":"tb_resultado_gpt","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_resultado_gpt","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"LXxvrn","type":"table","appId":137,"label":"tmp_resultado_gpt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":532.495582107011,"y":394.0037912415013},"sourceId":null,"tableName":"tmp_resultado_gpt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wsINYG","type":"api","appId":137,"label":"API: tmp_resultado_gpt","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":726.4895035875796,"y":395.0037599089269},"sourceId":null,"tableName":"tmp_resultado_gpt","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137","paramReferences":[]}],"edges":[{"id":"vjOIwP","source":"UFYGYF","target":"TOGpsE"},{"id":"ufjLqA","source":"TOGpsE","target":"iObyDt"},{"id":"prksyI","source":"UFYGYF","target":"pNCgfG"},{"id":"HQGhdf","source":"pNCgfG","target":"LXxvrn"},{"id":"XNCamN","source":"LXxvrn","target":"wsINYG"}]},"cron":null,"options":{"folder":"IANALYTICS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"RuHrcWvrxgQxwYEADNCNiulHHoWSRyLM","flowDescription":"","locked":null,"created":"2023-05-19 14:51:39","updated":"2023-09-08 09:08:23"},{"flowId":"2815","appId":137,"flowName":"CARGA - Taxa de Instalação","workflow":{"nodes":[{"id":"eUKbNF","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\n\r\nMENSAL_2 AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'VENDAS - NOVA VENDA' THEN 'Venda Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n    \tELSE TXA_ITL END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC = 'VENDAS - NOVA VENDA'\r\n    AND ISP.DSC_SGM_CLI = 'CORPORATIVO'\r\n\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'VENDAS - NOVA VENDA' THEN 'Venda Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n)\r\n\r\n\r\n\r\n\r\nSELECT 'Taxa Venda Mensal' AS TIP_MTC  \r\n\t, DATA_REF\r\n    , SEGMENTO\r\n    , REAL\r\n    , 0 AS ORCADO\r\nFROM (\r\n  SELECT *\r\n  FROM MENSAL_2\r\n)   \r\nWHERE 1 = 1\r\n\tAND TRUNC(sysdate-1, 'MM') = TRUNC(DATA_REF, 'MM')","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-26.36975800339375,"y":242.51531540826048},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"TAXA_INSTALACAO_INSIGHT","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"BvMXVv","type":"table","appId":137,"label":"TAXA_INSTALACAO_INSIGHT","client":"clickhouse","repoId":1,"shared":false,"position":{"x":107.80705854222256,"y":244.6767709823091},"sourceId":7,"tableName":"TAXA_INSTALACAO_INSIGHT","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"LoQteY","source":"eUKbNF","target":"BvMXVv"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"KNnDvhftgYXADptEERuHdOsizLfcjxgr","flowDescription":"Processo que efetua a carga da informação de Taxa de Instalação de forma separada para uso no Insight.","locked":"no","created":"2023-05-22 15:45:07","updated":"2023-09-08 09:08:23"},{"flowId":"3693","appId":137,"flowName":"FLUXO real x orçado (pre fechamento)","workflow":{"nodes":[{"id":"ufbBFB","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"position":{"x":2114,"y":194},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fpjomb","type":"group","label":"Parallel","created":false,"position":{"x":1955,"y":276.5}},{"id":"LnBEJC","type":"delete","appId":137,"label":"Delete","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"DpqzqP","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"=","tableName":"forecast_insight","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":265,"y":207},"sourceId":null,"tableName":"forecast_insight","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"fdKOxs","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":81.5,"y":68},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sEQoRn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AlQsdT","type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"qshwvi"},{"id":"lRtzXo","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","distinct":false,"columnName":"DATA_REF","computedId":"iWYrna"},{"id":"aFrAFl","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"id":"bXBrAl","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jYggoS"},{"id":"lCarqE","type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"qnOpbK"},{"id":"HPXCud","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"eAFaTy","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137"},{"id":"jUfBpb","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"qshwvi"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","columnName":"DATA_REF","computedId":"iWYrna"},{"type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"qnOpbK"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jYggoS"}]},"created":false,"optimize":false,"position":{"x":265,"y":68},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"TIC_ANALY_AUX","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WvsCVc","type":"table","appId":137,"label":"TIC_ANALY_AUX","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":420,"y":68},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NYElQD","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TIC_ANALY_AUX","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":551,"y":112},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"vNMXcv","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":170},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BbkjnJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AOLjea","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"UQwPFw"},{"id":"YkXRWa","type":"value","alias":"sgm","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QgrZoa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"UQwPFw"}]},"created":false,"optimize":false,"position":{"x":895,"y":170},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BQRWpp","type":"table","appId":137,"label":"tmp_forecast_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1055,"y":133},"sourceId":null,"tableName":"tmp_forecast_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RRoyis","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1209.5,"y":241},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YuYuwK","type":"group","label":"Parallel","created":false,"position":{"x":895,"y":289.5}},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":330},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FMbcyi","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":446},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rBtgRI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"rVTZKe","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"Tqywwc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"NaKfBI","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"QhJqUi","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"VDNaMT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"flfZhL","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"jpOUjw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gFehbn","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BJGcRN","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"gymQoD","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebqPuN","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zxtcQs","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"kIXayp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"WYGlTN","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"AADvRI","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QhBDxG","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"hesRBK","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jxOlCh"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}]},"created":false,"optimize":false,"position":{"x":895,"y":388},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"jgaznh","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TIC_ANALY_AUX","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137","targetColumn":"Mes_Ref_Visual"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"Mes_Ref"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"}]},"shared":false,"created":false,"position":{"x":1055,"y":286},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"RlloqT","type":"table","appId":137,"label":"tmp_alerta_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1209.5,"y":364},"sourceId":null,"tableName":"tmp_alerta_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_alerta_aux","id":"thRAEV","to":"tmp_forecast_alerta","raw":"","list":[{"id":"PAjsVb","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"lWkUve","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"SEGMENTO","columnTo":"sgm","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_alerta_aux","id":"iHPXzk","to":"teste_mail","raw":"","list":[{"id":"aqWATR","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"SEGMENTO","columnTo":"visao","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SHQxUQ","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qMXQWm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CPlPjP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Gtaiff","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"wdPKUm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SjNjTc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rxeDEX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"GGtaWk","type":"value","andOr":"and","value":"1","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"ativo","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MWBkFX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CdkxNl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"llTcdN","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"kFSItW","type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","distinct":false,"columnName":"teste","computedId":"gAYpmL"},{"id":"WObqMW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"tOvMBM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rmluuw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"mensagem","content":"concat(\n\nconcat(concat(concat('Olá ' ,  max(nome)), ', espero que esteja tudo bem!\\n'),\n\n\n' Segue resumo dos indicadores d-1 dos segmentos')\n,\ntoString(sum(REAL) over (partition by email))\n\n\n)","dataType":"Nullable(String)","columnName":"mensagem","computedId":"CrdTAV"},{"type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","columnName":"teste","computedId":"gAYpmL"},{"type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"PBipBh"}]},"created":false,"position":{"x":1338.5,"y":262},"sourceId":null,"tableName":"tmp_alerta_aux","sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ysUINE","type":"group","label":"Parallel","created":false,"position":{"x":265,"y":148}},{"id":"tbILex","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","parent":"fpjomb","repoId":1,"schema":{"join":[],"sort":[{"id":"ekmNON","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"fxkzhn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"moralI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"gCNWfH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HQkQmv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"xaduop","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"VKXQId","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"TaDxZh","type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"id":"XuPLsY","type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_vnd","computedId":"SWihKb"},{"id":"EbDuNz","type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"id":"SrThPF","type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ope_vnd","computedId":"sbovSd"},{"id":"brygbH","type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_vnd","computedId":"uUVxiO"},{"id":"fDYdfb","type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_prd","computedId":"MmOWIX"},{"id":"OEpoMi","type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_prd","computedId":"zsMWkr"},{"id":"mlZHKR","type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_prd","computedId":"GwZUwh"},{"id":"WqsERO","type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ata_prd","computedId":"ynBIlB"},{"id":"byIouZ","type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_prd","computedId":"btTuhJ"},{"id":"BrUIbf","type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}],"update":[],"computed":[{"type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_vnd","computedId":"SWihKb"},{"type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ope_vnd","computedId":"sbovSd"},{"type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_vnd","computedId":"uUVxiO"},{"type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_prd","computedId":"zsMWkr"},{"type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_prd","computedId":"GwZUwh"},{"type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ata_prd","computedId":"ynBIlB"},{"type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_prd","computedId":"btTuhJ"},{"type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","columnName":"msg_csl_prd","computedId":"MmOWIX"},{"type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}]},"created":false,"optimize":false,"position":{"x":1955,"y":194},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"envio_preparado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"cGryqE","type":"table","appId":137,"label":"tmp_aux_prepara_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1506,"y":262},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bsYYiW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"MnoewF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"heXpKp","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_aux_prepara_sgm_alerta","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"oOaOFx","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"kxREQG","type":"sum","alias":"ORCADO_TRATADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"oefYrH","type":"sum","alias":"FORECAST_VENDA","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"oEcCxS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1668,"y":305.1527830343917},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"tmp_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"Notrgp","type":"table","appId":137,"label":"tmp_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1795.5,"y":292},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYcLht","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","parent":"fpjomb","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"nome","columnLength":2,"databaseName":"bucket_137","targetColumn":"nome"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"email","columnLength":2,"databaseName":"bucket_137","targetColumn":"email"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_consolidado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137","targetColumn":"flag_de_acesso"}]},"shared":false,"created":false,"position":{"x":1955,"y":326},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","databaseName":"bucket_137","resultDatabase":"bucket_137"}],"edges":[{"id":"OYBuIx","source":"sEQoRn","target":"WvsCVc"},{"id":"KMMNNV","source":"WvsCVc","target":"jgaznh"},{"id":"Bkiddn","source":"BQRWpp","target":"kSIbMZ"},{"id":"oRAwbn","source":"RRoyis","target":"kSIbMZ"},{"id":"GiSwqZ","source":"kSIbMZ","target":"cGryqE"},{"id":"fXBBiD","source":"bsYYiW","target":"Notrgp"},{"id":"wozwKI","source":"cGryqE","target":"bsYYiW"},{"id":"jNsdaS","source":"DYcLht","target":"cGryqE"},{"id":"zvmuND","source":"jgaznh","target":"RlloqT"},{"id":"HvmKmO","source":"BbkjnJ","target":"BQRWpp"},{"id":"IZZMsh","source":"vNMXcv","target":"BbkjnJ"},{"id":"UVfeWb","source":"NYElQD","target":"vNMXcv"},{"id":"OaLsSz","source":"WvsCVc","target":"NYElQD"},{"id":"YvsHIs","source":"rBtgRI","target":"RlloqT"},{"id":"vGYyoy","source":"ustfRF","target":"rBtgRI"},{"id":"kaSjGb","source":"FMbcyi","target":"rBtgRI"},{"id":"EBYyep","source":"RlloqT","target":"kSIbMZ"},{"id":"uKbXYa","source":"Notrgp","target":"DYcLht"},{"id":"wDVTXb","type":"manual","label":"","source":"rBtgRI","target":"jgaznh"},{"id":"MZLOVu","source":"fdKOxs","target":"sEQoRn"},{"id":"VXHsiO","source":"LnBEJC","target":"vNMXcv"},{"id":"byVKik","source":"cGryqE","target":"tbILex"},{"id":"aCZCmB","source":"tbILex","target":"ufbBFB"}]},"cron":null,"options":{"folder":"ANALY PRÉ FECHAMENTO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"GpoiedwNaJLJhGHbhqLriLwjqusizYgX","flowDescription":"","locked":"no","created":"2023-08-01 11:36:09","updated":"2023-09-08 09:08:23"},{"flowId":"zjujXH","appId":137,"flowName":"Novo Indicador","workflow":{"nodes":[{"id":"CHslAj","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":195.9898045279344,"y":284.99503297514747},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QfiTui","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"kcuKog","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SDyrdD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"PdfZHA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"Orynkn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":289.9887588384918,"y":286.0117640062295},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"preparando_emails","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fhIyCn","type":"table","appId":137,"label":"preparando_emails","client":"clickhouse","repoId":1,"shared":false,"position":{"x":396.98431465836063,"y":286.0117640062295},"sourceId":null,"tableName":"preparando_emails","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gEYhXl","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Temos novidades de indicadores no Portal Analytics! Agora você conseguirá acessar os indicadores financeiros de Receita (Bruta/Líquida) e Capex de uma forma mais ágil e intuitiva. Essas métricas serão atualizadas d-1 diretamente do SAP. Para ter mais detalhes, clique no link abaxo:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n         \r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"zjujXH","method":"POST","repoId":1,"created":false,"headers":[{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"},{"prop":"Content-Type","value":"application/json;charset=UTF-8"}],"options":{},"timeout":0,"position":{"x":476.98431465836063,"y":286.0117640062295},"restType":"rest","tableName":"preparando_emails","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_change","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"NsMIBu","type":"table","appId":137,"label":"log_change","client":"clickhouse","repoId":1,"created":false,"position":{"x":596.9843146583606,"y":286.0117640062295},"tableName":"log_change","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"uhPghs","source":"fhIyCn","target":"gEYhXl"},{"id":"ndTTbb","source":"gEYhXl","target":"NsMIBu"},{"id":"Ptmysq","source":"CHslAj","target":"QfiTui"},{"id":"afQIJo","source":"QfiTui","target":"fhIyCn"}]},"cron":null,"options":{"folder":"ANALY CHANGE","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"app:137:cdTGduSzXeuOEAdYvsaAQYmLKTmKYuKz","flowDescription":"","locked":"no","created":"2023-09-15 11:35:14","updated":"2023-09-15 15:49:52"},{"flowId":"3675","appId":137,"flowName":"FLUXO","workflow":{"nodes":[{"id":"FTFiHK","type":"group","label":"Parallel","created":false,"position":{"x":587.5,"y":250}},{"id":"LnBEJC","type":"delete","appId":137,"label":"Delete","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"DpqzqP","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"=","tableName":"forecast_insight","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":265,"y":324},"sourceId":null,"tableName":"forecast_insight","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"fdKOxs","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":81.5,"y":192},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sEQoRn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AlQsdT","type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"qshwvi"},{"id":"lRtzXo","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","distinct":false,"columnName":"DATA_REF","computedId":"iWYrna"},{"id":"aFrAFl","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"id":"bXBrAl","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jYggoS"},{"id":"lCarqE","type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"qnOpbK"},{"id":"HPXCud","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"eAFaTy","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137"},{"id":"jUfBpb","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"qshwvi"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","columnName":"DATA_REF","computedId":"iWYrna"},{"type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"qnOpbK"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jYggoS"}]},"created":false,"optimize":false,"position":{"x":265,"y":192},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"TIC_ANALY_AUX","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WvsCVc","type":"table","appId":137,"label":"TIC_ANALY_AUX","client":"clickhouse","parent":"FTFiHK","repoId":1,"shared":false,"created":false,"position":{"x":445,"y":192},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NYElQD","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","parent":"FTFiHK","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TIC_ANALY_AUX","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":576,"y":229},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"vNMXcv","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","parent":"FTFiHK","repoId":1,"shared":false,"created":false,"position":{"x":736,"y":287},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BbkjnJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AOLjea","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"UQwPFw"},{"id":"YkXRWa","type":"value","alias":"sgm","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QgrZoa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"UQwPFw"}]},"created":false,"optimize":false,"position":{"x":945,"y":378},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BQRWpp","type":"table","appId":137,"label":"tmp_forecast_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1105,"y":378},"sourceId":null,"tableName":"tmp_forecast_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RRoyis","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1259.5,"y":446},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YuYuwK","type":"group","label":"Parallel","created":false,"position":{"x":945,"y":307}},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":736,"y":33},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FMbcyi","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":736,"y":436},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rBtgRI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"rVTZKe","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"Tqywwc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"NaKfBI","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"QhJqUi","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"VDNaMT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"flfZhL","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"jpOUjw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gFehbn","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BJGcRN","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"gymQoD","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebqPuN","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zxtcQs","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"kIXayp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"WYGlTN","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"AADvRI","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QhBDxG","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"hesRBK","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jxOlCh"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}]},"created":false,"optimize":false,"position":{"x":945,"y":215},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"jgaznh","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TIC_ANALY_AUX","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137","targetColumn":"Mes_Ref_Visual"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"Mes_Ref"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"}]},"shared":false,"created":false,"position":{"x":1105,"y":108},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"RlloqT","type":"table","appId":137,"label":"tmp_alerta_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1259.5,"y":145},"sourceId":null,"tableName":"tmp_alerta_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_alerta_aux","id":"thRAEV","to":"tmp_forecast_alerta","raw":"","list":[{"id":"PAjsVb","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"lWkUve","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"SEGMENTO","columnTo":"sgm","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_alerta_aux","id":"iHPXzk","to":"teste_mail","raw":"","list":[{"id":"aqWATR","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"SEGMENTO","columnTo":"visao","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SHQxUQ","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qMXQWm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CPlPjP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Gtaiff","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"wdPKUm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SjNjTc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rxeDEX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"GGtaWk","type":"value","andOr":"and","value":"1","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"ativo","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MWBkFX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CdkxNl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"llTcdN","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"kFSItW","type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","distinct":false,"columnName":"teste","computedId":"gAYpmL"},{"id":"WObqMW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"tOvMBM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rmluuw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"mensagem","content":"concat(\n\nconcat(concat(concat('Olá ' ,  max(nome)), ', espero que esteja tudo bem!\\n'),\n\n\n' Segue resumo dos indicadores d-1 dos segmentos')\n,\ntoString(sum(REAL) over (partition by email))\n\n\n)","dataType":"Nullable(String)","columnName":"mensagem","computedId":"CrdTAV"},{"type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","columnName":"teste","computedId":"gAYpmL"},{"type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"PBipBh"}]},"created":false,"position":{"x":1388.5,"y":348},"sourceId":null,"tableName":"tmp_alerta_aux","sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ysUINE","type":"group","label":"Parallel","created":false,"position":{"x":265,"y":268.5}},{"id":"UjzsBe","type":"group","label":"Parallel","created":false,"position":{"x":1894.7882240471552,"y":295.4272231175622}},{"id":"ufbBFB","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2021,"y":50},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"tbILex","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","parent":"UjzsBe","repoId":1,"schema":{"join":[],"sort":[{"id":"ekmNON","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"fxkzhn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"moralI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"gCNWfH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HQkQmv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"xaduop","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"VKXQId","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"TaDxZh","type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',\r\n    toString(round(FORECAST_VENDA/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"id":"XuPLsY","type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_vnd","computedId":"SWihKb"},{"id":"EbDuNz","type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"id":"SrThPF","type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ope_vnd","computedId":"sbovSd"},{"id":"brygbH","type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_vnd","computedId":"uUVxiO"},{"id":"fDYdfb","type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal'  THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_prd","computedId":"MmOWIX"},{"id":"OEpoMi","type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_prd","computedId":"zsMWkr"},{"id":"mlZHKR","type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_prd","computedId":"GwZUwh"},{"id":"WqsERO","type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ata_prd","computedId":"ynBIlB"},{"id":"byIouZ","type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_prd","computedId":"btTuhJ"},{"id":"BrUIbf","type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}],"update":[],"computed":[{"type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_vnd","computedId":"SWihKb"},{"type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ope_vnd","computedId":"sbovSd"},{"type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_vnd","computedId":"uUVxiO"},{"type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_prd","computedId":"zsMWkr"},{"type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_prd","computedId":"GwZUwh"},{"type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ata_prd","computedId":"ynBIlB"},{"type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_prd","computedId":"btTuhJ"},{"type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',\r\n    toString(round(FORECAST_VENDA/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal'  THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","columnName":"msg_csl_prd","computedId":"MmOWIX"},{"type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}]},"created":false,"optimize":false,"position":{"x":1792.575884107972,"y":152.8551668843354},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"envio_preparado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"cGryqE","type":"table","appId":137,"label":"tmp_aux_prepara_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1556,"y":348},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bsYYiW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"MnoewF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"heXpKp","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_aux_prepara_sgm_alerta","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"oOaOFx","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"kxREQG","type":"sum","alias":"ORCADO_TRATADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"oefYrH","type":"sum","alias":"FORECAST_VENDA","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"oEcCxS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1718,"y":314},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"tmp_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"Notrgp","type":"table","appId":137,"label":"tmp_consolidado","client":"clickhouse","parent":"UjzsBe","repoId":1,"shared":false,"created":false,"position":{"x":1852.5005639863384,"y":336.99927935078904},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYcLht","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","parent":"UjzsBe","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"nome","columnLength":2,"databaseName":"bucket_137","targetColumn":"nome"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"email","columnLength":2,"databaseName":"bucket_137","targetColumn":"email"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_consolidado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137","targetColumn":"flag_de_acesso"}]},"shared":false,"created":false,"position":{"x":2003.0005639863384,"y":404.99927935078904},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","databaseName":"bucket_137","resultDatabase":"bucket_137"}],"edges":[{"id":"YlPWkJ","source":"kSIbMZ","target":"cGryqE"},{"id":"OYBuIx","source":"sEQoRn","target":"WvsCVc"},{"id":"KMMNNV","source":"WvsCVc","target":"jgaznh"},{"id":"fXBBiD","source":"bsYYiW","target":"Notrgp"},{"id":"wozwKI","source":"cGryqE","target":"bsYYiW"},{"id":"jNsdaS","source":"DYcLht","target":"cGryqE"},{"id":"zvmuND","source":"jgaznh","target":"RlloqT"},{"id":"HvmKmO","source":"BbkjnJ","target":"BQRWpp"},{"id":"IZZMsh","source":"vNMXcv","target":"BbkjnJ"},{"id":"UVfeWb","source":"NYElQD","target":"vNMXcv"},{"id":"OaLsSz","source":"WvsCVc","target":"NYElQD"},{"id":"YvsHIs","source":"rBtgRI","target":"RlloqT"},{"id":"vGYyoy","source":"ustfRF","target":"rBtgRI"},{"id":"kaSjGb","source":"FMbcyi","target":"rBtgRI"},{"id":"uKbXYa","source":"Notrgp","target":"DYcLht"},{"id":"wDVTXb","type":"manual","label":"","source":"rBtgRI","target":"jgaznh"},{"id":"MZLOVu","source":"fdKOxs","target":"sEQoRn"},{"id":"VXHsiO","source":"LnBEJC","target":"vNMXcv"},{"id":"UWvKwr","source":"RlloqT","target":"kSIbMZ"},{"id":"OTprIf","source":"BQRWpp","target":"kSIbMZ"},{"id":"PyoLJZ","source":"RRoyis","target":"kSIbMZ"},{"id":"HNtOZW","source":"cGryqE","target":"tbILex"},{"id":"DNhbFT","source":"tbILex","target":"ufbBFB"},{"id":"GUaUhr","type":"manual","label":"","source":"tbILex","target":"DYcLht"},{"id":"CLNcxL","type":"manual","label":"","source":"DYcLht","target":"bsYYiW"},{"id":"gGNiri","type":"manual","label":"","source":"ufbBFB","target":"DYcLht"}]},"cron":null,"options":{"folder":"ANALY DIÁRIO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"b_MRdoLDTvAPwlVeCkSykoXFRxE_DHxO","flowDescription":"","locked":"no","created":"2023-08-01 08:14:48","updated":"2023-09-14 20:29:43"},{"flowId":"3680","appId":137,"flowName":"pre fechamento","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OoRddn","url":"https://1qaprwa0u6.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"(prévia fechamento julho/23 - ao longo do dia os números serão refinados pelos segmentos):\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Perda de Receita (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"spacing\": \"Medium\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                      \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ata_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                         \r\n                     ]\r\n                 },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"OKbxmOgoLP4bWcCcaRbmW8L4YvYbRVGm8CzI5gl4"}],"options":{},"timeout":0,"position":{"x":249.00106530752913,"y":34.99993733485121},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_recebeu","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"jfntKk","type":"table","appId":137,"label":"log_recebeu","client":"clickhouse","repoId":1,"created":false,"position":{"x":403,"y":33},"tableName":"log_recebeu","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"jfEGAk","source":"FwxqMi","target":"OoRddn"},{"id":"UKWHZQ","source":"OoRddn","target":"jfntKk"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"cRvsUtNeYppmhdpoFHIhkSGuhlaYZUVT","flowDescription":"","locked":"no","created":"2023-08-01 09:11:17","updated":"2023-09-08 09:08:23"},{"flowId":"3684","appId":137,"flowName":"TRIGGER MSG","workflow":{"nodes":[{"id":"beBEQS","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":50,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OkkRVm","type":"builder","appId":137,"label":"FILTRA EMAILS","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GZPwGF","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"mPETPk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"FAgXvH","type":"value","alias":"mail","dataType":"Nullable(String)","distinct":false,"tableName":"envio_preparado","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"cfodPm","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"NZaERd","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"paYOre","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"SbqqGQ","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"MkEOIp","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"OywHGk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"WvXFuU","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"yBqaMx","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"jDlWoB","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"CzibHl","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"bneFHy","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":177,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"envio","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SaHQqQ","type":"table","appId":137,"label":"envio","client":"clickhouse","repoId":1,"shared":false,"position":{"x":276,"y":39},"sourceId":null,"tableName":"envio","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IWLDdN","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{mail}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo de indicadores d-1:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd_tic_iot}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"Notas: Forecast considera produtividade diária e Best Guess para Corporativo/Atacado; Resultados de TIC + IoT estão contidos nos Segmentos de Negócios;\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Perda de Receita (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"spacing\": \"Medium\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                      \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ata_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                         \r\n                     ]\r\n                 },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3684","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"}],"options":{},"timeout":0,"position":{"x":370,"y":39},"restType":"rest","tableName":"envio","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","mail"],"resultTableTruncate":true},{"id":"bwXkIw","type":"table","appId":137,"label":"log","client":"clickhouse","repoId":1,"created":false,"position":{"x":464,"y":39},"tableName":"log","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"vqaMnJ","source":"SaHQqQ","target":"IWLDdN"},{"id":"ReuYqI","source":"IWLDdN","target":"bwXkIw"},{"id":"fqZgpi","source":"beBEQS","target":"OkkRVm"},{"id":"NzQBCp","source":"OkkRVm","target":"SaHQqQ"}]},"cron":null,"options":{"folder":"ANALY DIÁRIO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"xYrwNgSjUBUlrblqAHPSgqZaqsTLuRlx","flowDescription":"","locked":"no","created":"2023-08-01 10:58:59","updated":"2023-09-19 09:12:39"},{"flowId":"3687","appId":137,"flowName":"trigger","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OoRddn","url":"https://5ylb6d3zd9.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo dos indicadores d-1:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd_tic_iot}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"Notas: Forecast considera produtividade diária e Best Guess para Corporativo/Atacado; Resultados de TIC + IoT estão contidos nos Segmentos de Negócios.\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Perda de Receita (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"spacing\": \"Medium\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                      \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ata_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                         \r\n                     ]\r\n                 },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"IGQTw40IJm3etD5zfdcUAHFs9L7GcyF58wnYLZy0"}],"options":{},"timeout":0,"position":{"x":249.00106530752913,"y":34.99993733485121},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_recebeu","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"jfntKk","type":"table","appId":137,"label":"log_recebeu","client":"clickhouse","repoId":1,"created":false,"position":{"x":403,"y":33},"tableName":"log_recebeu","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"exTLjA","source":"OoRddn","target":"jfntKk"},{"id":"FYkhFq","source":"FwxqMi","target":"OoRddn"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"itoLSWZGIabwGQZpYWluQAauC_EzYSGD","flowDescription":"","locked":"no","created":"2023-08-01 11:04:23","updated":"2023-09-08 09:08:23"},{"flowId":"3688","appId":137,"flowName":"MENSAGEM","workflow":{"nodes":[{"id":"CHslAj","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":195.9898045279344,"y":284.99503297514747},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QfiTui","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"kcuKog","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SDyrdD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"PdfZHA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"Orynkn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":306.98431465836063,"y":286.0117640062295},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"preparando_emails","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fhIyCn","type":"table","appId":137,"label":"preparando_emails","client":"clickhouse","repoId":1,"shared":false,"position":{"x":396.98431465836063,"y":286.0117640062295},"sourceId":null,"tableName":"preparando_emails","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gEYhXl","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Em decorrência de instabilidades no DW nesta manhã, houve atraso no processamento das informações D-1, por isso excepcionalmente hoje, a disponibilização de resultados no Portal Analytics será realizada no final da manhã.\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         } \r\n         \r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3688","method":"POST","repoId":1,"created":false,"headers":[{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"},{"prop":"Content-Type","value":"application/json;charset=UTF-8"}],"options":{},"timeout":0,"position":{"x":476.98431465836063,"y":286.0117640062295},"restType":"rest","tableName":"preparando_emails","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_dw","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"QeJabi","type":"table","appId":137,"label":"log_dw","client":"clickhouse","repoId":1,"created":false,"position":{"x":593.0272809705093,"y":287.0236533427565},"tableName":"log_dw","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"mlrXZF","source":"fhIyCn","target":"gEYhXl"},{"id":"GaAmUf","source":"gEYhXl","target":"QeJabi"},{"id":"OxBwOw","source":"CHslAj","target":"QfiTui"},{"id":"BmjHCw","source":"QfiTui","target":"fhIyCn"}]},"cron":null,"options":{"folder":"ANALY DW","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"THYQOYkBRtVlAnAkEhDeNlRUJBINls_Q","flowDescription":"","locked":"no","created":"2023-08-01 11:16:22","updated":"2023-09-11 08:22:19"},{"flowId":"QGcEnK","appId":137,"flowName":"CARGA - Fluxo de Caixa","workflow":{"nodes":[{"id":"UVATnn","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT    TRUNC(F.DAT_OCO_FTO+1, 'DD') AS DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_BCO_EMP AS COD_BCO\r\n\t\t, COD_ITE_LIQ AS COD_IDT\r\n\t\t, 'SALDO INICIAL' AS INDICADOR\r\n\t\t, SUM(VLR) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'SALDO FINAL'\r\n\t\t\t\t\t\t\t\t  \tAND LAST_DAY(DAT_OCO_FTO) = DAT_OCO_FTO  \r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM'))\r\n\t\tAND TIP = 'SALDO FINAL'\r\n\t\tAND COD_EMP <> '3200'\r\n\tGROUP BY  TRUNC(F.DAT_OCO_FTO+1,'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, COD_ITE_LIQ","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":168.5,"y":1293},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"FC_SALDO_INICIAL","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"sxnrrq","type":"table","appId":137,"label":"FC_SALDO_INICIAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":354,"y":1293},"sourceId":7,"tableName":"FC_SALDO_INICIAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rVeqGy","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"ZfhUaI","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ncNnpN","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"runyqr","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"xCfwsL","type":"computed","alias":"HRQ_1","content":"'Saldo Inicial'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"oggKiu","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"RFeGYk","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"CVhGIK","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tTuaos","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"NSyjfX","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"BAWCvy","type":"computed","alias":"HRQ_1","content":"'Saldo Inicial'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"yyPwjw","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"DCZbqV","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"VqpfMr","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"id":"PWQRVB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"dkDabo"},{"type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"pquNKK"},{"type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"type":"computed","alias":"HRQ_1","content":"'Saldo Inicial'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"DeSjNy"},{"type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"StmtDX"},{"type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"NFgudd"}]},"created":false,"optimize":false,"position":{"x":549.5,"y":1293},"sourceId":7,"tableName":"FC_SALDO_INICIAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_GERAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XZMqou","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_GERAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":765.5,"y":1293},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wVHwwl","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GOylXh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"padKkk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"rFpgiW","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"NThOzk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"NleAdV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"rFTBgB","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"BdewCi","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"HOQTAt","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":984,"y":1343},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qSbgzL","type":"builder","appId":137,"label":"Valida Saldo Inicial","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"YfkFiP","type":"value","andOr":"and","value":"VOGEL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GOylXh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"padKkk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"rFpgiW","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"NThOzk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"NleAdV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"rFTBgB","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"BdewCi","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"HOQTAt","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":989.9998120045536,"y":989.00156662872},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_VALIDA_SALDO_INICIAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"HBpTux","type":"table","appId":137,"label":"FC_VALIDA_SALDO_INICIAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1206,"y":989},"sourceId":7,"tableName":"FC_VALIDA_SALDO_INICIAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"tjALzH","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"AkfIQO","type":"value","order":"asc","dataType":"Nullable(DateTime)","tableName":"FC_VALIDA_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"Rwyoro","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_VALIDA_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JAfkWM","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_VALIDA_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"nRyBMg","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_VALIDA_SALDO_INICIAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TcVtYl","type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1407,"y":1171},"sourceId":7,"tableName":"FC_VALIDA_SALDO_INICIAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"VALIDA_SALDO_INIC","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"EmuBUk","type":"table","appId":137,"label":"VALIDA_SALDO_INIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1646,"y":1171},"sourceId":7,"tableName":"VALIDA_SALDO_INIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RtQygk","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT \t  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, INDICADOR\r\n\t\t, entrada AS entrada\r\n\t\t, resgate AS resgate\r\n\t\t, rendimento AS rendimento\r\n\t\t, CASE WHEN entrada_acu - resgate_acu + rendimento_acu > 0 THEN entrada - resgate + rendimento ELSE entrada - resgate + rendimento - (entrada_acu - resgate_acu + rendimento_acu) end AS VLR_IND\r\n\t\t, entrada_acu - resgate_acu + rendimento_acu AS saldo_acu\r\nFROM (\r\nSELECT \t  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, INDICADOR\r\n\t\t, entrada AS entrada\r\n\t\t, resgate AS resgate\r\n\t\t, rendimento AS rendimento\r\n\t\t, SUM(entrada) OVER(PARTITION BY COD_EMP, DSC_EMP, COD_IDT, DESCRICAO, CATEGORIA, INDICADOR ORDER BY DATA_REF) AS entrada_acu\r\n\t\t, SUM(resgate) OVER(PARTITION BY COD_EMP, DSC_EMP, COD_IDT, DESCRICAO, CATEGORIA, INDICADOR  ORDER BY DATA_REF) AS resgate_acu\r\n\t\t, SUM(rendimento) OVER(PARTITION BY COD_EMP, DSC_EMP, COD_IDT, DESCRICAO, CATEGORIA, INDICADOR ORDER BY DATA_REF) AS rendimento_acu\r\nFROM (\r\nSELECT    DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, ' ' AS DESCRICAO\r\n\t\t, ' ' AS CATEGORIA\r\n\t\t, 'SALDO INICIAL APLICACAO' AS INDICADOR\r\n\t\t, SUM(CASE WHEN INDICADOR = 'ENTRADA APLICACAO' THEN VLR_IND ELSE 0 END) AS entrada\r\n\t\t, SUM(CASE WHEN INDICADOR = 'RESGATE APLICACAO' THEN VLR_IND ELSE 0 END) AS resgate\r\n\t\t, SUM(CASE WHEN INDICADOR = 'RENDIMENTOS' THEN VLR_IND ELSE 0 END) AS rendimento\r\n\t\t, CASE WHEN (SUM(CASE WHEN INDICADOR = 'ENTRADA APLICACAO' THEN VLR_IND ELSE 0 END)-SUM(CASE WHEN INDICADOR = 'RESGATE APLICACAO' THEN VLR_IND ELSE 0 END)+SUM(CASE WHEN INDICADOR = 'RENDIMENTOS' THEN VLR_IND ELSE 0 END)) < 0 THEN 0 ELSE (SUM(CASE WHEN INDICADOR = 'ENTRADA APLICACAO' THEN VLR_IND ELSE 0 END)-SUM(CASE WHEN INDICADOR = 'RESGATE APLICACAO' THEN VLR_IND ELSE 0 END)+SUM(CASE WHEN INDICADOR = 'RENDIMENTOS' THEN VLR_IND ELSE 0 END)) END AS VLR_IND\r\nFROM (\r\n\tSELECT \t  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RGS, 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RGS, 'DD')\r\n\t\t\t  END AS DATA_REF\r\n\t\t\t, COD_EMP AS COD_EMP\r\n\t\t\t, DSC_EMP AS DSC_EMP\r\n\t\t\t, COD_PSC AS COD_IDT\r\n\t\t\t, 'RESGATE APLICACAO' AS INDICADOR\r\n\t\t\t, SUM(VLR)+SUM(VLR_IRRF)+SUM(VLR_IOF) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA ffc \r\n\tWHERE 1 = 1\r\n\t\tAND TIP = 'RESGATE APLICACAO'\r\n\t\tAND COD_EMP <> '3200'\r\n\t\t/*AND TRUNC(DAT_RGS, 'DD') < TO_DATE('20230801','YYYYMMDD')*/\r\n\t\tAND DAT_OCO_FTO = (SELECT MAX(DAT_OCO_FTO)\r\n\t\t\t\t\t\t   FROM MARIALAR.F_FLUXO_CAIXA\r\n\t\t\t\t\t\t   WHERE 1 = 1\r\n\t\t\t\t\t\t\t AND TIP = 'RESGATE APLICACAO')\r\n\tGROUP BY  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RGS, 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RGS, 'DD')\r\n\t\t\t  END\r\n\t\t\t, COD_EMP\r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_PSC\r\n\t\r\n\tUNION ALL\r\n\t\r\n\tSELECT    CASE \r\n\t\t\t\tWHEN TRUNC(DAT_IVT , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_IVT, 'DD')\r\n\t\t\t  END AS DATA_REF\r\n\t\t\t, COD_EMP AS COD_EMP\r\n\t\t\t, DSC_EMP AS DSC_EMP\r\n\t\t\t, COD_PSC AS COD_IDT\r\n\t\t\t, 'ENTRADA APLICACAO' AS INDICADOR\r\n\t\t\t, SUM(VLR) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA ffc \r\n\tWHERE 1 = 1\r\n\t\tAND TIP = 'ENTRADA APLICACAO'\r\n\t\tAND COD_EMP <> '3200'\r\n\t\t/*AND TRUNC(DAT_IVT, 'DD') < TO_DATE('20230801','YYYYMMDD')*/\r\n\t\tAND DAT_OCO_FTO = (SELECT MAX(DAT_OCO_FTO)\r\n\t\t\t\t\t\t   FROM MARIALAR.F_FLUXO_CAIXA\r\n\t\t\t\t\t\t   WHERE 1 = 1\r\n\t\t\t\t\t\t\t AND TIP = 'ENTRADA APLICACAO')\r\n\tGROUP BY  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_IVT , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_IVT, 'DD')\r\n\t\t\t  END\r\n\t\t\t, COD_EMP\r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_PSC\r\n\t\t\t\r\n\tUNION ALL\r\n\t\r\n\tSELECT \t  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RTB , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RTB, 'DD')\r\n\t\t\t  END AS DATA_REF\r\n\t\t\t, COD_EMP AS COD_EMP\r\n\t\t\t, DSC_EMP AS DSC_EMP\r\n\t\t\t, COD_PSC AS COD_IDT\r\n\t\t\t, 'RENDIMENTOS' AS INDICADOR\r\n\t\t\t, SUM(VLR) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA ffc \r\n\tWHERE 1 = 1\r\n\t\tAND TIP = 'RENDIMENTOS'\r\n\t\t/*AND TRUNC(DAT_RTB, 'DD') < TO_DATE('20230801','YYYYMMDD')*/\r\n\t\tAND COD_EMP <> '3200'\r\n\t\tAND DAT_OCO_FTO = (SELECT MAX(DAT_OCO_FTO)\r\n\t\t\t\t\t\t   FROM MARIALAR.F_FLUXO_CAIXA\r\n\t\t\t\t\t\t   WHERE 1 = 1\r\n\t\t\t\t\t\t\t AND TIP = 'RENDIMENTOS')\r\n\tGROUP BY CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RTB , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RTB, 'DD')\r\n\t\t\t  END\r\n\t\t\t, COD_EMP\r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_PSC\r\n) WHERE 1 = 1\r\n/*AND TO_DATE('20230803','YYYYMMDD') = data_ref \r\nAND cod_idt = '00000090'*/\r\nGROUP BY  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n)\r\n\t\tGROUP BY   \r\n\t\t  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, INDICADOR\r\n\t\t, entrada\r\n\t\t, resgate\r\n\t\t, rendimento) \r\nORDER BY cod_idt, data_ref","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":22,"y":854},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"FC_SALDO_APLICACAO","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"OkpLTD","type":"table","appId":137,"label":"FC_SALDO_APLICACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":168.5,"y":854},"sourceId":7,"tableName":"FC_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jguVzB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"QzwhpR","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ncNnpN","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"runyqr","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"xCfwsL","type":"computed","alias":"HRQ_1","content":"'Aplicação'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"oggKiu","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"RFeGYk","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"CVhGIK","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tTuaos","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"NSyjfX","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"BAWCvy","type":"computed","alias":"HRQ_1","content":"'Aplicação'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"yyPwjw","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"DCZbqV","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"VqpfMr","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"id":"PWQRVB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"dkDabo"},{"type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"pquNKK"},{"type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"type":"computed","alias":"HRQ_1","content":"'Aplicação'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"DeSjNy"},{"type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"StmtDX"},{"type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"NFgudd"}]},"created":false,"optimize":false,"position":{"x":354,"y":854},"sourceId":7,"tableName":"FC_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_GERAL2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"imkQvc","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_GERAL2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":549.5,"y":854},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gLKsls","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":1206,"y":1219},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"nPKVpm","type":"builder","appId":137,"label":"Valida Saldo Aplicacao","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"ALghSY","type":"value","andOr":"and","value":"TELECOM","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL2","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VcVZvM","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ogbasZ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"akmUqX","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"KKdFPP","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"fBFCGS","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"fESSxM","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"CMuuix","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"PXoxOJ","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":765.5,"y":854},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"VALIDA_SALDO_APLICACAO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"gGyXhN","type":"table","appId":137,"label":"VALIDA_SALDO_APLICACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":984,"y":854},"sourceId":7,"tableName":"VALIDA_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UoUmSr","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"AkfIQO","type":"value","order":"asc","dataType":"Nullable(DateTime)","tableName":"VALIDA_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"Rwyoro","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"VALIDA_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JAfkWM","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"VALIDA_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"nRyBMg","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"VALIDA_SALDO_APLICACAO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TcVtYl","type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1206,"y":854},"sourceId":7,"tableName":"VALIDA_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"VALIDA_SALDO_APLI","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"enypnC","type":"table","appId":137,"label":"VALIDA_SALDO_APLI","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1407,"y":1036},"sourceId":7,"tableName":"VALIDA_SALDO_APLI","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fBNphu","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"WnDmWu","type":"computed","alias":"MES_REF","order":"asc","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"MES_REF","computedId":"xopPCT"},{"id":"VEVhqN","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"xfqoLB","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"XDBoww","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"SfWcLG","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"heckEz","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"YCeITg","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"uvvxil","type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"MES_REF","computedId":"xopPCT"},{"id":"KRyveM","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"WNFFaZ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"RUCRYd","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"vclKHl","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"qMwxeD","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"pcFVND","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"rkVvHX","type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"MES_REF","computedId":"xopPCT"},{"id":"KRyveM","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"WNFFaZ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"RUCRYd","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"vclKHl","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"qMwxeD","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"pcFVND","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"KEAIYf","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"jpnYgg","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER (PARTITION BY SEGMENTO ORDER BY MES_REF)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"efTtSs","columnLength":2},{"id":"nrdzHz","type":"computed","alias":"VALOR_FINAL","content":"CASE WHEN MES_REF <> '2023-08-01' THEN REAL_ACU-REAL ELSE REAL_ACU END","dataType":"Nullable(Float64)","distinct":false,"columnName":"VALOR_FINAL","computedId":"jdQSbq","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"MES_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"MES_REF","computedId":"xopPCT"},{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER (PARTITION BY SEGMENTO ORDER BY MES_REF)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"efTtSs","columnLength":2},{"type":"computed","alias":"VALOR_FINAL","content":"CASE WHEN MES_REF <> '2023-08-01' THEN REAL_ACU-REAL ELSE REAL_ACU END","dataType":"Nullable(Float64)","columnName":"VALOR_FINAL","computedId":"jdQSbq","columnLength":2}]},"created":false,"optimize":false,"position":{"x":765.5,"y":732},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"AUX_SALDO_APLICACAO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"LmxKzw","type":"table","appId":137,"label":"AUX_SALDO_APLICACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":984,"y":732},"sourceId":7,"tableName":"AUX_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"vlqiXm","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"SwKILl","type":"value","andOr":"and","value":"2023-08-01","dataType":"Nullable(Date)","operator":"!=","fieldType":"value","tableName":"AUX_SALDO_APLICACAO","valueType":"value","columnName":"MES_REF","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JSjBwX","type":"value","dataType":"Nullable(Date)","tableName":"AUX_SALDO_APLICACAO","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"PkqRcL","type":"value","dataType":"Nullable(String)","tableName":"AUX_SALDO_APLICACAO","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"gbgIyp","type":"value","dataType":"Nullable(String)","tableName":"AUX_SALDO_APLICACAO","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"dUxMmA","type":"value","dataType":"Nullable(String)","tableName":"AUX_SALDO_APLICACAO","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"PODGEY","type":"value","dataType":"Nullable(String)","tableName":"AUX_SALDO_APLICACAO","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"WJhMoE","type":"value","dataType":"Nullable(String)","tableName":"AUX_SALDO_APLICACAO","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"AYsAWy","type":"value","dataType":"Nullable(String)","tableName":"AUX_SALDO_APLICACAO","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"REhims","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"AUX_SALDO_APLICACAO","columnName":"VALOR_FINAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1206,"y":732},"sourceId":7,"tableName":"AUX_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"SALDO_APLICACAO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"RkGVSL","type":"table","appId":137,"label":"SALDO_APLICACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1407,"y":661},"sourceId":7,"tableName":"SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QasOOd","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH HIERARQUIA AS (\r\n\tSELECT E1.IDT AS COD, E1.DSC AS DESCRICAO, E4.DSC  CATEGORIA\r\n\tFROM MARIALAR.A_MODELO_ESTRUTURA_CAIXA E1\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E2\r\n\t\tON (E1.IDT_SUR = E2.IDT AND E2.IDT_NIV = 4)\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E3\r\n\t\tON (E2.IDT_SUR = E3.IDT AND E3.IDT_NIV = 3)\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E4\r\n\t\tON (E3.IDT_SUR = E4.IDT AND E4.IDT_NIV = 2)\r\n\tWHERE 1 = 1\r\n\t\tAND E1.IDT_NIV = 5\r\n\tUNION ALL \r\n\tSELECT E2.IDT AS COD, E2.DSC AS DESCRICAO, E4.DSC  CATEGORIA\r\n\tFROM MARIALAR.A_MODELO_ESTRUTURA_CAIXA E2\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E3\r\n\t\tON (E2.IDT_SUR = E3.IDT AND E3.IDT_NIV = 3)\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E4\r\n\t\tON (E3.IDT_SUR = E4.IDT AND E4.IDT_NIV = 2)\r\n\tWHERE 1 = 1\r\n\t\tAND E2.IDT_NIV = 4\r\n),\r\nFLUXO AS (\r\n\tSELECT    F.TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD') AS DATA_TRANSACAO\r\n\t\t\t, F.COD_EMP \r\n\t\t\t, F.DSC_EMP\r\n\t\t\t, F.COD_BCO_EMP \r\n\t\t\t, F.IDT_CNT \r\n\t\t\t, F.COD_ITE_LIQ\r\n\t\t\t, E1.DESCRICAO AS DESCRICAO\r\n\t\t\t, E1.CATEGORIA AS CATEGORIA\r\n\t\t\t, SUM(F.VLR_TXA) AS TAXA\r\n\t\t\t, SUM(F.VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(F.VLR_IOF) AS IOF\r\n\t\t\t, SUM(F.VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tLEFT JOIN HIERARQUIA E1\r\n\t\tON (F.COD_ITE_LIQ = E1.COD)\r\n\tWHERE 1 = 1\r\n\t\tAND COD_EMP <> '3200'\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'FLUXO'\r\n\t\t\t\t\t\t\t\t  \tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t\t\t  )\r\n\t\tAND F.TIP = 'FLUXO'\r\n\t\tAND F.NOM_IND = 'REALIZADO'\r\n\t\tAND F.DAT_TSC >= TO_DATE('20230801', 'YYYYMMDD')\r\n\t\tAND F.DAT_TSC <= (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\tWHERE TIP = 'FLUXO')\r\n\tGROUP BY  F.TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD')\r\n\t\t\t, F.COD_EMP\r\n\t\t\t, F.DSC_EMP\r\n\t\t\t, F.COD_BCO_EMP \r\n\t\t\t, F.IDT_CNT\r\n\t\t\t, F.COD_ITE_LIQ \r\n\t\t\t, E1.DESCRICAO\r\n\t\t\t, E1.CATEGORIA\r\n\tORDER BY  F.TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD')\r\n\t\t\t, F.COD_EMP \r\n\t\t\t, F.COD_BCO_EMP \r\n\t\t\t, F.IDT_CNT\r\n\t\t\t, E1.DESCRICAO\r\n\t\t\t, E1.CATEGORIA\r\n)\r\n\r\nSELECT TRUNC(DATA_TRANSACAO,'DD') AS DATA_REF\r\n\t\t, COD_EMP \r\n\t\t, DSC_EMP\r\n\t\t, COD_BCO_EMP \r\n\t\t, COD_ITE_LIQ\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, 'FLUXO DIÁRIO' AS INDICADOR\r\n\t\t, SUM(VALOR) AS VLR_IND\r\nFROM FLUXO\r\nWHERE 1 = 1\r\n\tAND TRUNC(DATA_TRANSACAO,'DD') >= TO_DATE('20230801','YYYYMMDD')\r\nGROUP BY  TRUNC(DATA_TRANSACAO,'DD')\r\n\t\t, COD_EMP \r\n\t\t, DSC_EMP\r\n\t\t, COD_BCO_EMP \r\n\t\t, COD_ITE_LIQ\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":549.5,"y":350},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"FC_FLUXO_DIARIO","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"DITkqZ","type":"table","appId":137,"label":"FC_FLUXO_DIARIO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":765.5,"y":350},"sourceId":7,"tableName":"FC_FLUXO_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NezGAE","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"zjRwSz","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ncNnpN","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"runyqr","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"xCfwsL","type":"computed","alias":"HRQ_1","content":"'Fluxo'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"oggKiu","type":"computed","alias":"HRQ_2","content":"CASE WHEN COD_ITE_LIQ = 'NN_IN' THEN 'ENTRADAS OPERACIONAIS'\nWHEN COD_ITE_LIQ = 'NN_OUT' THEN 'SAIDAS OPERACIONAIS'\nELSE CATEGORIA\nEND\n","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"RFeGYk","type":"computed","alias":"HRQ_3","content":"DESCRICAO","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"CVhGIK","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tTuaos","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"NSyjfX","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"BAWCvy","type":"computed","alias":"HRQ_1","content":"'Fluxo'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"yyPwjw","type":"computed","alias":"HRQ_2","content":"CASE WHEN COD_ITE_LIQ = 'NN_IN' THEN 'ENTRADAS OPERACIONAIS'\nWHEN COD_ITE_LIQ = 'NN_OUT' THEN 'SAIDAS OPERACIONAIS'\nELSE CATEGORIA\nEND\n","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"DCZbqV","type":"computed","alias":"HRQ_3","content":"DESCRICAO","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"VqpfMr","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"id":"PWQRVB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"dkDabo"},{"type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"pquNKK"},{"type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"type":"computed","alias":"HRQ_1","content":"'Fluxo'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"DeSjNy"},{"type":"computed","alias":"HRQ_2","content":"CASE WHEN COD_ITE_LIQ = 'NN_IN' THEN 'ENTRADAS OPERACIONAIS'\nWHEN COD_ITE_LIQ = 'NN_OUT' THEN 'SAIDAS OPERACIONAIS'\nELSE CATEGORIA\nEND\n","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"StmtDX"},{"type":"computed","alias":"HRQ_3","content":"DESCRICAO","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"NFgudd"}]},"created":false,"optimize":false,"position":{"x":984,"y":350},"sourceId":7,"tableName":"FC_FLUXO_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_GERAL3","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vhkvHg","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_GERAL3","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1206,"y":350},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"xEzuSv","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":1407,"y":867},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"BphxRW","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"SALDO_APLICACAO","columnName":"MES_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"SALDO_APLICACAO","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"SALDO_APLICACAO","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"SALDO_APLICACAO","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"SALDO_APLICACAO","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"SALDO_APLICACAO","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"SALDO_APLICACAO","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"SALDO_APLICACAO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":1646,"y":661},"sourceId":7,"tableName":"SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"Xbimgd","type":"table","appId":137,"label":"FC_FLUXO_FINAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1875.5,"y":1171},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"CagHpN","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jwkYEh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_FINAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"yODdQq","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_FINAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"}]},"created":false,"optimize":false,"position":{"x":2651.5,"y":1229},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_TESTE","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"efcbTg","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MvrBGM","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2},{"id":"pXNihn","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"SuYvcx"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_FINAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"},{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"SuYvcx"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2}]},"created":false,"optimize":false,"position":{"x":2083.5,"y":658},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_TESTE_MENSAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"yNRgww","type":"table","appId":137,"label":"BASE_FLUXO_TESTE_MENSAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2330,"y":658},"sourceId":7,"tableName":"BASE_FLUXO_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZwewDQ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"zHuMVb","type":"value","dataType":"Nullable(Date)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"OSftVt","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"ggtbPp","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"OViVkE","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"TvrhzQ","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"qXVIEV","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"RIZVrq","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"vOLoOF","type":"value","dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137"},{"id":"hFzgvW","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"jlVKnI","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"zHuMVb","type":"value","dataType":"Nullable(Date)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"OSftVt","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"ggtbPp","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"OViVkE","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"TvrhzQ","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"qXVIEV","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"RIZVrq","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"pviJpD","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"vOLoOF","type":"value","dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137"},{"id":"hFzgvW","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"jlVKnI","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":2502,"y":658},"sourceId":7,"tableName":"BASE_FLUXO_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_MENSAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XjRxnU","type":"table","appId":137,"label":"BASE_FLUXO_MENSAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2651.5,"y":658},"sourceId":7,"tableName":"BASE_FLUXO_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IYKQeR","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"BASE_FLUXO_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"BASE_FLUXO_MENSAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":2802,"y":668},"sourceId":7,"tableName":"BASE_FLUXO_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_TESTE","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"ajGQXV","type":"table","appId":137,"label":"BASE_FLUXO_TESTE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2947,"y":1171},"sourceId":7,"tableName":"BASE_FLUXO_TESTE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hrHbgU","type":"builder","appId":137,"label":"DUP -DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"wUwUlP","type":"value","andOr":"and","value":"ENTRADAS OPERACIONAIS","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL3","valueType":"value","columnName":"HRQ_2","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MvrBGM","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2},{"id":"pXNihn","type":"computed","alias":"TIP_MTC","content":"'Recebimentos de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"SuYvcx"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"},{"type":"computed","alias":"TIP_MTC","content":"'Recebimentos de Caixa Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"SuYvcx"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1407,"y":533},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_RECEBIMENTOS_TESTE_MENSAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"cOTUQy","type":"table","appId":137,"label":"BASE_RECEBIMENTOS_TESTE_MENSAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1646,"y":533},"sourceId":7,"tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"helCRn","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"tHWtZf","type":"value","andOr":"and","value":["ENTRADAS OPERACIONAIS"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL3","valueType":"value","columnName":"HRQ_2","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jwkYEh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"IgSQKU","type":"computed","alias":"TIP_MTC","content":"'Recebimentos de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"DvRXBC"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"},{"type":"computed","alias":"TIP_MTC","content":"'Recebimentos de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"DvRXBC"}]},"created":false,"optimize":false,"position":{"x":1646,"y":411},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_RECEBIMENTOS_CAIXA","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"jhhsyE","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":1875.5,"y":513},"sourceId":7,"tableName":"BASE_RECEBIMENTOS_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_RECEBIMENTOS_CAIXA","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"QzuViL","type":"table","appId":137,"label":"FC_RECEBIMENTOS_CAIXA","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2083.5,"y":461},"sourceId":7,"tableName":"FC_RECEBIMENTOS_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sVpIAg","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"MeRQTr","type":"value","andOr":"and","value":["INVESTIMENTOS","ENTRADAS OPERACIONAIS","SAIDAS OPERACIONAIS"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL3","valueType":"value","columnName":"HRQ_2","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MvrBGM","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2},{"id":"pXNihn","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Livre Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"SuYvcx"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"},{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Livre Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"SuYvcx"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1407,"y":289},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_LIVRE_TESTE_MENSAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"MtOjyF","type":"table","appId":137,"label":"BASE_FLUXO_LIVRE_TESTE_MENSAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1646,"y":289},"sourceId":7,"tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SpKABp","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"tHWtZf","type":"value","andOr":"and","value":["INVESTIMENTOS","ENTRADAS OPERACIONAIS","SAIDAS OPERACIONAIS"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL3","valueType":"value","columnName":"HRQ_2","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jwkYEh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"KnVAQk","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Livre'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"wERGmq"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"},{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Livre'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"wERGmq"}]},"created":false,"optimize":false,"position":{"x":1646,"y":167},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_FLUXO_LIVRE","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"gfwLHJ","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":1875.5,"y":269},"sourceId":7,"tableName":"BASE_FLUXO_LIVRE_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_FLUXO_LIVRE","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"ZaPOVO","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_FLUXO_LIVRE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2083.5,"y":217},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HEYeIG","type":"builder","appId":137,"label":"Valida Fluxo Caixa","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"XhZmwO","type":"value","andOr":"and","value":"VOGEL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL3","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uPsavL","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"svEHmR","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"WkBXMe","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"piSall","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"QJwdMK","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"ruOqYS","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"jTjqOi","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"syOuxd","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1407,"y":45},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"VALIDA_FLUXO_CAIXA","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"txZzDL","type":"table","appId":137,"label":"VALIDA_FLUXO_CAIXA","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1646,"y":45},"sourceId":7,"tableName":"VALIDA_FLUXO_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eziIIG","type":"builder","appId":137,"label":"DUP -DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"AkfIQO","type":"value","order":"asc","dataType":"Nullable(DateTime)","tableName":"VALIDA_FLUXO_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"Rwyoro","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"VALIDA_FLUXO_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JAfkWM","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"VALIDA_FLUXO_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"nRyBMg","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"VALIDA_FLUXO_CAIXA","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TcVtYl","type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1875.5,"y":45},"sourceId":7,"tableName":"VALIDA_FLUXO_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"VALIDA_FLUXO_CAI","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"wvkMSE","type":"table","appId":137,"label":"VALIDA_FLUXO_CAI","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2083.5,"y":45},"sourceId":7,"tableName":"VALIDA_FLUXO_CAI","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"Svoimh","source":"NezGAE","target":"vhkvHg"},{"id":"RsDMZk","source":"DITkqZ","target":"NezGAE"},{"id":"GzbcRl","source":"tjALzH","target":"EmuBUk"},{"id":"GgsXQB","source":"HBpTux","target":"tjALzH"},{"id":"HBiilM","source":"IYKQeR","target":"ajGQXV"},{"id":"BNFraW","source":"XZMqou","target":"wVHwwl"},{"id":"DxutfC","source":"wVHwwl","target":"Xbimgd"},{"id":"jMYaaP","source":"imkQvc","target":"gLKsls"},{"id":"gYFgbd","source":"gLKsls","target":"Xbimgd"},{"id":"fZMTog","source":"vhkvHg","target":"xEzuSv"},{"id":"kPEodz","source":"xEzuSv","target":"Xbimgd"},{"id":"EYgVvv","source":"sxnrrq","target":"rVeqGy"},{"id":"JjDKMm","source":"rVeqGy","target":"XZMqou"},{"id":"XpTHXN","source":"OkpLTD","target":"jguVzB"},{"id":"IRmseD","source":"jguVzB","target":"imkQvc"},{"id":"OPJMJA","source":"gGyXhN","target":"UoUmSr"},{"id":"TwDRjw","source":"UoUmSr","target":"enypnC"},{"id":"qLMHog","source":"txZzDL","target":"eziIIG"},{"id":"prnNCC","source":"eziIIG","target":"wvkMSE"},{"id":"qLFdbH","source":"Xbimgd","target":"CagHpN"},{"id":"zGvcFy","source":"CagHpN","target":"ajGQXV"},{"id":"yLtuIj","source":"Xbimgd","target":"efcbTg"},{"id":"pYdVxx","source":"efcbTg","target":"yNRgww"},{"id":"gHfqaJ","source":"yNRgww","target":"ZwewDQ"},{"id":"CdjzNv","source":"ZwewDQ","target":"XjRxnU"},{"id":"TGtMfg","source":"XjRxnU","target":"IYKQeR"},{"id":"XAbpMD","type":"manual","label":"","source":"wVHwwl","target":"gLKsls"},{"id":"kyqgXt","type":"manual","label":"","source":"gLKsls","target":"xEzuSv"},{"id":"jjpDAt","type":"manual","label":"","source":"CagHpN","target":"IYKQeR"},{"id":"ABjXwb","source":"cOTUQy","target":"jhhsyE"},{"id":"JbKShw","source":"jhhsyE","target":"QzuViL"},{"id":"igMnbe","source":"MtOjyF","target":"gfwLHJ"},{"id":"AuDbYZ","source":"gfwLHJ","target":"ZaPOVO"},{"id":"SPyiOk","type":"manual","label":"","source":"SpKABp","target":"gfwLHJ"},{"id":"dRpSoT","type":"manual","label":"","source":"helCRn","target":"jhhsyE"},{"id":"adrwHY","source":"QasOOd","target":"DITkqZ"},{"id":"YnWoFx","source":"RtQygk","target":"OkpLTD"},{"id":"ITspWR","source":"UVATnn","target":"sxnrrq"},{"id":"JpMCTP","source":"vhkvHg","target":"hrHbgU"},{"id":"DudKmq","source":"hrHbgU","target":"cOTUQy"},{"id":"VYgJFm","source":"vhkvHg","target":"helCRn"},{"id":"KPVYzh","source":"helCRn","target":"QzuViL"},{"id":"ObKgHW","source":"vhkvHg","target":"sVpIAg"},{"id":"znwgkx","source":"sVpIAg","target":"MtOjyF"},{"id":"tVEqEj","source":"vhkvHg","target":"SpKABp"},{"id":"sONDRI","source":"SpKABp","target":"ZaPOVO"},{"id":"bUeIbz","source":"imkQvc","target":"nPKVpm"},{"id":"pdbPqC","source":"nPKVpm","target":"gGyXhN"},{"id":"ymYtPF","source":"XZMqou","target":"qSbgzL"},{"id":"cfjZDp","source":"qSbgzL","target":"HBpTux"},{"id":"yKiCXx","source":"vhkvHg","target":"HEYeIG"},{"id":"GzuIrX","source":"HEYeIG","target":"txZzDL"},{"id":"mfOKrB","source":"RkGVSL","target":"BphxRW"},{"id":"MtHvFB","source":"imkQvc","target":"fBNphu"},{"id":"RafzSA","source":"fBNphu","target":"LmxKzw"},{"id":"vqBjzM","source":"LmxKzw","target":"vlqiXm"},{"id":"zAYgKw","source":"vlqiXm","target":"RkGVSL"},{"id":"vhspvo","type":"manual","label":"","source":"xEzuSv","target":"BphxRW"},{"id":"awbhxo","source":"BphxRW","target":"Xbimgd"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"app:137:uqoyGfauQXhpKGHkIbpGpJOeotWOcsmo","flowDescription":"","locked":"no","created":"2023-09-01 13:23:09","updated":"2023-09-20 17:19:18"},{"flowId":"3694","appId":137,"flowName":"TRIGGER MSG","workflow":{"nodes":[{"id":"beBEQS","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":50,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OkkRVm","type":"builder","appId":137,"label":"FILTRA EMAILS","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"CxqUim","type":"value","andOr":"and","value":"carloshj@algartelecom.com.br","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"envio_preparado","valueType":"value","columnName":"email","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GZPwGF","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"mPETPk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"FAgXvH","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"cfodPm","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"NZaERd","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"paYOre","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"SbqqGQ","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"MkEOIp","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"OywHGk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"WvXFuU","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"yBqaMx","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"jDlWoB","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"CzibHl","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"bneFHy","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":177,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"envio","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SaHQqQ","type":"table","appId":137,"label":"envio","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":276,"y":39},"sourceId":null,"tableName":"envio","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IWLDdN","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo dos indicadores d-1 (prévia fechamento julho/23 - ao longo do dia os números serão refinados pelos segmentos):\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd_tic_iot}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"Notas: Forecast considera produtividade diária e Best Guess para Corporativo/Atacado; Resultados de TIC + IoT estão contidos nos Segmentos de Negócios.\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Perda de Receita (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"spacing\": \"Medium\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                      \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ata_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                         \r\n                     ]\r\n                 },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3694","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"}],"options":{},"timeout":0,"position":{"x":370,"y":39},"restType":"rest","tableName":"envio","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"bwXkIw","type":"table","appId":137,"label":"log","client":"clickhouse","repoId":1,"created":false,"position":{"x":464,"y":39},"tableName":"log","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"fDQOiK","source":"beBEQS","target":"OkkRVm"},{"id":"wYsoLO","source":"OkkRVm","target":"SaHQqQ"},{"id":"opEGMO","source":"SaHQqQ","target":"IWLDdN"},{"id":"lIiNhI","source":"IWLDdN","target":"bwXkIw"}]},"cron":null,"options":{"folder":"ANALY PRÉ FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"HLLvqbigvqXIVb_JSeAXYpHhFNMrQiUA","flowDescription":"","locked":"no","created":"2023-08-01 11:36:58","updated":"2023-09-08 09:08:23"},{"flowId":"3695","appId":137,"flowName":"FLUXO real x orçado (fechamento)","workflow":{"nodes":[{"id":"ufbBFB","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2114,"y":194},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fpjomb","type":"group","label":"Parallel","created":false,"position":{"x":1955,"y":276.5}},{"id":"LnBEJC","type":"delete","appId":137,"label":"Delete","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"DpqzqP","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"=","tableName":"forecast_insight","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":265,"y":207},"sourceId":null,"tableName":"forecast_insight","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"fdKOxs","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":81.5,"y":68},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RRoyis","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1209.5,"y":241},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YuYuwK","type":"group","label":"Parallel","created":false,"position":{"x":895,"y":289.5}},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":330},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FMbcyi","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":446},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rBtgRI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"rVTZKe","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"Tqywwc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"NaKfBI","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"QhJqUi","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"VDNaMT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"flfZhL","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"jpOUjw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gFehbn","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BJGcRN","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"gymQoD","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-3))","dataType":"Nullable(DateTime)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebqPuN","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zxtcQs","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"kIXayp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"WYGlTN","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"AADvRI","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QhBDxG","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"hesRBK","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jxOlCh"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}]},"created":false,"optimize":false,"position":{"x":895,"y":388},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ysUINE","type":"group","label":"Parallel","created":false,"position":{"x":265,"y":148}},{"id":"SYzQyT","type":"table","appId":137,"label":"analy_disparo_tic_iot_fechamento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":87.9683746050494,"y":-70.00709714674718},"tableName":"analy_disparo_tic_iot_fechamento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sEQoRn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QiSBup","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"aNVIme","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"hdRRcB","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"xTRZDW","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"qshwvi"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","columnName":"DATA_REF","computedId":"iWYrna"},{"type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"qnOpbK"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jYggoS"}]},"created":false,"optimize":false,"position":{"x":265,"y":68},"sourceId":null,"tableName":"analy_disparo_tic_iot_fechamento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"TIC_ANALY_AUX","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WvsCVc","type":"table","appId":137,"label":"TIC_ANALY_AUX","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":657.9925428472955,"y":-21.997180068305028},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jgaznh","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"metrica","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"}]},"shared":false,"created":false,"position":{"x":1055,"y":286},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"RlloqT","type":"table","appId":137,"label":"tmp_alerta_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1209.5,"y":364},"sourceId":null,"tableName":"tmp_alerta_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NYElQD","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"metrica","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":682.9958641001806,"y":75.00115930525237},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"vNMXcv","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":170},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BbkjnJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AOLjea","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"UQwPFw"},{"id":"YkXRWa","type":"value","alias":"sgm","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QgrZoa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"UQwPFw"}]},"created":false,"optimize":false,"position":{"x":895,"y":170},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BQRWpp","type":"table","appId":137,"label":"tmp_forecast_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1055,"y":133},"sourceId":null,"tableName":"tmp_forecast_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_alerta_aux","id":"thRAEV","to":"tmp_forecast_alerta","raw":"","list":[{"id":"PAjsVb","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"lWkUve","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"SEGMENTO","columnTo":"sgm","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_alerta_aux","id":"iHPXzk","to":"teste_mail","raw":"","list":[{"id":"aqWATR","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"SEGMENTO","columnTo":"visao","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SHQxUQ","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qMXQWm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CPlPjP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Gtaiff","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"wdPKUm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SjNjTc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rxeDEX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"GGtaWk","type":"value","andOr":"and","value":"1","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"ativo","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MWBkFX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CdkxNl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"llTcdN","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"kFSItW","type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","distinct":false,"columnName":"teste","computedId":"gAYpmL"},{"id":"WObqMW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"tOvMBM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rmluuw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"mensagem","content":"concat(\n\nconcat(concat(concat('Olá ' ,  max(nome)), ', espero que esteja tudo bem!\\n'),\n\n\n' Segue resumo dos indicadores d-1 dos segmentos')\n,\ntoString(sum(REAL) over (partition by email))\n\n\n)","dataType":"Nullable(String)","columnName":"mensagem","computedId":"CrdTAV"},{"type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","columnName":"teste","computedId":"gAYpmL"},{"type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"PBipBh"}]},"created":false,"position":{"x":1338.5,"y":262},"sourceId":null,"tableName":"tmp_alerta_aux","sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"tbILex","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","parent":"fpjomb","repoId":1,"schema":{"join":[],"sort":[{"id":"ekmNON","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"fxkzhn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"moralI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"gCNWfH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HQkQmv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"xaduop","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"VKXQId","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"TaDxZh","type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"id":"XuPLsY","type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_vnd","computedId":"SWihKb"},{"id":"EbDuNz","type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"id":"SrThPF","type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ope_vnd","computedId":"sbovSd"},{"id":"brygbH","type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_vnd","computedId":"uUVxiO"},{"id":"fDYdfb","type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_prd","computedId":"MmOWIX"},{"id":"OEpoMi","type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_prd","computedId":"zsMWkr"},{"id":"mlZHKR","type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_prd","computedId":"GwZUwh"},{"id":"WqsERO","type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ata_prd","computedId":"ynBIlB"},{"id":"byIouZ","type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_prd","computedId":"btTuhJ"},{"id":"BrUIbf","type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}],"update":[],"computed":[{"type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_vnd","computedId":"SWihKb"},{"type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ope_vnd","computedId":"sbovSd"},{"type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_vnd","computedId":"uUVxiO"},{"type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_prd","computedId":"zsMWkr"},{"type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_prd","computedId":"GwZUwh"},{"type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ata_prd","computedId":"ynBIlB"},{"type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_prd","computedId":"btTuhJ"},{"type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","columnName":"msg_csl_prd","computedId":"MmOWIX"},{"type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}]},"created":false,"optimize":false,"position":{"x":1955,"y":194},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"envio_preparado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"cGryqE","type":"table","appId":137,"label":"tmp_aux_prepara_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1506,"y":262},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bsYYiW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"MnoewF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"heXpKp","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_aux_prepara_sgm_alerta","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"oOaOFx","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"kxREQG","type":"sum","alias":"ORCADO_TRATADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"oefYrH","type":"sum","alias":"FORECAST_VENDA","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"oEcCxS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1668,"y":305.1527830343917},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"tmp_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"Notrgp","type":"table","appId":137,"label":"tmp_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1795.5,"y":292},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYcLht","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","parent":"fpjomb","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"nome","columnLength":2,"databaseName":"bucket_137","targetColumn":"nome"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"email","columnLength":2,"databaseName":"bucket_137","targetColumn":"email"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_consolidado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137","targetColumn":"flag_de_acesso"}]},"shared":false,"created":false,"position":{"x":1955,"y":326},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","databaseName":"bucket_137","resultDatabase":"bucket_137"}],"edges":[{"id":"KMMNNV","source":"WvsCVc","target":"jgaznh"},{"id":"Bkiddn","source":"BQRWpp","target":"kSIbMZ"},{"id":"oRAwbn","source":"RRoyis","target":"kSIbMZ"},{"id":"GiSwqZ","source":"kSIbMZ","target":"cGryqE"},{"id":"fXBBiD","source":"bsYYiW","target":"Notrgp"},{"id":"wozwKI","source":"cGryqE","target":"bsYYiW"},{"id":"jNsdaS","source":"DYcLht","target":"cGryqE"},{"id":"HvmKmO","source":"BbkjnJ","target":"BQRWpp"},{"id":"IZZMsh","source":"vNMXcv","target":"BbkjnJ"},{"id":"OaLsSz","source":"WvsCVc","target":"NYElQD"},{"id":"EBYyep","source":"RlloqT","target":"kSIbMZ"},{"id":"uKbXYa","source":"Notrgp","target":"DYcLht"},{"id":"wDVTXb","type":"manual","label":"","source":"rBtgRI","target":"jgaznh"},{"id":"VXHsiO","source":"LnBEJC","target":"vNMXcv"},{"id":"byVKik","source":"cGryqE","target":"tbILex"},{"id":"aCZCmB","source":"tbILex","target":"ufbBFB"},{"id":"ddqsss","source":"FMbcyi","target":"rBtgRI"},{"id":"BWjlEH","source":"ustfRF","target":"rBtgRI"},{"id":"EBtRks","source":"rBtgRI","target":"RlloqT"},{"id":"EPvlWx","source":"SYzQyT","target":"sEQoRn"},{"id":"CZkNUi","source":"sEQoRn","target":"WvsCVc"},{"id":"cwKpHI","source":"NYElQD","target":"vNMXcv"},{"id":"HDNnGQ","source":"jgaznh","target":"RlloqT"}]},"cron":null,"options":{"folder":"ANALY FECHAMENTO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"QxiiTxXDuMxVkZzZziNCZBLFOgLNAAD_","flowDescription":"","locked":"no","created":"2023-08-01 11:42:48","updated":"2023-09-08 09:08:23"},{"flowId":"3696","appId":137,"flowName":"TRIGGER MSG","workflow":{"nodes":[{"id":"beBEQS","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":50,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OkkRVm","type":"builder","appId":137,"label":"FILTRA EMAILS","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GZPwGF","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"mPETPk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"FAgXvH","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"cfodPm","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"NZaERd","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"paYOre","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"SbqqGQ","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"MkEOIp","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"OywHGk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"WvXFuU","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"yBqaMx","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"jDlWoB","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"CzibHl","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"bneFHy","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":177,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"envio","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SaHQqQ","type":"table","appId":137,"label":"envio","client":"clickhouse","repoId":1,"shared":false,"position":{"x":276,"y":39},"sourceId":null,"tableName":"envio","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IWLDdN","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo dos indicadores do fechamento de Ago/23:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd_tic_iot}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"Resultados de TIC + IoT estão contidos nos Segmentos de Negócios.\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n        {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3696","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"}],"options":{},"timeout":0,"position":{"x":370,"y":39},"restType":"rest","tableName":"envio","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"bwXkIw","type":"table","appId":137,"label":"log","client":"clickhouse","repoId":1,"created":false,"position":{"x":464,"y":39},"tableName":"log","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"vyDqFl","source":"beBEQS","target":"OkkRVm"},{"id":"LFouys","source":"OkkRVm","target":"SaHQqQ"},{"id":"tBIEsf","source":"SaHQqQ","target":"IWLDdN"},{"id":"NAwAGm","source":"IWLDdN","target":"bwXkIw"}]},"cron":null,"options":{"folder":"ANALY FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"uBLKVyrvvrSsJrWeTpIxHwrgpgYoqOSg","flowDescription":"","locked":"no","created":"2023-08-01 11:43:59","updated":"2023-09-08 09:08:23"},{"flowId":"3704","appId":137,"flowName":"MENSAGEM","workflow":{"nodes":[{"id":"CHslAj","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":195.9898045279344,"y":284.99503297514747},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"QfiTui","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"kcuKog","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SDyrdD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"PdfZHA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"Orynkn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":289.9887588384918,"y":286.0117640062295},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"preparando_emails","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fhIyCn","type":"table","appId":137,"label":"preparando_emails","client":"clickhouse","repoId":1,"shared":false,"position":{"x":396.98431465836063,"y":286.0117640062295},"sourceId":null,"tableName":"preparando_emails","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gEYhXl","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Por conta da janela de changes mensais que ocorreu na madrugada de hoje (18/09/23), as cargas nos sistemas de origem, DW e outros bancos, impactaram a publicação de indicadores d-1. Por isso excepcionalmente hoje, a disponibilização de resultados no Portal Analytics será realizada no período da tarde.\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         } \r\n         \r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3704","method":"POST","repoId":1,"created":false,"headers":[{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"},{"prop":"Content-Type","value":"application/json;charset=UTF-8"}],"options":{},"timeout":0,"position":{"x":476.98431465836063,"y":286.0117640062295},"restType":"rest","tableName":"preparando_emails","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_change","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"NsMIBu","type":"table","appId":137,"label":"log_change","client":"clickhouse","repoId":1,"created":false,"position":{"x":596.9843146583606,"y":286.0117640062295},"tableName":"log_change","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"GaeHvz","source":"fhIyCn","target":"gEYhXl"},{"id":"UXaeEr","source":"gEYhXl","target":"NsMIBu"},{"id":"urwJgZ","source":"CHslAj","target":"QfiTui"},{"id":"GthBnF","source":"QfiTui","target":"fhIyCn"}]},"cron":null,"options":{"folder":"ANALY CHANGE","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"kUeYQCVzKQt_eYkJalJoEPNhfxFXq_Lr","flowDescription":"","locked":"no","created":"2023-08-02 08:45:01","updated":"2023-09-18 08:02:33"},{"flowId":"LskBZS","appId":137,"flowName":"Dup. CARGA - Fluxo de Caixa","workflow":{"nodes":[{"id":"QasOOd","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH HIERARQUIA AS (\r\n\tSELECT E1.IDT AS COD, E1.DSC AS DESCRICAO, E4.DSC  CATEGORIA\r\n\tFROM MARIALAR.A_MODELO_ESTRUTURA_CAIXA E1\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E2\r\n\t\tON (E1.IDT_SUR = E2.IDT AND E2.IDT_NIV = 4)\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E3\r\n\t\tON (E2.IDT_SUR = E3.IDT AND E3.IDT_NIV = 3)\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E4\r\n\t\tON (E3.IDT_SUR = E4.IDT AND E4.IDT_NIV = 2)\r\n\tWHERE 1 = 1\r\n\t\tAND E1.IDT_NIV = 5\r\n\tUNION ALL \r\n\tSELECT E2.IDT AS COD, E2.DSC AS DESCRICAO, E4.DSC  CATEGORIA\r\n\tFROM MARIALAR.A_MODELO_ESTRUTURA_CAIXA E2\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E3\r\n\t\tON (E2.IDT_SUR = E3.IDT AND E3.IDT_NIV = 3)\r\n\tLEFT JOIN MARIALAR.A_MODELO_ESTRUTURA_CAIXA E4\r\n\t\tON (E3.IDT_SUR = E4.IDT AND E4.IDT_NIV = 2)\r\n\tWHERE 1 = 1\r\n\t\tAND E2.IDT_NIV = 4\r\n),\r\nFLUXO AS (\r\n\tSELECT    F.TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD') AS DATA_TRANSACAO\r\n\t\t\t, F.COD_EMP \r\n\t\t\t, F.DSC_EMP\r\n\t\t\t, F.COD_BCO_EMP \r\n\t\t\t, F.IDT_CNT \r\n\t\t\t, F.COD_ITE_LIQ\r\n\t\t\t, E1.DESCRICAO AS DESCRICAO\r\n\t\t\t, E1.CATEGORIA AS CATEGORIA\r\n\t\t\t, SUM(F.VLR_TXA) AS TAXA\r\n\t\t\t, SUM(F.VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(F.VLR_IOF) AS IOF\r\n\t\t\t, SUM(F.VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tLEFT JOIN HIERARQUIA E1\r\n\t\tON (F.COD_ITE_LIQ = E1.COD)\r\n\tWHERE 1 = 1\r\n\t\tAND COD_EMP = '3000'\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'FLUXO'\r\n\t\t\t\t\t\t\t\t  \tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t\t\t  )\r\n\t\tAND F.TIP = 'FLUXO'\r\n\t\tAND F.NOM_IND = 'REALIZADO'\r\n\t\tAND F.DAT_TSC >= TO_DATE('20230801', 'YYYYMMDD')\r\n\t\tAND F.DAT_TSC <= (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\tWHERE TIP = 'FLUXO')\r\n\tGROUP BY  F.TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD')\r\n\t\t\t, F.COD_EMP\r\n\t\t\t, F.DSC_EMP\r\n\t\t\t, F.COD_BCO_EMP \r\n\t\t\t, F.IDT_CNT\r\n\t\t\t, F.COD_ITE_LIQ \r\n\t\t\t, E1.DESCRICAO\r\n\t\t\t, E1.CATEGORIA\r\n\tORDER BY  F.TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD')\r\n\t\t\t, F.COD_EMP \r\n\t\t\t, F.COD_BCO_EMP \r\n\t\t\t, F.IDT_CNT\r\n\t\t\t, E1.DESCRICAO\r\n\t\t\t, E1.CATEGORIA\r\n)\r\n\r\nSELECT TRUNC(DATA_TRANSACAO,'DD') AS DATA_REF\r\n\t\t, COD_EMP \r\n\t\t, DSC_EMP\r\n\t\t, COD_BCO_EMP \r\n\t\t, COD_ITE_LIQ\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, 'FLUXO DIÁRIO' AS INDICADOR\r\n\t\t, SUM(VALOR) AS VLR_IND\r\nFROM FLUXO\r\nWHERE 1 = 1\r\n\tAND TRUNC(DATA_TRANSACAO,'DD') >= TO_DATE('20230801','YYYYMMDD')\r\nGROUP BY  TRUNC(DATA_TRANSACAO,'DD')\r\n\t\t, COD_EMP \r\n\t\t, DSC_EMP\r\n\t\t, COD_BCO_EMP \r\n\t\t, COD_ITE_LIQ\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":27.99981200455366,"y":282.00003133257434},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"FC_FLUXO_DIARIO","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"DITkqZ","type":"table","appId":137,"label":"FC_FLUXO_DIARIO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":172.49987466970242,"y":282.0000313325744},"sourceId":7,"tableName":"FC_FLUXO_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NezGAE","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"zjRwSz","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ncNnpN","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"runyqr","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"xCfwsL","type":"computed","alias":"HRQ_1","content":"'Fluxo'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"oggKiu","type":"computed","alias":"HRQ_2","content":"CATEGORIA","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"RFeGYk","type":"computed","alias":"HRQ_3","content":"DESCRICAO","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"CVhGIK","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tTuaos","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"NSyjfX","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"BAWCvy","type":"computed","alias":"HRQ_1","content":"'Fluxo'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"yyPwjw","type":"computed","alias":"HRQ_2","content":"CATEGORIA","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"DCZbqV","type":"computed","alias":"HRQ_3","content":"DESCRICAO","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"VqpfMr","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"id":"PWQRVB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_DIARIO","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"dkDabo"},{"type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"pquNKK"},{"type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"type":"computed","alias":"HRQ_1","content":"'Fluxo'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"DeSjNy"},{"type":"computed","alias":"HRQ_2","content":"CATEGORIA","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"StmtDX"},{"type":"computed","alias":"HRQ_3","content":"DESCRICAO","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"NFgudd"}]},"created":false,"optimize":false,"position":{"x":323.5,"y":283},"sourceId":7,"tableName":"FC_FLUXO_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_GERAL3","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vhkvHg","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_GERAL3","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":488.5,"y":283},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"xEzuSv","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":651,"y":283},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"HEYeIG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uPsavL","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"svEHmR","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"WkBXMe","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"piSall","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"QJwdMK","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"ruOqYS","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"jTjqOi","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"syOuxd","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":579.4999686674256,"y":329.0005953189135},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oIGKCj","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"wYBuiF","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"IiBjPr","type":"value","andOr":"and","value":"2023-09-01 00:00:00","dataType":"Nullable(DateTime)","operator":"between","fieldType":"value","tableName":"FC_FLUXO_CAIXA_GERAL3","valueType":"value","columnName":"DATA_REF","extraValue":"2023-09-05 00:00:00","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"wYBuiF","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_CAIXA_GERAL3","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"rPRbCj","type":"computed","alias":"ENTRADAS","content":"SUM(case when HRQ_2 = 'ENTRADAS OPERACIONAIS' THEN REAL ELSE 0 END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ENTRADAS","computedId":"dWNtWj","columnLength":2},{"id":"RkttOB","type":"computed","alias":"SAIDAS","content":"SUM(case when HRQ_2 = 'SAIDAS OPERACIONAIS' THEN REAL ELSE 0 END)*-1","dataType":"Nullable(Float64)","distinct":false,"columnName":"SAIDAS","computedId":"YvKiTT","columnLength":2},{"id":"TNNrRg","type":"computed","alias":"PERCENTUAL","content":"ENTRADAS/SAIDAS*100","dataType":"Nullable(Float64)","distinct":false,"columnName":"PERCENTUAL","computedId":"ZFPOYm","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"ENTRADAS","content":"SUM(case when HRQ_2 = 'ENTRADAS OPERACIONAIS' THEN REAL ELSE 0 END)","dataType":"Nullable(Float64)","columnName":"ENTRADAS","computedId":"dWNtWj","columnLength":2},{"type":"computed","alias":"SAIDAS","content":"SUM(case when HRQ_2 = 'SAIDAS OPERACIONAIS' THEN REAL ELSE 0 END)*-1","dataType":"Nullable(Float64)","columnName":"SAIDAS","computedId":"YvKiTT","columnLength":2},{"type":"computed","alias":"PERCENTUAL","content":"ENTRADAS/SAIDAS*100","dataType":"Nullable(Float64)","columnName":"PERCENTUAL","computedId":"ZFPOYm","columnLength":2}]},"created":false,"optimize":false,"position":{"x":231.2542808626459,"y":554.0805454821093},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_luana","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"uuvVLn","type":"table","appId":137,"label":"tmp_luana","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":373.8048199605837,"y":560.2629618465726},"sourceId":7,"tableName":"tmp_luana","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"PsWPMx","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"eQucbJ","type":"value","andOr":"and","value":["INVESTIMENTOS","ENTRADAS OPERACIONAIS","SAIDAS OPERACIONAIS"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"FC_FLUXO_DIARIO","valueType":"value","columnName":"CATEGORIA","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"TtXSPM","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"mWEnpu","type":"value","dataType":"Nullable(Int64)","tableName":"FC_FLUXO_DIARIO","columnName":"COD_EMP","columnLength":2,"databaseName":"bucket_137"},{"id":"YDGyCb","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"DSC_EMP","columnLength":2,"databaseName":"bucket_137"},{"id":"hXhSbH","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"COD_BCO_EMP","columnLength":2,"databaseName":"bucket_137"},{"id":"BPhGni","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"COD_ITE_LIQ","columnLength":2,"databaseName":"bucket_137"},{"id":"ZVDVMO","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"DESCRICAO","columnLength":2,"databaseName":"bucket_137"},{"id":"TcUIBh","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"CATEGORIA","columnLength":2,"databaseName":"bucket_137"},{"id":"ORfcHD","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"INDICADOR","columnLength":2,"databaseName":"bucket_137"},{"id":"GvxfSQ","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_DIARIO","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":321.4980260478135,"y":362.9995300113842},"sourceId":7,"tableName":"FC_FLUXO_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_FLUXO_LIVRE","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ZaPOVO","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_FLUXO_LIVRE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":492.4954881092881,"y":362.9995300113842},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DvLsLR","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"LBkVvU","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"JjraLK","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"LCWlPr","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"LORzbh","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":623.4942034737381,"y":363.0015666287194},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_FLUXO_LIVRE_VISUAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ZNcAKM","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_FLUXO_LIVRE_VISUAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":774.4922921867004,"y":363.0015666287195},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE_VISUAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jvmjvW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"AgAQvg","type":"value","andOr":"and","value":["ENTRADAS OPERACIONAIS"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"FC_FLUXO_DIARIO","valueType":"value","columnName":"CATEGORIA","extraValue":[],"columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="},{"list":[{"id":"tjVbhF","type":"value","andOr":"and","value":"NN_IN222","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"FC_FLUXO_DIARIO","valueType":"value","columnName":"COD_ITE_LIQ","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"or","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GjbOjh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_DIARIO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"nmzWFk","type":"value","dataType":"Nullable(Int64)","tableName":"FC_FLUXO_DIARIO","columnName":"COD_EMP","columnLength":2,"databaseName":"bucket_137"},{"id":"tbBbAD","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"DSC_EMP","columnLength":2,"databaseName":"bucket_137"},{"id":"BoNSuY","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"COD_BCO_EMP","columnLength":2,"databaseName":"bucket_137"},{"id":"JUlcLk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"COD_ITE_LIQ","columnLength":2,"databaseName":"bucket_137"},{"id":"xTOssG","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"DESCRICAO","columnLength":2,"databaseName":"bucket_137"},{"id":"eMtgDa","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"CATEGORIA","columnLength":2,"databaseName":"bucket_137"},{"id":"CVIAmH","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_DIARIO","columnName":"INDICADOR","columnLength":2,"databaseName":"bucket_137"},{"id":"NVCboQ","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_DIARIO","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":174.5026319362486,"y":445.9969294077099},"sourceId":7,"tableName":"FC_FLUXO_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_RECEBIMENTOS_CAIXA","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"QzuViL","type":"table","appId":137,"label":"FC_RECEBIMENTOS_CAIXA","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":328.50062665148766,"y":445.99692940771},"sourceId":7,"tableName":"FC_RECEBIMENTOS_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"oGuzrS","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"BeYIIG","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"edWKxw","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"usweif","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"dVwiGj","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":495.49821404325974,"y":444.9989973576196},"sourceId":7,"tableName":"FC_RECEBIMENTOS_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_RECEBIMENTOS_CAIXA_VISUAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pvyWsM","type":"table","appId":137,"label":"FC_RECEBIMENTOS_CAIXA_VISUAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":649.4962087584988,"y":446.9989346924709},"sourceId":7,"tableName":"FC_RECEBIMENTOS_CAIXA_VISUAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RtQygk","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT \t  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, INDICADOR\r\n\t\t, entrada AS entrada\r\n\t\t, resgate AS resgate\r\n\t\t, rendimento AS rendimento\r\n\t\t, CASE WHEN entrada_acu - resgate_acu + rendimento_acu > 0 THEN entrada - resgate + rendimento ELSE entrada - resgate + rendimento - (entrada_acu - resgate_acu + rendimento_acu) end AS VLR_IND\r\n\t\t, entrada_acu - resgate_acu + rendimento_acu AS saldo_acu\r\nFROM (\r\nSELECT \t  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, INDICADOR\r\n\t\t, entrada AS entrada\r\n\t\t, resgate AS resgate\r\n\t\t, rendimento AS rendimento\r\n\t\t, SUM(entrada) OVER(PARTITION BY COD_EMP, DSC_EMP, COD_IDT, DESCRICAO, CATEGORIA, INDICADOR ORDER BY DATA_REF) AS entrada_acu\r\n\t\t, SUM(resgate) OVER(PARTITION BY COD_EMP, DSC_EMP, COD_IDT, DESCRICAO, CATEGORIA, INDICADOR  ORDER BY DATA_REF) AS resgate_acu\r\n\t\t, SUM(rendimento) OVER(PARTITION BY COD_EMP, DSC_EMP, COD_IDT, DESCRICAO, CATEGORIA, INDICADOR ORDER BY DATA_REF) AS rendimento_acu\r\nFROM (\r\nSELECT    DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, ' ' AS DESCRICAO\r\n\t\t, ' ' AS CATEGORIA\r\n\t\t, 'SALDO INICIAL APLICACAO' AS INDICADOR\r\n\t\t, SUM(CASE WHEN INDICADOR = 'ENTRADA APLICACAO' THEN VLR_IND ELSE 0 END) AS entrada\r\n\t\t, SUM(CASE WHEN INDICADOR = 'RESGATE APLICACAO' THEN VLR_IND ELSE 0 END) AS resgate\r\n\t\t, SUM(CASE WHEN INDICADOR = 'RENDIMENTOS' THEN VLR_IND ELSE 0 END) AS rendimento\r\n\t\t, CASE WHEN (SUM(CASE WHEN INDICADOR = 'ENTRADA APLICACAO' THEN VLR_IND ELSE 0 END)-SUM(CASE WHEN INDICADOR = 'RESGATE APLICACAO' THEN VLR_IND ELSE 0 END)+SUM(CASE WHEN INDICADOR = 'RENDIMENTOS' THEN VLR_IND ELSE 0 END)) < 0 THEN 0 ELSE (SUM(CASE WHEN INDICADOR = 'ENTRADA APLICACAO' THEN VLR_IND ELSE 0 END)-SUM(CASE WHEN INDICADOR = 'RESGATE APLICACAO' THEN VLR_IND ELSE 0 END)+SUM(CASE WHEN INDICADOR = 'RENDIMENTOS' THEN VLR_IND ELSE 0 END)) END AS VLR_IND\r\nFROM (\r\n\tSELECT \t  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RGS, 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RGS, 'DD')\r\n\t\t\t  END AS DATA_REF\r\n\t\t\t, COD_EMP AS COD_EMP\r\n\t\t\t, DSC_EMP AS DSC_EMP\r\n\t\t\t, COD_PSC AS COD_IDT\r\n\t\t\t, 'RESGATE APLICACAO' AS INDICADOR\r\n\t\t\t, SUM(VLR)+SUM(VLR_IRRF)+SUM(VLR_IOF) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA ffc \r\n\tWHERE 1 = 1\r\n\t\tAND TIP = 'RESGATE APLICACAO'\r\n\t\tAND COD_EMP = '3400'\r\n\t\t/*AND TRUNC(DAT_RGS, 'DD') < TO_DATE('20230801','YYYYMMDD')*/\r\n\t\tAND DAT_OCO_FTO = (SELECT MAX(DAT_OCO_FTO)\r\n\t\t\t\t\t\t   FROM MARIALAR.F_FLUXO_CAIXA\r\n\t\t\t\t\t\t   WHERE 1 = 1\r\n\t\t\t\t\t\t\t AND TIP = 'RESGATE APLICACAO')\r\n\tGROUP BY  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RGS, 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RGS, 'DD')\r\n\t\t\t  END\r\n\t\t\t, COD_EMP\r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_PSC\r\n\t\r\n\tUNION ALL\r\n\t\r\n\tSELECT    CASE \r\n\t\t\t\tWHEN TRUNC(DAT_IVT , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_IVT, 'DD')\r\n\t\t\t  END AS DATA_REF\r\n\t\t\t, COD_EMP AS COD_EMP\r\n\t\t\t, DSC_EMP AS DSC_EMP\r\n\t\t\t, COD_PSC AS COD_IDT\r\n\t\t\t, 'ENTRADA APLICACAO' AS INDICADOR\r\n\t\t\t, SUM(VLR) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA ffc \r\n\tWHERE 1 = 1\r\n\t\tAND TIP = 'ENTRADA APLICACAO'\r\n\t\tAND COD_EMP = '3400'\r\n\t\t/*AND TRUNC(DAT_IVT, 'DD') < TO_DATE('20230801','YYYYMMDD')*/\r\n\t\tAND DAT_OCO_FTO = (SELECT MAX(DAT_OCO_FTO)\r\n\t\t\t\t\t\t   FROM MARIALAR.F_FLUXO_CAIXA\r\n\t\t\t\t\t\t   WHERE 1 = 1\r\n\t\t\t\t\t\t\t AND TIP = 'ENTRADA APLICACAO')\r\n\tGROUP BY  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_IVT , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_IVT, 'DD')\r\n\t\t\t  END\r\n\t\t\t, COD_EMP\r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_PSC\r\n\t\t\t\r\n\tUNION ALL\r\n\t\r\n\tSELECT \t  CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RTB , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RTB, 'DD')\r\n\t\t\t  END AS DATA_REF\r\n\t\t\t, COD_EMP AS COD_EMP\r\n\t\t\t, DSC_EMP AS DSC_EMP\r\n\t\t\t, COD_PSC AS COD_IDT\r\n\t\t\t, 'RENDIMENTOS' AS INDICADOR\r\n\t\t\t, SUM(VLR) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA ffc \r\n\tWHERE 1 = 1\r\n\t\tAND TIP = 'RENDIMENTOS'\r\n\t\t/*AND TRUNC(DAT_RTB, 'DD') < TO_DATE('20230801','YYYYMMDD')*/\r\n\t\tAND COD_EMP = '3400'\r\n\t\tAND DAT_OCO_FTO = (SELECT MAX(DAT_OCO_FTO)\r\n\t\t\t\t\t\t   FROM MARIALAR.F_FLUXO_CAIXA\r\n\t\t\t\t\t\t   WHERE 1 = 1\r\n\t\t\t\t\t\t\t AND TIP = 'RENDIMENTOS')\r\n\tGROUP BY CASE \r\n\t\t\t\tWHEN TRUNC(DAT_RTB , 'DD') < TO_DATE('20230801','YYYYMMDD') THEN TO_DATE('20230801','YYYYMMDD')\r\n\t\t\t\tELSE TRUNC(DAT_RTB, 'DD')\r\n\t\t\t  END\r\n\t\t\t, COD_EMP\r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_PSC\r\n) WHERE 1 = 1\r\n/*AND TO_DATE('20230803','YYYYMMDD') = data_ref \r\nAND cod_idt = '00000090'*/\r\nGROUP BY  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n)\r\n\t\tGROUP BY   \r\n\t\t  DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_IDT\r\n\t\t, DESCRICAO\r\n\t\t, CATEGORIA\r\n\t\t, INDICADOR\r\n\t\t, entrada\r\n\t\t, resgate\r\n\t\t, rendimento) \r\nORDER BY cod_idt, data_ref","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":22,"y":155},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"FC_SALDO_APLICACAO","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"OkpLTD","type":"table","appId":137,"label":"FC_SALDO_APLICACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":168.5,"y":155},"sourceId":7,"tableName":"FC_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jguVzB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"QzwhpR","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ncNnpN","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"runyqr","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"xCfwsL","type":"computed","alias":"HRQ_1","content":"'Aplicação'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"oggKiu","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"RFeGYk","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"CVhGIK","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tTuaos","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"NSyjfX","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"BAWCvy","type":"computed","alias":"HRQ_1","content":"'Aplicação'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"yyPwjw","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"DCZbqV","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"VqpfMr","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"id":"PWQRVB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_SALDO_APLICACAO","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"dkDabo"},{"type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"pquNKK"},{"type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"type":"computed","alias":"HRQ_1","content":"'Aplicação'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"DeSjNy"},{"type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"StmtDX"},{"type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"NFgudd"}]},"created":false,"optimize":false,"position":{"x":323.5,"y":155},"sourceId":7,"tableName":"FC_SALDO_APLICACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_GERAL2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"imkQvc","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_GERAL2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":488.5,"y":155},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gLKsls","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":651,"y":155},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"nPKVpm","type":"builder","appId":137,"label":"ConsultaFC_FLUXO_FINAL","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VcVZvM","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ogbasZ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"akmUqX","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"KKdFPP","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"fBFCGS","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"fESSxM","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"CMuuix","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"PXoxOJ","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":578.5,"y":220},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL2","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"UVATnn","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT    TRUNC(F.DAT_OCO_FTO+1, 'DD') AS DATA_REF\r\n\t\t, COD_EMP\r\n\t\t, DSC_EMP\r\n\t\t, COD_BCO_EMP AS COD_BCO\r\n\t\t, COD_ITE_LIQ AS COD_IDT\r\n\t\t, 'SALDO INICIAL' AS INDICADOR\r\n\t\t, SUM(VLR) AS VLR_IND\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'SALDO FINAL'\r\n\t\t\t\t\t\t\t\t  \tAND LAST_DAY(DAT_OCO_FTO) = DAT_OCO_FTO  \r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM'))\r\n\t\tAND TIP = 'SALDO FINAL'\r\n\t\tAND COD_EMP = '3400'\r\n\tGROUP BY  TRUNC(F.DAT_OCO_FTO+1,'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, DSC_EMP\r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, COD_ITE_LIQ","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":22,"y":33},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"FC_SALDO_INICIAL","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"sxnrrq","type":"table","appId":137,"label":"FC_SALDO_INICIAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":168.5,"y":33},"sourceId":7,"tableName":"FC_SALDO_INICIAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rVeqGy","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"ZfhUaI","type":"value","alias":"","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ncNnpN","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"runyqr","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"xCfwsL","type":"computed","alias":"HRQ_1","content":"'Saldo Inicial'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"oggKiu","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"RFeGYk","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"CVhGIK","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UsTGar","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"tTuaos","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"dkDabo"},{"id":"NSyjfX","type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"pquNKK"},{"id":"BAWCvy","type":"computed","alias":"HRQ_1","content":"'Saldo Inicial'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"DeSjNy"},{"id":"yyPwjw","type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"StmtDX"},{"id":"DCZbqV","type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"NFgudd"},{"id":"VqpfMr","type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"id":"PWQRVB","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_SALDO_INICIAL","columnName":"VLR_IND","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"dkDabo"},{"type":"computed","alias":"SEGMENTO","content":"DSC_EMP","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"pquNKK"},{"type":"computed","alias":"DSC_LNH_NGC","content":"''","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"zBekrD"},{"type":"computed","alias":"HRQ_1","content":"'Saldo Inicial'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"DeSjNy"},{"type":"computed","alias":"HRQ_2","content":"''","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"StmtDX"},{"type":"computed","alias":"HRQ_3","content":"''","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"NFgudd"}]},"created":false,"optimize":false,"position":{"x":323.5,"y":33},"sourceId":7,"tableName":"FC_SALDO_INICIAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_GERAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XZMqou","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_GERAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":488.5,"y":33},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wVHwwl","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GOylXh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"padKkk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"rFpgiW","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"NThOzk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"NleAdV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"rFTBgB","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"BdewCi","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"HOQTAt","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_GERAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":651,"y":33},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_GERAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_FINAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Xbimgd","type":"table","appId":137,"label":"FC_FLUXO_FINAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":785.5,"y":155},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"iyoAZb","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"AkfIQO","type":"value","order":"asc","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_FINAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"Rwyoro","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_FINAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"JAfkWM","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"FC_FLUXO_FINAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"nRyBMg","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_FINAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TcVtYl","type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","distinct":false,"columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"round(sum(REAL/1000) OVER\n       (PARTITION BY toStartOfMonth(DATA_REF) ORDER BY DATA_REF ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW),0)","dataType":"Nullable(Int64)","columnName":"REAL_ACU","computedId":"CKrMpM","columnLength":2}]},"created":false,"optimize":false,"position":{"x":917.0000626651488,"y":161.9997806719793},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"FC_FLUXO_CAIXA_VISUAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GnsNkd","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_VISUAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1078.5,"y":156.99993733485127},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_VISUAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"XXywJk","type":"report","appId":137,"forms":[],"label":"Explorer","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"kGKSaW","type":"value","alias":"DATA_REF","order":"asc","dataType":"Nullable(DateTime)","fieldType":"","tableName":"FC_FLUXO_CAIXA_VISUAL","columnName":"DATA_REF","localOrder":"asc","filterValue":"","columnLength":2,"databaseName":"bucket_137","filterOperator":"="}],"group":[],"filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"","operator":"="}],"select":[{"id":"kGKSaW","type":"value","dataType":"Nullable(DateTime)","fieldType":"","tableName":"FC_FLUXO_CAIXA_VISUAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zMfHDb","type":"sum","alias":"sum_REAL_ACU","dataType":"Nullable(Int64)","fieldType":"","tableName":"FC_FLUXO_CAIXA_VISUAL","textAlign":"right","columnName":"REAL_ACU","columnLength":2,"databaseName":"bucket_137"}],"limitBy":[]},"shared":false,"created":false,"position":{"x":1204.4988720273222,"y":154.00206794990964},"settings":{"type":"table","theme":{"colors":["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],"labelTextFill":"#444","backgroundColor":"#fff"},"title":"","ranges":[{"id":"start","color":"#222","fixed":true,"value":0,"category":"min"},{"id":"otherRange","color":"#f1c40e","fixed":false,"value":500,"category":"Target 1"},{"id":"someRange","color":"#2ecc71","fixed":false,"value":900,"category":"Target 2"},{"id":"end","color":"#3149D0","fixed":true,"value":1000,"category":"max"}],"cardPic":"","padding":{"leftRight":0,"topBottom":0},"tableSm":true,"cardHtml":false,"cardRows":1,"cardType":"freeStyle","condType":"fontColor","fontSize":14,"linkType":"none","pageSize":40,"pieDonut":false,"showRows":true,"columnBar":true,"limitRows":50,"lineWidth":2,"pointType":"circle","quadrantX":0,"quadrantY":0,"showLabel":false,"showPoint":true,"showTable":true,"showXAxis":true,"showXGrid":false,"showXLine":true,"showYAxis":true,"showYGrid":true,"showYLine":true,"cardBorder":true,"cardMargin":true,"extraColor":"#FACC14","labelAngle":0,"lineSmooth":false,"meterGauge":false,"showFilter":true,"showHeader":false,"showLegend":false,"showXTitle":false,"showYTitle":false,"tableHover":true,"titleAlign":"left","transposed":false,"cardColumns":6,"description":"","headerAlign":"left","innerRadius":0.74,"labelRotate":false,"regionStyle":[{"fill":"#119561"},{"fill":"#667796"},{"fill":"#d5cece"},{"fill":"#933b2b"}],"reportStyle":"clean","showOrderBy":true,"strokeItems":false,"titleHeight":0,"axisFontSize":12,"cardHtmlCode":"","interactions":"none","showQuadrant":false,"tableStriped":true,"axisFontColor":"#222222","cardDirection":"vertical","cardFontColor":"#444","cardTypeStyle":"card_1","comboSyncAxis":false,"guidelineText":"Text","guidelineType":"none","labelFontSize":12,"showLabelType":"bottom","showStatistic":true,"tableBordered":true,"tableFontSize":14,"titleFontSize":14,"totalPosition":"footer","xAxisMaxScale":1000,"xAxisMinScale":0,"yAxisMaxScale":1000,"yAxisMinScale":0,"cardAlignItems":"top","colorFieldType":"measure","labelFontColor":"#222222","legendFontSize":13,"legendPosition":"bottom","stackedPercent":false,"staticFontSize":36,"tableFontColor":"#444","tableWordBreak":false,"titleFontColor":"#222","xAxisTickCount":0,"yAxisTickCount":0,"bulletRangeType":"static","legendFontColor":"#444","quadrantContent":"","tableBackground":"#fff","tableBorderless":false,"appendPaddingTop":0,"comboSeriesField":"stacked","guideScatterType":"none","showLabelMeasure":true,"showLabelPercent":false,"xAxisChangeScale":false,"yAxisChangeScale":false,"appendPaddingLeft":0,"compactNumberAxis":false,"statisticFontSize":13,"appendPaddingRight":0,"cardBackgroundType":"solid","compactNumberLabel":false,"histogramFrequency":2,"showLabelDimension":false,"showLabelDualExtra":false,"statisticFontColor":"#444","xAxisAutoHideLabel":true,"yAxisAutoHideLabel":true,"appendPaddingBottom":0,"cardBackgroundColor":"#ffffff","cardBackgroundField":"","xAxisAutoRotateLabel":false,"yAxisAutoRotateLabel":false,"guidelineTextPosition":"start","interactionScrollSize":150,"compactNumberStatistic":false,"cardBackgroundFontColor":"#606266","interactionSliderPosition":"start"},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_VISUAL","tableView":false,"temporary":false,"reportType":"table","sourceType":"bucket","databaseName":"bucket_137"},{"id":"QZxGtG","type":"reportPreview","label":"Preview","created":false,"position":{"x":1310.4983707061317,"y":153.00209928248407},"reportId":"XXywJk","reportType":"table"},{"id":"CagHpN","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"jwkYEh","type":"value","dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_FINAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"yODdQq","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","dataType":"Nullable(Float64)","tableName":"FC_FLUXO_FINAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"}]},"created":false,"optimize":false,"position":{"x":1364.4846783711237,"y":9.006611173196106},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_TESTE","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"efcbTg","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MvrBGM","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2},{"id":"pXNihn","type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"SuYvcx"},{"id":"CBhTKJ","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"ThlKhk","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iVIEEV","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"byIPtj","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"aGkrdv","type":"value","dataType":"Nullable(String)","tableName":"FC_FLUXO_FINAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"WKGJgH","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"FC_FLUXO_FINAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"NReGcN","type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","distinct":false,"columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"id":"SSzECy","type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"CtJOKA"},{"id":"HVXDVn","type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"METRICA_JOIN","computedId":"PooZoM"}],"update":[],"computed":[{"type":"computed","alias":"TAXA_INSTALACAO","content":"0","dataType":"Nullable(Int64)","columnName":"TAXA_INSTALACAO","computedId":"sWNqnV"},{"type":"computed","alias":"PRODUTO","content":"'N/A'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"CtJOKA"},{"type":"computed","alias":"METRICA_JOIN","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"METRICA_JOIN","computedId":"PooZoM"},{"type":"computed","alias":"TIP_MTC","content":"'Fluxo de Caixa Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"SuYvcx"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"DATA_REF","computedId":"CTTLQR","columnLength":2}]},"created":false,"optimize":false,"position":{"x":787.5027572665459,"y":476.994767460077},"sourceId":7,"tableName":"FC_FLUXO_FINAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_TESTE_MENSAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"yNRgww","type":"table","appId":137,"label":"BASE_FLUXO_TESTE_MENSAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":934.5009713098055,"y":479.99467346235394},"sourceId":7,"tableName":"BASE_FLUXO_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZwewDQ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"zHuMVb","type":"value","dataType":"Nullable(Date)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"OSftVt","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"ggtbPp","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"OViVkE","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"TvrhzQ","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"qXVIEV","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"RIZVrq","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"vOLoOF","type":"value","dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137"},{"id":"hFzgvW","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"jlVKnI","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"zHuMVb","type":"value","dataType":"Nullable(Date)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"OSftVt","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"ggtbPp","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"OViVkE","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"TvrhzQ","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"qXVIEV","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"RIZVrq","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"pviJpD","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"vOLoOF","type":"value","dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137"},{"id":"hFzgvW","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"jlVKnI","type":"value","dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1088.4989660250446,"y":481.99664741454046},"sourceId":7,"tableName":"BASE_FLUXO_TESTE_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_MENSAL","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XjRxnU","type":"table","appId":137,"label":"BASE_FLUXO_MENSAL","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1222.4975873917715,"y":481.99664741454035},"sourceId":7,"tableName":"BASE_FLUXO_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IYKQeR","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"BASE_FLUXO_MENSAL","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"BASE_FLUXO_MENSAL","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_MENSAL","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_MENSAL","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":1372.4958014350314,"y":482.99664741454035},"sourceId":7,"tableName":"BASE_FLUXO_MENSAL","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FLUXO_TESTE","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"ajGQXV","type":"table","appId":137,"label":"BASE_FLUXO_TESTE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1371.4872789747983,"y":398.99439146918434},"sourceId":7,"tableName":"BASE_FLUXO_TESTE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"HBiilM","source":"IYKQeR","target":"ajGQXV"},{"id":"BNFraW","source":"XZMqou","target":"wVHwwl"},{"id":"DxutfC","source":"wVHwwl","target":"Xbimgd"},{"id":"jMYaaP","source":"imkQvc","target":"gLKsls"},{"id":"gYFgbd","source":"gLKsls","target":"Xbimgd"},{"id":"fZMTog","source":"vhkvHg","target":"xEzuSv"},{"id":"kPEodz","source":"xEzuSv","target":"Xbimgd"},{"id":"EYgVvv","source":"sxnrrq","target":"rVeqGy"},{"id":"JjDKMm","source":"rVeqGy","target":"XZMqou"},{"id":"XpTHXN","source":"OkpLTD","target":"jguVzB"},{"id":"IRmseD","source":"jguVzB","target":"imkQvc"},{"id":"XUKgRs","source":"DITkqZ","target":"NezGAE"},{"id":"sUGbCS","source":"NezGAE","target":"vhkvHg"},{"id":"OTOjEw","source":"Xbimgd","target":"iyoAZb"},{"id":"LWPMbH","source":"iyoAZb","target":"GnsNkd"},{"id":"uLNgXI","source":"GnsNkd","target":"XXywJk"},{"id":"PqBOsr","source":"XXywJk","target":"QZxGtG"},{"id":"qLFdbH","source":"Xbimgd","target":"CagHpN"},{"id":"zGvcFy","source":"CagHpN","target":"ajGQXV"},{"id":"yLtuIj","source":"Xbimgd","target":"efcbTg"},{"id":"pYdVxx","source":"efcbTg","target":"yNRgww"},{"id":"gHfqaJ","source":"yNRgww","target":"ZwewDQ"},{"id":"CdjzNv","source":"ZwewDQ","target":"XjRxnU"},{"id":"TGtMfg","source":"XjRxnU","target":"IYKQeR"},{"id":"QzpOsY","source":"QzuViL","target":"oGuzrS"},{"id":"EaGNAe","source":"oGuzrS","target":"pvyWsM"},{"id":"BNizao","source":"DITkqZ","target":"PsWPMx"},{"id":"WUWtBJ","source":"PsWPMx","target":"ZaPOVO"},{"id":"ojOFBW","source":"ZaPOVO","target":"DvLsLR"},{"id":"rfRrrx","source":"DvLsLR","target":"ZNcAKM"},{"id":"Hucobm","source":"imkQvc","target":"nPKVpm"},{"id":"dBLbFy","source":"nPKVpm","target":"Xbimgd"},{"id":"DjHGvr","source":"UVATnn","target":"sxnrrq"},{"id":"MQNhoI","source":"RtQygk","target":"OkpLTD"},{"id":"VUFirE","source":"vhkvHg","target":"HEYeIG"},{"id":"WYrLiV","source":"HEYeIG","target":"Xbimgd"},{"id":"cGTVLR","source":"QasOOd","target":"DITkqZ"},{"id":"WJMeex","source":"DITkqZ","target":"jvmjvW"},{"id":"dXnvti","source":"jvmjvW","target":"QzuViL"},{"id":"oaPadI","source":"vhkvHg","target":"oIGKCj"},{"id":"EMXTBQ","source":"oIGKCj","target":"uuvVLn"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"app:137:kUpFxbezoQKFtLHAOpOsgsqaMWlyMLmE","flowDescription":"","locked":null,"created":"2023-09-13 07:40:21","updated":"2023-09-13 07:40:21"},{"flowId":"kZVLcq","appId":137,"flowName":"CARGA - Forecast Venda S3","workflow":{"nodes":[{"id":"WEQXWm","type":"cloudStorage","appId":137,"label":"Forecast Venda S3","client":"s3","repoId":1,"columns":[],"created":false,"fileData":{"filePath":"gaio/portal_analytics/forecast_corporativo.csv"},"position":{"x":31,"y":39},"sourceId":8,"insertMode":false,"sourceType":"source","resultTable":"forecast_venda_s3","fileFormatType":";","resultDatabase":"bucket_137","schemaInference":"noSchemaInference"},{"id":"WvVTCn","type":"table","appId":137,"label":"forecast_venda_s3","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":167.5,"y":39},"sourceId":8,"tableName":"forecast_venda_s3","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qHFFXk","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"CHAoPl","type":"computed","alias":"mes_ref","order":"asc","content":"toStartOfMonth(toDate(data))","dataType":"Nullable(Date)","distinct":false,"columnName":"mes_ref","computedId":"oUofWV"},{"id":"CVoyRA","type":"value","alias":"","order":"desc","dataType":"Nullable(Date)","distinct":false,"tableName":"forecast_venda_s3","columnName":"data","columnLength":null,"databaseName":"bucket_137"}],"group":[],"limit":1,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"offset":null,"select":[{"id":"vourwY","type":"computed","alias":"mes_ref","content":"toStartOfMonth(toDate(data))","dataType":"Nullable(Date)","distinct":false,"columnName":"mes_ref","computedId":"oUofWV"},{"id":"OvcMjr","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"forecast_venda_s3","columnName":"data","columnLength":null,"databaseName":"bucket_137"},{"id":"eFtPEb","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_venda_s3","columnName":"valor","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"mes_ref","content":"toStartOfMonth(toDate(data))","dataType":"Nullable(Date)","columnName":"mes_ref","computedId":"oUofWV"}]},"created":false,"optimize":false,"position":{"x":300,"y":42.99987466970248},"sourceId":8,"tableName":"forecast_venda_s3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_venda_s3_ttd","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"IsRDgN","type":"table","appId":137,"label":"forecast_venda_s3_ttd","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":442.5,"y":39},"sourceId":8,"tableName":"forecast_venda_s3_ttd","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NcEJen","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":440.1492711457685,"y":-58.78061847566352},"tableName":"forecast_venda_s3_ttd","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_forecast_mes_ref","columnName":"mes_ref"},{"paramName":"prm_forecast_data","columnName":"data"},{"paramName":"prm_forecast_valor","columnName":"valor"}]},{"id":"ynMoqZ","type":"query","appId":137,"label":"SQL Query","query":"ALTER TABLE\n  bucket_137.forecast_atacado\nUPDATE\n  Data = '{{prm_forecast_data}}',\n  MesRef = '{{prm_forecast_mes_ref}}',\n  PrevisaoAtacado = {{prm_forecast_valor}}\nwhere\n  SEGMENTO = 'CORPORATIVO'","client":"clickhouse","repoId":1,"tables":[],"created":false,"position":{"x":602.2917387200574,"y":39.57884668494013},"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"uHCnzH","source":"WEQXWm","target":"WvVTCn"},{"id":"ZLEHwT","type":"manual","label":"","source":"NcEJen","target":"ynMoqZ"},{"id":"ELrkVb","source":"WvVTCn","target":"qHFFXk"},{"id":"kTVSca","source":"qHFFXk","target":"IsRDgN"},{"id":"hEsRfD","source":"IsRDgN","target":"NcEJen"}]},"cron":"5 * * * *","options":{"folder":"CARGAS","reload":0,"cronBase":{"every":2,"current":"5 * * * *","dayValues":[],"hourValues":[],"monthValues":[],"minuteValues":[5],"dayOfMonthValues":[]},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"app:137:BiFauwrOqGYJtqTWBOVezeAXBhYaznwl","flowDescription":"","locked":"no","created":"2023-09-05 10:18:36","updated":"2023-09-08 09:08:23"},{"flowId":"TTSvDo","appId":137,"flowName":"Dup. TRIGGER MSG","workflow":{"nodes":[{"id":"beBEQS","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":50,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OkkRVm","type":"builder","appId":137,"label":"FILTRA EMAILS","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GZPwGF","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"mPETPk","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"FAgXvH","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"cfodPm","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"NZaERd","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"paYOre","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"SbqqGQ","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"MkEOIp","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"bneFHy","type":"value","dataType":"Nullable(String)","tableName":"envio_preparado","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":177,"y":39},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"envio","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SaHQqQ","type":"table","appId":137,"label":"envio","client":"clickhouse","repoId":1,"shared":false,"position":{"x":276,"y":39},"sourceId":null,"tableName":"envio","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IWLDdN","url":"https://syjmidi1fb.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo do fechamento de Vendas Agosto/23:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd_tic_iot}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"Resultados de TIC + IoT estão contidos nos Segmentos de Negócios.\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n        {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"TTSvDo","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"kwih2hm8hR1d3KqlF74CX4PVcsDrQWjNy8WKGrJ4"}],"options":{},"timeout":0,"position":{"x":370,"y":39},"restType":"rest","tableName":"envio","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"bwXkIw","type":"table","appId":137,"label":"log","client":"clickhouse","repoId":1,"created":false,"position":{"x":464,"y":39},"tableName":"log","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"bqOzKl","source":"SaHQqQ","target":"IWLDdN"},{"id":"WDsmyc","source":"IWLDdN","target":"bwXkIw"},{"id":"Hcigrm","source":"beBEQS","target":"OkkRVm"},{"id":"AjsxyV","source":"OkkRVm","target":"SaHQqQ"}]},"cron":null,"options":{"folder":"ANALY FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"app:137:QDvsTuTtRTEyiwaWJPiaVWpeBeYQcnsb","flowDescription":"","locked":null,"created":"2023-09-02 09:05:27","updated":"2023-09-08 09:08:23"},{"flowId":"3887","appId":137,"flowName":"CARGA - Cargas Sem Segmento","workflow":{"nodes":[{"id":"sneeAm","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT  ISP.TIP_MTC             \t\t\tAS TIP_MTC\r\n      , TRUNC(ISP.DAT_DIA_MES_REF,'DD') \tAS DATA_REF\r\n      , ISP.NOM_PRG             \t\t\tAS DSC_NVL_1\r\n      , ISP.NOM_SUB_PRG         \t\t\tAS DSC_NVL_2\r\n      , 'NÃO SE APLICA'             \t\tAS DSC_NVL_3\r\n      , SUM(VLR_IND) \t\t\t\t\t\tAS REAL_BASE\r\n      , 0.00000000001                       AS ORCADO_BASE\r\nFROM THIAGO.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'CAPEX'\r\nGROUP BY ISP.TIP_MTC\r\n      , TRUNC(ISP.DAT_DIA_MES_REF,'DD')\r\n      , ISP.NOM_PRG\r\n      , ISP.NOM_SUB_PRG\r\n      , 'NÃO SE APLICA'\r\nUNION ALL \r\nSELECT  Concat(ISP.TIP_MTC, ' Mensal')      AS TIP_MTC\r\n      , TRUNC(ISP.DAT_DIA_MES_REF,'MM') \tAS DATA_REF\r\n      , ISP.NOM_PRG             \t\t\tAS DSC_NVL_1\r\n      , ISP.NOM_SUB_PRG         \t\t\tAS DSC_NVL_2\r\n      , 'NÃO SE APLICA'             \t\tAS DSC_NVL_3\r\n      , SUM(VLR_IND)\t\t\t\t\t\tAS REAL_BASE\r\n      , 0.00000000001                       AS ORCADO_BASE\r\nFROM THIAGO.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'CAPEX'\r\nGROUP BY Concat(ISP.TIP_MTC, ' Mensal')\r\n      , TRUNC(ISP.DAT_DIA_MES_REF,'MM')\r\n      , ISP.NOM_PRG\r\n      , ISP.NOM_SUB_PRG\r\n      , 'NÃO SE APLICA'","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-167.99404681086628,"y":-84.99630275622214},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"aux_crg_base_bases_sem_segmento","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"VqaGww","type":"fileImport","appId":137,"label":"orcado_base_sem_segmento.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"JnCQXT","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica","alternativeName":"metrica"},{"id":"nDqOhM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_1","alternativeName":"hierarquia_nivel_1"},{"id":"nKwnrE","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hierarquia_nivel_2","alternativeName":"hierarquia_nivel_2"},{"id":"bXfXVX","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hieraraquia_nivel_3","alternativeName":"hieraraquia_nivel_3"},{"id":"ZDSUUb","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"linha_de_negocio_produto","alternativeName":"linha_de_negocio_produto"},{"id":"OvIFKl","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes_ref","alternativeName":"mes_ref"},{"id":"MNhDJq","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"orcado","columnLength":14,"alternativeName":"orcado"}],"created":false,"fileName":"orcado_base_sem_segmento.csv","position":{"x":-524.9780358653535,"y":268.0067051709192},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"aux_orcado_sem_segmento","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"vrTZeN","type":"table","appId":137,"label":"aux_orcado_sem_segmento","client":"clickhouse","repoId":1,"created":false,"position":{"x":-345.9806678016021,"y":268.0066425057704},"tableName":"aux_orcado_sem_segmento","sourceType":"bucket","databaseName":"bucket_137"},{"id":"EVlGkv","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VrLBEb","type":"value","dataType":"Nullable(String)","tableName":"aux_orcado_sem_segmento","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"ZmoHVO","type":"computed","alias":"hierarquia_nivel_1","content":"CASE\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'Estoque' THEN 'ESTOQUE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'IMPULSO'\r\nWHEN hierarquia_nivel_1 = 'InfraCo' THEN 'INFRACO'\r\nWHEN hierarquia_nivel_1 = 'InfraCo' THEN 'INFRACO'\r\nWHEN hierarquia_nivel_1 = 'IOT' THEN 'IOT'\r\nWHEN hierarquia_nivel_1 = 'Manutenção da Operação' THEN 'MANUTENCAO DA OPERACAO'\r\nWHEN hierarquia_nivel_1 = 'Manutenção da Operação' THEN 'MANUTENCAO DA OPERACAO'\r\nWHEN hierarquia_nivel_1 = 'Manutenção da Operação' THEN 'MANUTENCAO DA OPERACAO'\r\nWHEN hierarquia_nivel_1 = 'Redes Compartilhadas' THEN 'REDES COMPARTILHADAS'\r\nWHEN hierarquia_nivel_1 = 'Requisito Legal' THEN 'REQUISITO LEGAL'\r\nELSE upper(hierarquia_nivel_1)\r\nEND ","dataType":"Nullable(String)","distinct":false,"columnName":"hierarquia_nivel_1","computedId":"rhDxDV"},{"id":"cbFImq","type":"computed","alias":"hierarquia_nivel_2","content":"CASE\r\nWHEN hierarquia_nivel_2 = 'Corporativo Ativação Clientes' THEN 'CORPORATIVO ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'MPE Ativação Clientes' THEN 'MPE ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'Plano de Qualidade' THEN 'PLANO DE QUALIDADE'\r\nWHEN hierarquia_nivel_2 = 'TIC' THEN 'TIC'\r\nWHEN hierarquia_nivel_2 = 'B2C Ativação Clientes' THEN 'B2C ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'Evolução Móvel' THEN 'EVOLUCAO MOVEL'\r\nWHEN hierarquia_nivel_2 = 'Expansão Novas Localidades B2C' THEN 'EXPANSAO NOVAS LOCALIDADES B2C'\r\nWHEN hierarquia_nivel_2 = 'Fibra Verde' THEN 'FIBRA VERDE'\r\nWHEN hierarquia_nivel_2 = 'Franquias' THEN 'FRANQUIAS'\r\nWHEN hierarquia_nivel_2 = 'Estoque' THEN 'ESTOQUE'\r\nWHEN hierarquia_nivel_2 = 'Brain' THEN 'BRAIN'\r\nWHEN hierarquia_nivel_2 = 'CSC' THEN 'CSC'\r\nWHEN hierarquia_nivel_2 = 'ERP' THEN 'ERP'\r\nWHEN hierarquia_nivel_2 = 'Juros s/ Obras' THEN 'JUROS S/ OBRAS'\r\nWHEN hierarquia_nivel_2 = 'Suprimentos' THEN 'IMPULSO'\r\nWHEN hierarquia_nivel_2 = 'InfraCo - Projetos Especiais' THEN 'INFRACO - PROJETOS ESPECIAIS'\r\nWHEN hierarquia_nivel_2 = 'InfraCo Ativação Clientes' THEN 'INFRACO ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'IOT' THEN 'IOT'\r\nWHEN hierarquia_nivel_2 = 'Redes' THEN 'REDES'\r\nWHEN hierarquia_nivel_2 = 'TI' THEN 'TI'\r\nWHEN hierarquia_nivel_2 = 'Vogel Sustentação' THEN 'VOGEL SUSTENTACAO'\r\nWHEN hierarquia_nivel_2 = 'Redes Compartilhadas' THEN 'REDES COMPARTILHADAS'\r\nWHEN hierarquia_nivel_2 = 'Requisito Legal' THEN 'REQUISITO LEGAL'\r\nELSE upper(hierarquia_nivel_2)\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"hierarquia_nivel_2","computedId":"WdSNRT"},{"id":"JBaPht","type":"computed","alias":"hierarquia_nivel_3","content":"upper(hieraraquia_nivel_3)","dataType":"Nullable(String)","distinct":false,"columnName":"hierarquia_nivel_3","computedId":"lJSTED"},{"id":"KgDtHX","type":"value","dataType":"Nullable(String)","tableName":"aux_orcado_sem_segmento","columnName":"linha_de_negocio_produto","columnLength":null,"databaseName":"bucket_137"},{"id":"QuIrVv","type":"value","dataType":"Nullable(Date)","tableName":"aux_orcado_sem_segmento","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"SbJoLb","type":"value","dataType":"Nullable(Float64)","tableName":"aux_orcado_sem_segmento","columnName":"orcado","columnLength":14,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"hierarquia_nivel_1","content":"CASE\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2B' THEN 'B2B'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'B2C' THEN 'B2C'\r\nWHEN hierarquia_nivel_1 = 'Estoque' THEN 'ESTOQUE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'ESTRUTURANTE'\r\nWHEN hierarquia_nivel_1 = 'Estruturante' THEN 'IMPULSO'\r\nWHEN hierarquia_nivel_1 = 'InfraCo' THEN 'INFRACO'\r\nWHEN hierarquia_nivel_1 = 'InfraCo' THEN 'INFRACO'\r\nWHEN hierarquia_nivel_1 = 'IOT' THEN 'IOT'\r\nWHEN hierarquia_nivel_1 = 'Manutenção da Operação' THEN 'MANUTENCAO DA OPERACAO'\r\nWHEN hierarquia_nivel_1 = 'Manutenção da Operação' THEN 'MANUTENCAO DA OPERACAO'\r\nWHEN hierarquia_nivel_1 = 'Manutenção da Operação' THEN 'MANUTENCAO DA OPERACAO'\r\nWHEN hierarquia_nivel_1 = 'Redes Compartilhadas' THEN 'REDES COMPARTILHADAS'\r\nWHEN hierarquia_nivel_1 = 'Requisito Legal' THEN 'REQUISITO LEGAL'\r\nELSE upper(hierarquia_nivel_1)\r\nEND ","dataType":"Nullable(String)","columnName":"hierarquia_nivel_1","computedId":"rhDxDV"},{"type":"computed","alias":"hierarquia_nivel_2","content":"CASE\r\nWHEN hierarquia_nivel_2 = 'Corporativo Ativação Clientes' THEN 'CORPORATIVO ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'MPE Ativação Clientes' THEN 'MPE ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'Plano de Qualidade' THEN 'PLANO DE QUALIDADE'\r\nWHEN hierarquia_nivel_2 = 'TIC' THEN 'TIC'\r\nWHEN hierarquia_nivel_2 = 'B2C Ativação Clientes' THEN 'B2C ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'Evolução Móvel' THEN 'EVOLUCAO MOVEL'\r\nWHEN hierarquia_nivel_2 = 'Expansão Novas Localidades B2C' THEN 'EXPANSAO NOVAS LOCALIDADES B2C'\r\nWHEN hierarquia_nivel_2 = 'Fibra Verde' THEN 'FIBRA VERDE'\r\nWHEN hierarquia_nivel_2 = 'Franquias' THEN 'FRANQUIAS'\r\nWHEN hierarquia_nivel_2 = 'Estoque' THEN 'ESTOQUE'\r\nWHEN hierarquia_nivel_2 = 'Brain' THEN 'BRAIN'\r\nWHEN hierarquia_nivel_2 = 'CSC' THEN 'CSC'\r\nWHEN hierarquia_nivel_2 = 'ERP' THEN 'ERP'\r\nWHEN hierarquia_nivel_2 = 'Juros s/ Obras' THEN 'JUROS S/ OBRAS'\r\nWHEN hierarquia_nivel_2 = 'Suprimentos' THEN 'IMPULSO'\r\nWHEN hierarquia_nivel_2 = 'InfraCo - Projetos Especiais' THEN 'INFRACO - PROJETOS ESPECIAIS'\r\nWHEN hierarquia_nivel_2 = 'InfraCo Ativação Clientes' THEN 'INFRACO ATIVACAO CLIENTES'\r\nWHEN hierarquia_nivel_2 = 'IOT' THEN 'IOT'\r\nWHEN hierarquia_nivel_2 = 'Redes' THEN 'REDES'\r\nWHEN hierarquia_nivel_2 = 'TI' THEN 'TI'\r\nWHEN hierarquia_nivel_2 = 'Vogel Sustentação' THEN 'VOGEL SUSTENTACAO'\r\nWHEN hierarquia_nivel_2 = 'Redes Compartilhadas' THEN 'REDES COMPARTILHADAS'\r\nWHEN hierarquia_nivel_2 = 'Requisito Legal' THEN 'REQUISITO LEGAL'\r\nELSE upper(hierarquia_nivel_2)\r\nEND","dataType":"Nullable(String)","columnName":"hierarquia_nivel_2","computedId":"WdSNRT"},{"type":"computed","alias":"hierarquia_nivel_3","content":"upper(hieraraquia_nivel_3)","dataType":"Nullable(String)","columnName":"hierarquia_nivel_3","computedId":"lJSTED"}]},"created":false,"optimize":false,"position":{"x":-157.98373839389217,"y":269.0086477905313},"tableName":"aux_orcado_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"orcado_sem_segmento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qCUtKr","type":"table","appId":137,"label":"orcado_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-0.9921041912539864,"y":268.00582785883626},"tableName":"orcado_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"vwPWhK","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"orcado_sem_segmento","columnName":"metrica","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"orcado_sem_segmento","columnName":"hierarquia_nivel_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_NVL_1"},{"dataType":"Nullable(String)","tableName":"orcado_sem_segmento","columnName":"hierarquia_nivel_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_NVL_2"},{"dataType":"Nullable(String)","tableName":"orcado_sem_segmento","columnName":"hierarquia_nivel_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_NVL_3"},{"dataType":"Nullable(String)","tableName":"orcado_sem_segmento","columnName":"linha_de_negocio_produto","columnLength":null,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Date)","tableName":"orcado_sem_segmento","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(Float64)","tableName":"orcado_sem_segmento","columnName":"orcado","columnLength":14,"databaseName":"bucket_137","targetColumn":"ORCADO_BASE"}]},"shared":false,"created":false,"position":{"x":4.010214419250701,"y":89.01287768807384},"tableName":"orcado_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"aux_crg_base_bases_sem_segmento","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"dpQsSn","type":"fileImport","appId":137,"label":"validacaoopexjulho23_postratamento.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"kCctUw","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"data","alternativeName":"data"},{"id":"yPNXNR","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"entidade","alternativeName":"entidade"},{"id":"AYfDUw","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"entidade_old","alternativeName":"entidade_old"},{"id":"txLPWM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"pacote","alternativeName":"pacote"},{"id":"aCfaQr","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"pacote_old","alternativeName":"pacote_old"},{"id":"gopZgB","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"sub_pacote","alternativeName":"sub_pacote"},{"id":"mLpUcy","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"sub_pacote_old","alternativeName":"sub_pacote_old"},{"id":"OXWVyR","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"empresa","alternativeName":"empresa"},{"id":"yfaOKL","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"cod_conta_razao","columnLength":2,"alternativeName":"cod_conta_razao"},{"id":"CCudUU","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"conta_razao","alternativeName":"conta_razao"},{"id":"hqoCxA","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"cod_cr","columnLength":2,"alternativeName":"cod_cr"},{"id":"hqCRvK","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"cod_cr_old","columnLength":2,"alternativeName":"cod_cr_old"},{"id":"EJZlHO","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"diretoria","alternativeName":"diretoria"},{"id":"DbODpM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"diretoria_old","alternativeName":"diretoria_old"},{"id":"SLotlO","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu","alternativeName":"bu"},{"id":"pOjnBJ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu_old","alternativeName":"bu_old"},{"id":"YPsgdJ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"agrupamento","alternativeName":"agrupamento"},{"id":"VFgOaG","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"agrupamento_old","alternativeName":"agrupamento_old"},{"id":"CiqVKP","index":false,"decimal":"dot","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"valor","columnLength":2,"alternativeName":"valor"}],"created":false,"fileName":"validacaoopexjulho23_postratamento.csv","position":{"x":-922.0409829738624,"y":-306.99721883119355},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"tabela_opex_v1","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"lfNewLine","fieldsTerminatedBy":"tab"},{"id":"lgCkVH","type":"table","appId":137,"label":"tabela_opex_v1","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-740.0459762916282,"y":-305.00360734068823},"sourceId":7,"tableName":"tabela_opex_v1","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"APrQCB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"NOZGiv","type":"computed","alias":"TIP_MTC","content":"'OPEX Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"sBHWGi"},{"id":"twJbQE","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(toDate(data))","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"zerRGH"},{"id":"MhomMX","type":"value","alias":"DSC_NVL_1","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"diretoria","columnLength":null,"databaseName":"bucket_137"},{"id":"ZnXibd","type":"value","alias":"DSC_NVL_2","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"pacote","columnLength":null,"databaseName":"bucket_137"},{"id":"aRymtb","type":"value","alias":"DSC_NVL_3","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"sub_pacote","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"waJmxm","type":"computed","alias":"TIP_MTC","content":"'OPEX Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"sBHWGi"},{"id":"qPirOW","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(toDate(data))","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"zerRGH"},{"id":"MhomMX","type":"value","alias":"DSC_NVL_1","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"diretoria","columnLength":null,"databaseName":"bucket_137"},{"id":"ZnXibd","type":"value","alias":"DSC_NVL_2","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"pacote","columnLength":null,"databaseName":"bucket_137"},{"id":"aRymtb","type":"value","alias":"DSC_NVL_3","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"sub_pacote","columnLength":null,"databaseName":"bucket_137"},{"id":"DzubjK","type":"sum","alias":"REAL_BASE","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_opex_v1","columnName":"valor","columnLength":2,"databaseName":"bucket_137"},{"id":"QzfLIg","type":"computed","alias":"ORCADO_BASE","content":"0.001","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_BASE","computedId":"wwwJDn","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'OPEX Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"sBHWGi"},{"type":"computed","alias":"ORCADO_BASE","content":"0.001","dataType":"Nullable(Float64)","columnName":"ORCADO_BASE","computedId":"wwwJDn","columnLength":2},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(toDate(data))","dataType":"Nullable(Date)","columnName":"DATA_REF","computedId":"zerRGH"}]},"created":false,"optimize":false,"position":{"x":-631.0445810998995,"y":-305.0083803650233},"sourceId":7,"tableName":"tabela_opex_v1","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_opex_v2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"odxcet","type":"table","appId":137,"label":"tabela_opex_v2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-527.0435530638889,"y":-303.00823350273606},"sourceId":7,"tableName":"tabela_opex_v2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"asxGRB","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"NOZGiv","type":"computed","alias":"TIP_MTC","content":"'OPEX'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"sBHWGi"},{"id":"twJbQE","type":"computed","alias":"DATA_REF","content":"toDate(data)","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"zerRGH"},{"id":"MhomMX","type":"value","alias":"DSC_NVL_1","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"diretoria","columnLength":null,"databaseName":"bucket_137"},{"id":"ZnXibd","type":"value","alias":"DSC_NVL_2","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"pacote","columnLength":null,"databaseName":"bucket_137"},{"id":"aRymtb","type":"value","alias":"DSC_NVL_3","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"sub_pacote","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"waJmxm","type":"computed","alias":"TIP_MTC","content":"'OPEX'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"sBHWGi"},{"id":"qPirOW","type":"computed","alias":"DATA_REF","content":"toDate(data)","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_REF","computedId":"zerRGH"},{"id":"MhomMX","type":"value","alias":"DSC_NVL_1","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"diretoria","columnLength":null,"databaseName":"bucket_137"},{"id":"ZnXibd","type":"value","alias":"DSC_NVL_2","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"pacote","columnLength":null,"databaseName":"bucket_137"},{"id":"aRymtb","type":"value","alias":"DSC_NVL_3","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_opex_v1","columnName":"sub_pacote","columnLength":null,"databaseName":"bucket_137"},{"id":"DzubjK","type":"sum","alias":"REAL_BASE","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_opex_v1","columnName":"valor","columnLength":2,"databaseName":"bucket_137"},{"id":"QzfLIg","type":"computed","alias":"ORCADO_BASE","content":"0.001","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO_BASE","computedId":"wwwJDn","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'OPEX'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"sBHWGi"},{"type":"computed","alias":"ORCADO_BASE","content":"0.001","dataType":"Nullable(Float64)","columnName":"ORCADO_BASE","computedId":"wwwJDn","columnLength":2},{"type":"computed","alias":"DATA_REF","content":"toDate(data)","dataType":"Nullable(Date)","columnName":"DATA_REF","computedId":"zerRGH"}]},"created":false,"optimize":false,"position":{"x":-625.1209359575251,"y":-447.2885434785796},"sourceId":7,"tableName":"tabela_opex_v1","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_opex_v3","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pERfvE","type":"table","appId":137,"label":"tabela_opex_v3","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-527.696455858005,"y":-446.75822347147096},"sourceId":7,"tableName":"tabela_opex_v3","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VRWWgS","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH OPEX AS (\r\n\tSELECT    DAT_LCT AS DATA\r\n\t\t, CASE \r\n\t\t\tWHEN NOM_PCT = 'DESPESAS TRIBUTARIAS' THEN 'CONTROLADORIA CORPORATIVA'\r\n\t\t\tWHEN NOM_PCT = 'CONCESSAO, LICENCAS E AUTORIZACOES' THEN 'CONTROLADORIA CORPORATIVA' \r\n\t\t\tWHEN COD_CNT_RAZ IN ('4107010003'\r\n\t\t\t\t\t\t\t\t,'6101100015'\r\n\t\t\t\t\t\t\t\t,'6101100020'\r\n\t\t\t\t\t\t\t\t,'6101100021') THEN 'CONTROLADORIA CORPORATIVA' \r\n\t\t\tELSE NOM_NVA_EDE \r\n\t\t\tEND AS ENTIDADE\r\n\t\t, NOM_NVA_EDE AS ENTIDADE_OLD\r\n\t\t, CASE \r\n\t\t\tWHEN NOM_PCT = 'TI CORPORATIVO' AND COD_CR = '023' THEN 'TI TIC'\r\n\t\t\tWHEN COD_CR = '080' THEN 'BRAIN'\r\n\t\t\tWHEN COD_CR IN ('081', '111', '132', '135', '136', '137', '138', '186') THEN 'BPO'\r\n\t\t\tWHEN COD_CR = '069' THEN 'EFICIENCIA TRIBUTARIA'\r\n\t\t\tWHEN COD_CR IN ('001', '014', '089', '092') THEN 'CONSELHO E COMITES'\r\n\t\t\tWHEN COD_CR = '079' THEN 'PESSOAL'\r\n\t\t\tWHEN COD_CR = '172' AND COD_CNT_RAZ NOT IN ('4103010006', '5103010006') THEN 'BPO'\r\n\t\t\tELSE NOM_PCT\r\n\t\t  END AS PACOTE\r\n\t\t, NOM_PCT AS PACOTE_OLD\r\n\t\t, CASE \r\n\t\t\tWHEN NOM_PCT = 'TI CORPORATIVO' AND COD_CR = '023' THEN 'TI TIC'\r\n\t\t\tWHEN COD_CR IN ('081', '111', '132', '135', '136', '137', '138', '186') THEN 'CSC'\r\n\t\t\tWHEN COD_CR = '080' THEN 'BRAIN'\r\n\t\t\tWHEN COD_CR = '069' THEN 'EFICIENCIA TRIBUTARIA'\r\n\t\t\tWHEN COD_CR IN ('001', '014', '089', '092') THEN 'CONSELHO E COMITES'\r\n\t\t\tWHEN COD_CR = '079' THEN 'DESENVOLVIMENTO'\r\n\t\t\tWHEN COD_CR = '172' AND COD_CNT_RAZ NOT IN ('4103010006', '5103010006') THEN 'ACN'\r\n\t\t\tELSE NOM_SUB_PCT\r\n\t\t  END AS SUB_PACOTE\r\n\t\t, NOM_SUB_PCT AS SUB_PACOTE_OLD\r\n\t\t, DSC_EMP AS EMPRESA\r\n\t\t, COD_CNT_RAZ AS COD_CONTA_RAZAO\r\n\t\t, DSC_CNT_RAZ AS CONTA_RAZAO\r\n\t\t, CASE\r\n\t\t\tWHEN NOM_PCT = 'DESPESAS TRIBUTARIAS' THEN '192'\r\n\t\t\tWHEN NOM_PCT = 'CONCESSAO, LICENCAS E AUTORIZACOES' THEN '192'\r\n\t\t\tWHEN COD_CNT_RAZ IN ('4107010003'\r\n\t\t\t\t\t\t\t\t,'6101100015'\r\n\t\t\t\t\t\t\t\t,'6101100020'\r\n\t\t\t\t\t\t\t\t,'6101100021') THEN '192'\r\n\t\t\tELSE COD_CR\r\n\t\t  END AS COD_CR\r\n\t\t, COD_CR AS COD_CR_OLD\r\n\t\t, CASE \r\n\t\t\t\tWHEN NOM_PCT = 'DESPESAS TRIBUTARIAS' THEN 'GASTOS CORPORATIVOS'\r\n\t\t\t\tWHEN NOM_PCT = 'CONCESSAO, LICENCAS E AUTORIZACOES' THEN 'GASTOS CORPORATIVOS'\r\n\t\t\t\tWHEN COD_CNT_RAZ IN ('4107010003'\r\n\t\t\t\t\t\t\t\t,'6101100015'\r\n\t\t\t\t\t\t\t\t,'6101100020'\r\n\t\t\t\t\t\t\t\t,'6101100021') THEN 'GASTOS CORPORATIVOS' \r\n\t\t\t\tELSE NOM_NVA_DRT_EXE END AS DIRETORIA\r\n\t\t, NOM_NVA_DRT_EXE AS DIRETORIA_OLD\r\n\t\t, CASE \r\n\t\t\tWHEN NOM_PCT = 'DESPESAS TRIBUTARIAS' THEN 'TRANSVERSAL'\r\n\t\t\tWHEN NOM_PCT = 'CONCESSAO, LICENCAS E AUTORIZACOES' THEN 'TRANSVERSAL'\r\n\t\t\t\tWHEN COD_CNT_RAZ IN ('4107010003'\r\n\t\t\t\t\t\t\t\t,'6101100015'\r\n\t\t\t\t\t\t\t\t,'6101100020'\r\n\t\t\t\t\t\t\t\t,'6101100021') THEN 'TRANSVERSAL'\r\n\t\t\tELSE NOM_NVA_UND_NGC END AS BU\r\n\t\t, NOM_NVA_UND_NGC AS BU_OLD\r\n\t\t, CASE \r\n\t\t\tWHEN NOM_PCT = 'TI CORPORATIVO' AND COD_CR = '023' THEN 'TI TIC'\r\n\t\t\tWHEN COD_CR IN ('081', '111', '132', '135', '136', '137', '138', '186') THEN 'CSC'\r\n\t\t\tWHEN COD_CR = '080' THEN 'BRAIN'\r\n\t\t\tWHEN COD_CR = '069' THEN 'EFICIENCIA TRIBUTARIA'\r\n\t\t\tWHEN COD_CR IN ('001', '014', '089', '092') THEN 'CONSELHO E COMITES'\r\n\t\t\tWHEN COD_CR = '079' THEN 'TREINAMENTO'\r\n\t\t\tWHEN COD_CR = '172' AND COD_CNT_RAZ NOT IN ('4103010006', '5103010006') THEN 'FINANCAS'\r\n\t\t\tWHEN NOM_PCT = 'DESPESAS TRIBUTARIAS' THEN 'N/A'\r\n\t\t\tWHEN NOM_PCT = 'CONCESSAO, LICENCAS E AUTORIZACOES' THEN 'N/A'\r\n\t\t\tWHEN COD_CNT_RAZ IN ('4107010003'\r\n\t\t\t\t\t\t\t\t,'6101100015'\r\n\t\t\t\t\t\t\t\t,'6101100020'\r\n\t\t\t\t\t\t\t\t,'6101100021') THEN 'N/A'\r\n\t\t\tELSE DSC_GRP\r\n\t\t  END AS AGRUPAMENTO\r\n\t\t, DSC_GRP AS AGRUPAMENTO_OLD\r\n\t\t, VLR_RLZ AS VALOR\r\nFROM MARIALAR.F_ACOMPANHAMENTO_OPEX fao\r\nWHERE 1 = 1\r\n\tAND TIP_DOC <> 'CO'\r\n\tAND NOM_PCT NOT IN ('DEPRECIACAO', 'EQUIVALENCIA PATRIMONIAL')\r\n\tAND NOM_PCT IS NOT NULL\r\n\tAND COD_CNT_RAZ NOT IN ('4112010003', '4112010005')\r\nUNION ALL \r\nSELECT \t  TRUNC(DAT_LCT,'MM') AS DATA\r\n\t\t, '' AS ENTIDADE\r\n\t\t, '' AS ENTIDADE_OLD\r\n\t\t, 'ELIMINACAO' AS PACOTE\r\n\t\t, 'ELIMINACAO' AS PACOTE_OLD\r\n\t\t, 'ELIMINACAO' SUB_PACOTE\r\n\t\t, 'ELIMINACAO' AS SUB_PACOTE_OLD\r\n\t\t, 'MULTIMIDIA' AS EMPRESA\r\n\t\t, '999999' AS COD_CONTA_RAZAO\r\n\t\t, '999999' AS CONTA_RAZAO\r\n\t\t, 'CR192' AS COD_CR\r\n\t\t, 'CR192' AS COD_CR_OLD\r\n\t\t, '' AS DIRETORIA\r\n\t\t, '' AS DIRETORIA_OLD\r\n\t\t, '' AS BU\r\n\t\t, '' AS BU_OLD\r\n\t\t, 'ELIMINACAO' AS AGRUPAMENTO\r\n\t\t, 'ELIMINACAO' AS AGRUPAMENTO_OLD\r\n\t\t, SUM(VLR) AS VALOR\r\nFROM DWADM.F_RECEITA R\r\nWHERE 1 = 1\r\n\tAND R.COD_CNT_RAZ NOT LIKE '34%'\r\n\tAND NVL(R.COD_SCD_PRA,'0') IN ('3000', '3100', '3200', '3300','3400')\r\n\tAND R.TIP_DOC <> 'SC'\r\nGROUP BY TRUNC(DAT_LCT,'MM')\r\nUNION ALL\r\nSELECT \t  TRUNC(DAT_LCT,'MM') AS DATA\r\n\t\t, '' AS ENTIDADE\r\n\t\t, '' AS ENTIDADE_OLD\r\n\t\t, 'ELIMINACAO' AS PACOTE\r\n\t\t, 'ELIMINACAO' AS PACOTE_OLD\r\n\t\t, 'ELIMINACAO' SUB_PACOTE\r\n\t\t, 'ELIMINACAO' AS SUB_PACOTE_OLD\r\n\t\t, 'MULTIMIDIA' AS EMPRESA\r\n\t\t, '999999' AS COD_CONTA_RAZAO\r\n\t\t, '999999' AS CONTA_RAZAO\r\n\t\t, 'CR192' AS COD_CR\r\n\t\t, 'CR192' AS COD_CR_OLD\r\n\t\t, '' AS DIRETORIA\r\n\t\t, '' AS DIRETORIA_OLD\r\n\t\t, '' AS BU\r\n\t\t, '' AS BU_OLD\r\n\t\t, 'ELIMINACAO' AS AGRUPAMENTO\r\n\t\t, 'ELIMINACAO' AS AGRUPAMENTO_OLD\r\n\t\t, SUM(VLR_RLZ) AS VALOR\r\nFROM MARIALAR.F_ACOMPANHAMENTO_OPEX R\r\nWHERE 1 = 1\r\n\tAND TIP_DOC <> 'CO'\r\n\tAND NOM_PCT = 'REDES E DADOS'\r\n\tAND COD_CNT_RAZ IN ('4112010003', '4112010005')\r\nGROUP BY TRUNC(DAT_LCT,'MM')\r\n)\r\n\r\n\r\nSELECT    'OPEX' AS TIP_MTC\r\n\t\t, DATA AS DATA_REF\r\n\t\t, REPLACE(REPLACE(REPLACE(DIRETORIA,'/',''),',',''),'&', 'E') AS DSC_NVL_1\r\n\t\t, REPLACE(REPLACE(PACOTE,'/',''),',','') AS DSC_NVL_2\r\n\t\t, REPLACE(REPLACE(SUB_PACOTE,'/',''),',','') AS DSC_NVL_3\r\n\t\t, SUM(VALOR) AS REAL_BASE\r\n\t\t, 0.0001 AS ORCADO_BASE\r\nFROM OPEX\r\nWHERE 1 = 1\r\n\tAND TRUNC(DATA, 'MM') >= TO_DATE('20230101', 'YYYYMMDD')\r\nGROUP BY  DATA\r\n\t\t, DIRETORIA\r\n\t\t, PACOTE\r\n\t\t, SUB_PACOTE\r\nUNION ALL\r\nSELECT    'OPEX Mensal' AS TIP_MTC\r\n\t\t, TRUNC(DATA, 'MM') AS DATA_REF\r\n\t\t, REPLACE(REPLACE(REPLACE(DIRETORIA,'/',''),',',''),'&', 'E') AS DSC_NVL_1\r\n\t\t, REPLACE(REPLACE(PACOTE,'/',''),',','') AS DSC_NVL_2\r\n\t\t, REPLACE(REPLACE(SUB_PACOTE,'/',''),',','') AS DSC_NVL_3\r\n\t\t, SUM(VALOR) AS REAL_BASE\r\n\t\t, 0.0001 AS ORCADO_BASE\r\nFROM OPEX\r\nWHERE 1 = 1\r\n\tAND TRUNC(DATA, 'MM') >= TO_DATE('20230101', 'YYYYMMDD')\r\nGROUP BY  TRUNC(DATA, 'MM')\r\n\t\t, DIRETORIA\r\n\t\t, PACOTE\r\n\t\t, SUB_PACOTE","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-170.99150887234072,"y":-339.98621366726894},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"tmp_sql_opex","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"XQzoRj","type":"table","appId":137,"label":"tmp_sql_opex","client":"clickhouse","repoId":1,"shared":false,"position":{"x":9.005671195964169,"y":-340.98414571735924},"sourceId":7,"tableName":"tmp_sql_opex","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"Ebuzim","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_sql_opex","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"tmp_sql_opex","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"tmp_sql_opex","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137","targetColumn":"DSC_NVL_1"},{"dataType":"Nullable(String)","tableName":"tmp_sql_opex","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137","targetColumn":"DSC_NVL_2"},{"dataType":"Nullable(String)","tableName":"tmp_sql_opex","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137","targetColumn":"DSC_NVL_3"},{"dataType":"Nullable(Float64)","tableName":"tmp_sql_opex","columnName":"REAL_BASE","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL_BASE"},{"dataType":"Nullable(Float64)","tableName":"tmp_sql_opex","columnName":"ORCADO_BASE","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO_BASE"}]},"shared":false,"created":false,"position":{"x":10.007989806469029,"y":-237.98590034152505},"sourceId":7,"tableName":"tmp_sql_opex","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"aux_crg_base_bases_sem_segmento","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"hmfoRn","type":"table","appId":137,"label":"aux_crg_base_bases_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":10.50595318913372,"y":-84.99630275622214},"sourceId":7,"tableName":"aux_crg_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bIfEah","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"nBJvCZ","type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"YgHklI"},{"id":"YidRll","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"pkKRct"},{"id":"irSJYe","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"zclYUx","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"bfYcOn","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"UMpkqD","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"aetWrN","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"VSipCc","type":"value","andOr":"and","value":"toStartOfMonth(addMonths(today(),1))","dataType":"Nullable(DateTime)","operator":"<","fieldType":"value","tableName":"aux_crg_base_bases_sem_segmento","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CaqxuC","type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"YgHklI"},{"id":"XZdvBS","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"pkKRct"},{"id":"irSJYe","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"zclYUx","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"bfYcOn","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"UMpkqD","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"aetWrN","type":"value","dataType":"Nullable(String)","tableName":"aux_crg_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"},{"id":"Mykcdb","type":"computed","alias":"REAL","content":"SUM(\n\n\ncase \nwhen TIP_MTC = 'CAPEX Mensal' AND DATA_REF = toDate('2023-01-01') then ORCADO_BASE\nwhen TIP_MTC = 'CAPEX Mensal' AND DATA_REF = toDate('2023-02-01') then ORCADO_BASE\nwhen REAL_BASE is null then 0 \nelse REAL_BASE end\n\n\n\n)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"OYCyxq","columnLength":2},{"id":"xupcdh","type":"computed","alias":"ORCADO","content":"SUM(case \nwhen ORCADO_BASE is null then 0\nwhen ORCADO_BASE < 0.001 and ORCADO_BASE > -0.001 then 0\nelse ORCADO_BASE end)","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"RjtEcy","columnLength":14}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"SUM(case \nwhen ORCADO_BASE is null then 0\nwhen ORCADO_BASE < 0.001 and ORCADO_BASE > -0.001 then 0\nelse ORCADO_BASE end)","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"RjtEcy","columnLength":14},{"type":"computed","alias":"REAL","content":"SUM(\n\n\ncase \nwhen TIP_MTC = 'CAPEX Mensal' AND DATA_REF = toDate('2023-01-01') then ORCADO_BASE\nwhen TIP_MTC = 'CAPEX Mensal' AND DATA_REF = toDate('2023-02-01') then ORCADO_BASE\nwhen REAL_BASE is null then 0 \nelse REAL_BASE end\n\n\n\n)","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"OYCyxq","columnLength":2},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\nsubstring(toString(toYear(DATA_REF)), 3, 2)\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"pkKRct"},{"type":"computed","alias":"Mes_Ref","content":"case\nwhen toMonth(DATA_REF) > 9\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"YgHklI"}]},"created":false,"optimize":false,"position":{"x":182.0063291800263,"y":-85.99627142364774},"sourceId":7,"tableName":"aux_crg_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"aux_base_bases_sem_segmento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"rGGvJU","type":"table","appId":137,"label":"aux_base_bases_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":365.5059531891337,"y":-84.99630275622214},"sourceId":7,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"VHggVQ","source":"asxGRB","target":"pERfvE"},{"id":"RDBURH","source":"sneeAm","target":"hmfoRn"},{"id":"rBbkEf","source":"VqaGww","target":"vrTZeN"},{"id":"LhTgmI","source":"qCUtKr","target":"vwPWhK"},{"id":"McvYtT","type":"manual","label":"","source":"sneeAm","target":"vwPWhK"},{"id":"UKAfuL","source":"hmfoRn","target":"bIfEah"},{"id":"YFpbDv","source":"bIfEah","target":"rGGvJU"},{"id":"CXmLEg","source":"dpQsSn","target":"lgCkVH"},{"id":"yQmivL","source":"lgCkVH","target":"APrQCB"},{"id":"XbKuzg","source":"APrQCB","target":"odxcet"},{"id":"LJkQwK","source":"XQzoRj","target":"Ebuzim"},{"id":"qqAeMS","source":"Ebuzim","target":"hmfoRn"},{"id":"lsIomU","source":"lgCkVH","target":"asxGRB"},{"id":"NXkJoA","source":"vrTZeN","target":"EVlGkv"},{"id":"yRYFQY","source":"EVlGkv","target":"qCUtKr"},{"id":"IACoJC","source":"vwPWhK","target":"hmfoRn"},{"id":"dnkUdp","type":"manual","label":"","source":"vwPWhK","target":"Ebuzim"},{"id":"QYedCy","source":"VRWWgS","target":"XQzoRj"}]},"cron":"20 8 * * *","options":{"folder":"CARGAS","reload":0,"cronBase":{"every":3,"current":"20 8 * * *","dayValues":[],"hourValues":[8],"monthValues":[],"minuteValues":[20],"dayOfMonthValues":[]},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"dYKjevXylbqrgwCwvQsEXqZQZGpGocZx","flowDescription":"","locked":"no","created":"2023-08-14 09:03:36","updated":"2023-09-20 14:19:33"},{"flowId":"3888","appId":137,"flowName":"ETL - Base sem Segmento","workflow":{"nodes":[{"id":"lpeHnp","type":"table","appId":137,"label":"aux_base_bases_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":94.5,"y":381},"sourceId":7,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"zjCEpJ","type":"builder","appId":137,"label":"Diário","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"WjXlUB","type":"computed","alias":"Mes_Ref_Visual","order":"asc","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"id":"DMqQKy","type":"computed","alias":"Dia","order":"asc","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"Dia","computedId":"dDFnLp"},{"id":"lVJngL","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"INmVJB","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"IUusKh","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qVuhPn","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"id":"YghbRY","type":"computed","alias":"Dia","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"Dia","computedId":"dDFnLp"},{"id":"xIGyQr","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"MQUTvx","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"JJWyie","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"uZtgUN","type":"value","andOr":"and","value":"Mensal","dataType":"Nullable(String)","operator":"notLike","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"iofetD","type":"computed","alias":"Mes_Ref","andOr":"and","value":"prm_filtro_mes_base_sem_segmento","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","operator":"in","fieldType":"computed","valueType":"parameter","columnName":"Mes_Ref","computedId":"vHsCGo","extraValue":[]},{"id":"KJKIKS","type":"value","andOr":"and","value":"prm_tip_mtc_sem_segmento","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"parameter","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QgzILh","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"id":"pMzAZA","type":"computed","alias":"Dia","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","distinct":false,"columnName":"Dia","computedId":"dDFnLp"},{"id":"xIGyQr","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"MQUTvx","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"JJWyie","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"},{"id":"bbQknR","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"aux_base_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Dia","content":"toDayOfMonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"Dia","computedId":"dDFnLp"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"vHsCGo"}]},"created":false,"optimize":false,"position":{"x":261.5,"y":555},"sourceId":7,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_bases_sem_segmento_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"HgkxgB","type":"table","appId":137,"label":"tmp_aux_bases_sem_segmento_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":437,"y":555},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EAMsUJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"jDmZvR","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"oSzTiA","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"xZuBGB","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Dia","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"HyTGSX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"AtwcMr","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"abdBSk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Dia","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CiNRnQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"lPNktS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"IIsvpk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Dia","columnLength":null,"databaseName":"bucket_137"},{"id":"HNCDuK","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"xCfThb","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY DSC_NVL_1 ORDER BY Dia ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"GgXfXp","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY DSC_NVL_1 ORDER BY Dia ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"GgXfXp","columnLength":2}]},"created":false,"optimize":false,"position":{"x":646.002129503165,"y":622.0006608802926},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento_dia","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_2_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"nuiCnv","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_2_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":811.2994803976266,"y":618.5710574268761},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_2_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VkjTbD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"FJcCGT","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Dia","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"GtjwzS","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Dia","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fWnndl","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"Dia","columnLength":null,"databaseName":"bucket_137"},{"id":"AHJViC","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento_dia","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"lWKByL","type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY Dia ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_ACU","computedId":"ikDHgs","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_ACU","content":"sum(REAL) OVER\r\n       (PARTITION BY 1 ORDER BY Dia ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"REAL_ACU","computedId":"ikDHgs","columnLength":2}]},"created":false,"optimize":false,"position":{"x":649.9989660250451,"y":498.99993733485127},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento_dia","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_1_dia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"LhMuwq","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_1_dia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":803.5,"y":497},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_1_dia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"oyATkB","type":"builder","appId":137,"label":"Mensal","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"UDaCNT","type":"computed","alias":"Mes_Ref","order":"asc","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"dDFnLp"},{"id":"dFExSW","type":"computed","alias":"Mes_Ref_Visual","order":"asc","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"id":"lVVjrr","type":"value","order":"asc","dataType":"Nullable(DateTime)","tableName":"aux_base_bases_sem_segmento","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"pYlecA","type":"computed","alias":"DSC_NVL_ORDEM","order":"asc","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","columnName":"DSC_NVL_ORDEM","computedId":"QNjjVu"},{"id":"AOfGxk","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"RzAcEW","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"TDctsP","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"JdSbuG","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"dDFnLp"},{"id":"CckVmB","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"id":"OgCWDN","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_base_bases_sem_segmento","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"VmlWpz","type":"computed","alias":"DSC_NVL_ORDEM","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_NVL_ORDEM","computedId":"QNjjVu"},{"id":"xIGyQr","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"MQUTvx","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"JJWyie","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"tVfnSE","type":"value","andOr":"and","value":"Mensal","dataType":"Nullable(String)","operator":"like","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"OuQlpV","type":"value","andOr":"and","value":"prm_tip_mtc_sem_segmento","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"parameter","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"pMzAZA","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"dDFnLp"},{"id":"SqEUWS","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"id":"OgCWDN","type":"value","dataType":"Nullable(DateTime)","tableName":"aux_base_bases_sem_segmento","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"YHoxXM","type":"computed","alias":"DSC_NVL_ORDEM","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_NVL_ORDEM","computedId":"QNjjVu"},{"id":"xIGyQr","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"MQUTvx","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"JJWyie","type":"value","dataType":"Nullable(String)","tableName":"aux_base_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"},{"id":"bbQknR","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"aux_base_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"zZhUXz","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"aux_base_bases_sem_segmento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"dDFnLp"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"DpzNEg"},{"type":"computed","alias":"DSC_NVL_ORDEM","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","columnName":"DSC_NVL_ORDEM","computedId":"QNjjVu"}]},"created":false,"optimize":false,"position":{"x":261.5,"y":207},"sourceId":7,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_bases_sem_segmento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"TYPtMd","type":"table","appId":137,"label":"tmp_aux_bases_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":437,"y":207},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EcTNXc","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"yGfuMA","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"xIleFj","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"WUOHEX","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"xXAssm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"QGuCZq","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"ItdIOI","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":611.0001879954464,"y":-70.99674141226353},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_1","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"xTIUor","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_1","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":797.5001879954464,"y":-70.99674141226353},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_1","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"AIfWbS","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"HhHMmT","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"QHnwcx","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"Tmslou","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"FVhDQs","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"lHVKvS","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"AGjRYj","type":"value","andOr":"and","value":"prm_filtro_mes_base_sem_segmento_mensal","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_bases_sem_segmento","valueType":"parameter","columnName":"Mes_Ref","extraValue":[],"columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"fwoHzJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"ChvHpV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"psNpfZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"acQmTM","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"DsgSPC","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":611.0001879954464,"y":161.00325858773647},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_3","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"JAPwKM","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_3","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":797.5001879954464,"y":161.00325858773647},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_3","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"yOnODV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"ZuOuou","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_sem_segmento_nivel_3","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"yGygny","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_sem_segmento_nivel_3","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"RvVRBx","type":"computed","alias":"Categoria","content":"'Total'","dataType":"Nullable(String)","distinct":false,"columnName":"Categoria","computedId":"uRkprf"},{"id":"ppMSbn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UxNInK","type":"computed","alias":"Categoria","content":"'Total'","dataType":"Nullable(String)","distinct":false,"columnName":"Categoria","computedId":"uRkprf"},{"id":"SUnatE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"IvOIZS","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"cyQBnH","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Categoria","content":"'Total'","dataType":"Nullable(String)","columnName":"Categoria","computedId":"uRkprf"}]},"created":false,"optimize":false,"position":{"x":940.7602919965598,"y":162.88017236419444},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_3_total","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XHPhrH","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_3_total","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1099.8011675535593,"y":161.89387414195164},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_3_total","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"yMiXZV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"qLzlkZ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"ZbTRWf","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"RvCKEJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"cDSPBT","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"FVhDQs","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"BGPmgs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"cQDKKa","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"AGjRYj","type":"value","andOr":"and","value":"prm_filtro_mes_base_sem_segmento_mensal","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_aux_bases_sem_segmento","valueType":"parameter","columnName":"Mes_Ref","extraValue":[],"columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"pXHMhD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"ChvHpV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"BGPmgs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_2","columnLength":2,"databaseName":"bucket_137"},{"id":"cQDKKa","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_3","columnLength":2,"databaseName":"bucket_137"},{"id":"acQmTM","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"DsgSPC","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":616.9971800683052,"y":269.0026946013975},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_3_2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"lhBPLY","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_3_2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":800.9942348063125,"y":268.0027259339719},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_3_2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"amIPZV","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"mKnEHV","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_base_sem_segmento_nivel_3_2","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"zOcDFf","type":"value","dataType":"Nullable(String)","tableName":"tmp_base_sem_segmento_nivel_3_2","columnName":"DSC_NVL_ORDEM","columnLength":null,"databaseName":"bucket_137"},{"id":"RvVRBx","type":"computed","alias":"Categoria","content":"'Total'","dataType":"Nullable(String)","distinct":false,"columnName":"Categoria","computedId":"uRkprf"},{"id":"ppMSbn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3_2","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"UxNInK","type":"computed","alias":"Categoria","content":"'Total'","dataType":"Nullable(String)","distinct":false,"columnName":"Categoria","computedId":"uRkprf"},{"id":"SUnatE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3_2","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"IvOIZS","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3_2","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"cyQBnH","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_base_sem_segmento_nivel_3_2","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Categoria","content":"'Total'","dataType":"Nullable(String)","columnName":"Categoria","computedId":"uRkprf"}]},"created":false,"optimize":false,"position":{"x":936.4986526993016,"y":266.87973370815297},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_3_2","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_3_2_total","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"JwQeIQ","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_3_2_total","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1109.4960520956272,"y":268.8796710430042},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_3_2_total","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LTikpv","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"eXIKXN","type":"computed","alias":"DSC_NVL_1_ORDEM","order":"asc","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","columnName":"DSC_NVL_1_ORDEM","computedId":"zGAaiY"},{"id":"xKTggg","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"rrxGEp","type":"computed","alias":"DSC_NVL_1_ORDEM","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","columnName":"DSC_NVL_1_ORDEM","computedId":"zGAaiY"},{"id":"MZrUHZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"pPOvZP","type":"value","andOr":"and","value":"","dataType":"Nullable(String)","operator":"isNotNull","fieldType":"value","tableName":"tmp_aux_bases_sem_segmento","valueType":"value","columnName":"DSC_NVL_1","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"xpfSRz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DSC_NVL_1_ORDEM","content":"CASE\r\n    WHEN DSC_NVL_1 = 'B2B' THEN '01 - B2B'\r\n    WHEN DSC_NVL_1 = 'B2C' THEN '02 - B2C'\r\n    WHEN DSC_NVL_1 = 'IOT' THEN '03 - IOT'\r\n    WHEN DSC_NVL_1 = 'INFRACO' THEN '04 - INFRACO'\r\n    WHEN DSC_NVL_1 = 'REDES COMPARTILHADAS' THEN '05 - REDES COMPARTILHADAS'\r\n    WHEN DSC_NVL_1 = 'MANUTENCAO DA OPERACAO' THEN '06 - MANUTENCAO DA OPERACAO'\r\n    WHEN DSC_NVL_1 = 'ESTRUTURANTE' THEN '07 - ESTRUTURANTE'\r\n    WHEN DSC_NVL_1 = 'REQUISITO LEGAL' THEN '08 - REQUISITO LEGAL'\r\n    WHEN DSC_NVL_1 = 'IMPULSO' THEN '09 - IMPULSO'\r\n    WHEN DSC_NVL_1 = 'ESTOQUE' THEN '10 - ESTOQUE'\r\n    ELSE DSC_NVL_1\r\nEND","dataType":"Nullable(String)","columnName":"DSC_NVL_1_ORDEM","computedId":"zGAaiY"}]},"created":false,"optimize":false,"position":{"x":617,"y":381},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_nivel_1","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XTQewf","type":"table","appId":137,"label":"tmp_nivel_1","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":803.5,"y":381},"sourceId":7,"tableName":"tmp_nivel_1","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"huAdmy","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"IJrvrw","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"group":[{"id":"vWEtkK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"MmRgvX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"MOJdtB","type":"value","dataType":"Nullable(String)","tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"hVGriu","type":"value","andOr":"and","value":"","dataType":"Nullable(String)","operator":"isNotNull","fieldType":"value","tableName":"tmp_aux_bases_sem_segmento","valueType":"value","columnName":"DSC_NVL_1","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"YxMqmn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"MmRgvX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"DSC_NVL_1","columnLength":2,"databaseName":"bucket_137"},{"id":"Pkbyjh","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"ByRbkb","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_bases_sem_segmento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":611.0001879954464,"y":45.00325858773647},"sourceId":7,"tableName":"tmp_aux_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_base_sem_segmento_nivel_2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"chuZDr","type":"table","appId":137,"label":"tmp_base_sem_segmento_nivel_2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":801.5000626651488,"y":42.00335258545962},"sourceId":7,"tableName":"tmp_base_sem_segmento_nivel_2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"lSIRvE","type":"table","appId":137,"label":"parametros_portal_analytics_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-105.7610904203943,"y":764.6943028465216},"tableName":"parametros_portal_analytics_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NpppDI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"parametros_portal_analytics_sem_segmento","id":"eSdGZE","to":"aux_base_bases_sem_segmento","raw":"","list":[{"id":"AIJGZn","andOr":"and","tableBy":"parametros_portal_analytics_sem_segmento","tableTo":"aux_base_bases_sem_segmento","columnBy":"indicador_selecionado","columnTo":"TIP_MTC","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"lSoMfj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"indicador_selecionado","columnLength":null,"databaseName":"bucket_137"},{"id":"oENfOR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"indicador_pai","columnLength":null,"databaseName":"bucket_137"},{"id":"ZmSdFt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"escala_valor","columnLength":null,"databaseName":"bucket_137"},{"id":"NKDWSS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"escala_texto","columnLength":null,"databaseName":"bucket_137"},{"id":"sphgfJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"escala_decimal","columnLength":null,"databaseName":"bucket_137"},{"id":"ZQRnFy","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"botao_um","columnLength":null,"databaseName":"bucket_137"},{"id":"apfAIn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"botao_dois","columnLength":null,"databaseName":"bucket_137"},{"id":"hidNHK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"nvl_um","columnLength":null,"databaseName":"bucket_137"},{"id":"mDZgkQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"nvl_dois","columnLength":null,"databaseName":"bucket_137"},{"id":"CvFyIK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"nvl_tres","columnLength":null,"databaseName":"bucket_137"},{"id":"scTRsU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"hrq1","columnLength":null,"databaseName":"bucket_137"},{"id":"ENsBiB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"hrq2","columnLength":null,"databaseName":"bucket_137"},{"id":"cJzMvv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"hrq3","columnLength":null,"databaseName":"bucket_137"},{"id":"HDRbHU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"botao3","columnLength":null,"databaseName":"bucket_137"}],"limit":1,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"IIHKUG","type":"value","andOr":"and","value":"prm_tip_mtc_sem_segmento","dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"aux_base_bases_sem_segmento","valueType":"parameter","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"offset":null,"select":[{"id":"lSoMfj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"indicador_selecionado","columnLength":null,"databaseName":"bucket_137"},{"id":"oENfOR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"indicador_pai","columnLength":null,"databaseName":"bucket_137"},{"id":"scTRsU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"hrq1","columnLength":null,"databaseName":"bucket_137"},{"id":"ENsBiB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"hrq2","columnLength":null,"databaseName":"bucket_137"},{"id":"cJzMvv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"hrq3","columnLength":null,"databaseName":"bucket_137"},{"id":"EmRNoa","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"escala_valor","columnLength":null,"databaseName":"bucket_137"},{"id":"NKDWSS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"escala_texto","columnLength":null,"databaseName":"bucket_137"},{"id":"sphgfJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"escala_decimal","columnLength":null,"databaseName":"bucket_137"},{"id":"ZQRnFy","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"botao_um","columnLength":null,"databaseName":"bucket_137"},{"id":"apfAIn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"botao_dois","columnLength":null,"databaseName":"bucket_137"},{"id":"hidNHK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"nvl_um","columnLength":null,"databaseName":"bucket_137"},{"id":"mDZgkQ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"nvl_dois","columnLength":null,"databaseName":"bucket_137"},{"id":"CvFyIK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"nvl_tres","columnLength":null,"databaseName":"bucket_137"},{"id":"HDRbHU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_portal_analytics_sem_segmento","columnName":"botao3","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":103.74715902534469,"y":762.3523527620181},"tableName":"parametros_portal_analytics_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_parametros_portal_analytics_sem_segmento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"IrIxby","type":"table","appId":137,"label":"tmp_parametros_portal_analytics_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":398.6184437894687,"y":759.5069182514054},"tableName":"tmp_parametros_portal_analytics_sem_segmento","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EMDIFD","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":687.6466733981011,"y":756.8855798230132},"tableName":"tmp_parametros_portal_analytics_sem_segmento","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_indicador_sem_segmento","columnName":"indicador_selecionado"},{"paramName":"prm_indicador_pai_sem_segmento","columnName":"indicador_pai"},{"paramName":"prm_hrq1_sem_segmento","columnName":"hrq1"},{"paramName":"prm_hrq2_sem_segmento","columnName":"hrq2"},{"paramName":"prm_hrq3_sem_segmento","columnName":"hrq3"},{"paramName":"prm_escala_valor_sem_segmento","columnName":"escala_valor"},{"paramName":"prm_escala_texto_sem_segmento","columnName":"escala_texto"},{"paramName":"prm_escala_decimais_sem_segmento","columnName":"escala_decimal"},{"paramName":"prm_nome_botao1_sem_segmento","columnName":"botao_um"},{"paramName":"prm_nome_botao2_sem_segmento","columnName":"botao_dois"},{"paramName":"prm_nivel1_sem_segmento","columnName":"nvl_um"},{"paramName":"prm_nivel2_sem_segmento","columnName":"nvl_dois"},{"paramName":"prm_nivel3_sem_segmento","columnName":"nvl_tres"},{"paramName":"prm_nome_botao3_sem_segmento","columnName":"botao3"}]}],"edges":[{"id":"xlRQaG","source":"TYPtMd","target":"EcTNXc"},{"id":"RssZxL","source":"EcTNXc","target":"xTIUor"},{"id":"imKofM","source":"HgkxgB","target":"EAMsUJ"},{"id":"oKgevw","source":"EAMsUJ","target":"nuiCnv"},{"id":"pvJcJi","source":"lpeHnp","target":"zjCEpJ"},{"id":"gJpqRG","source":"zjCEpJ","target":"HgkxgB"},{"id":"UhFVOA","source":"HgkxgB","target":"VkjTbD"},{"id":"JZTmTz","source":"VkjTbD","target":"LhMuwq"},{"id":"wRNBFr","source":"TYPtMd","target":"AIfWbS"},{"id":"XSzJfO","source":"AIfWbS","target":"JAPwKM"},{"id":"iXSngz","source":"TYPtMd","target":"yMiXZV"},{"id":"aVSaZN","source":"yMiXZV","target":"lhBPLY"},{"id":"NKfTHv","source":"lhBPLY","target":"amIPZV"},{"id":"AzMcWU","source":"amIPZV","target":"JwQeIQ"},{"id":"uHIzJd","source":"JAPwKM","target":"yOnODV"},{"id":"ZwFWZy","source":"yOnODV","target":"XHPhrH"},{"id":"SUAQnj","source":"TYPtMd","target":"LTikpv"},{"id":"BPcHPD","source":"LTikpv","target":"XTQewf"},{"id":"iUkNnT","source":"lSIRvE","target":"NpppDI"},{"id":"wUTDVU","source":"lpeHnp","target":"NpppDI"},{"id":"BppKTd","source":"NpppDI","target":"IrIxby"},{"id":"WbhjGs","source":"IrIxby","target":"EMDIFD"},{"id":"dkHhrR","source":"lpeHnp","target":"oyATkB"},{"id":"JHSUfO","source":"oyATkB","target":"TYPtMd"},{"id":"KdSoke","source":"TYPtMd","target":"huAdmy"},{"id":"zJtyGe","source":"huAdmy","target":"chuZDr"}]},"cron":null,"options":{"folder":"PORTAL - INDICADORES","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"IGJysxyvlwsRNdWpxatgJXkuswhNVZHF","flowDescription":"","locked":null,"created":"2023-08-14 09:11:35","updated":"2023-09-20 14:24:08"},{"flowId":"cRlqgE","appId":137,"flowName":"Dup. FLUXO real x orçado (fechamento)","workflow":{"nodes":[{"id":"ufbBFB","type":"table","appId":137,"label":"envio_preparado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2114,"y":194},"sourceId":null,"tableName":"envio_preparado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SYzQyT","type":"table","appId":137,"label":"analy_disparo_tic_iot_fechamento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":87.9683746050494,"y":-70.00709714674718},"tableName":"analy_disparo_tic_iot_fechamento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sEQoRn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QiSBup","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"metrica","columnLength":null,"databaseName":"bucket_137"},{"id":"aNVIme","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"hdRRcB","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"xTRZDW","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"analy_disparo_tic_iot_fechamento","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"qshwvi"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","columnName":"DATA_REF","computedId":"iWYrna"},{"type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"qnOpbK"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jYggoS"}]},"created":false,"optimize":false,"position":{"x":265,"y":68},"sourceId":null,"tableName":"analy_disparo_tic_iot_fechamento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"TIC_ANALY_AUX","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WvsCVc","type":"table","appId":137,"label":"TIC_ANALY_AUX","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":657.9925428472955,"y":-21.997180068305028},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NYElQD","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"metrica","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":682.9958641001806,"y":75.00115930525237},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"ysUINE","type":"group","label":"Parallel","created":false,"position":{"x":265,"y":148}},{"id":"FMbcyi","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":446},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":330},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rBtgRI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"rVTZKe","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"Tqywwc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"NaKfBI","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"QhJqUi","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"VDNaMT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"flfZhL","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"jpOUjw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gFehbn","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BJGcRN","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"gymQoD","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-3))","dataType":"Nullable(DateTime)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebqPuN","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zxtcQs","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"kIXayp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"WYGlTN","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"AADvRI","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QhBDxG","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"hesRBK","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jxOlCh"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}]},"created":false,"optimize":false,"position":{"x":895,"y":388},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"jgaznh","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"metrica","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"}]},"shared":false,"created":false,"position":{"x":1055,"y":286},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"RlloqT","type":"table","appId":137,"label":"tmp_alerta_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1209.5,"y":364},"sourceId":null,"tableName":"tmp_alerta_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YuYuwK","type":"group","label":"Parallel","created":false,"position":{"x":895,"y":289.5}},{"id":"RRoyis","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1209.5,"y":241},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fdKOxs","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":81.5,"y":68},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LnBEJC","type":"delete","appId":137,"label":"Delete","client":"clickhouse","parent":"ysUINE","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"DpqzqP","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"=","tableName":"forecast_insight","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":265,"y":207},"sourceId":null,"tableName":"forecast_insight","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"vNMXcv","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":711,"y":170},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BbkjnJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AOLjea","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"UQwPFw"},{"id":"YkXRWa","type":"value","alias":"sgm","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QgrZoa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"UQwPFw"}]},"created":false,"optimize":false,"position":{"x":895,"y":170},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BQRWpp","type":"table","appId":137,"label":"tmp_forecast_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1055,"y":133},"sourceId":null,"tableName":"tmp_forecast_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_alerta_aux","id":"thRAEV","to":"tmp_forecast_alerta","raw":"","list":[{"id":"PAjsVb","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"lWkUve","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"SEGMENTO","columnTo":"sgm","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_alerta_aux","id":"iHPXzk","to":"teste_mail","raw":"","list":[{"id":"aqWATR","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"SEGMENTO","columnTo":"visao","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SHQxUQ","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qMXQWm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CPlPjP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Gtaiff","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"wdPKUm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SjNjTc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rxeDEX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"GGtaWk","type":"value","andOr":"and","value":"1","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"ativo","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MWBkFX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CdkxNl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"llTcdN","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"kFSItW","type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","distinct":false,"columnName":"teste","computedId":"gAYpmL"},{"id":"WObqMW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"tOvMBM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rmluuw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"mensagem","content":"concat(\n\nconcat(concat(concat('Olá ' ,  max(nome)), ', espero que esteja tudo bem!\\n'),\n\n\n' Segue resumo dos indicadores d-1 dos segmentos')\n,\ntoString(sum(REAL) over (partition by email))\n\n\n)","dataType":"Nullable(String)","columnName":"mensagem","computedId":"CrdTAV"},{"type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","columnName":"teste","computedId":"gAYpmL"},{"type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"PBipBh"}]},"created":false,"position":{"x":1338.5,"y":262},"sourceId":null,"tableName":"tmp_alerta_aux","sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"fpjomb","type":"group","label":"Parallel","created":false,"position":{"x":1955,"y":276.5}},{"id":"tbILex","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","parent":"fpjomb","repoId":1,"schema":{"join":[],"sort":[{"id":"ekmNON","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"fxkzhn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"moralI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"gCNWfH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HQkQmv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"xaduop","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"VKXQId","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"TaDxZh","type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"id":"XuPLsY","type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_vnd","computedId":"SWihKb"},{"id":"EbDuNz","type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"id":"SrThPF","type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ope_vnd","computedId":"sbovSd"},{"id":"brygbH","type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_vnd","computedId":"uUVxiO"},{"id":"BrUIbf","type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}],"update":[],"computed":[{"type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_vnd","computedId":"SWihKb"},{"type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ope_vnd","computedId":"sbovSd"},{"type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_vnd","computedId":"uUVxiO"},{"type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}]},"created":false,"optimize":false,"position":{"x":1955,"y":194},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"envio_preparado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"cGryqE","type":"table","appId":137,"label":"tmp_aux_prepara_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1506,"y":262},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bsYYiW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"MnoewF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"heXpKp","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_aux_prepara_sgm_alerta","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"oOaOFx","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"kxREQG","type":"sum","alias":"ORCADO_TRATADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"oefYrH","type":"sum","alias":"FORECAST_VENDA","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"oEcCxS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_prepara_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1668,"y":305.1527830343917},"sourceId":null,"tableName":"tmp_aux_prepara_sgm_alerta","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"tmp_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":[]},{"id":"Notrgp","type":"table","appId":137,"label":"tmp_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1801.499812004554,"y":254.0011906378268},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYcLht","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","parent":"fpjomb","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"nome","columnLength":2,"databaseName":"bucket_137","targetColumn":"nome"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"email","columnLength":2,"databaseName":"bucket_137","targetColumn":"email"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_consolidado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137","targetColumn":"flag_de_acesso"}]},"shared":false,"created":false,"position":{"x":1955,"y":326},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_prepara_sgm_alerta","databaseName":"bucket_137","resultDatabase":"bucket_137"}],"edges":[{"id":"KMMNNV","source":"WvsCVc","target":"jgaznh"},{"id":"Bkiddn","source":"BQRWpp","target":"kSIbMZ"},{"id":"oRAwbn","source":"RRoyis","target":"kSIbMZ"},{"id":"GiSwqZ","source":"kSIbMZ","target":"cGryqE"},{"id":"fXBBiD","source":"bsYYiW","target":"Notrgp"},{"id":"wozwKI","source":"cGryqE","target":"bsYYiW"},{"id":"jNsdaS","source":"DYcLht","target":"cGryqE"},{"id":"HvmKmO","source":"BbkjnJ","target":"BQRWpp"},{"id":"IZZMsh","source":"vNMXcv","target":"BbkjnJ"},{"id":"OaLsSz","source":"WvsCVc","target":"NYElQD"},{"id":"EBYyep","source":"RlloqT","target":"kSIbMZ"},{"id":"uKbXYa","source":"Notrgp","target":"DYcLht"},{"id":"wDVTXb","type":"manual","label":"","source":"rBtgRI","target":"jgaznh"},{"id":"VXHsiO","source":"LnBEJC","target":"vNMXcv"},{"id":"ddqsss","source":"FMbcyi","target":"rBtgRI"},{"id":"BWjlEH","source":"ustfRF","target":"rBtgRI"},{"id":"EBtRks","source":"rBtgRI","target":"RlloqT"},{"id":"EPvlWx","source":"SYzQyT","target":"sEQoRn"},{"id":"CZkNUi","source":"sEQoRn","target":"WvsCVc"},{"id":"cwKpHI","source":"NYElQD","target":"vNMXcv"},{"id":"HDNnGQ","source":"jgaznh","target":"RlloqT"},{"id":"GPxftR","source":"cGryqE","target":"tbILex"},{"id":"vQtABR","source":"tbILex","target":"ufbBFB"}]},"cron":null,"options":{"folder":"ANALY FECHAMENTO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"app:137:YCFyHmhjmyLZlkurCqyRrwUKMePRCtiK","flowDescription":"","locked":null,"created":"2023-09-02 08:23:44","updated":"2023-09-08 09:08:23"},{"flowId":"3189","appId":137,"flowName":"PrevisaoMPE","workflow":{"nodes":[{"id":"awFTRN","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-32.98756096796767,"y":-458.9812317879412},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RnyLVB","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"gtYHNe","type":"value","alias":"DATA","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"jwqefP","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"Mqwbeq","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"VAUCJw","type":"value","andOr":"and","value":"2023-07-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"2023-05-31 23:00:00","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"WwewLk","type":"sum","alias":"VENDA","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":238.00676783606792,"y":-460.9803858084326},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_modelo_mpe_venda_forecast_v3","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GxPjTA","type":"table","appId":137,"label":"tmp_teste_modelo_mpe_venda_forecast_v3","client":"clickhouse","repoId":1,"shared":false,"position":{"x":489.0017232915913,"y":-459.98041714100685},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v3","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ojmBMK","type":"scoring","appId":137,"label":"Score: tmp_teste_modelo_mpe_venda_forecast_v3","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":170,"position":{"x":489.00172329159136,"y":-226.98771763083943},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v3","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_tmp_teste_modelo_mpe_venda_forecast_v3","databaseName":"bucket_137"},{"id":"btGmbT","type":"table","appId":137,"label":"score_tmp_teste_modelo_mpe_venda_forecast_v3","client":"clickhouse","repoId":1,"created":false,"position":{"x":758.9762185760391,"y":-222.9930128359113},"tableName":"score_tmp_teste_modelo_mpe_venda_forecast_v3","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rdHMjy","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\nDIA_UTIL AS (\r\n\r\nselect TAB.DATA,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'DD') AS DATA,\r\n             DSC_DIA_SMN_ABV\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n        and TRUNC(A.dat_dia, 'MM') >= TO_DATE('20230101','YYYYMMDD')\r\n        and TRUNC(A.dat_dia, 'MM') <= SYSDATE\r\n      GROUP BY TRUNC(DAT_DIA,'DD'), DSC_DIA_SMN_ABV) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'DD') = tab.DATA\r\n  AND a.dsc_frd like 'DIA %TIL'\r\nGROUP BY TAB.DATA\r\nORDER BY TAB.DATA\r\n),\r\n\r\nMENSAL AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'MM') AS DATA\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230430','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'MM')\r\n),\r\n\r\nDIARIO AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'DD') AS DATA\r\n\t\t, DSC_LNH_NGC AS PRODUTO\r\n\t\t, DSC_REG_ITL AS REGIONAL\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230430','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\nORDER BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\n)\r\n\r\nSELECT D.DATA\r\n, EXTRACT(DAY FROM D.DATA) AS DIA\r\n, EXTRACT(MONTH FROM D.DATA) AS MES\r\n, D.PRODUTO\r\n, D.REGIONAL\r\n, MAX(D.VENDA) AS VENDA\r\n, SUM(SUM(D.VENDA)) over(PARTITION BY  EXTRACT(MONTH FROM D.DATA) order BY D.DATA rows between unbounded preceding and current ROW) AS VENDA_ACU\r\n, MAX(M.VENDA) AS FINAL\r\n, MAX(DU.QTD) AS DIA_UTIL\r\nFROM DIARIO D\r\nINNER JOIN MENSAL M\r\n\tON (TRUNC(D.DATA, 'MM') = M.DATA)\r\nINNER JOIN DIA_UTIL DU \r\n\tON (D.DATA = DU.DATA)\r\nGROUP BY D.DATA\r\n, EXTRACT(DAY FROM D.DATA)\r\n, EXTRACT(MONTH FROM D.DATA)\r\n, D.PRODUTO\r\n, D.REGIONAL\r\n, D.VENDA","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-99.99686674256117,"y":0.9999686674256054},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"base_aux_previsao_mpe","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"SdwPfE","type":"table","appId":137,"label":"base_aux_previsao_mpe","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":90,"y":0},"sourceId":7,"tableName":"base_aux_previsao_mpe","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wjyhEh","type":"automl","appId":137,"label":"base_aux_previsao_mpe","client":"clickhouse","repoId":1,"created":false,"position":{"x":260.9974620614745,"y":-1.9999373348512677},"settings":{"seed":7,"maxModels":999,"projectId":"wjyhEh","splitFrame":0.7,"projectName":"project_wjyhEh","reloadSource":true,"removeColumns":[],"trainingFrame":"base_aux_previsao_mpe","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"base_aux_previsao_mpe","sourceType":"bucket","databaseName":"bucket_137"},{"id":"aOrOkH","type":"automlReport","appId":137,"label":"base_aux_previsao_mpe","client":"clickhouse","repoId":1,"created":false,"position":{"x":437.9947361275029,"y":-0.9999686674255486},"settings":{"seed":7,"maxModels":999,"projectId":"wjyhEh","splitFrame":0.7,"projectName":"project_wjyhEh","reloadSource":true,"removeColumns":[],"trainingFrame":"base_aux_previsao_mpe","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"base_aux_previsao_mpe","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"jGVzpG","source":"SdwPfE","target":"wjyhEh"},{"id":"NoVrdW","source":"wjyhEh","target":"aOrOkH"},{"id":"MLUaOk","source":"GxPjTA","target":"ojmBMK"},{"id":"cIzXHO","source":"ojmBMK","target":"btGmbT"},{"id":"mVSgJb","source":"rdHMjy","target":"SdwPfE"},{"id":"DuNLua","source":"awFTRN","target":"RnyLVB"},{"id":"AsdHsu","source":"RnyLVB","target":"GxPjTA"}]},"cron":null,"options":{"reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":99,"flowStart":1,"flowType":"dataPrep","flowKey":"KUmarZClLFoCCHiLgzwyQvBytIPOhptm","flowDescription":"","locked":null,"created":"2023-06-22 17:37:38","updated":"2023-09-08 09:08:23"},{"flowId":"2881","appId":137,"flowName":"Carga_Base_Perfomance","workflow":{"nodes":[{"id":"SUBVQH","type":"fileImport","appId":137,"label":"performance_segmento_agosto_23.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"tOOavG","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes","alternativeName":"mes"},{"id":"VDxgKh","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"concatenado","alternativeName":"concatenado"},{"id":"tMZYhW","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"referencia","alternativeName":"referencia"},{"id":"mxbMPB","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu","alternativeName":"bu"},{"id":"cQByDb","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i_obz","alternativeName":"d_i_obz"},{"id":"TZsybz","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produtos_geral","alternativeName":"produtos_geral"},{"id":"opOECl","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"f_v","alternativeName":"f_v"},{"id":"SltdCN","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i","alternativeName":"d_i"},{"id":"pTRjiP","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"depre","alternativeName":"depre"},{"id":"UBjlqU","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"operacao_direta_franquias","alternativeName":"operacao_direta_franquias"},{"id":"ULpOCB","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"versao","alternativeName":"versao"},{"id":"ozHIaT","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"nom_sgm_dtl","alternativeName":"nom_sgm_dtl"},{"id":"NixzYA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ett_mod","alternativeName":"dsc_cnt_ett_mod"},{"id":"DilcfG","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_tip_cr","alternativeName":"dsc_tip_cr"},{"id":"FXsCDg","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produto","alternativeName":"produto"},{"id":"PBLfML","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"cod_cnt_ebit","alternativeName":"cod_cnt_ebit"},{"id":"GJhZBK","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ebit","alternativeName":"dsc_cnt_ebit"},{"id":"skJIKR","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_reg","alternativeName":"dsc_reg"},{"id":"WQXWgP","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"valor","columnLength":14,"alternativeName":"valor"}],"created":false,"fileName":"performance_segmento_agosto_23.csv","position":{"x":114.0058591914106,"y":374.00617251715454},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"PerformanceAgosto","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"fiHGKK","type":"table","appId":137,"label":"PerformanceAgosto","client":"clickhouse","repoId":1,"created":false,"position":{"x":318.0015352961453,"y":352.0086477905313},"tableName":"PerformanceAgosto","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LoTFbP","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"PerformanceAgosto","columnName":"mes","columnLength":null,"databaseName":"bucket_137","targetColumn":"mes"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"concatenado","columnLength":null,"databaseName":"bucket_137","targetColumn":"concatenado"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"referencia","columnLength":null,"databaseName":"bucket_137","targetColumn":"referencia"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"bu","columnLength":null,"databaseName":"bucket_137","targetColumn":"bu"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"d_i_obz","columnLength":null,"databaseName":"bucket_137","targetColumn":"d_i_obz"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"produtos_geral","columnLength":null,"databaseName":"bucket_137","targetColumn":"produtos_geral"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"f_v","columnLength":null,"databaseName":"bucket_137","targetColumn":"f_v"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"d_i","columnLength":null,"databaseName":"bucket_137","targetColumn":"d_i"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"depre","columnLength":null,"databaseName":"bucket_137","targetColumn":"depre"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"operacao_direta_franquias","columnLength":null,"databaseName":"bucket_137","targetColumn":"operacao_direta_franquias"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"versao","columnLength":null,"databaseName":"bucket_137","targetColumn":"versao"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"nom_sgm_dtl","columnLength":null,"databaseName":"bucket_137","targetColumn":"nom_sgm_dtl"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"dsc_cnt_ett_mod","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_cnt_ett_mod"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"dsc_tip_cr","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_tip_cr"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"produto","columnLength":null,"databaseName":"bucket_137","targetColumn":"produto"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"cod_cnt_ebit","columnLength":null,"databaseName":"bucket_137","targetColumn":"cod_cnt_ebit"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"dsc_cnt_ebit","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_cnt_ebit"},{"dataType":"Nullable(String)","tableName":"PerformanceAgosto","columnName":"dsc_reg","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_reg"},{"dataType":"Nullable(Float64)","tableName":"PerformanceAgosto","columnName":"valor","columnLength":14,"databaseName":"bucket_137","targetColumn":"valor"}]},"created":false,"position":{"x":433.0009086446576,"y":341.00855379280813},"tableName":"PerformanceAgosto","temporary":false,"sourceType":"bucket","resultTable":"Perfomance_Segmento","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"DPFWRJ","type":"fileImport","appId":137,"label":"perfomance_segmento_maio_23.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"PlRYjE","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes","alternativeName":"mes"},{"id":"OcbJyn","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"concatenado","alternativeName":"concatenado"},{"id":"MetPpM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"referencia","alternativeName":"referencia"},{"id":"ZRtkUZ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu","alternativeName":"bu"},{"id":"JIRpku","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i_obz","alternativeName":"d_i_obz"},{"id":"DnIRgw","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produtos_geral","alternativeName":"produtos_geral"},{"id":"BkcjKL","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"f_v","alternativeName":"f_v"},{"id":"qObEDA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i","alternativeName":"d_i"},{"id":"IuAQKf","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"depre","alternativeName":"depre"},{"id":"eKDryU","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"operacao_direta_franquias","alternativeName":"operacao_direta_franquias"},{"id":"eNkavn","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"versao","alternativeName":"versao"},{"id":"mMyIhE","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"nom_sgm_dtl","alternativeName":"nom_sgm_dtl"},{"id":"PJPSUg","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ett_mod","alternativeName":"dsc_cnt_ett_mod"},{"id":"VaxLFo","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_tip_cr","alternativeName":"dsc_tip_cr"},{"id":"PMSAbA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produto","alternativeName":"produto"},{"id":"ywMjRL","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"cod_cnt_ebit","alternativeName":"cod_cnt_ebit"},{"id":"oQXhrJ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ebit","alternativeName":"dsc_cnt_ebit"},{"id":"gdYWuj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_reg","alternativeName":"dsc_reg"},{"id":"EbsZYr","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"valor","columnLength":14,"alternativeName":"valor"}],"created":false,"fileName":"perfomance_segmento_maio_23.csv","position":{"x":110.99736473154827,"y":163.99981176653915},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"Perfomance_Segmento","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"xQPNsj","type":"fileImport","appId":137,"label":"perfomance_segmento_abril.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"ggDrIe","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes","alternativeName":"mes"},{"id":"iPifeK","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"concatenado","alternativeName":"concatenado"},{"id":"YagbPd","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"referencia","alternativeName":"referencia"},{"id":"rAyHVA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu","alternativeName":"bu"},{"id":"DtbEyp","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i_obz","alternativeName":"d_i_obz"},{"id":"yjokTk","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produtos_geral","alternativeName":"produtos_geral"},{"id":"KSDSSY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"f_v","alternativeName":"f_v"},{"id":"GYmEVj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i","alternativeName":"d_i"},{"id":"agoLeY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"depre","alternativeName":"depre"},{"id":"nPQmuB","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"operacao_direta_franquias","alternativeName":"operacao_direta_franquias"},{"id":"TsNHtf","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"versao","alternativeName":"versao"},{"id":"PmIHWj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"nom_sgm_dtl","alternativeName":"nom_sgm_dtl"},{"id":"mVwIQV","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ett_mod","alternativeName":"dsc_cnt_ett_mod"},{"id":"oGzfpC","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_tip_cr","alternativeName":"dsc_tip_cr"},{"id":"YYRfdA","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produto","alternativeName":"produto"},{"id":"GaLnQp","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"cod_cnt_ebit","alternativeName":"cod_cnt_ebit"},{"id":"EsBNBr","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ebit","alternativeName":"dsc_cnt_ebit"},{"id":"wqHthm","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_reg","alternativeName":"dsc_reg"},{"id":"LzTvBU","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"valor","columnLength":14,"alternativeName":"valor"}],"created":false,"fileName":"perfomance_segmento_abril.csv","position":{"x":112,"y":56},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"Perfomance_Segmento","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"ebBhGq","type":"fileImport","appId":137,"label":"perfomance_segmento_junho_23.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"mEpyLM","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes","alternativeName":"mes"},{"id":"PlMCqN","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"concatenado","alternativeName":"concatenado"},{"id":"ZtYtoi","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"referencia","alternativeName":"referencia"},{"id":"BCmumJ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu","alternativeName":"bu"},{"id":"ttUZUJ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i_obz","alternativeName":"d_i_obz"},{"id":"QiJaSC","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produtos_geral","alternativeName":"produtos_geral"},{"id":"rvUmmj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"f_v","alternativeName":"f_v"},{"id":"bWFmNs","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i","alternativeName":"d_i"},{"id":"xxIYAO","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"depre","alternativeName":"depre"},{"id":"pGsHbd","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"operacao_direta_franquias","alternativeName":"operacao_direta_franquias"},{"id":"hVDCev","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"versao","alternativeName":"versao"},{"id":"pgAzGw","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"nom_sgm_dtl","alternativeName":"nom_sgm_dtl"},{"id":"DdeIMC","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ett_mod","alternativeName":"dsc_cnt_ett_mod"},{"id":"SGpaHu","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_tip_cr","alternativeName":"dsc_tip_cr"},{"id":"pXEjeN","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produto","alternativeName":"produto"},{"id":"ZJQiBx","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"cod_cnt_ebit","alternativeName":"cod_cnt_ebit"},{"id":"McEAxC","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ebit","alternativeName":"dsc_cnt_ebit"},{"id":"PHuZCY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_reg","alternativeName":"dsc_reg"},{"id":"RChBau","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"valor","columnLength":14,"alternativeName":"valor"}],"created":false,"fileName":"perfomance_segmento_junho_23.csv","position":{"x":114.00288259684372,"y":263.0005953189134},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"Perfomance_Segmento","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"kzwYtk","type":"fileImport","appId":137,"label":"base_dashboard_agosto23.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"txLSPi","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"mes","alternativeName":"mes"},{"id":"RxsIxD","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"concatenado","alternativeName":"concatenado"},{"id":"RMfIaZ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"referencia","alternativeName":"referencia"},{"id":"LTXllX","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"bu","alternativeName":"bu"},{"id":"qtiIcd","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i_obz","alternativeName":"d_i_obz"},{"id":"tyqYzH","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produtos_geral","alternativeName":"produtos_geral"},{"id":"rhWSpT","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"f_v","alternativeName":"f_v"},{"id":"soSHyr","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"d_i","alternativeName":"d_i"},{"id":"yFPNCk","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"depre","alternativeName":"depre"},{"id":"VvRuTq","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"operacao_direta_franquias","alternativeName":"operacao_direta_franquias"},{"id":"HsYRWZ","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"versao","alternativeName":"versao"},{"id":"ezSgNz","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"nom_sgm_dtl","alternativeName":"nom_sgm_dtl"},{"id":"hsCxiS","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ett_mod","alternativeName":"dsc_cnt_ett_mod"},{"id":"qPMJCm","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_tip_cr","alternativeName":"dsc_tip_cr"},{"id":"wZTMur","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produto","alternativeName":"produto"},{"id":"buaRBv","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"cod_cnt_ebit","alternativeName":"cod_cnt_ebit"},{"id":"vNErce","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_cnt_ebit","alternativeName":"dsc_cnt_ebit"},{"id":"vxVHJi","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_reg","alternativeName":"dsc_reg"},{"id":"SqwgbC","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"valor","columnLength":14,"alternativeName":"valor"}],"created":false,"fileName":"base_dashboard_agosto23.csv","position":{"x":114,"y":517},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"PerformanceSegmentoAgosto23","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"YRHWtg","type":"table","appId":137,"label":"PerformanceSegmentoAgosto23","client":"clickhouse","repoId":1,"created":false,"position":{"x":355.9944854669076,"y":519.0003759908927},"tableName":"PerformanceSegmentoAgosto23","sourceType":"bucket","databaseName":"bucket_137"},{"id":"LSWUBF","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"PerformanceSegmentoAgosto23","columnName":"mes","columnLength":null,"databaseName":"bucket_137","targetColumn":"mes"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"concatenado","columnLength":null,"databaseName":"bucket_137","targetColumn":"concatenado"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"referencia","columnLength":null,"databaseName":"bucket_137","targetColumn":"referencia"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"bu","columnLength":null,"databaseName":"bucket_137","targetColumn":"bu"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"d_i_obz","columnLength":null,"databaseName":"bucket_137","targetColumn":"d_i_obz"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"produtos_geral","columnLength":null,"databaseName":"bucket_137","targetColumn":"produtos_geral"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"f_v","columnLength":null,"databaseName":"bucket_137","targetColumn":"f_v"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"d_i","columnLength":null,"databaseName":"bucket_137","targetColumn":"d_i"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"depre","columnLength":null,"databaseName":"bucket_137","targetColumn":"depre"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"operacao_direta_franquias","columnLength":null,"databaseName":"bucket_137","targetColumn":"operacao_direta_franquias"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"versao","columnLength":null,"databaseName":"bucket_137","targetColumn":"versao"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"nom_sgm_dtl","columnLength":null,"databaseName":"bucket_137","targetColumn":"nom_sgm_dtl"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"dsc_cnt_ett_mod","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_cnt_ett_mod"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"dsc_tip_cr","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_tip_cr"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"produto","columnLength":null,"databaseName":"bucket_137","targetColumn":"produto"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"cod_cnt_ebit","columnLength":null,"databaseName":"bucket_137","targetColumn":"cod_cnt_ebit"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"dsc_cnt_ebit","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_cnt_ebit"},{"dataType":"Nullable(String)","tableName":"PerformanceSegmentoAgosto23","columnName":"dsc_reg","columnLength":null,"databaseName":"bucket_137","targetColumn":"dsc_reg"},{"dataType":"Nullable(Float64)","tableName":"PerformanceSegmentoAgosto23","columnName":"valor","columnLength":14,"databaseName":"bucket_137","targetColumn":"valor"}]},"created":false,"position":{"x":588.9891589292615,"y":518.0011279726781},"tableName":"PerformanceSegmentoAgosto23","sourceType":"bucket","resultTable":"Perfomance_Segmento","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"IoEwaS","type":"table","appId":137,"label":"Perfomance_Segmento","client":"clickhouse","repoId":1,"created":false,"position":{"x":280.00665091561615,"y":54.0033254578081},"tableName":"Perfomance_Segmento","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"EKICiv","source":"DPFWRJ","target":"IoEwaS"},{"id":"mbPZJx","source":"ebBhGq","target":"IoEwaS"},{"id":"rDYBuc","source":"SUBVQH","target":"fiHGKK"},{"id":"slbsmd","source":"xQPNsj","target":"IoEwaS"},{"id":"SoAhFv","source":"fiHGKK","target":"LoTFbP"},{"id":"WOPUMe","source":"LoTFbP","target":"IoEwaS"},{"id":"mPCaWw","source":"kzwYtk","target":"YRHWtg"},{"id":"NOyKHW","source":"YRHWtg","target":"LSWUBF"},{"id":"htmchv","source":"LSWUBF","target":"IoEwaS"}]},"cron":null,"options":{"folder":"Perfomance_Segmento","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"wwgBgPqEGZDWOoMGPHOuUUlpyDhjvUsB","flowDescription":"","locked":null,"created":"2023-05-30 11:12:15","updated":"2023-09-11 18:08:42"},{"flowId":"2882","appId":137,"flowName":"Tratativa_Perfomance_Segmento","workflow":{"nodes":[{"id":"BoNMkm","type":"table","appId":137,"label":"Perfomance_Segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":68,"y":296},"sourceId":null,"tableName":"Perfomance_Segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wDGAAD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"ivsSEu","type":"value","alias":"DATA_REF","dataType":"Nullable(Date)","distinct":false,"tableName":"Perfomance_Segmento","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"ggVVjF","type":"computed","alias":"SEGMENTO","content":"CASE\nWHEN  upper(nom_sgm_dtl) = 'ATACADO' THEN 'OPERADORAS'\nWHEN  upper(nom_sgm_dtl) = 'CORPORATIVO' THEN 'CORPORATIVO'\nWHEN  upper(nom_sgm_dtl) = 'MPE' THEN 'EMPRESARIAL'\nWHEN  upper(nom_sgm_dtl) = 'VAREJO' THEN 'RESIDENCIAL'\nEND\n","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"TfNpUm"},{"id":"wYSuMY","type":"computed","alias":"HRQ_1","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"XaphBH"},{"id":"ldNNHo","type":"computed","alias":"HRQ_2","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"AhKHFI"},{"id":"PYvbzz","type":"computed","alias":"HRQ_3","content":" dsc_reg","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"BgDcIV"},{"id":"JqNEJU","type":"computed","alias":"DSC_LNH_NGC","content":"produtos_geral","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"YyenAH"},{"id":"gEyWOC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"Perfomance_Segmento","columnName":"dsc_cnt_ett_mod","columnLength":null,"databaseName":"bucket_137"},{"id":"CJnaYq","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"Perfomance_Segmento","columnName":"f_v","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ivsSEu","type":"value","alias":"DATA_REF","dataType":"Nullable(Date)","distinct":false,"tableName":"Perfomance_Segmento","columnName":"mes","columnLength":null,"databaseName":"bucket_137"},{"id":"cHzrSu","type":"computed","alias":"SEGMENTO","content":"CASE\nWHEN  upper(nom_sgm_dtl) = 'ATACADO' THEN 'OPERADORAS'\nWHEN  upper(nom_sgm_dtl) = 'CORPORATIVO' THEN 'CORPORATIVO'\nWHEN  upper(nom_sgm_dtl) = 'MPE' THEN 'EMPRESARIAL'\nWHEN  upper(nom_sgm_dtl) = 'VAREJO' THEN 'RESIDENCIAL'\nEND\n","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"TfNpUm"},{"id":"tAvxCT","type":"computed","alias":"HRQ_1","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_1","computedId":"XaphBH"},{"id":"qfFUHc","type":"computed","alias":"HRQ_2","content":"'N/A'","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_2","computedId":"AhKHFI"},{"id":"alCGDB","type":"computed","alias":"HRQ_3","content":" dsc_reg","dataType":"Nullable(String)","distinct":false,"columnName":"HRQ_3","computedId":"BgDcIV"},{"id":"edpGwJ","type":"computed","alias":"DSC_LNH_NGC","content":"produtos_geral","dataType":"Nullable(String)","distinct":false,"columnName":"DSC_LNH_NGC","computedId":"YyenAH"},{"id":"xsjZcO","type":"computed","alias":"VLR_REAL","content":"SUM(\nCASE \nWHEN versao='Real' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VLR_REAL","computedId":"TIFIYt","columnLength":14},{"id":"tdvRML","type":"computed","alias":"VLR_ORCADO","content":"SUM(\nCASE \nWHEN versao='1ª Revisão' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VLR_ORCADO","computedId":"Rcplbb","columnLength":14},{"id":"KPcJdP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"Perfomance_Segmento","columnName":"dsc_cnt_ett_mod","columnLength":null,"databaseName":"bucket_137"},{"id":"qwyVzt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"Perfomance_Segmento","columnName":"f_v","columnLength":null,"databaseName":"bucket_137"},{"id":"jliVpc","type":"computed","alias":"VLR_ORCADO_RECEITA","content":"SUM(\nCASE \nWHEN versao='1ª Revisão' and dsc_cnt_ett_mod='Receita' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VLR_ORCADO_RECEITA","computedId":"bEFZEl","columnLength":14},{"id":"qvdWTN","type":"computed","alias":"VLR_ORCADO_IMPOSTO","content":"SUM(\nCASE \nWHEN versao='1ª Revisão' and dsc_cnt_ett_mod='Imposto & Dedução' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VLR_ORCADO_IMPOSTO","computedId":"NSWzct","columnLength":14},{"id":"PJKRsv","type":"computed","alias":"VLR_REAL_IMPOSTO","content":"SUM(\nCASE \nWHEN versao='Real' and dsc_cnt_ett_mod='Imposto & Dedução' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VLR_REAL_IMPOSTO","computedId":"MgMevG","columnLength":14},{"id":"BiiKQN","type":"computed","alias":"VLR_REAL_RECEITA","content":"SUM(\nCASE \nWHEN versao='Real' and dsc_cnt_ett_mod='Receita' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VLR_REAL_RECEITA","computedId":"aKlpoH","columnLength":14}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO","content":"CASE\nWHEN  upper(nom_sgm_dtl) = 'ATACADO' THEN 'OPERADORAS'\nWHEN  upper(nom_sgm_dtl) = 'CORPORATIVO' THEN 'CORPORATIVO'\nWHEN  upper(nom_sgm_dtl) = 'MPE' THEN 'EMPRESARIAL'\nWHEN  upper(nom_sgm_dtl) = 'VAREJO' THEN 'RESIDENCIAL'\nEND\n","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"TfNpUm"},{"type":"computed","alias":"HRQ_1","content":"'N/A'","dataType":"Nullable(String)","columnName":"HRQ_1","computedId":"XaphBH"},{"type":"computed","alias":"HRQ_2","content":"'N/A'","dataType":"Nullable(String)","columnName":"HRQ_2","computedId":"AhKHFI"},{"type":"computed","alias":"HRQ_3","content":" dsc_reg","dataType":"Nullable(String)","columnName":"HRQ_3","computedId":"BgDcIV"},{"type":"computed","alias":"DSC_LNH_NGC","content":"produtos_geral","dataType":"Nullable(String)","columnName":"DSC_LNH_NGC","computedId":"YyenAH"},{"type":"computed","alias":"VLR_REAL","content":"SUM(\nCASE \nWHEN versao='Real' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","columnName":"VLR_REAL","computedId":"TIFIYt","columnLength":14},{"type":"computed","alias":"VLR_ORCADO","content":"SUM(\nCASE \nWHEN versao='1ª Revisão' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","columnName":"VLR_ORCADO","computedId":"Rcplbb","columnLength":14},{"type":"computed","alias":"VLR_ORCADO_RECEITA","content":"SUM(\nCASE \nWHEN versao='1ª Revisão' and dsc_cnt_ett_mod='Receita' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","columnName":"VLR_ORCADO_RECEITA","computedId":"bEFZEl","columnLength":14},{"type":"computed","alias":"VLR_ORCADO_IMPOSTO","content":"SUM(\nCASE \nWHEN versao='1ª Revisão' and dsc_cnt_ett_mod='Imposto & Dedução' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","columnName":"VLR_ORCADO_IMPOSTO","computedId":"NSWzct","columnLength":14},{"type":"computed","alias":"VLR_REAL_IMPOSTO","content":"SUM(\nCASE \nWHEN versao='Real' and dsc_cnt_ett_mod='Imposto & Dedução' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","columnName":"VLR_REAL_IMPOSTO","computedId":"MgMevG","columnLength":14},{"type":"computed","alias":"VLR_REAL_RECEITA","content":"SUM(\nCASE \nWHEN versao='Real' and dsc_cnt_ett_mod='Receita' THEN valor\nelse 0 \nend)","dataType":"Nullable(Float64)","columnName":"VLR_REAL_RECEITA","computedId":"aKlpoH","columnLength":14}]},"created":false,"optimize":false,"position":{"x":213,"y":296},"sourceId":null,"tableName":"Perfomance_Segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_perfomance_segmento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GsGMZl","type":"table","appId":137,"label":"tmp_perfomance_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":369.5,"y":296},"sourceId":null,"tableName":"tmp_perfomance_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dreaad","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"ETVqcY","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"rNMofp","type":"computed","alias":"TIP_MTC","content":"'Ebit Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"KVbVYg"},{"id":"YKMtNY","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"pRREGR","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"dsc_cnt_ett_mod","columnLength":null,"databaseName":"bucket_137"},{"id":"NmgHVB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"DDDGVE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"ILyEdV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"iWumXK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"IWQmrn","type":"computed","alias":"ORCADO","content":"VLR_ORCADO *-1","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"tfzDJj","columnLength":14},{"id":"tMeQxS","type":"computed","alias":"REAL","content":"VLR_REAL * -1","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"cqKmbi","columnLength":14}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebvuyt","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"qYGFgX","type":"computed","alias":"TIP_MTC","content":"'Ebit Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"KVbVYg"},{"id":"MyijjD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"NmgHVB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"DDDGVE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"ILyEdV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"iWumXK","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"MbATcb","type":"computed","alias":"ORCADO","content":"VLR_ORCADO *-1","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"tfzDJj","columnLength":14},{"id":"eeHbxC","type":"computed","alias":"REAL","content":"VLR_REAL * -1","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"cqKmbi","columnLength":14}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Ebit Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"KVbVYg"},{"type":"computed","alias":"REAL","content":"VLR_REAL * -1","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"cqKmbi","columnLength":14},{"type":"computed","alias":"ORCADO","content":"VLR_ORCADO *-1","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"tfzDJj","columnLength":14}]},"created":false,"optimize":false,"position":{"x":526,"y":70},"sourceId":null,"tableName":"tmp_perfomance_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_ebit","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ZveEGR","type":"table","appId":137,"label":"perfomance_segmento_ebit","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":904.5,"y":104},"sourceId":null,"tableName":"perfomance_segmento_ebit","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VMwEVL","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"NOYkgt","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"perfomance_segmento_ebit","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"dThgrg","type":"value","alias":"","andOr":"and","value":"2023-01-01","dataType":"Nullable(Date)","distinct":false,"operator":"between","fieldType":"value","tableName":"perfomance_segmento_ebit","valueType":"value","columnName":"DATA_REF","extraValue":"2023-04-01","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"rZZuqF","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"perfomance_segmento_ebit","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"cXPwgM","type":"sum","alias":"sum_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_ebit","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137"},{"id":"vKkGZN","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_ebit","columnName":"REAL","columnLength":14,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1144.5,"y":33},"sourceId":null,"tableName":"perfomance_segmento_ebit","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_agru_ebit","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"jdEnaM","type":"table","appId":137,"label":"tmp_agru_ebit","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1348.5,"y":33},"sourceId":null,"tableName":"tmp_agru_ebit","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jSitJr","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"XusBJe","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"lgvyjU","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"HwFXxe","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"dFeNyG","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"BYFmOr","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"IwscrM","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"AYPFuB","type":"value","alias":"","andOr":"and","value":"Variável","dataType":"Nullable(String)","distinct":false,"operator":"=","fieldType":"value","tableName":"tmp_perfomance_segmento","valueType":"value","columnName":"f_v","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"XusBJe","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"MopEBU","type":"computed","alias":"TIP_MTC","content":"'Margem Contribuição Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"oGYFXZ"},{"id":"lgvyjU","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"HwFXxe","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"dFeNyG","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"BYFmOr","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"IwscrM","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"Qyolee","type":"computed","alias":"ORCADO","content":"SUM(\r\nCASE\r\nWHEN f_v = 'Variável' THEN VLR_ORCADO * -1\r\nELSE 0 \r\nEND )","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"uOyCiS","columnLength":14},{"id":"yGmOkL","type":"computed","alias":"REAL","content":"SUM(\r\nCASE\r\nWHEN f_v = 'Variável' THEN VLR_REAL * -1\r\nELSE 0 \r\nEND )","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"GifVRG","columnLength":14}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Margem Contribuição Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"oGYFXZ"},{"type":"computed","alias":"ORCADO","content":"SUM(\r\nCASE\r\nWHEN f_v = 'Variável' THEN VLR_ORCADO * -1\r\nELSE 0 \r\nEND )","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"uOyCiS","columnLength":14},{"type":"computed","alias":"REAL","content":"SUM(\r\nCASE\r\nWHEN f_v = 'Variável' THEN VLR_REAL * -1\r\nELSE 0 \r\nEND )","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"GifVRG","columnLength":14}]},"created":false,"optimize":false,"position":{"x":526,"y":251},"sourceId":null,"tableName":"tmp_perfomance_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_mc","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"guxEbc","type":"table","appId":137,"label":"perfomance_segmento_mc","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1093.4968000311658,"y":452.9986196212872},"sourceId":null,"tableName":"perfomance_segmento_mc","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"yAwFMz","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"EXeYIy","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"perfomance_segmento_mc","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"VNRsvl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"perfomance_segmento_mc","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"pcezHu","type":"value","andOr":"and","value":"2023-01-01","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"perfomance_segmento_mc","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"EXeYIy","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"perfomance_segmento_mc","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"VNRsvl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"perfomance_segmento_mc","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"mCBBFJ","type":"sum","alias":"sum_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_mc","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"iHeFiH","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_mc","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1348.5,"y":533},"sourceId":null,"tableName":"perfomance_segmento_mc","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_perfomance_segmento_agr_mc","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"wDjwWg","type":"table","appId":137,"label":"tmp_perfomance_segmento_agr_mc","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1545,"y":594},"sourceId":null,"tableName":"tmp_perfomance_segmento_agr_mc","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FjOMvD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"IJlAur","type":"value","dataType":"Nullable(Date)","tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"KNcNPG","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"baHQbm","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"TNTIXp","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"JEKqJz","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"qZslIy","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"XFpmyC","type":"value","andOr":"and","value":"Depreciação e Amortização","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_perfomance_segmento","valueType":"value","columnName":"dsc_cnt_ett_mod","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"IJlAur","type":"value","dataType":"Nullable(Date)","tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"eahFXh","type":"computed","alias":"TIP_MTC","content":"'Ebitda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"UdWaBn"},{"id":"KNcNPG","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"baHQbm","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"TNTIXp","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"JEKqJz","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"qZslIy","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"NAeXQN","type":"computed","alias":"ORCADO","content":"SUM(\nCASE\nWHEN upper(dsc_cnt_ett_mod) <> 'DEPRECIAÇÃO E AMORTIZAÇÃO' THEN VLR_ORCADO *-1\nELSE 0 \nEND )","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"AUGOEz","columnLength":14},{"id":"bzPGys","type":"computed","alias":"REAL","content":"SUM(\nCASE\nWHEN upper(dsc_cnt_ett_mod) <> 'DEPRECIAÇÃO E AMORTIZAÇÃO' THEN VLR_REAL* -1\nELSE 0 \nEND )","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"VSIZhK","columnLength":14}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Ebitda Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"UdWaBn"},{"type":"computed","alias":"REAL","content":"SUM(\nCASE\nWHEN upper(dsc_cnt_ett_mod) <> 'DEPRECIAÇÃO E AMORTIZAÇÃO' THEN VLR_REAL* -1\nELSE 0 \nEND )","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"VSIZhK","columnLength":14},{"type":"computed","alias":"ORCADO","content":"SUM(\nCASE\nWHEN upper(dsc_cnt_ett_mod) <> 'DEPRECIAÇÃO E AMORTIZAÇÃO' THEN VLR_ORCADO *-1\nELSE 0 \nEND )","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"AUGOEz","columnLength":14}]},"created":false,"optimize":false,"position":{"x":526,"y":554},"sourceId":null,"tableName":"tmp_perfomance_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_ebitda","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"xINMaX","type":"table","appId":137,"label":"perfomance_segmento_ebitda","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":689,"y":574},"sourceId":null,"tableName":"perfomance_segmento_ebitda","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HnPPCH","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"ILoqiE","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"perfomance_segmento_ebitda","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"QxcYce","type":"value","alias":"","andOr":"and","value":"2023-01-01","dataType":"Nullable(Date)","distinct":false,"operator":"=","fieldType":"value","tableName":"perfomance_segmento_ebitda","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"sMePpO","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"perfomance_segmento_ebitda","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"bYhGMb","type":"sum","alias":"sum_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_ebitda","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"vijWdh","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_ebitda","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":904.5,"y":591},"sourceId":null,"tableName":"perfomance_segmento_ebitda","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_perfomance_agrupamento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"bRdaSR","type":"table","appId":137,"label":"tmp_perfomance_agrupamento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1053.494290251688,"y":557.9979294319307},"sourceId":null,"tableName":"tmp_perfomance_agrupamento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hvVlhf","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"iFSMPd","type":"value","dataType":"Nullable(Date)","tableName":"tmp_perfomance_segmento","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"KnGmDN","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"PwAYds","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"CHfGBU","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"BhPXjW","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"bShNuG","type":"value","dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"wvBoeQ","type":"computed","alias":"TIP_MTC","content":"'Receita Liquida Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"FWITnp"},{"id":"rUPwUF","type":"computed","alias":"ORCADO","content":"(VLR_ORCADO_RECEITA * -1) - VLR_ORCADO_IMPOSTO","dataType":"Nullable(Float64)","distinct":false,"columnName":"ORCADO","computedId":"jOHPGp","columnLength":14},{"id":"SFvhBV","type":"computed","alias":"REAL","content":"(VLR_REAL_RECEITA *-1) - VLR_REAL_IMPOSTO","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL","computedId":"QZBCTN","columnLength":14}],"update":[],"computed":[{"type":"computed","alias":"ORCADO","content":"(VLR_ORCADO_RECEITA * -1) - VLR_ORCADO_IMPOSTO","dataType":"Nullable(Float64)","columnName":"ORCADO","computedId":"jOHPGp","columnLength":14},{"type":"computed","alias":"REAL","content":"(VLR_REAL_RECEITA *-1) - VLR_REAL_IMPOSTO","dataType":"Nullable(Float64)","columnName":"REAL","computedId":"QZBCTN","columnLength":14},{"type":"computed","alias":"TIP_MTC","content":"'Receita Liquida Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"FWITnp"}]},"created":false,"optimize":false,"position":{"x":370.4664944439712,"y":600.993160850923},"sourceId":null,"tableName":"tmp_perfomance_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_perfomance_segmento_receita_liq","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ieebZp","type":"delete","appId":137,"label":"Delete","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"gZQHGE","type":"value","andOr":"and","dataType":"Nullable(Date)","operator":"isNotNull","tableName":"perfomance_segmento_geral","valueType":"value","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":689,"y":233},"sourceId":null,"tableName":"perfomance_segmento_geral","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"wpOLSS","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"perfomance_segmento_ebitda","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebitda","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebitda","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebitda","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebitda","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebitda","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebitda","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_ebitda","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137","targetColumn":"ORCADO"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_ebitda","columnName":"REAL","columnLength":14,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":968.5040156471644,"y":372.9982431543655},"sourceId":null,"tableName":"perfomance_segmento_ebitda","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_geral","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"eoviEP","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"perfomance_segmento_ebit","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebit","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebit","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebit","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebit","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebit","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_ebit","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_ebit","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137","targetColumn":"ORCADO"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_ebit","columnName":"REAL","columnLength":14,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":1144.5,"y":155},"sourceId":null,"tableName":"perfomance_segmento_ebit","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_geral","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"baBfZc","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"perfomance_segmento_mc","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_mc","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_mc","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_mc","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_mc","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_mc","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_mc","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_mc","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137","targetColumn":"ORCADO"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_mc","columnName":"REAL","columnLength":14,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":1348.5,"y":317},"sourceId":null,"tableName":"perfomance_segmento_mc","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_geral","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"iNmgUs","type":"table","appId":137,"label":"tmp_perfomance_segmento_receita_liq","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":628.4676238447362,"y":702.9995607885915},"sourceId":null,"tableName":"tmp_perfomance_segmento_receita_liq","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"WVAXmy","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(String)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137","targetColumn":"ORCADO"},{"dataType":"Nullable(Float64)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"REAL","columnLength":14,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":893.47145125844,"y":764.9996235330784},"sourceId":null,"tableName":"tmp_perfomance_segmento_receita_liq","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_geral","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"WYUPcD","type":"table","appId":137,"label":"perfomance_segmento_geral","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1545,"y":330},"sourceId":null,"tableName":"perfomance_segmento_geral","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qLvCsn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"lgRphD","type":"value","alias":"","andOr":"and","value":"0","dataType":"Nullable(Float64)","distinct":false,"operator":"!=","fieldType":"value","tableName":"perfomance_segmento_geral","valueType":"value","columnName":"REAL","extraValue":"","columnLength":14,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"nXVWEN","type":"value","dataType":"Nullable(Date)","tableName":"perfomance_segmento_geral","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"BZVOHC","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"kakKNy","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"kMSQIS","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"atzuAQ","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"UiMjQL","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"rxRBHX","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"xKTadv","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"perfomance_segmento_geral","columnName":"REAL","columnLength":14,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1725,"y":272},"sourceId":null,"tableName":"perfomance_segmento_geral","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_real","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BXVJTO","type":"table","appId":137,"label":"perfomance_segmento_real","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1890,"y":272},"sourceId":null,"tableName":"perfomance_segmento_real","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"duxbut","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"OMNfbB","type":"value","andOr":"and","value":"0","dataType":"Nullable(Float64)","operator":"!=","fieldType":"value","tableName":"perfomance_segmento_geral","valueType":"value","columnName":"ORCADO","extraValue":"","columnLength":14,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"rywmYf","type":"value","dataType":"Nullable(Date)","tableName":"perfomance_segmento_geral","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"cTDXRL","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137"},{"id":"fcWEqD","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"wpThYL","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137"},{"id":"iqFUaX","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137"},{"id":"GlqKje","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137"},{"id":"NpFJVd","type":"value","dataType":"Nullable(String)","tableName":"perfomance_segmento_geral","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137"},{"id":"jBqyTJ","type":"value","dataType":"Nullable(Float64)","tableName":"perfomance_segmento_geral","columnName":"ORCADO","columnLength":14,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1725,"y":388},"sourceId":null,"tableName":"perfomance_segmento_geral","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"perfomance_segmento_orcado","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pyCvcs","type":"table","appId":137,"label":"perfomance_segmento_orcado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1890,"y":388},"sourceId":null,"tableName":"perfomance_segmento_orcado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qdgPjD","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"LErOKF","type":"value","dataType":"Nullable(Date)","tableName":"tmp_perfomance_segmento_receita_liq","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"CuXGxP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento_receita_liq","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"hSkWRk","type":"value","andOr":"and","value":"2023-01-01","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"tmp_perfomance_segmento_receita_liq","valueType":"value","columnName":"DATA_REF","extraValue":"2023-05-31","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"xcCwBR","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"tmp_perfomance_segmento_receita_liq","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137"},{"id":"AmtKlo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_perfomance_segmento_receita_liq","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"XmZiPw","type":"sum","alias":"sum_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_perfomance_segmento_receita_liq","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"YCiIRP","type":"sum","alias":"sum_REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_perfomance_segmento_receita_liq","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":915.4728316371528,"y":672.0014431231998},"sourceId":null,"tableName":"tmp_perfomance_segmento_receita_liq","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_perfomance_segmento_agr_rl","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"FhgbKQ","type":"table","appId":137,"label":"tmp_perfomance_segmento_agr_rl","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1247.9813648873774,"y":706.9998117665391},"sourceId":null,"tableName":"tmp_perfomance_segmento_agr_rl","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"hUwPyc","source":"xINMaX","target":"wpOLSS"},{"id":"fpiVcO","source":"ZveEGR","target":"eoviEP"},{"id":"SsfORK","source":"guxEbc","target":"baBfZc"},{"id":"YAoMOK","type":"manual","label":"","source":"FjOMvD","target":"ieebZp"},{"id":"iZaQBf","type":"manual","label":"","source":"dreaad","target":"ieebZp"},{"id":"muwYFD","type":"manual","label":"","source":"jSitJr","target":"ieebZp"},{"id":"NqvgbM","type":"manual","label":"","source":"ieebZp","target":"wpOLSS"},{"id":"KBGauz","source":"wpOLSS","target":"WYUPcD"},{"id":"LJkDND","source":"eoviEP","target":"WYUPcD"},{"id":"RTOPNb","source":"baBfZc","target":"WYUPcD"},{"id":"PvDAlE","type":"manual","label":"","source":"wpOLSS","target":"eoviEP"},{"id":"LAlXPV","type":"manual","label":"","source":"eoviEP","target":"baBfZc"},{"id":"cyyUPp","source":"WYUPcD","target":"qLvCsn"},{"id":"OxpTpr","source":"qLvCsn","target":"BXVJTO"},{"id":"bmUFUn","source":"WYUPcD","target":"duxbut"},{"id":"XssRen","source":"duxbut","target":"pyCvcs"},{"id":"TUbkvM","source":"GsGMZl","target":"dreaad"},{"id":"GQWnDg","source":"dreaad","target":"ZveEGR"},{"id":"UNlWdW","source":"GsGMZl","target":"jSitJr"},{"id":"kaJrIJ","source":"jSitJr","target":"guxEbc"},{"id":"ffJoGy","source":"ZveEGR","target":"VMwEVL"},{"id":"GXnEwM","source":"VMwEVL","target":"jdEnaM"},{"id":"NSHRFT","source":"guxEbc","target":"yAwFMz"},{"id":"RsxsbV","source":"yAwFMz","target":"wDjwWg"},{"id":"PXxTwC","source":"xINMaX","target":"HnPPCH"},{"id":"fcwKaP","source":"HnPPCH","target":"bRdaSR"},{"id":"PfAaRw","source":"GsGMZl","target":"FjOMvD"},{"id":"eDhSYS","source":"FjOMvD","target":"xINMaX"},{"id":"nkfFKy","source":"iNmgUs","target":"WVAXmy"},{"id":"zUpXgn","type":"manual","label":"","source":"hvVlhf","target":"ieebZp"},{"id":"zMjygu","source":"WVAXmy","target":"WYUPcD"},{"id":"kvPGpQ","source":"ieebZp","target":"WYUPcD"},{"id":"IuSKsP","source":"iNmgUs","target":"qdgPjD"},{"id":"xRMAas","source":"qdgPjD","target":"FhgbKQ"},{"id":"bdDAaM","source":"GsGMZl","target":"hvVlhf"},{"id":"TQesOO","source":"hvVlhf","target":"iNmgUs"},{"id":"VYYSkF","source":"BoNMkm","target":"wDGAAD"},{"id":"zrqAqd","source":"wDGAAD","target":"GsGMZl"}]},"cron":null,"options":{"folder":"Perfomance_Segmento","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"AHvULiCxiDOQbOrOiJmXPUXJPltRDoXn","flowDescription":"","locked":null,"created":"2023-05-30 11:28:07","updated":"2023-09-08 09:08:23"},{"flowId":"2884","appId":137,"flowName":"CARGA - Hard Coded","workflow":{"nodes":[{"id":"cguYzh","type":"fileImport","appId":137,"label":"perda_receita_corp_iot_manual.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"MOXxfK","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"data_ref","alternativeName":"data_ref"},{"id":"JcFvJi","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"tip_mtc","alternativeName":"tip_mtc"},{"id":"TqsfzU","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"BEjthY","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_1","alternativeName":"hrq_1"},{"id":"piKGrR","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_2","alternativeName":"hrq_2"},{"id":"XTJAKc","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_3","alternativeName":"hrq_3"},{"id":"IDxFzh","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_lnh_ngc","alternativeName":"dsc_lnh_ngc"},{"id":"kHadCT","index":false,"decimal":"comma","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"real","columnLength":2,"alternativeName":"real"}],"created":false,"fileName":"perda_receita_corp_iot_manual.csv","position":{"x":291.0118750456934,"y":-27.99736806375131},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"perda_iot_corp_manual","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"lfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"dEDcHm","type":"table","appId":137,"label":"perda_iot_corp_manual","client":"clickhouse","repoId":1,"created":false,"position":{"x":604.0048252164559,"y":-31.995425444139215},"tableName":"perda_iot_corp_manual","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EDGElq","type":"fileImport","appId":137,"label":"hard_coded_portal_base.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"ANvOoF","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"data_ref","alternativeName":"data_ref"},{"id":"UZzLKj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"tip_mtc","alternativeName":"tip_mtc"},{"id":"SvCRjz","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"MZlQgM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_1","alternativeName":"hrq_1"},{"id":"VnQoEu","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_2","alternativeName":"hrq_2"},{"id":"lHxgpx","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_3","alternativeName":"hrq_3"},{"id":"OeKioF","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_lnh_ngc","alternativeName":"dsc_lnh_ngc"},{"id":"wggVBB","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"real","columnLength":2,"alternativeName":"real"}],"created":false,"fileName":"hard_coded_portal_base.csv","position":{"x":-97.99436013661006,"y":79.00090864465724},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"hard_coded_portal_base","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"Ndadwk","type":"table","appId":137,"label":"hard_coded_portal_base","client":"clickhouse","repoId":1,"created":false,"position":{"x":292.49978067197924,"y":75.00103397495482},"tableName":"hard_coded_portal_base","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RejCXd","type":"delete","appId":137,"label":"DeletarVendaMPE","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"sQrffl","type":"value","andOr":"and","value":"Venda Mensal","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"nZvJFW","type":"value","andOr":"and","value":["2023-01-01 00:00:00","2023-02-01 00:00:00","2023-03-01 00:00:00","2023-04-01 00:00:00","2023-05-01 00:00:00","2023-06-01 00:00:00","2023-07-01 00:00:00","2023-08-01 00:00:00"],"dataType":"Nullable(DateTime)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ANSOCK","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":-401.46760211808214,"y":219.0023812756537},"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"BhDgvm","type":"delete","appId":137,"label":"DeletarVendaVarejo","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"SNzzGp","type":"value","andOr":"and","value":"Venda Mensal","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"GvlXYq","type":"value","andOr":"and","value":["2023-01-01 00:00:00","2023-02-01 00:00:00","2023-03-01 00:00:00","2023-04-01 00:00:00","2023-05-01 00:00:00","2023-06-01 00:00:00","2023-07-01 00:00:00","2023-08-01 00:00:00"],"dataType":"Nullable(DateTime)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"LfxNBy","type":"value","andOr":"and","value":"RESIDENCIAL","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":-222.47321064889752,"y":205.00281993169529},"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"dDQQvY","type":"delete","appId":137,"label":"DeletevendaPerda2023CorpAtacado","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"nFCcuF","type":"value","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"mWcOUE","type":"value","andOr":"and","value":["2023-04-01 00:00:00","2023-03-01 00:00:00","2023-02-01 00:00:00","2023-01-01 00:00:00","2023-05-01 00:00:00","2023-06-01 00:00:00","2023-07-01 00:00:00","2023-08-01 00:00:00"],"dataType":"Nullable(DateTime)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"YxWxUW","type":"value","andOr":"and","value":["CORPORATIVO","OPERADORAS"],"dataType":"Nullable(String)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":88.99978067197924,"y":228.00103397495485},"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","databaseName":"bucket_137","clearMutation":true},{"id":"AbCNqY","type":"delete","appId":137,"label":"DeletarPerdaMPE","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"KcSefT","type":"value","andOr":"and","value":["2022-05-01 00:00:00","2022-06-01 00:00:00","2022-07-01 00:00:00","2022-08-01 00:00:00","2022-09-01 00:00:00","2022-10-01 00:00:00","2022-11-01 00:00:00","2022-12-01 00:00:00","2023-01-01 00:00:00","2023-02-01 00:00:00","2023-03-01 00:00:00","2023-04-01 00:00:00","2023-05-01 00:00:00","2023-06-01 00:00:00","2023-07-01 00:00:00","2023-08-01 00:00:00"],"dataType":"Nullable(DateTime)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"qcYjpj","type":"value","andOr":"and","value":"Perda de Receita Mensal","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"mnLAez","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":292.49978067197924,"y":191.0010339749548},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"DmjDkK","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"hard_coded_portal_base","columnName":"data_ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"segmento","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"hrq_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"hrq_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"hrq_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"dsc_lnh_ngc","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Int64)","tableName":"hard_coded_portal_base","columnName":"real","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"col_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"none"}]},"created":false,"position":{"x":441.9997806719792,"y":133.00103397495482},"tableName":"hard_coded_portal_base","temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO_VALIDACAO","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"EUZQfX","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"perda_iot_corp_manual","columnName":"data_ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"perda_iot_corp_manual","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"perda_iot_corp_manual","columnName":"segmento","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"perda_iot_corp_manual","columnName":"hrq_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"perda_iot_corp_manual","columnName":"hrq_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"perda_iot_corp_manual","columnName":"hrq_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"perda_iot_corp_manual","columnName":"dsc_lnh_ngc","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"perda_iot_corp_manual","columnName":"real","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"created":false,"position":{"x":604.0076451481509,"y":82.99918535306591},"tableName":"perda_iot_corp_manual","sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO_VALIDACAO","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"TwVFhj","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_VALIDACAO","client":"clickhouse","repoId":1,"shared":false,"position":{"x":609.500720649211,"y":214.00253793852556},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"MvQcug","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"rUxwph","type":"value","andOr":"and","value":"toStartOfMonth(addMonths(today(),-13))","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"THOZkf","type":"value","dataType":"Nullable(DateTime)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"CgsBrt","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"SZDHFj","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"UsoVNe","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"dPJdRE","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"geXIrm","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"MuzRqD","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"vzwjVp","type":"value","dataType":"Nullable(Float64)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"KiDEqU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":835.9997806719792,"y":180.00103397495482},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"cnNstL","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":994.9997806719792,"y":180.00103397495482},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"lVtqdi","type":"manual","label":"","source":"AbCNqY","target":"DmjDkK"},{"id":"tVMgxs","source":"DmjDkK","target":"TwVFhj"},{"id":"uSahZE","source":"Ndadwk","target":"DmjDkK"},{"id":"FJAtSE","type":"manual","label":"","source":"DmjDkK","target":"MvQcug"},{"id":"uJrJMW","type":"manual","label":"","source":"dDQQvY","target":"AbCNqY"},{"id":"vrmlDQ","source":"dEDcHm","target":"EUZQfX"},{"id":"NDcZaX","source":"EUZQfX","target":"TwVFhj"},{"id":"wxcnAi","type":"manual","label":"","source":"EUZQfX","target":"MvQcug"},{"id":"zKkpQv","type":"manual","label":"","source":"DmjDkK","target":"EUZQfX"},{"id":"OopObO","type":"manual","label":"","source":"BhDgvm","target":"dDQQvY"},{"id":"CZoFAY","source":"TwVFhj","target":"MvQcug"},{"id":"eMWCRL","source":"MvQcug","target":"cnNstL"},{"id":"IItcVP","type":"manual","label":"","source":"RejCXd","target":"BhDgvm"},{"id":"HxbTcF","source":"cguYzh","target":"dEDcHm"},{"id":"wMOHGE","source":"BhDgvm","target":"TwVFhj"},{"id":"gpwKzZ","source":"RejCXd","target":"TwVFhj"},{"id":"Rbmere","source":"dDQQvY","target":"TwVFhj"},{"id":"gItXTr","source":"AbCNqY","target":"TwVFhj"},{"id":"TkYnRw","source":"EDGElq","target":"Ndadwk"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"LnxWePeNEmGxYAGAXYcUQqsgfRCPhwWW","flowDescription":"Processo responsável por ajustes nos números do Portal.","locked":"no","created":"2023-05-30 13:32:07","updated":"2023-09-08 09:08:23"},{"flowId":"2885","appId":137,"flowName":"CARGA - Rest Insight/Filtros","workflow":{"nodes":[{"id":"niVDGN","type":"table","appId":137,"label":"aux_base_desempenho_projetos","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":335.1081769464718,"y":510.44750341392273},"sourceId":null,"tableName":"aux_base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"cnNstL","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":322.9398382580495,"y":152.28030296081312},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pLCJgY","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH INDICADORES AS (\r\n\tSELECT \t  CASE \r\n\t\t\t\tWHEN TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'VENDAS - NOVA VENDA') THEN 'Venda'\r\n\t\t\t\tWHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n\t\t\t\tWHEN TIP_MTC = 'CHURN RECEITA' THEN 'Churn de Receita'\r\n\t\t\t\tWHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n\t\t\t\tWHEN TIP_MTC = 'DOWNGRADE' THEN 'Downgrade'\r\n\t\t\t\tWHEN TIP_MTC = 'FATURAMENTO - FATURAMENTO BRUTO' THEN 'Faturamento'\r\n\t\t\t  END AS INDICADOR\r\n\t\t\t, CASE \r\n\t\t\t\tWHEN TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'VENDAS - NOVA VENDA') THEN 'Venda'\r\n\t\t\t\tWHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes / Ticket Medio'\r\n\t\t\t\tWHEN TIP_MTC = 'CHURN RECEITA' THEN 'Perda de Receita'\r\n\t\t\t\tWHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n\t\t\t\tWHEN TIP_MTC = 'DOWNGRADE' THEN 'Perda de Receita'\r\n\t\t\t\tWHEN TIP_MTC = 'FATURAMENTO - FATURAMENTO BRUTO' THEN 'Ticket Medio'\r\n\t\t\t  END AS USADO_EM\r\n\t\t\t, DSC_SGM_CLI  AS segmento\r\n\t\t\t, MAX(DAT_CRG_RGT) AS DATA_carga\r\n\t\t\t, MAX(DAT_DIA_MES_REF) AS DATA_REF\r\n\tFROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n\tWHERE 1 = 1\r\n\t\tAND DSC_SGM_CLI IS NOT NULL\r\n\t\tAND (TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO'\r\n\t\t\t\t\t  , 'BASE DE CLIENTES'\r\n\t\t\t\t\t  , 'DADOS FISICOS - BASE'\r\n\t\t\t\t\t  , 'CHURN RECEITA'\r\n\t\t\t\t\t  , 'DOWNGRADE')\r\n\t\t\tOR  (TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL' AND DSC_SGM_CLI = 'EMPRESARIAL')\r\n\t\t\tOR  (TIP_MTC = 'VENDAS - NOVA VENDA' AND DSC_SGM_CLI <> 'EMPRESARIAL')\r\n\t\t\t)\r\n\tGROUP BY  TIP_MTC\r\n\t\t\t, DSC_SGM_CLI\r\n\tORDER BY  TIP_MTC\r\n\t\t\t, DSC_SGM_CLI\r\n)\r\n\r\nSELECT \t  INDICADOR\r\n\t\t, USADO_EM\r\n\t\t, SEGMENTO\r\n\t\t, DATA_CARGA\r\n\t\t, DATA_REF\r\n\t\t, CASE \r\n\t\t\tWHEN TRUNC(SYSDATE, 'DD') = DATA_CARGA THEN 'RODOU' \r\n\t\t\tELSE 'VERIFICAR' \r\n\t\t  END AS STATUS_CARGA\r\n\t\t, CASE \r\n\t\t\tWHEN TRUNC(SYSDATE-1, 'DD') = DATA_REF OR TRUNC(SYSDATE, 'DD') = DATA_REF THEN 'D-1' \r\n\t\t\tELSE 'VERIFICAR' \r\n\t\t  END AS STATUS\r\n\t\t, to_char(sysdate,'HH:mi:ss') AS HORARIO\r\nFROM INDICADORES","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":326.005290611014,"y":344.0213840558379},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"VALIDACAO_CARGA","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"nxXnAl","type":"table","appId":137,"label":"VALIDACAO_CARGA","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":737.9980301424473,"y":343.02152015213034},"sourceId":7,"tableName":"VALIDACAO_CARGA","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qhWOWw","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"uUpxLM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"esgZWB","type":"computed","alias":"SEGMENTO_VISUAL","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN 'CORPORATIVO'\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    WHEN SEGMENTO = 'OPERADORAS' THEN 'ATACADO'\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN 'VAREJO'\n    ELSE ''\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_VISUAL","computedId":"xrbmKX"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uUpxLM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"JSOmRv","type":"computed","alias":"SEGMENTO_VISUAL","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN 'CORPORATIVO'\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    WHEN SEGMENTO = 'OPERADORAS' THEN 'ATACADO'\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN 'VAREJO'\n    ELSE ''\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO_VISUAL","computedId":"xrbmKX"}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO_VISUAL","content":"CASE\n    WHEN SEGMENTO = 'CORPORATIVO' THEN 'CORPORATIVO'\n    WHEN SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    WHEN SEGMENTO = 'OPERADORAS' THEN 'ATACADO'\n    WHEN SEGMENTO = 'RESIDENCIAL' THEN 'VAREJO'\n    ELSE ''\nEND","dataType":"Nullable(String)","columnName":"SEGMENTO_VISUAL","computedId":"xrbmKX"}]},"created":false,"optimize":false,"position":{"x":451.94270207265066,"y":87.27552993647807},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"IND_FILTRO_SEGMENTO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"AKjGOU","type":"table","appId":137,"label":"IND_FILTRO_SEGMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":585.9455139880979,"y":88.27707005967375},"sourceId":7,"tableName":"IND_FILTRO_SEGMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YUMuSX","url":"https://gaio.algartelecom.com.br/api/rest/NyPuSS_vlkRapgyCrmppZWracqhYsOrq/tb_hom_processa_nlp/","body":"{ \"property\": \"{{column_name}}\" }","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"1794","method":"GET","repoId":1,"created":false,"headers":[{"prop":"Accept","value":"application/json"},{"prop":"Content-Type","value":"application/json;charset=UTF-8"}],"options":{},"timeout":0,"position":{"x":319.121705111517,"y":-52.95070028037632},"restType":"rest","tableName":"","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":false},{"id":"BwvKzg","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SfcTBG","type":"computed","alias":"mes_ref","content":"Max(case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend)","dataType":"Nullable(String)","distinct":false,"columnName":"mes_ref","computedId":"FcjjoC"},{"id":"zAyPoO","type":"computed","alias":"dia_mes","content":"Max(toDayOfMonth(today()))","dataType":"Nullable(String)","distinct":false,"columnName":"dia_mes","computedId":"eUXbRT"}],"update":[],"computed":[{"type":"computed","alias":"mes_ref","content":"Max(case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend)","dataType":"Nullable(String)","columnName":"mes_ref","computedId":"FcjjoC"},{"type":"computed","alias":"dia_mes","content":"Max(toDayOfMonth(today()))","dataType":"Nullable(String)","columnName":"dia_mes","computedId":"eUXbRT"}]},"created":false,"optimize":false,"position":{"x":461.9434363840869,"y":239.28669147030777},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"aux_mes_max","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"nzieRN","type":"table","appId":137,"label":"aux_mes_max","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":588.946153336401,"y":238.28661803916415},"sourceId":7,"tableName":"aux_mes_max","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"iwMmPn","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":733.0854636711088,"y":239.0181786256324},"tableName":"aux_mes_max","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_mes_diario","columnName":"mes_ref"},{"paramName":"dia_mes","columnName":"dia_mes"}]},{"id":"BUMIHB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"sRxkEm","type":"computed","alias":"data_max","content":"concat(toString(toYear(max(DATA_REF))),\n\n\n\ntoString(\ncase when toMonth(max(DATA_REF)) >= 10 then toString(toMonth(max(DATA_REF)))\nelse concat('0',toString(toMonth(max(DATA_REF)))) end\n\n)\n)","dataType":"Nullable(String)","distinct":false,"columnName":"data_max","computedId":"LnPxqn"}],"update":[],"computed":[{"type":"computed","alias":"data_max","content":"concat(toString(toYear(max(DATA_REF))),\n\n\n\ntoString(\ncase when toMonth(max(DATA_REF)) >= 10 then toString(toMonth(max(DATA_REF)))\nelse concat('0',toString(toMonth(max(DATA_REF)))) end\n\n)\n)","dataType":"Nullable(String)","columnName":"data_max","computedId":"LnPxqn"}]},"created":false,"optimize":false,"position":{"x":458.48971000143,"y":510.25533297718096},"sourceId":null,"tableName":"aux_base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"parametro_data_max_projeto","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"coGPig","type":"table","appId":137,"label":"parametro_data_max_projeto","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":583.4421387295627,"y":511.04078081376827},"sourceId":null,"tableName":"parametro_data_max_projeto","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"yxKBOg","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":742.8178449133492,"y":511.98202059764697},"tableName":"parametro_data_max_projeto","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_data_max_projeto","columnName":"data_max"}]},{"id":"gceSwx","type":"table","appId":137,"label":"aux_base_bases_sem_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":319.9978039429569,"y":676.0008784228172},"sourceId":null,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"AzwehI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"NdycZo","type":"computed","alias":"data_max","content":"concat(toString(toYear(max(DATA_REF))),\n\n\n\ntoString(\ncase when toMonth(max(DATA_REF)) >= 10 then toString(toMonth(max(DATA_REF)))\nelse concat('0',toString(toMonth(max(DATA_REF)))) end\n\n)\n)","dataType":"Nullable(String)","distinct":false,"columnName":"data_max","computedId":"flcRqv"}],"update":[],"computed":[{"type":"computed","alias":"data_max","content":"concat(toString(toYear(max(DATA_REF))),\n\n\n\ntoString(\ncase when toMonth(max(DATA_REF)) >= 10 then toString(toMonth(max(DATA_REF)))\nelse concat('0',toString(toMonth(max(DATA_REF)))) end\n\n)\n)","dataType":"Nullable(String)","columnName":"data_max","computedId":"flcRqv"}]},"created":false,"optimize":false,"position":{"x":453.0005019558956,"y":675.9968000311657},"sourceId":null,"tableName":"aux_base_bases_sem_segmento","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"parametro_maximo_base_se_segmento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"EUSomO","type":"table","appId":137,"label":"parametro_maximo_base_se_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":599.0040156471646,"y":677.9969255201396},"sourceId":null,"tableName":"parametro_maximo_base_se_segmento","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mhDXuf","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":974.061113130285,"y":654.0410348944623},"tableName":"parametro_maximo_base_se_segmento","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_filtro_mes_base_sem_segmento","columnName":"data_max"}]},{"id":"RsMJgU","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":977.0657229856286,"y":779.0488779553305},"tableName":"parametro_maximo_base_se_segmento","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_filtro_mes_base_sem_segmento_mensal","columnName":"data_max"}]}],"edges":[{"id":"eAqNzR","source":"qhWOWw","target":"AKjGOU"},{"id":"WnosJx","type":"manual","label":"","source":"cnNstL","target":"pLCJgY"},{"id":"WkXOrH","source":"pLCJgY","target":"nxXnAl"},{"id":"OZzQwk","source":"cnNstL","target":"qhWOWw"},{"id":"BsGHjF","source":"nzieRN","target":"iwMmPn"},{"id":"XKXlCf","type":"manual","label":"","source":"cnNstL","target":"YUMuSX"},{"id":"zHJKBq","source":"cnNstL","target":"BwvKzg"},{"id":"wkckHS","source":"BwvKzg","target":"nzieRN"},{"id":"GLfNiz","source":"niVDGN","target":"BUMIHB"},{"id":"hUPoyw","source":"BUMIHB","target":"coGPig"},{"id":"RgDCgU","type":"manual","label":"","source":"BwvKzg","target":"BUMIHB"},{"id":"rmooGq","source":"coGPig","target":"yxKBOg"},{"id":"VRkcvO","source":"gceSwx","target":"AzwehI"},{"id":"zZqTOa","source":"AzwehI","target":"EUSomO"},{"id":"eKbscm","source":"EUSomO","target":"mhDXuf"},{"id":"qZzZPy","source":"EUSomO","target":"RsMJgU"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"lQhEjYZufLzDiyqVBcFoSWYwilTnsMnG","flowDescription":"Processo responsável por chamar a API de Insights e configurar os filtros iniciais do dashboard.","locked":"no","created":"2023-05-30 13:34:30","updated":"2023-09-08 09:08:23"},{"flowId":"2886","appId":137,"flowName":"CARGA - Controle de Fluxo","workflow":{"nodes":[{"id":"Dayzuw","type":"flow","appId":137,"label":"Carregar Taxa de Instalação","client":"clickhouse","flowId":"2815","repoId":1,"created":false,"position":{"x":139.5,"y":45}},{"id":"ZxWmNM","type":"flow","appId":137,"label":"Carregar Ajustes Manuais","client":"clickhouse","flowId":"2884","repoId":1,"created":false,"position":{"x":250.5,"y":45}},{"id":"LqjaqZ","type":"flow","appId":137,"label":"Carregar Performance Segmento","client":"clickhouse","flowId":"2952","repoId":1,"created":false,"position":{"x":368.5,"y":45}},{"id":"NAkINr","type":"flow","appId":137,"label":"Forecast TIC/IoT","client":"clickhouse","flowId":"3263","repoId":1,"created":false,"position":{"x":486.5,"y":45}},{"id":"ZcqLib","type":"flow","appId":137,"label":"Carregar Forecast de Venda","client":"clickhouse","flowId":"2414","repoId":1,"created":false,"position":{"x":601.5,"y":45}},{"id":"qpyeCc","type":"flow","appId":137,"label":"Carregar Insights/Filtros","client":"clickhouse","flowId":"2885","repoId":1,"created":false,"position":{"x":731.5,"y":45}},{"id":"oyeFeo","type":"flow","appId":137,"label":"Gerar Base Analy","client":"clickhouse","flowId":"2738","repoId":1,"created":false,"position":{"x":863.9729286557281,"y":46.99852736900374}}],"edges":[{"id":"DHmTVF","type":"manual","label":"","source":"LqjaqZ","target":"NAkINr"},{"id":"dtyqAj","type":"manual","label":"","source":"NAkINr","target":"ZcqLib"},{"id":"IYQBeM","type":"manual","label":"","source":"Dayzuw","target":"ZxWmNM"},{"id":"hXxtIL","type":"manual","label":"","source":"ZcqLib","target":"qpyeCc"},{"id":"MDYpal","type":"manual","label":"","source":"ZxWmNM","target":"LqjaqZ"},{"id":"nxtyFY","type":"manual","label":"","source":"qpyeCc","target":"oyeFeo"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"tddxeSMZeqXxTlpklBulIcPExXODdPmc","flowDescription":"Processo de controle do fluxo de carga do Portal Analytics","locked":"no","created":"2023-05-30 13:40:30","updated":"2023-09-08 09:08:23"},{"flowId":"2940","appId":137,"flowName":"CARGA - Histórico","workflow":{"nodes":[{"id":"EDGElq","type":"fileImport","appId":137,"label":"hard_coded_portal_base.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"ANvOoF","index":false,"decimal":"comma","dataType":"Nullable(Date)","transform":"bestEffortOrNull","columnName":"data_ref","alternativeName":"data_ref"},{"id":"UZzLKj","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"tip_mtc","alternativeName":"tip_mtc"},{"id":"SvCRjz","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"MZlQgM","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_1","alternativeName":"hrq_1"},{"id":"VnQoEu","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_2","alternativeName":"hrq_2"},{"id":"lHxgpx","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_3","alternativeName":"hrq_3"},{"id":"OeKioF","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_lnh_ngc","alternativeName":"dsc_lnh_ngc"},{"id":"wggVBB","index":false,"decimal":"dot","dataType":"Nullable(Int64)","transform":"bestEffortOrNull","columnName":"real","columnLength":2,"alternativeName":"real"}],"created":false,"fileName":"hard_coded_portal_base.csv","position":{"x":-0.7340852973426877,"y":109.77922764080309},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"hard_coded_portal_base","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"Ndadwk","type":"table","appId":137,"label":"hard_coded_portal_base","client":"clickhouse","repoId":1,"created":false,"position":{"x":167.18136188659585,"y":110.6688414612046},"tableName":"hard_coded_portal_base","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dDQQvY","type":"delete","appId":137,"label":"DeletevendaPerdaJanAbril","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"nFCcuF","type":"value","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"mWcOUE","type":"value","andOr":"and","value":["2023-04-01 00:00:00","2023-03-01 00:00:00","2023-02-01 00:00:00","2023-01-01 00:00:00"],"dataType":"Nullable(DateTime)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":10.830894367877264,"y":238.7596544899617},"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","databaseName":"bucket_137","clearMutation":true},{"id":"AbCNqY","type":"delete","appId":137,"label":"Deleteperdampe2022","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"KcSefT","type":"value","andOr":"and","value":["2022-05-01 00:00:00","2022-06-01 00:00:00","2022-07-01 00:00:00","2022-08-01 00:00:00","2022-09-01 00:00:00","2022-10-01 00:00:00","2022-11-01 00:00:00","2022-12-01 00:00:00"],"dataType":"Nullable(DateTime)","operator":"in","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","valueType":"value","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"qcYjpj","type":"value","andOr":"and","value":"Perda de Receita Mensal","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","valueType":"value","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"mnLAez","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":176.96711391101283,"y":237.344207306023},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"DmjDkK","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"hard_coded_portal_base","columnName":"data_ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"segmento","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"hrq_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"hrq_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"hrq_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"hard_coded_portal_base","columnName":"dsc_lnh_ngc","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Int64)","tableName":"hard_coded_portal_base","columnName":"real","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"}]},"created":false,"position":{"x":449.23382112642474,"y":233.6106503505166},"tableName":"hard_coded_portal_base","temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"MsPPrm","type":"sourceRaw","appId":137,"label":"DWADM","query":"WITH\r\n\r\nDIARIO AS (\r\n  SELECT    DAT_DIA_MES_REF AS DATA_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL')  THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          ELSE TIP_MTC\r\n          END AS TIP_MTC\r\n    , DSC_SGM_CLI AS SEGMENTO\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_1\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_2\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_3\r\n    , DSC_LNH_NGC \r\n    , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') <= TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND+NVL(TXA_ITL,0)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') <= TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n    \tELSE VLR_IND END) AS REAL\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n  AND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'BASE DE CLIENTES', 'DADOS FISICOS - BASE', 'CHURN RECEITA', 'DOWNGRADE', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE', 'DADOS FISICOS - MIGRAÇÃO SAINTE')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL')))\r\n  AND DAT_DIA_MES_REF IS NOT NULL\r\n  \r\n  AND TRUNC(DAT_DIA_MES_REF,'MM') >= TO_DATE('20230301','YYYYMMDD')\r\nGROUP BY  DAT_DIA_MES_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          ELSE TIP_MTC\r\n          END\r\n    , DSC_SGM_CLI\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL_2 AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n        \tWHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') <= TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND+NVL(TXA_ITL,0)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230501','YYYYMMDD') <= TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND\r\n    \tELSE VLR_IND END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'CHURN RECEITA', 'DOWNGRADE', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE', 'DADOS FISICOS - MIGRAÇÃO SAINTE')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL')))\r\n\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nONE_PAGE AS (\r\nSELECT O3.IDT_CAD_IND_ONE_PGE,\r\n       O3.NOM_IND,\r\n       O3.DSC_SGM AS SEGMENTO,\r\n       O3.DAT_MES_REF,\r\n       O3.DAT_REF_RGT,\r\n       O3.VLR_RLZ,\r\n       O3.VLR_OCD AS OCD,\r\n       O3.VLR_FCT,\r\n       O3.VLR_OTR,\r\n       O3.DAT_CRG_RGT,\r\n       O3.NOM_JOB_CRG,\r\n       to_date(to_char(O3.MES_REF, 'YYYY')||'-'||to_char(O3.MES_REF, 'MM')||'-1', 'YYYY-MM-DD') as MES_REF\r\nFROM (SELECT *\r\nFROM arthural.IND_ONE_PAGE O\r\nINNER JOIN (SELECT DAT_MES_REF DAT_MES_REF_2,\r\n                   MAX(O2.DAT_REF_RGT) MES_REF\r\n            FROM ARTHURAL.IND_ONE_PAGE O2\r\n            WHERE 1=1\r\n            AND O2.DAT_REF_RGT >= to_date('01/01/2022', 'dd/mm/rrrr')\r\n            GROUP BY DAT_MES_REF) DT ON (O.DAT_REF_RGT = DT.MES_REF)\r\norder by DAT_REF_RGT) O3\r\n\r\n),\r\n\r\nTICKET_MEDIO AS (\r\n\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Ticket Medio' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI <> 'OPERADORAS'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Base de Contratos TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI = 'OPERADORAS'\r\n          AND DSC_LNH_NGC = 'Conectividade'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('DADOS FISICOS - BASE')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n\r\n),\r\n\r\nVENDA_ONE_PAGE AS (\r\nSELECT    MES_REF AS DATA_REF\r\n    , 'Venda Mensal' TIP_MTC\r\n    , SEGMENTO\r\n    , '' HRQ_1\r\n    , '' HRQ_2\r\n    , '' HRQ_3\r\n    , '' DSC_LNH_NGC\r\n    , REAL\r\nFROM (\r\n  SELECT     MES_REF\r\n      , 'CORPORATIVO' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (1) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n    AND SEGMENTO in ('Corporativo')\r\n    AND NOM_IND IN ('Valor de Vendas','Receita Vendas Total')\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'EMPRESARIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (106, 117) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'OPERADORAS' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (35) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'RESIDENCIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (139,497) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  \r\n  GROUP BY MES_REF\r\n)\r\nWHERE 1 = 1\r\n    AND MES_REF < TO_DATE('20230301','YYYYMMDD')\r\n)\r\n\r\n\r\n\r\n\r\nSELECT    DATA_REF\r\n    , TIP_MTC\r\n    , SEGMENTO\r\n    , HRQ_1\r\n    , HRQ_2\r\n    , HRQ_3\r\n    , DSC_LNH_NGC\r\n    , REAL\r\nFROM (\r\nSELECT *\r\nFROM (\r\nSELECT *\r\nFROM (\r\n  SELECT *\r\n  FROM DIARIO\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL_2\r\n  UNION ALL\r\n  SELECT *\r\n  FROM TICKET_MEDIO\r\n\r\n\r\n)\r\nWHERE 1 = 1\r\n    AND (ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM') AND TIP_MTC <> 'Venda Mensal')\r\n     OR  (TIP_MTC = 'Venda Mensal' AND TRUNC(DATA_REF, 'MM') >= TO_DATE('20230301','YYYYMMDD'))\r\n) f      \r\nUNION ALL\r\n  (SELECT *\r\n  FROM VENDA_ONE_PAGE)\r\n)\r\n\r\nWHERE ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM')\r\n    and TRUNC(DATA_REF, 'MM') < TO_DATE('20230501','YYYYMMDD')\r\n\r\n","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":52.9440754976282,"y":401.42737117218473},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"resultTable":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"mELjmn","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":322.6460672187382,"y":401.42737117218473},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"MvQcug","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"THOZkf","type":"value","dataType":"Nullable(DateTime)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"CgsBrt","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"SZDHFj","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"UsoVNe","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"dPJdRE","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"geXIrm","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"MuzRqD","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"vzwjVp","type":"value","dataType":"Nullable(Float64)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":539.8755083695014,"y":396.260447002716},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO_HIST","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO_HIST","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"AcSYjj","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_HIST","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":772.5679613245891,"y":396.4376396666646},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_HIST","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"BRftOe","source":"mELjmn","target":"MvQcug"},{"id":"WXiXoE","source":"MvQcug","target":"AcSYjj"},{"id":"ifilpg","type":"manual","label":"","source":"EDGElq","target":"DmjDkK"},{"id":"uSahZE","source":"Ndadwk","target":"DmjDkK"},{"id":"uJrJMW","type":"manual","label":"","source":"dDQQvY","target":"AbCNqY"},{"id":"uDxkDX","source":"EDGElq","target":"Ndadwk"},{"id":"lVtqdi","type":"manual","label":"","source":"AbCNqY","target":"DmjDkK"},{"id":"EIPVTN","source":"MsPPrm","target":"mELjmn"},{"id":"kPfscr","source":"dDQQvY","target":"mELjmn"},{"id":"WOrggG","source":"AbCNqY","target":"mELjmn"},{"id":"VWgMlT","source":"DmjDkK","target":"mELjmn"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"_qflZIPdXvvzFFSE_RUdOcrSHTgPRZdx","flowDescription":"Processo responsável por ajustes nos números do Portal, e armazenamento de seu histórico.","locked":"no","created":"2023-05-31 13:32:53","updated":"2023-09-08 09:08:23"},{"flowId":"2941","appId":137,"flowName":"CARGA - Ajuste Manual Diário","workflow":{"nodes":[{"id":"SkYqeR","type":"table","appId":137,"label":"hard_coded_diario","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":244.5,"y":149},"tableName":"hard_coded_diario","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"TwVFhj","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_VALIDACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":244.5,"y":33},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"KNixJp","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO_VALIDACAO","id":"rnbwAg","to":"hard_coded_diario","raw":"","list":[{"id":"HbWQOz","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableTo":"hard_coded_diario","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"utJtYT","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableTo":"hard_coded_diario","columnBy":"SEGMENTO","columnTo":"segmento_cliente","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"nYkqHi","type":"computed","alias":"mes_ref","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"mes_ref","computedId":"oTgVVh"},{"id":"LbbpJn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"dDDxfs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"Osqrun","type":"computed","alias":"mes_ref","andOr":"and","value":"toStartOfMonth(today())","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","operator":"=","fieldType":"computed","valueType":"computed","columnName":"mes_ref","computedId":"oTgVVh","extraValue":""}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"nZgtJX","type":"computed","alias":"mes_ref","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","distinct":false,"columnName":"mes_ref","computedId":"oTgVVh"},{"id":"hpRTyL","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"dDDxfs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"nKbYWX","type":"computed","alias":"FATOR","content":"CASE\nwhen MAX(valor_referencia) > 0 then MAX(valor_referencia)/SUM(REAL)\nelse 1 end","dataType":"Nullable(Float64)","distinct":false,"columnName":"FATOR","computedId":"QEVdyO","columnLength":8}],"update":[],"computed":[{"type":"computed","alias":"mes_ref","content":"toStartOfMonth(DATA_REF)","dataType":"Nullable(Date)","columnName":"mes_ref","computedId":"oTgVVh"},{"type":"computed","alias":"FATOR","content":"CASE\nwhen MAX(valor_referencia) > 0 then MAX(valor_referencia)/SUM(REAL)\nelse 1 end","dataType":"Nullable(Float64)","columnName":"FATOR","computedId":"QEVdyO","columnLength":8}]},"created":false,"optimize":false,"position":{"x":441,"y":139},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"TABELA_FATOR_DIARIO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"qcHPEK","type":"table","appId":137,"label":"TABELA_FATOR_DIARIO","client":"clickhouse","repoId":1,"shared":false,"position":{"x":592.5,"y":139},"sourceId":7,"tableName":"TABELA_FATOR_DIARIO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"zJMqfK","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO_VALIDACAO","id":"TTMkjK","to":"TABELA_FATOR_DIARIO","raw":"","list":[{"id":"zRrnpd","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableTo":"TABELA_FATOR_DIARIO","columnBy":"TIP_MTC","columnTo":"TIP_MTC","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"YstPzJ","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableTo":"TABELA_FATOR_DIARIO","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"XflljL","type":"value","dataType":"Nullable(DateTime)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"IxHjxb","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"tIMzGJ","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"ZNIydL","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"JYnuJj","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"GRSIDP","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"cGYzEA","type":"value","dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"GUfbWn","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"LrdSSD","type":"computed","alias":"REAL_AJD","content":"case\nwhen toStartOfMonth(today()) = toStartOfMonth(DATA_REF) then REAL*FATOR\nelse REAL\nend","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_AJD","computedId":"qssQPw","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"REAL_AJD","content":"case\nwhen toStartOfMonth(today()) = toStartOfMonth(DATA_REF) then REAL*FATOR\nelse REAL\nend","dataType":"Nullable(Float64)","columnName":"REAL_AJD","computedId":"qssQPw","columnLength":2}]},"created":false,"optimize":false,"position":{"x":744,"y":91},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO_AJUSTADO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"XQGciE","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_AJUSTADO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":938,"y":91},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO_AJUSTADO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"QWFYvM","source":"qcHPEK","target":"zJMqfK"},{"id":"hKyKVc","source":"zJMqfK","target":"XQGciE"},{"id":"IQCEns","source":"TwVFhj","target":"zJMqfK"},{"id":"GJgjGZ","source":"TwVFhj","target":"KNixJp"},{"id":"GwqIiO","source":"SkYqeR","target":"KNixJp"},{"id":"jRHlXx","source":"KNixJp","target":"qcHPEK"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"AoBUZmzwBejVaFiUWkYEDwKxrUJqRddv","flowDescription":"Processo para efetuar ajustes diários quando necessário","locked":null,"created":"2023-05-31 13:45:39","updated":"2023-09-08 09:08:23"},{"flowId":"2952","appId":137,"flowName":"CARGA - Perfomance por Segmento","workflow":{"nodes":[{"id":"qFWkGG","type":"table","appId":137,"label":"perfomance_segmento_real","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":74.9974891097878,"y":93.0012549690771},"sourceId":null,"tableName":"perfomance_segmento_real","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SvBhIL","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(Date)","tableName":"perfomance_segmento_real","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_real","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_real","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_real","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_real","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_real","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"perfomance_segmento_real","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"perfomance_segmento_real","columnName":"REAL","columnLength":14,"databaseName":"bucket_137","targetColumn":"REAL"}]},"shared":false,"created":false,"position":{"x":214.9979294319308,"y":93.00138037871282},"sourceId":null,"tableName":"perfomance_segmento_real","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"AWHJaB","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":411,"y":91},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"MhUfXT","source":"qFWkGG","target":"SvBhIL"},{"id":"movtlY","source":"SvBhIL","target":"AWHJaB"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"faJzueqsIBHE_leHpGmXSRlEzfZRPxG_","flowDescription":"-Resultados EBIT,EBTIDA etc...","locked":null,"created":"2023-06-01 14:16:40","updated":"2023-09-08 09:08:23"},{"flowId":"2960","appId":137,"flowName":"FECHAMENTO ACIONA TRIGGER","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"koSeiU","url":"https://graph.microsoft.com/v1.0/users/{{id_final}}/teamwork/installedApps","body":"{\r\n   \"teamsApp@odata.bind\":\"https://graph.microsoft.com/v1.0/appCatalogs/teamsApps/0c249069-a50a-4aea-b247-f3bedf048bca\"\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"Authorization","value":"Bearer {{get_token}}"}],"options":{},"timeout":0,"position":{"x":177.99919225742022,"y":96.0021295031649},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":false},{"id":"OoRddn","url":"https://smba.trafficmanager.net/emea/v3/conversations/19:{{id_final}}_26e8b898-c240-44ca-bfdb-baae3b03ece7@unq.gbl.spaces/activities","body":"{\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n                 \r\n                 \r\n                 {\r\n                     \"type\": \"TextBlock\",\r\n                     \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n                     \"wrap\": true,\r\n                     \"weight\": \"Bolder\",\r\n                     \"size\": \"Medium\"\r\n                 },\r\n                 {\r\n                     \"type\": \"TextBlock\",\r\n                     \"text\": \"Em decorrência de instabilidades no DW nesta manhã, houve atraso no processamento das informações D-1, por isso excepcionalmente hoje, a disponibilização de resultados no Portal Analytics será realizada no período da tarde.\",\r\n                     \"wrap\": true,\r\n                     \"spacing\": \"Large\",\r\n                     \"separator\": true\r\n                 }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"Authorization","value":"Bearer {{token_bot}}"}],"options":{},"timeout":0,"position":{"x":283,"y":33},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":false}],"edges":[{"id":"LoMjfX","source":"FwxqMi","target":"koSeiU"},{"id":"yjQJjb","source":"FwxqMi","target":"OoRddn"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS FECHAMENTO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"XmSYizZjPUYRmvwrXTpEPDEQrPZpMMfq","flowDescription":"","locked":"no","created":"2023-06-02 09:58:49","updated":"2023-09-08 09:08:23"},{"flowId":"2977","appId":137,"flowName":"FLUXO TRIGGER SEM R$ MIL","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":3239.5,"y":137},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LnBEJC","type":"delete","appId":137,"label":"Delete","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"DpqzqP","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"=","tableName":"forecast_insight","valueType":"value","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":230.03659913049188,"y":393.99085021737704},"sourceId":null,"tableName":"forecast_insight","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"fdKOxs","type":"table","appId":137,"label":"base_forecast_highlight_TIC","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":81.5,"y":494},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sEQoRn","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AlQsdT","type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"TIP_MTC","computedId":"qshwvi"},{"id":"lRtzXo","type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","distinct":false,"columnName":"DATA_REF","computedId":"iWYrna"},{"id":"aFrAFl","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"id":"bXBrAl","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jYggoS"},{"id":"lCarqE","type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"qnOpbK"},{"id":"HPXCud","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"eAFaTy","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137"},{"id":"jUfBpb","type":"value","dataType":"Nullable(Float64)","tableName":"base_forecast_highlight_TIC","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"TIP_MTC","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"TIP_MTC","computedId":"qshwvi"},{"type":"computed","alias":"DATA_REF","content":"toStartOfMonth(today())","dataType":"Nullable(DateTime)","columnName":"DATA_REF","computedId":"iWYrna"},{"type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"qnOpbK"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"KXsmgm"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jYggoS"}]},"created":false,"optimize":false,"position":{"x":240,"y":494},"sourceId":null,"tableName":"base_forecast_highlight_TIC","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"TIC_ANALY_AUX","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"WvsCVc","type":"table","appId":137,"label":"TIC_ANALY_AUX","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":370,"y":494},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NYElQD","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TIC_ANALY_AUX","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"orcado"}]},"shared":false,"created":false,"position":{"x":492.00235280124593,"y":436.9963400869508},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"forecast_insight","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"vNMXcv","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":661,"y":386},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BbkjnJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AOLjea","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"UQwPFw"},{"id":"YkXRWa","type":"value","alias":"sgm","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QgrZoa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"UQwPFw"}]},"created":false,"optimize":false,"position":{"x":845,"y":386},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BQRWpp","type":"table","appId":137,"label":"tmp_forecast_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1005,"y":565},"sourceId":null,"tableName":"tmp_forecast_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RRoyis","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1159.5,"y":239},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YuYuwK","type":"group","label":"Parallel","created":false,"position":{"x":845,"y":311.5}},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":661,"y":230},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FMbcyi","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":661,"y":114},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rBtgRI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"rVTZKe","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"Tqywwc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"NaKfBI","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"QhJqUi","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"VDNaMT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"flfZhL","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"jpOUjw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gFehbn","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BJGcRN","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"gymQoD","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebqPuN","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zxtcQs","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"kIXayp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"WYGlTN","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"AADvRI","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QhBDxG","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"hesRBK","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jxOlCh"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}]},"created":false,"optimize":false,"position":{"x":845,"y":216},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"jgaznh","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(DateTime)","tableName":"TIC_ANALY_AUX","columnName":"DATA_REF","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137","targetColumn":"Mes_Ref_Visual"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"Mes_Ref"},{"dataType":"Nullable(String)","tableName":"TIC_ANALY_AUX","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"FORECAST","columnLength":2,"databaseName":"bucket_137","targetColumn":"none"},{"dataType":"Nullable(Float64)","tableName":"TIC_ANALY_AUX","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"}]},"shared":false,"created":false,"position":{"x":1005,"y":443},"sourceId":null,"tableName":"TIC_ANALY_AUX","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"RlloqT","type":"table","appId":137,"label":"tmp_alerta_aux","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1159.5,"y":355},"sourceId":null,"tableName":"tmp_alerta_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_alerta_aux","id":"thRAEV","to":"tmp_forecast_alerta","raw":"","list":[{"id":"PAjsVb","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"lWkUve","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"SEGMENTO","columnTo":"sgm","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_alerta_aux","id":"iHPXzk","to":"teste_mail","raw":"","list":[{"id":"aqWATR","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"SEGMENTO","columnTo":"visao","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SHQxUQ","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qMXQWm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CPlPjP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Gtaiff","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"wdPKUm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SjNjTc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rxeDEX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"GGtaWk","type":"value","andOr":"and","value":"1","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"ativo","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MWBkFX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CdkxNl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"llTcdN","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"kFSItW","type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","distinct":false,"columnName":"teste","computedId":"gAYpmL"},{"id":"WObqMW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"tOvMBM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rmluuw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"mensagem","content":"concat(\n\nconcat(concat(concat('Olá ' ,  max(nome)), ', espero que esteja tudo bem!\\n'),\n\n\n' Segue resumo dos indicadores d-1 dos segmentos')\n,\ntoString(sum(REAL) over (partition by email))\n\n\n)","dataType":"Nullable(String)","columnName":"mensagem","computedId":"CrdTAV"},{"type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","columnName":"teste","computedId":"gAYpmL"},{"type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\n    when SEGMENTO = 'TIC/IoT' THEN 'TIC + IoT'\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"PBipBh"}]},"created":false,"position":{"x":1288.5,"y":331},"sourceId":null,"tableName":"tmp_alerta_aux","sourceType":"bucket","resultTable":"tmp_aux_sgm_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"mvskWg","type":"table","appId":137,"label":"app_analy_info","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2067.5,"y":103},"sourceId":null,"tableName":"app_analy_info","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SRINxy","url":"https://login.microsoftonline.com/aed466c0-de70-4cf7-9e10-5ea1f9a696f4/oauth2/token","body":"{\"grant_type\": \"{{grant_type}}\",\r\n\"client_id\": \"{{client_id}}\",\r\n\"client_secret\": \"{{client_secret}}\",\r\n\"resource\": \"https://graph.microsoft.com/\"\r\n}","type":"rest","appId":137,"label":"Tarefa","client":"clickhouse","flowId":"2977","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/x-www-form-urlencoded"}],"options":{},"timeout":0,"position":{"x":2185,"y":39},"restType":"rest","tableName":"app_analy_info","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"AnalyToken","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":true},{"id":"aANSCa","type":"table","appId":137,"label":"AnalyToken","client":"clickhouse","repoId":1,"created":false,"position":{"x":2291.5,"y":39},"tableName":"AnalyToken","sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZPFtkr","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":2430.5,"y":39},"tableName":"AnalyToken","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"token_graph","columnName":"access_token"}]},{"id":"WLTLOw","url":"https://login.microsoftonline.com/botframework.com/oauth2/v2.0/token","body":"{\"grant_type\": \"{{grant_type}}\",\r\n\"client_id\": \"{{client_id}}\",\r\n\"client_secret\": \"{{client_secret}}\",\r\n\"scope\": \"https://api.botframework.com/.default\"\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2977","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/x-www-form-urlencoded"}],"options":{},"timeout":0,"position":{"x":2185,"y":167},"restType":"rest","tableName":"app_analy_info","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"token_bot","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":true},{"id":"GlfBLs","type":"table","appId":137,"label":"token_bot","client":"clickhouse","repoId":1,"created":false,"position":{"x":2291.5,"y":167},"tableName":"token_bot","sourceType":"bucket","databaseName":"bucket_137"},{"id":"KOhmsS","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":2430.5,"y":167},"tableName":"token_bot","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"token_bot","columnName":"access_token"}]},{"id":"pJkPzF","type":"delete","appId":137,"label":"Delete","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"QEMawC","type":"value","andOr":"and","dataType":"Nullable(String)","operator":"isNull","tableName":"tmp_aux_sgm_alerta","valueType":"value","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":2067.5,"y":287},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"MybeVZ","type":"table","appId":137,"label":"tmp_event_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2702.5,"y":219},"sourceId":null,"tableName":"tmp_event_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JQyDpi","type":"table","appId":137,"label":"tmp_envio_alerta2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":2430.5,"y":355},"sourceId":null,"tableName":"tmp_envio_alerta2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EivOtX","type":"table","appId":137,"label":"tmp_aux_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1793,"y":287},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"PBrISI","type":"table","appId":137,"label":"ResultadoIDTEAMS","client":"clickhouse","repoId":1,"created":false,"position":{"x":2961.5,"y":171},"tableName":"ResultadoIDTEAMS","sourceType":"bucket","databaseName":"bucket_137"},{"id":"bsYYiW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"MnoewF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"heXpKp","type":"value","andOr":"and","value":"TIC/IoT","dataType":"Nullable(String)","operator":"!=","fieldType":"value","tableName":"tmp_aux_sgm_alerta","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"oOaOFx","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"kxREQG","type":"sum","alias":"ORCADO_TRATADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"oefYrH","type":"sum","alias":"FORECAST_VENDA","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"oEcCxS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1562.9568653104916,"y":555.9322916085899},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Notrgp","type":"table","appId":137,"label":"tmp_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1698.7681787049603,"y":709.8918259917683},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYcLht","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"nome","columnLength":2,"databaseName":"bucket_137","targetColumn":"nome"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"email","columnLength":2,"databaseName":"bucket_137","targetColumn":"email"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_consolidado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137","targetColumn":"flag_de_acesso"}]},"shared":false,"created":false,"position":{"x":1815.521183538523,"y":579.8782293889449},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_sgm_alerta","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"tbILex","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"fxkzhn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"moralI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"gCNWfH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"tYkDIL","type":"computed","alias":"id_analy","content":"'1'","dataType":"Nullable(String)","distinct":false,"columnName":"id_analy","computedId":"sxdxbM"},{"id":"xaduop","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"VKXQId","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"XuPLsY","type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_vnd","computedId":"SWihKb"},{"id":"EbDuNz","type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"id":"SrThPF","type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ope_vnd","computedId":"sbovSd"},{"id":"brygbH","type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_vnd","computedId":"uUVxiO"},{"id":"OEpoMi","type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_prd","computedId":"zsMWkr"},{"id":"mlZHKR","type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_prd","computedId":"GwZUwh"},{"id":"WqsERO","type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ata_prd","computedId":"ynBIlB"},{"id":"byIouZ","type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_prd","computedId":"btTuhJ"},{"id":"ylzexC","type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',\r\n    toString(round(FORECAST_VENDA/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"id":"ZjFMKB","type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal'  THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_prd","computedId":"MmOWIX"},{"id":"BrUIbf","type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"},{"id":"NOJsmA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_vnd","computedId":"SWihKb"},{"type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ope_vnd","computedId":"sbovSd"},{"type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_vnd","computedId":"uUVxiO"},{"type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_prd","computedId":"zsMWkr"},{"type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_prd","computedId":"GwZUwh"},{"type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ata_prd","computedId":"ynBIlB"},{"type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_prd","computedId":"btTuhJ"},{"type":"computed","alias":"id_analy","content":"'1'","dataType":"Nullable(String)","columnName":"id_analy","computedId":"sxdxbM"},{"type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',\r\n    toString(round(FORECAST_VENDA/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal'  THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","columnName":"msg_csl_prd","computedId":"MmOWIX"},{"type":"computed","alias":"msg_csl_vnd_tic_iot","content":"max(case when SEGMENTO = 'TIC/IoT' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','Forecast: ',toString(round(FORECAST_VENDA/1000,0)),' | ','% Orçado: ',toString(round((FORECAST_VENDA/ORCADO_TRATADO)*100,0)),'% (forecast x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_csl_vnd_tic_iot","computedId":"JTOYzR"}]},"created":false,"optimize":false,"position":{"x":1942.9986928881967,"y":410.9675836272786},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_envio_alerta2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eIfxFA","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_envio_alerta2","id":"ByfGWZ","to":"app_analy_info","raw":"","list":[{"id":"jRXLXL","andOr":"and","tableBy":"tmp_envio_alerta2","tableTo":"app_analy_info","columnBy":"id_analy","columnTo":"id","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"GZNcXv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"id_analy","columnLength":null,"databaseName":"bucket_137"},{"id":"MhlwYJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"app_analy_info","columnName":"id","columnLength":null,"databaseName":"bucket_137"},{"id":"HsZyOf","type":"value","dataType":"Nullable(String)","tableName":"tmp_envio_alerta2","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"qarnEB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"TPKGGh","type":"computed","alias":"get_token","content":"'{{token_graph}}'","dataType":"Nullable(String)","distinct":false,"columnName":"get_token","computedId":"msBDBx"},{"id":"kWAyCy","type":"computed","alias":"token_bot","content":"'{{token_bot}}'","dataType":"Nullable(String)","distinct":false,"columnName":"token_bot","computedId":"elTEhL"},{"id":"mAVSMI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"VXeKwg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"YoyzmU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QmDHRT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QOvgsw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"lBQcWl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"NNfFtk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"KliiCW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"BqCTYu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"BswCGS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"SStZJP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GlbFXi","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"id_analy","columnLength":null,"databaseName":"bucket_137"},{"id":"KhBwtD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"app_analy_info","columnName":"id","columnLength":null,"databaseName":"bucket_137"},{"id":"ahaMHO","type":"value","dataType":"Nullable(String)","tableName":"tmp_envio_alerta2","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"smcnvp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"JcEers","type":"computed","alias":"get_token","content":"'{{token_graph}}'","dataType":"Nullable(String)","distinct":false,"columnName":"get_token","computedId":"msBDBx"},{"id":"WHHyIb","type":"computed","alias":"token_bot","content":"'{{token_bot}}'","dataType":"Nullable(String)","distinct":false,"columnName":"token_bot","computedId":"elTEhL"},{"id":"mAVSMI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"VXeKwg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"YoyzmU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QmDHRT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QOvgsw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"lBQcWl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"NNfFtk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"KliiCW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"BqCTYu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"BswCGS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"CFcREb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"get_token","content":"'{{token_graph}}'","dataType":"Nullable(String)","columnName":"get_token","computedId":"msBDBx"},{"type":"computed","alias":"token_bot","content":"'{{token_bot}}'","dataType":"Nullable(String)","columnName":"token_bot","computedId":"elTEhL"}]},"created":false,"position":{"x":2565.5,"y":103},"sourceId":null,"tableName":"tmp_envio_alerta2","sourceType":"bucket","resultTable":"tmp_event_trigger2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ctrzYv","url":"https://graph.microsoft.com/v1.0/users/{{email}}","body":"{ \"property\": \"{{column_name}}\" }","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2977","method":"GET","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"Authorization","value":"Bearer {{get_token}}"}],"options":{},"timeout":0,"position":{"x":2831,"y":103},"restType":"rest","tableName":"tmp_event_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"ResultadoIDTEAMS","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":true},{"id":"SSvVPI","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_event_trigger2","id":"kVzUvs","to":"ResultadoIDTEAMS","raw":"","list":[{"id":"VtwSTT","andOr":"and","tableBy":"tmp_event_trigger2","tableTo":"ResultadoIDTEAMS","columnBy":"email","columnTo":"mail","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"IgkNfJ","type":"value","alias":"id_final","dataType":"Nullable(String)","distinct":false,"tableName":"ResultadoIDTEAMS","columnName":"id","columnLength":null,"databaseName":"bucket_137"},{"id":"WfcfbN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"uZuhio","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"LYhNPE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"get_token","columnLength":null,"databaseName":"bucket_137"},{"id":"LSlWJY","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"token_bot","columnLength":null,"databaseName":"bucket_137"},{"id":"QGoCql","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"EpoDqM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"kbwxNG","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"CGSaKn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"hYLupJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"uyEJmA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"pAUJeB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"AZdgAZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"bwFNBF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"ByYxkn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"WZMpEA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_csl_vnd_tic_iot","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"ola","content":"concat('Olá ', nome, ', espero que esteja Tudo bem!')","dataType":"Nullable(String)","columnName":"ola","computedId":"Swrgvm"}]},"created":false,"position":{"x":3100.5,"y":137},"sourceId":null,"tableName":"tmp_event_trigger2","sourceType":"bucket","resultTable":"tmp_get_id_trigger2","bucketClient":"clickhouse","databaseName":"bucket_137"}],"edges":[{"id":"wDVTXb","type":"manual","label":"","source":"rBtgRI","target":"jgaznh"},{"id":"uzICWL","type":"manual","label":"","source":"pJkPzF","target":"WLTLOw"},{"id":"RAvdFO","type":"manual","label":"","source":"eIfxFA","target":"ctrzYv"},{"id":"klqais","type":"manual","label":"","source":"ctrzYv","target":"SSvVPI"},{"id":"qnVCiH","type":"manual","label":"","source":"KOhmsS","target":"eIfxFA"},{"id":"PVasYr","type":"manual","label":"","source":"ZPFtkr","target":"eIfxFA"},{"id":"riXkgj","source":"MybeVZ","target":"ctrzYv"},{"id":"WvGaVP","source":"mvskWg","target":"SRINxy"},{"id":"RdFyBc","source":"WLTLOw","target":"GlfBLs"},{"id":"ZnRWUR","source":"mvskWg","target":"WLTLOw"},{"id":"VlDixP","source":"SRINxy","target":"aANSCa"},{"id":"OIDoSo","source":"ctrzYv","target":"PBrISI"},{"id":"kceSsP","source":"aANSCa","target":"ZPFtkr"},{"id":"WaKVYb","source":"GlfBLs","target":"KOhmsS"},{"id":"uKbXYa","source":"Notrgp","target":"DYcLht"},{"id":"xkpQym","source":"pJkPzF","target":"EivOtX"},{"id":"IZZMsh","source":"vNMXcv","target":"BbkjnJ"},{"id":"HvmKmO","source":"BbkjnJ","target":"BQRWpp"},{"id":"MMERfX","type":"manual","label":"","source":"pJkPzF","target":"SRINxy"},{"id":"DsQbEz","type":"manual","label":"","source":"tbILex","target":"pJkPzF"},{"id":"FUecMR","type":"manual","label":"","source":"kSIbMZ","target":"bsYYiW"},{"id":"dWybmx","type":"manual","label":"","source":"bsYYiW","target":"DYcLht"},{"id":"ZUpqGD","source":"DYcLht","target":"EivOtX"},{"id":"kaSjGb","source":"FMbcyi","target":"rBtgRI"},{"id":"vGYyoy","source":"ustfRF","target":"rBtgRI"},{"id":"YvsHIs","source":"rBtgRI","target":"RlloqT"},{"id":"OaLsSz","source":"WvsCVc","target":"NYElQD"},{"id":"UVfeWb","source":"NYElQD","target":"vNMXcv"},{"id":"VXHsiO","source":"LnBEJC","target":"vNMXcv"},{"id":"KMMNNV","source":"WvsCVc","target":"jgaznh"},{"id":"MZLOVu","source":"fdKOxs","target":"sEQoRn"},{"id":"OYBuIx","source":"sEQoRn","target":"WvsCVc"},{"id":"zvmuND","source":"jgaznh","target":"RlloqT"},{"id":"CGAKjO","source":"EivOtX","target":"bsYYiW"},{"id":"dbHQCz","source":"bsYYiW","target":"Notrgp"},{"id":"uSBAkV","source":"EivOtX","target":"tbILex"},{"id":"xrEAVg","source":"tbILex","target":"JQyDpi"},{"id":"eHBnrK","source":"JQyDpi","target":"eIfxFA"},{"id":"ymGfmZ","source":"mvskWg","target":"eIfxFA"},{"id":"urqJur","source":"eIfxFA","target":"MybeVZ"},{"id":"cGHvwN","source":"MybeVZ","target":"SSvVPI"},{"id":"KPxTnA","source":"PBrISI","target":"SSvVPI"},{"id":"WangdF","source":"SSvVPI","target":"FwxqMi"},{"id":"WEaGhS","source":"kSIbMZ","target":"EivOtX"},{"id":"eQyalP","source":"RlloqT","target":"kSIbMZ"},{"id":"GnKWYD","source":"BQRWpp","target":"kSIbMZ"},{"id":"HKgoCZ","source":"RRoyis","target":"kSIbMZ"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"tUyp_NbdSxbXvYzWotKlbXoBQmNGCDUM","flowDescription":"","locked":"no","created":"2023-06-04 18:48:45","updated":"2023-09-08 09:08:23"},{"flowId":"3113","appId":137,"flowName":"TesteAutoML - Previsão MPE","workflow":{"nodes":[{"id":"awFTRN","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":118.0077078132996,"y":-330.9852423574629},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sXKZyu","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"gtYHNe","type":"value","alias":"DATA","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"wtYPXe","type":"value","alias":"PRODUTO","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"XsfExd","type":"value","alias":"PRODUTO","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"jwqefP","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"Mqwbeq","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"VAUCJw","type":"value","andOr":"and","value":"2023-06-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"XsfExd","type":"value","alias":"PRODUTO","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"WwewLk","type":"sum","alias":"VENDA","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":271.00573386111313,"y":-329.98527369003733},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_modelo_mpe_venda_forecast","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"kQzaNG","type":"table","appId":137,"label":"tmp_teste_modelo_mpe_venda_forecast","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":452.00288259684373,"y":-327.985336355186},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"yulVFJ","type":"scoring","appId":137,"label":"Score: tmp_teste_modelo_mpe_venda_forecast","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":169,"position":{"x":689.9954254441393,"y":-327.985336355186},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_tmp_teste_modelo_mpe_venda_forecast","databaseName":"bucket_137"},{"id":"kAJcMk","type":"table","appId":137,"label":"score_tmp_teste_modelo_mpe_venda_forecast","client":"clickhouse","repoId":1,"created":false,"position":{"x":929.9708607058188,"y":-329.98966025045166},"tableName":"score_tmp_teste_modelo_mpe_venda_forecast","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RnyLVB","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"gtYHNe","type":"value","alias":"DATA","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"jwqefP","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"Mqwbeq","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"VAUCJw","type":"value","andOr":"and","value":"2023-05-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"WwewLk","type":"sum","alias":"VENDA","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":259.00610985200575,"y":-541.9778478699071},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_modelo_mpe_venda_forecast_data","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oYgsgg","type":"table","appId":137,"label":"tmp_teste_modelo_mpe_venda_forecast_data","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":423.00379124150106,"y":-541.9778478699071},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_data","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NkAyPq","type":"scoring","appId":137,"label":"Score: tmp_teste_modelo_mpe_venda_forecast_data","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":169,"position":{"x":673.9959267653294,"y":-540.9778792024815},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_data","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_tmp_teste_modelo_mpe_venda_forecast_data","databaseName":"bucket_137"},{"id":"OvvXYK","type":"table","appId":137,"label":"score_tmp_teste_modelo_mpe_venda_forecast_data","client":"clickhouse","repoId":1,"created":false,"position":{"x":984.9691374142274,"y":-539.98308040983},"tableName":"score_tmp_teste_modelo_mpe_venda_forecast_data","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UlRLwe","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\n\r\nMENSAL AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'MM') AS DATA\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230531','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'MM')\r\n),\r\n\r\nDIARIO AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'DD') AS DATA\r\n\t\t, DSC_LNH_NGC AS PRODUTO\r\n\t\t, DSC_REG_ITL AS REGIONAL\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230531','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\nORDER BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\n)\r\n\r\nSELECT D.*, M.VENDA AS FINAL\r\nFROM DIARIO D\r\nINNER JOIN MENSAL M\r\n\tON (TRUNC(D.DATA, 'MM') = M.DATA)","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":22,"y":33},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"TABELA_TREINO_ML_PREVISAO_MPE","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"mkIPWH","type":"table","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":209.5,"y":33},"sourceId":7,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IsuRdT","type":"automl","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"created":false,"position":{"x":490.5,"y":33},"settings":{"seed":7,"maxModels":999,"projectId":"IsuRdT","splitFrame":0.7,"projectName":"project_IsuRdT","reloadSource":true,"removeColumns":[],"trainingFrame":"TABELA_TREINO_ML_PREVISAO_MPE","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","sourceType":"bucket","databaseName":"bucket_137"},{"id":"FfkeIZ","type":"automlReport","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"created":false,"position":{"x":771.5,"y":33},"settings":{"seed":7,"maxModels":999,"projectId":"IsuRdT","splitFrame":0.7,"projectName":"project_IsuRdT","reloadSource":true,"removeColumns":[],"trainingFrame":"TABELA_TREINO_ML_PREVISAO_MPE","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","sourceType":"bucket","databaseName":"bucket_137"},{"id":"SqQuWB","type":"scoring","appId":137,"label":"Score: TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":169,"position":{"x":207.5000626651487,"y":174.99555077443682},"sourceId":7,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_TABELA_TREINO_ML_PREVISAO_MPE","databaseName":"bucket_137"},{"id":"ZHBhIV","type":"table","appId":137,"label":"score_TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"created":false,"position":{"x":207.99348282452712,"y":309.9902869019395},"tableName":"score_TABELA_TREINO_ML_PREVISAO_MPE","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"DMcVhA","source":"yulVFJ","target":"kAJcMk"},{"id":"oTYwlN","source":"UlRLwe","target":"mkIPWH"},{"id":"xgPyFs","source":"mkIPWH","target":"IsuRdT"},{"id":"lYtcwg","source":"IsuRdT","target":"FfkeIZ"},{"id":"SPGEzP","source":"mkIPWH","target":"SqQuWB"},{"id":"AoLMJg","source":"SqQuWB","target":"ZHBhIV"},{"id":"zRzUdI","source":"awFTRN","target":"sXKZyu"},{"id":"YVizRh","source":"sXKZyu","target":"kQzaNG"},{"id":"yDztvG","source":"kQzaNG","target":"yulVFJ"},{"id":"Pnvzja","source":"oYgsgg","target":"NkAyPq"},{"id":"sqteuW","source":"NkAyPq","target":"OvvXYK"},{"id":"DsULPO","source":"awFTRN","target":"RnyLVB"},{"id":"yIzUqn","source":"RnyLVB","target":"oYgsgg"}]},"cron":null,"options":{"reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":99,"flowStart":1,"flowType":"dataPrep","flowKey":"TSxSAiFYxwiRXHPDnduoHTGVmexfYDYc","flowDescription":"","locked":"no","created":"2023-06-21 17:13:47","updated":"2023-09-08 09:08:23"},{"flowId":"3120","appId":137,"flowName":"Previsão MPE - v5","workflow":{"nodes":[{"id":"awFTRN","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":59.00955643518857,"y":-540.9786625168413},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UlRLwe","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\nDIA_UTIL AS (\r\n\r\nselect TAB.DATA,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'DD') AS DATA,\r\n             DSC_DIA_SMN_ABV\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n        and TRUNC(A.dat_dia, 'MM') >= TO_DATE('20230101','YYYYMMDD')\r\n        and TRUNC(A.dat_dia, 'MM') <= SYSDATE\r\n      GROUP BY TRUNC(DAT_DIA,'DD'), DSC_DIA_SMN_ABV) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'DD') = tab.DATA\r\nGROUP BY TAB.DATA\r\nORDER BY TAB.DATA\r\n),\r\n\r\nMENSAL AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'MM') AS DATA\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230531','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'MM')\r\n),\r\n\r\nDIA_UTIL_MENSAL AS (\r\n\r\nselect TRUNC(TAB.DATA,'MM') AS DATA,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'DD') AS DATA,\r\n             DSC_DIA_SMN_ABV\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n        and TRUNC(A.dat_dia, 'MM') >= TO_DATE('20230101','YYYYMMDD')\r\n        and TRUNC(A.dat_dia, 'MM') <= SYSDATE\r\n      GROUP BY TRUNC(DAT_DIA,'DD'), DSC_DIA_SMN_ABV) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'DD') = tab.DATA\r\nGROUP BY TRUNC(TAB.DATA,'MM')\r\nORDER BY TRUNC(TAB.DATA,'MM')\r\n),\r\n\r\nMENSAL AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'MM') AS DATA\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230531','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'MM')\r\n),\r\n\r\nDIARIO AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'DD') AS DATA\r\n\t\t, DSC_LNH_NGC AS PRODUTO\r\n\t\t, DSC_REG_ITL AS REGIONAL\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230531','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\nORDER BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\n)\r\n\r\nSELECT D.DATA AS DATA\r\n, SUM(DU.QTD) OVER (PARTITION BY EXTRACT(MONTH FROM DU.DATA) order BY DU.DATA rows between unbounded preceding and current ROW) AS DIAS_ATUAL\r\n, sum(D.VENDA) AS VENDA\r\n, DUM.QTD AS DIAS_TOTAIS\r\n, SUM(SUM(D.VENDA)) over(PARTITION BY  EXTRACT(MONTH FROM D.DATA) order BY D.DATA rows between unbounded preceding and current ROW) AS VENDA_ACU\r\n, MAX(M.VENDA) AS FINAL\r\nFROM DIARIO D\r\nINNER JOIN MENSAL M\r\n\tON (TRUNC(D.DATA, 'MM') = M.DATA)\r\nINNER JOIN DIA_UTIL DU \r\n\tON (D.DATA = DU.DATA)\r\nLEFT JOIN DIA_UTIL_MENSAL DUM\r\n\tON (TRUNC(DU.DATA,'MM') = DUM.DATA)\r\nGROUP BY D.DATA, DUM.QTD, DU.QTD, DU.DATA","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":44.99927935078904,"y":-304.9894095898566},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"TABELA_TREINO_ML_PREVISAO_MPE","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"mkIPWH","type":"table","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":232.49927935078904,"y":-304.9894095898566},"sourceId":7,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SqQuWB","type":"scoring","appId":137,"label":"Score: TABELA_TREINO_ML_PREVISAO_MPE_v2","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":169,"position":{"x":230.49934201593777,"y":-162.9938588154198},"sourceId":7,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_TABELA_TREINO_ML_PREVISAO_MPE_v2","databaseName":"bucket_137"},{"id":"YCWBUW","type":"table","appId":137,"label":"score_TABELA_TREINO_ML_PREVISAO_MPE_v2","client":"clickhouse","repoId":1,"created":false,"position":{"x":232.99269951016748,"y":5.9998120045536325},"tableName":"score_TABELA_TREINO_ML_PREVISAO_MPE_v2","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IsuRdT","type":"automl","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPEv2","client":"clickhouse","repoId":1,"created":false,"position":{"x":513.499279350789,"y":-304.9894095898566},"settings":{"seed":7,"maxModels":999,"projectId":"IsuRdT","splitFrame":0.7,"projectName":"project_IsuRdT","reloadSource":true,"removeColumns":[],"trainingFrame":"TABELA_TREINO_ML_PREVISAO_MPE","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","sourceType":"bucket","databaseName":"bucket_137"},{"id":"FfkeIZ","type":"automlReport","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPEv2","client":"clickhouse","repoId":1,"created":false,"position":{"x":794.499279350789,"y":-304.9894095898566},"settings":{"seed":7,"maxModels":999,"projectId":"IsuRdT","splitFrame":0.7,"projectName":"project_IsuRdT","reloadSource":true,"removeColumns":[],"trainingFrame":"TABELA_TREINO_ML_PREVISAO_MPE","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE","sourceType":"bucket","databaseName":"bucket_137"},{"id":"tIofiv","type":"export","appId":137,"label":"Exp. TABELA_TREINO_ML_PREVISAO_MPE","client":"clickhouse","repoId":1,"shared":false,"created":false,"compress":false,"position":{"x":392.4942661388869,"y":-408.9861510021202},"sourceId":7,"separator":";","tableName":"TABELA_TREINO_ML_PREVISAO_MPE","tableView":false,"temporary":false,"enclosedBy":"doubleQuotes","sourceType":"bucket","databaseName":"bucket_137","linesTerminatedBy":"lfNewLine","fieldsTerminatedBy":"comma"},{"id":"yodaDm","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT DATA, dias_uteis_corridos-2 as dias_uteis_corridos, SUM(qtd) over(PARTITION BY trunc(DATA,'mm') order BY DATA rows between unbounded preceding and current ROW)  AS qtd\r\nFROM (\r\nselect trunc(A.dat_dia, 'dd') data,\r\n       TAB.DIAS_UTEIS_CORRIDOS,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'MM') AS anomes,\r\n             SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                      WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                      ELSE 1 \r\n                 END) AS DIAS_UTEIS_CORRIDOS\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n     \tAND trunc(A.dat_dia, 'mm') = trunc(sysdate-60,'mm')\r\n        \r\n      GROUP BY TRUNC(DAT_DIA,'MM')) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'mm') = tab.anomes\r\nGROUP BY trunc(A.dat_dia, 'dd'),\r\n         TAB.DIAS_UTEIS_CORRIDOS, A.DSC_DIA_SMN_ABV\r\nORDER BY trunc(A.dat_dia, 'dd')\r\n)\r\nGROUP BY DATA, dias_uteis_corridos, qtd","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":67.9978693849416,"y":-722.977346548717},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"dias_uteis_forecast_mpe","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"VheAYM","type":"table","appId":137,"label":"dias_uteis_forecast_mpe","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":259.9946734623539,"y":-722.977346548717},"sourceId":7,"tableName":"dias_uteis_forecast_mpe","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RnyLVB","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"VpqCHL","to":"dias_uteis_forecast_mpe","raw":"","list":[{"id":"CSopbP","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"dias_uteis_forecast_mpe","columnBy":"DATA_REF","columnTo":"DATA","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"gtYHNe","type":"value","alias":"DATA","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"SxUKcc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"EMiyoN","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"jwqefP","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"Mqwbeq","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"VAUCJw","type":"value","andOr":"and","value":"2023-05-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"cujiXa","type":"value","alias":"DIAS_ATUAIS","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"},{"id":"SxUKcc","type":"value","alias":"DIAS_TOTAIS","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"WwewLk","type":"sum","alias":"VENDA","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":259.00610985200575,"y":-541.9778478699071},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_modelo_mpe_venda_forecast_data","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"oYgsgg","type":"table","appId":137,"label":"tmp_teste_modelo_mpe_venda_forecast_data","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":429.0036032460547,"y":-540.9778792024815},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_data","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"NkAyPq","type":"scoring","appId":137,"label":"Score: tmp_teste_modelo_mpe_venda_forecast_data","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":169,"position":{"x":688.9954567767136,"y":-540.9778792024815},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_data","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_tmp_teste_modelo_mpe_venda_forecast_datav2","databaseName":"bucket_137"},{"id":"iUfqqL","type":"table","appId":137,"label":"score_tmp_teste_modelo_mpe_venda_forecast_datav2","client":"clickhouse","repoId":1,"created":false,"position":{"x":954.970077391459,"y":-538.9831117424045},"tableName":"score_tmp_teste_modelo_mpe_venda_forecast_datav2","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"KwJYxX","source":"NkAyPq","target":"iUfqqL"},{"id":"yMkEkj","source":"SqQuWB","target":"YCWBUW"},{"id":"MhnBKN","source":"mkIPWH","target":"SqQuWB"},{"id":"AlniLu","source":"oYgsgg","target":"NkAyPq"},{"id":"XiEkjO","source":"mkIPWH","target":"IsuRdT"},{"id":"VpFqVv","source":"IsuRdT","target":"FfkeIZ"},{"id":"sMUglB","source":"awFTRN","target":"RnyLVB"},{"id":"FMTLuM","source":"VheAYM","target":"RnyLVB"},{"id":"KHESSH","source":"RnyLVB","target":"oYgsgg"},{"id":"zlADHz","source":"yodaDm","target":"VheAYM"},{"id":"OrvDVf","source":"UlRLwe","target":"mkIPWH"},{"id":"CmTcKx","source":"mkIPWH","target":"tIofiv"}]},"cron":null,"options":{"reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":99,"flowStart":1,"flowType":"dataPrep","flowKey":"_ovNBDyOowseycmlhkALnxJIJFgYmLjh","flowDescription":"","locked":"no","created":"2023-06-22 09:54:24","updated":"2023-09-08 09:08:23"},{"flowId":"3263","appId":137,"flowName":"CARGA - TIC/IoT","workflow":{"nodes":[{"id":"DVDkVy","type":"table","appId":137,"label":"base_orcado_portal_analytics","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-10.969771037053306,"y":662.7888305990188},"tableName":"base_orcado_portal_analytics","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"aLToXT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"ShGCqR","type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"IfwsKd"},{"id":"axUzSq","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"marcacao_tic_iot","columnLength":null,"databaseName":"bucket_137"},{"id":"oDguJd","type":"value","dataType":"Nullable(Date)","tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"KPpmIZ","type":"value","andOr":"and","value":["VENDAS EXPANSAO TIC","Venda Mensal"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_analytics","valueType":"value","columnName":"tip_mtc","extraValue":"","columnLength":null,"databaseName":"bucket_137"},{"id":"wZffRe","type":"value","andOr":"and","value":["IOT","TIC"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"base_orcado_portal_analytics","valueType":"value","columnName":"marcacao_tic_iot","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZbhlTV","type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"IfwsKd"},{"id":"axUzSq","type":"value","dataType":"Nullable(String)","tableName":"base_orcado_portal_analytics","columnName":"marcacao_tic_iot","columnLength":null,"databaseName":"bucket_137"},{"id":"oDguJd","type":"value","dataType":"Nullable(Date)","tableName":"base_orcado_portal_analytics","columnName":"mes_ref","columnLength":null,"databaseName":"bucket_137"},{"id":"dnPlsf","type":"sum","alias":"sum_orcado","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_analytics","columnName":"orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO","content":"'TIC/IoT'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"IfwsKd"}]},"created":false,"optimize":false,"position":{"x":138.8143488430357,"y":661.1119301296744},"tableName":"base_orcado_portal_analytics","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_orcado_tic_iot_analy","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"iRwsgF","type":"table","appId":137,"label":"base_orcado_tic_iot_analy","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":328.32971521333957,"y":661.7607425608377},"tableName":"base_orcado_tic_iot_analy","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dqlUPL","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":-28.93930295960115,"y":185.82793135170783},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"CKKgWG","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"QtVAZe","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"RHPuqh","type":"computed","alias":"PRODUTO","content":"CASE\nWHEN DSC_LNH_NGC = 'TIC Dados' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC TI' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC' then 'TIC'\nELSE DSC_LNH_NGC\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"gMTKoZ"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"xpdrhb","type":"value","andOr":"and","value":"Venda Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"zguRLd","type":"computed","alias":"marcacao_tic_iot","andOr":"and","value":["IOT","TIC"],"content":"case\nwhen upper(PRODUTO) like '%TIC%'  then 'TIC'\nwhen upper(PRODUTO) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","operator":"in","fieldType":"computed","valueType":"value","columnName":"marcacao_tic_iot","computedId":"hKnrGC","extraValue":""}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"QtVAZe","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"RWUotD","type":"computed","alias":"PRODUTO","content":"CASE\nWHEN DSC_LNH_NGC = 'TIC Dados' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC TI' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC' then 'TIC'\nELSE DSC_LNH_NGC\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"gMTKoZ"},{"id":"hnWgMt","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"XVDJBz"},{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"ZKlybt"},{"type":"computed","alias":"JOIN_INDICADOR","content":"CASE\r\nWHEN TIP_MTC = 'Venda Mensal' THEN 'Venda'\r\nWHEN TIP_MTC = 'Base de Clientes Mensal' THEN 'Base de Clientes'\r\nWHEN TIP_MTC = 'Base de Contratos Mensal' THEN 'Base de Contratos'\r\nWHEN TIP_MTC = 'Perda de Receita Mensal' THEN 'Perda de Receita'\r\nWHEN TIP_MTC = 'Churn Físico Mensal' THEN 'Churn Físico'\r\nWHEN TIP_MTC = 'Migração Entrante Mensal' THEN 'Migração Entrante'\r\nWHEN TIP_MTC = 'Migração Sainte Mensal' THEN 'Migração Sainte'\r\nWHEN TIP_MTC = 'Ebit Mensal' THEN 'Ebit'\r\nWHEN TIP_MTC = 'Ebitda Mensal' THEN 'Ebitda'\r\nWHEN TIP_MTC = 'Margem Contribuição Mensal' THEN 'Margem Contribuição'\r\nWHEN TIP_MTC = 'Receita Liquida Mensal' THEN 'Receita Liquida'\r\nELSE TIP_MTC\r\nEND","dataType":"Nullable(String)","columnName":"JOIN_INDICADOR","computedId":"SrUmku"},{"type":"computed","alias":"PRODUTO","content":"CASE\nWHEN DSC_LNH_NGC = 'TIC Dados' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC TI' then 'TIC'\nWHEN DSC_LNH_NGC = 'TIC' then 'TIC'\nELSE DSC_LNH_NGC\nEND","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"gMTKoZ"},{"type":"computed","alias":"marcacao_tic_iot","content":"case\nwhen upper(PRODUTO) like '%TIC%'  then 'TIC'\nwhen upper(PRODUTO) like '%IOT%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","columnName":"marcacao_tic_iot","computedId":"hKnrGC"}]},"created":false,"position":{"x":-27.082263742725345,"y":521.2356688926917},"sourceId":7,"tableName":"IND_SAP_PLANEJAMENTO","sourceType":"bucket","resultTable":"Base_real_tic_iot_anly","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"pZDFWQ","type":"table","appId":137,"label":"Base_real_tic_iot_anly","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":129.5132513421059,"y":524.3169602794816},"sourceId":7,"tableName":"Base_real_tic_iot_anly","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fHaBAb","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"base_orcado_tic_iot_analy","id":"sStHUR","to":"Base_real_tic_iot_anly","raw":"","list":[{"id":"kxsjEe","andOr":"and","tableBy":"base_orcado_tic_iot_analy","tableTo":"Base_real_tic_iot_anly","columnBy":"mes_ref","columnTo":"DATA_REF","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"eOFDBf","andOr":"and","tableBy":"base_orcado_tic_iot_analy","tableTo":"Base_real_tic_iot_anly","columnBy":"marcacao_tic_iot","columnTo":"PRODUTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"zNwseM","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"teIKjP"},{"id":"avCnRU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_tic_iot_analy","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"HyKaqy","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-3))","dataType":"Nullable(Date)","operator":"=","fieldType":"value","tableName":"base_orcado_tic_iot_analy","valueType":"computed","columnName":"mes_ref","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZhoaHd","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"teIKjP"},{"id":"avCnRU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_tic_iot_analy","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"wrDQIU","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"Base_real_tic_iot_anly","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"sYkeOM","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_tic_iot_analy","columnName":"sum_orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"teIKjP"}]},"created":false,"optimize":false,"position":{"x":327.332566477609,"y":526.1626141061538},"tableName":"base_orcado_tic_iot_analy","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"analy_disparo_tic_iot_fechamento","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SYzQyT","type":"table","appId":137,"label":"analy_disparo_tic_iot_fechamento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":493.95565357984754,"y":526.9741973063427},"tableName":"analy_disparo_tic_iot_fechamento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"zXttII","type":"builder","appId":137,"label":"Analy Responde","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"base_orcado_tic_iot_analy","id":"sStHUR","to":"Base_real_tic_iot_anly","raw":"","list":[{"id":"kxsjEe","andOr":"and","tableBy":"base_orcado_tic_iot_analy","tableTo":"Base_real_tic_iot_anly","columnBy":"mes_ref","columnTo":"DATA_REF","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"eOFDBf","andOr":"and","tableBy":"base_orcado_tic_iot_analy","tableTo":"Base_real_tic_iot_anly","columnBy":"marcacao_tic_iot","columnTo":"PRODUTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"GoPwrC","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"Base_real_tic_iot_anly","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"caBgQc","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"teIKjP"},{"id":"oqwAmm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_tic_iot_analy","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"dhvlNn","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"Base_real_tic_iot_anly","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"ZhoaHd","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"teIKjP"},{"id":"avCnRU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_tic_iot_analy","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"wrDQIU","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"Base_real_tic_iot_anly","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"sYkeOM","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_tic_iot_analy","columnName":"sum_orcado","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"teIKjP"}]},"created":false,"optimize":false,"position":{"x":327.3325664776089,"y":882.1542796413662},"tableName":"base_orcado_tic_iot_analy","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"analy_responde_tic_iot","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"GeFgKm","type":"table","appId":137,"label":"analy_responde_tic_iot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":474.33078052086887,"y":883.1542483087919},"tableName":"analy_responde_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"eHzJER","type":"sourceRaw","appId":137,"label":"SQL","query":"select TAB.anomes,\r\n       TAB.DIAS_UTEIS_CORRIDOS,\r\n       'RESIDENCIAL' AS SEGMENTO,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0.5 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'MM') AS anomes,\r\n             SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0.5 \r\n                      WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                      ELSE 1 \r\n                 END) AS DIAS_UTEIS_CORRIDOS\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n     \tAND trunc(A.dat_dia, 'mm') = trunc(sysdate-1,'mm')\r\n        and A.dat_dia <= sysdate-1\r\n        and a.dsc_frd like 'DIA %TIL'\r\n      GROUP BY TRUNC(DAT_DIA,'MM')) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'mm') = tab.anomes\r\n  AND a.dsc_frd like 'DIA %TIL'\r\nGROUP BY TAB.anomes,\r\n         TAB.DIAS_UTEIS_CORRIDOS\r\nUNION ALL \r\nselect TAB.anomes,\r\n       TAB.DIAS_UTEIS_CORRIDOS,\r\n       'EMPRESARIAL' AS SEGMENTO,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'MM') AS anomes,\r\n             SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                      WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                      ELSE 1 \r\n                 END) AS DIAS_UTEIS_CORRIDOS\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n     \tAND trunc(A.dat_dia, 'mm') = trunc(sysdate-1,'mm')\r\n        and A.dat_dia <= sysdate-1\r\n        and a.dsc_frd like 'DIA %TIL'\r\n      GROUP BY TRUNC(DAT_DIA,'MM')) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'mm') = tab.anomes\r\n  AND a.dsc_frd like 'DIA %TIL'\r\nGROUP BY TAB.anomes,\r\n         TAB.DIAS_UTEIS_CORRIDOS","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":-46.46244045360736,"y":379.46463373381454},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"resultTable":"tmp_dias_uteis","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"mPhrmB","type":"table","appId":137,"label":"tmp_dias_uteis","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":147.00132769952927,"y":381},"sourceId":7,"tableName":"tmp_dias_uteis","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dFgSTJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"LyntyN","to":"tmp_dias_uteis","raw":"","list":[{"id":"ieAPpS","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"tmp_dias_uteis","columnBy":"DATA_REF","columnTo":"ANOMES","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"STrblH","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"tmp_dias_uteis","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"nbLyTV","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"bBMadN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"PAtBNY","type":"value","andOr":"and","value":"Venda Mensal","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"BMMopn","type":"value","alias":"","andOr":"and","value":"toStartOfMonth(addDays(today(),-1))","dataType":"Nullable(DateTime)","distinct":false,"operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"addDays(addMonths(toStartOfMonth(today()), 1),-1)","columnLength":2,"databaseName":"bucket_137"},{"id":"AvrugB","type":"value","andOr":"and","value":["IOT","IoT","TIC","TIC Dados","TIC TI"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DSC_LNH_NGC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"PLjnbZ","type":"value","andOr":"and","value":["EMPRESARIAL","CORPORATIVO","OPERADORAS"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"nbvEnx","type":"value","alias":"","dataType":"Nullable(Date)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"bBMadN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"wKntSR","type":"computed","alias":"FORECAST_IOT","content":"SUM(case \nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'IOT' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'IOT' THEN  REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_IOT","computedId":"DupfQf","columnLength":2},{"id":"twnyWO","type":"computed","alias":"FORECAST_TIC","content":"SUM(case \nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'TIC' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'TIC DADOS' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'TIC TI' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'TIC' THEN  REAL\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'TIC DADOS' THEN  REAL\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'TIC TI' THEN  REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"FORECAST_TIC","computedId":"XyHJQG","columnLength":2},{"id":"woxHpP","type":"computed","alias":"REAL_IOT","content":"SUM(case \nwhen UPPER(DSC_LNH_NGC) = 'IOT' THEN  REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_IOT","computedId":"YWZbTo","columnLength":2},{"id":"MAoQML","type":"computed","alias":"REAL_TIC","content":"SUM(case \nwhen UPPER(DSC_LNH_NGC) = 'TIC' THEN  REAL\nwhen UPPER(DSC_LNH_NGC) = 'TIC DADOS' THEN REAL\nwhen UPPER(DSC_LNH_NGC) = 'TIC TI' THEN REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_TIC","computedId":"qCGQrQ","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"FORECAST_IOT","content":"SUM(case \nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'IOT' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'IOT' THEN  REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"FORECAST_IOT","computedId":"DupfQf","columnLength":2},{"type":"computed","alias":"FORECAST_TIC","content":"SUM(case \nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'TIC' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'TIC DADOS' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'EMPRESARIAL' AND UPPER(DSC_LNH_NGC) = 'TIC TI' THEN  (REAL/ DIAS_UTEIS_CORRIDOS)* QTD\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'TIC' THEN  REAL\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'TIC DADOS' THEN  REAL\nwhen SEGMENTO = 'CORPORATIVO' AND UPPER(DSC_LNH_NGC) = 'TIC TI' THEN  REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"FORECAST_TIC","computedId":"XyHJQG","columnLength":2},{"type":"computed","alias":"REAL_IOT","content":"SUM(case \nwhen UPPER(DSC_LNH_NGC) = 'IOT' THEN  REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_IOT","computedId":"YWZbTo","columnLength":2},{"type":"computed","alias":"REAL_TIC","content":"SUM(case \nwhen UPPER(DSC_LNH_NGC) = 'TIC' THEN  REAL\nwhen UPPER(DSC_LNH_NGC) = 'TIC DADOS' THEN REAL\nwhen UPPER(DSC_LNH_NGC) = 'TIC TI' THEN REAL\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"REAL_TIC","computedId":"qCGQrQ","columnLength":2}]},"created":false,"optimize":false,"position":{"x":335,"y":323},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_tic_iot","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NdwrRM","type":"table","appId":137,"label":"tmp_forecast_tic_iot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":498.9976813894953,"y":322.00003133257434},"sourceId":null,"tableName":"tmp_forecast_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"KIIDTe","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT \r\n   CO.DAT_FCH AS DATA_FECHAMENTO,\r\n   CASE  \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%IOT%') THEN 'IOT' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%LORAWAN%') THEN 'IOT' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%LORA WAN%') THEN 'IOT' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%MOT%') THEN 'IOT' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%M2M%') THEN 'IOT' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%THING%') THEN 'IOT' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%0800%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%NUMERO UNI%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%NÚMERO UNI%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%CELULAR%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%NUMERO%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%VOZ%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%CSP%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%800%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%DDG%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%TERMINAÇÃO TRÁF%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%TERMINAÇÃO TRÁF%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%4G%') THEN 'VOZ' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%BANDA LARGA%') THEN 'DADOS' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%INTERNET LINK%') THEN 'DADOS' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%BL%') THEN 'DADOS%' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%DARK FIBER%') THEN 'DADOS' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%FIBRA APAGADA%') THEN 'DADOS' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%SD-WAN%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%CLOUD BAKCUP%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%HOSTING%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%SMS%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%OMNI%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%SD-WAN%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%AZURE%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%AZURE%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%365%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%SDWAN%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%CLOUD PHONE%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%CLOUD PHONE%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%HOSTING%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%OMNI PRO%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%VIRUS%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%BEST GUESS%') AND (CO.DSC_COT like '%VIRUS%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%VÍRUS%') THEN 'TIC' \r\n\tWHEN (CI.DESCRIPTION like '%PROJETO ESPECIAL%') AND (CO.DSC_COT like '%CLOUD 1.0%') THEN 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%IOT INTERNET%' THEN 'IOT' \r\n\tWHEN CI.DESCRIPTION like '%LORAWAN%' then 'IOT' \r\n\tWHEN CI.DESCRIPTION like '%BANDA LARGA%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%API MULTI%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%BANDA INTERNET%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%VPN%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%CONEXAO%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%DADOS REVERSO%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%EILD%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%FIBRA APAGADA%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%INTERNET%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%IP ISP%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%IP TR%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%LAN TO%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%LAST MILE%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%PONTO DE ACESSO%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%DARK FIBER%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%SWAP%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%GOLDEN JUMP%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%PROFISSIONAIS%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%MPLS%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%WAVE%' then 'DADOS' \r\n\tWHEN CI.DESCRIPTION like '%IOT%' then 'IOT' \r\n\tWHEN CI.DESCRIPTION like '%DDOS%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%EXCHANGE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%ATENDIMENTO PREMIUM%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%AZURE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%CLOUD%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SMS%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%CREDITO%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%DÉBITO%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%ENTERPRISE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%STORAGE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%GERENCIAMENTO%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%GEST%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%HOSPEDAGEM%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%HOSTING%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%LICEN%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%MICROSOFT%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%OFFICE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%ONEDRIVE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%PHONE%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%MULTICANAL%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%POWER%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%PROJECT%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%ANTIV%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%OMNI%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%CONECT%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%TEAMS%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%BUSINESS%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%365%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SHAREPOINT%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%VISIO%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SD%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SMART%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SMS%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SOC%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SIMPLES DIGITAL%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%SD-WAN%' then 'TIC' \r\n\tWHEN CI.DESCRIPTION like '%0800%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%CELULAR%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%CSP12%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%DDR%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%FIXA%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%VOZ%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%VOZ TOTAL%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%NÚMERO%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%NUMERO%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%CONTROLE%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%DDG%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%MOT%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%PLANO%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%TELEFONIA%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%TERMINA%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%SVA%' then 'VOZ' \r\n\tWHEN CI.DESCRIPTION like '%TELEF%' then 'VOZ' \r\n\tWHEN CO.DSC_COT like '%IOT%' then 'IOT' \r\n\tWHEN CO.DSC_COT like '%365%' then 'TIC' \r\n\tWHEN CO.DSC_COT like '%OFFICE%' then 'TIC'\r\n\tELSE 'OUTROS'\r\n   END AS mix_produto,\r\n   CO.BSK_ORI_OBE AS ID_OPORTUNIDADE,\r\n   CO.NUM_PTL AS PROTOCOLO,\r\n   OP.BSK_ORI_OBE AS ID_LEAD,\r\n   C.NAME AS NOME_CLIENTE,\r\n   C.CPF_CGC AS CPFCNPJ_CLIENTE,\r\n   C.GROUP_SEGMENT AS SEGMENTO_CLIENTE,\r\n   C.STATUS AS STATUS_DO_CLIENTE,\r\n   CO.BSK_COT AS ID_COTACAO,\r\n   CO.DSC_COT AS DESCRICAO,\r\n   SA.NOM_STA AS SUB_STATUS,\r\n   CO.DSC_ETG_VND AS ESTAGIO,\r\n   CI.DSC_MTV_ITP AS MOTIVO_INTERRUPCAO,\r\n   CO.DAT_CRI_RGT AS CRIADO_EM,\r\n   CO.DAT_FCH AS FINALIZADO_EM,\r\n   CO.TIP_COT AS TIPO,\r\n   CO.COD_USR_ATR AS ATRIBUIDO_A,\r\n   PES.NOM_PES AS CONSULTOR,\r\n   OP.COD_REG AS REGIONAL,\r\n   CO.DAT_ETM_FCH_COT AS DATA_PREV_FECHAMENTO,\r\n   CI.VLR_CPO_NUM AS RECEITA_BRUTA_ESPERADA,\r\n   AT.DAT_CRI_ATI AS DATA_ENTRADA_CONFERENCIA,\r\n   AT.DAT_FCH_ATI AS DATA_ULTIMA_CONFERENCIA,\r\n   CO.DSC_PDO_CTO AS CONTRACT_PERIOD_LOV,\r\n   CO.BSK_STA_COT AS CRM_QUOTE_STATUS_ID,\r\n   CO.NOM_PSC AS POSICAO_CONSULTOR,\r\n   CI.VLR_VND AS VALOR_BRUTO,\r\n   CI.VLR_SEM_IMP AS VALOR_LIQUIDO,\r\n   CI.TIP_OPE TIPO_VENDA,\r\n   DECODE(NVL(OPO.FLAG_BIG_DEAL, '0'),'1','SIM', 'NÃO') AS FLAG_BIG_DEAL,\r\n   SOW.NOTE AS MOTIVO_ALTA,\r\n   CI.DESCRIPTION AS PRODUTO,\r\n   CI.VELOCIDADE AS VELOCIDADE,\r\n   DECODE(CASE\r\n     WHEN CO.BSK_TIP_ORI_OBE = 54 THEN\r\n      NVL(OP.VLR_PBB_FCH,'-1')\r\n     ELSE\r\n      0\r\n   END,'-1','',CASE\r\n     WHEN CO.BSK_TIP_ORI_OBE = 54 THEN\r\n      NVL(OP.VLR_PBB_FCH,'-1')\r\n     ELSE\r\n      0\r\n   END) AS TEMPERATURA,\r\n   CO.COD_USR_CRI_RGT AS CRIADO_POR,\r\n   C.CUSTOMER_SEGMENT AS SUB_SEGMENTO_CLIENTE,\r\n   DECODE(CO.FLG_CTD, 1, 'SIM', 'NÃO') AS COMPROMETIDO,\r\n   C.SRK_HRQ_VND,\r\n   CO.BSK_FLU,\r\n   CI.DSC_TCN AS TECNOLOGIA,\r\n   CI.DSC_ABD AS ABORDAGEM,\r\n   CI.VLR_MSL_LST_MLE_SEM_IMP,\r\n   CI.VLR_MSL_LST_MLE_COM_IMP,\r\n   CI.VLR_IST_LST_MLE_SEM_IMP,\r\n   REPLACE(REPLACE(PES.NUM_CPF,'.',''),'-','') AS CPF_CONSULTOR,\r\n   trunc(sysdate,'dd') data_atualizacao\r\n    FROM DWADM.D_COTACAO CO\r\n    LEFT JOIN DWADM.D_PESSOA PES\r\n      ON (CO.SRK_PES = PES.SRK_PES AND PES.TIP_PES || null = 'PERSON' AND\r\n         PES.IDT_RGT_ATU = 1 AND PES.NOM_SIS_ORI = 'ALGAR CRM')\r\n    LEFT JOIN DWADM.D_OPORTUNIDADE OP\r\n      ON (CO.SRK_OPT = OP.SRK_OPT AND OP.IDT_RGT_ATU = 1)\r\n    LEFT JOIN DWADM.D_CUSTOMER C\r\n      ON (CO.SRK_CLI = C.CUSTOMER_KEY AND C.RECORD_STATUS = 1 AND C.SRC_SYS_NAME = 'ALGAR CRM')\r\n    LEFT JOIN ( SELECT  A.BSK_OBE,\r\n    \t\t\t\t\tMIN(A.DAT_CRI_ATI) AS DAT_CRI_ATI,\r\n   \t\t\t\t\t\tMAX(A.DAT_FCH_ATI) AS DAT_FCH_ATI\r\n    \t\t\tFROM DWADM.D_ATIVIDADE A\r\n    \t\t\tWHERE 1 = 1\r\n    \t\t\t\tAND A.IDT_RGT_ATU = 1\r\n    \t\t\t\tAND A.BSK_TIP_OBE = 81 \r\n    \t\t\t\tAND A.BSK_TIP_ATI = 18\r\n    \t\t\tGROUP BY A.BSK_OBE) AT\r\n      ON (CO.BSK_COT = AT.BSK_OBE)\r\n    LEFT JOIN DWADM.AC_CRM_OPPORTUNITY_ODS OPO\r\n      ON (OP.BSK_OPT = OPO.ID AND CO.BSK_TIP_ORI_OBE = 54)\r\n    LEFT JOIN DWADM.D_SERVICE_ORDER_WORKLOG SOW\r\n      ON (OP.BSK_OPT = SOW.SRC_SYS_KEY AND SOW.SRC_OBJECT_TYPE_KEY = 81 AND\r\n         UPPER(SOW.NOTE) LIKE\r\n         '%FOI MARCADA COMO ALTA COMPLEXIDADE, MOTIVO: %' AND\r\n         UPPER(SOW.NOTE) NOT LIKE '%A COMPLEXIDADE JÁ É ALTA%' AND\r\n         SOW.RECORD_STATUS = 1 AND SOW.SRC_SYS_NAME = 'ALGAR CRM')\r\n   LEFT JOIN DWADM.D_STATUS SA\r\n      ON (CO.SRK_SUB_STA_COT = SA.SRK_STA AND SA.IDT_RGT_ATU = 1 \r\n      \tAND SA.NOM_SIS_ORI = 'ALGAR CRM')\r\n    LEFT JOIN (SELECT   c.SRK_COT\r\n\t\t\t\t\t\t, CASE WHEN C.BSK_COT_ITE_PAI = 0 THEN C.TIP_OPE ELSE NULL END TIP_OPE\r\n\t\t\t\t\t\t, PD.DESCRIPTION \r\n\t\t\t\t\t\t, SUM(RCI.VLR_CPO_NUM) VLR_CPO_NUM\r\n\t\t\t\t\t\t, MAX(C2.VELOCIDADE) VELOCIDADE\r\n\t\t\t\t\t\t, MAX(COI.DSC_MTV_ITP) DSC_MTV_ITP\r\n\t\t\t\t\t\t, TEC.VLR_CPO_LST DSC_TCN\r\n\t\t\t\t\t\t, ABD.VLR_CPO_LST DSC_ABD\r\n\t\t\t\t\t\t, SUM(CASE WHEN C.BSK_COT_ITE_SPR_PAI = 0 AND C.BSK_STA IN (1, 4, 5, 8) THEN C.VLR_VND ELSE 0 END) VLR_VND\t\t\t\t\t\t\r\n\t\t\t\t\t\t, SUM(CASE WHEN C.BSK_COT_ITE_SPR_PAI = 0 AND C.BSK_STA IN (1, 4, 5, 8) THEN C.VLR_SEM_IMP ELSE 0 END) VLR_SEM_IMP\r\n\t\t\t\t\t\t, SUM(CASE WHEN CIA.BSK_ATR = 801 THEN CIA.VLR_CPO_NUM ELSE 0 END) AS VLR_MSL_LST_MLE_SEM_IMP\r\n\t\t\t\t\t\t, SUM(CASE WHEN CIA.BSK_ATR = 802 THEN CIA.VLR_CPO_NUM ELSE 0 END) AS VLR_MSL_LST_MLE_COM_IMP\r\n\t\t\t\t\t\t, SUM(CASE WHEN CIA.BSK_ATR = 803 THEN CIA.VLR_CPO_NUM ELSE 0 END) AS VLR_IST_LST_MLE_SEM_IMP\r\n    \t\t\tFROM DWADM.D_COTACAO_ITEM C\r\n    \t\t\tLEFT JOIN DWADM.D_PRODUCT PD\r\n     \t\t\t\tON (C.SRK_PDT = PD.PRODUCT_KEY AND PD.RECORD_STATUS = 1)\r\n      \t\t\tLEFT JOIN (SELECT  TO_CHAR(CI.BSK_COT_ITE_SPR_PAI) AS  BSK_COT_ITE_SPR_PAI\r\n\t\t\t\t\t\t\t\t, VLR_CPO_NUM\r\n\t\t\t\t\t\t\t\t, IA.BSK_COT_ITE_ATR \r\n\t\t\t\t\t\t\t\t,CI.BSK_COT_ITE\r\n\t\t\t           FROM DWADM.D_COTACAO_ITEM CI, \r\n\t\t\t           \t\tDWADM.D_COTACAO_ITEM_ATRIBUTO IA\r\n\t\t\t           WHERE 1=1\r\n\t\t\t           \tAND CI.IDT_RGT_ATU = 1\r\n\t\t\t           \tAND IA.IDT_RGT_ATU = 1\r\n\t\t\t           \tAND IA.NOM_ATR LIKE '%RECEITA%'\r\n\t\t\t           \tAND IA.BSK_ATR IN (719, 484) \r\n\t\t\t           \tAND CI.SRK_STA IN (332,\r\n333,\r\n334,\r\n335,\r\n336,\r\n337,\r\n381,\r\n382)\r\n\t\t\t           \tAND CI.BSK_COT_ITE = IA.BSK_COT_ITE) RCI \r\n\t\t\t\tON (CASE WHEN RCI.BSK_COT_ITE_SPR_PAI = '0' THEN RCI.BSK_COT_ITE ELSE RCI.BSK_COT_ITE_SPR_PAI END = C.BSK_COT_ITE) \r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\tLEFT JOIN (SELECT     CI.BSK_COT_ITE_SPR_PAI, CI.BSK_COT_ITE, ci.srk_cot\r\n\t\t\t\t\t\t\t\t, VLR_CPO_NUM\r\n\t\t\t\t\t\t\t\t, IA.BSK_ATR\r\n\t\t\t\t\t\t\t\t, IA.BSK_COT_ITE_ATR \r\n\t\t\t           FROM DWADM.D_COTACAO_ITEM CI, \r\n\t\t\t           \t\tDWADM.D_COTACAO_ITEM_ATRIBUTO IA\r\n\t\t\t           WHERE 1=1\r\n\t\t\t           \tAND CI.IDT_RGT_ATU = 1\r\n\t\t\t           \tAND IA.IDT_RGT_ATU = 1\r\n\t\t\t           \tAND IA.BSK_ATR IN (801, 802, 803) \r\n\t\t\t           \tAND IA.NOM_ATR IN ('VALOR MENSAL LASTMILE S/ IMPOSTOS (B2B)', 'VALOR MENSAL LASTMILE C/ IMPOSTOS (B2B)', 'VALOR INSTALAÇÃO LASTMILE S/ IMPOSTOS')\r\n\t\t\t           \tAND CI.BSK_COT_ITE = IA.BSK_COT_ITE) CIA \r\n\t\t\t\t\tON (CIA.BSK_COT_ITE_SPR_PAI = C.BSK_COT_ITE)\r\n\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tLEFT JOIN (SELECT  CI.BSK_COT_ITE, CIA.VLR_CPO_LST \r\n\t\t\t\t\t\tFROM\tDWADM.D_COTACAO_ITEM CI\r\n\t\t\t\t\t\t\t  , DWADM.D_COTACAO_ITEM CI1\r\n\t\t\t\t\t\t\t  , DWADM.D_COTACAO_ITEM CI2\r\n\t\t\t\t\t\t\t  , DWADM.D_COTACAO_ITEM_ATRIBUTO CIA\r\n\t\t\t\t\t\tWHERE 1 = 1\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CI.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CI1.BSK_COT_ITE_SPR_PAI = CI.BSK_COT_ITE\r\n\t\t\t\t\t\t\tAND CI1.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\tAND CI1.BSK_OBE IN (1098, 496)\r\n\t\t\t\t\t\t\tAND CI1.BSK_TIP_OBE = 5\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CI2.BSK_COT_ITE_PAI = CI1.BSK_COT_ITE \r\n\t\t\t\t\t\t\tAND CI2.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\tAND CI2.BSK_OBE = 129\r\n\t\t\t\t\t\t\tAND CI2.BSK_TIP_OBE = 5\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CIA.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\tAND CIA.BSK_COT_ITE = CI2.BSK_COT_ITE \r\n\t\t\t\t\t\t\tAND CIA.BSK_ATR = 721\r\n\t\t\t\t\t\t\tAND NVL(CIA.VLR_CPO_LST, '-1') <> '-1') TEC \r\n\t\t\t\t\tON (TEC.BSK_COT_ITE = C.BSK_COT_ITE)\r\n\t\t\tLEFT JOIN (SELECT  CI.BSK_COT_ITE, CIA.VLR_CPO_LST \r\n\t\t\t\t\t\tFROM\tDWADM.D_COTACAO_ITEM CI\r\n\t\t\t\t\t\t\t  , DWADM.D_COTACAO_ITEM CI1\r\n\t\t\t\t\t\t\t  , DWADM.D_COTACAO_ITEM CI2\r\n\t\t\t\t\t\t\t  , DWADM.D_COTACAO_ITEM_ATRIBUTO CIA\r\n\t\t\t\t\t\tWHERE 1 = 1\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CI.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CI1.BSK_COT_ITE_SPR_PAI = CI.BSK_COT_ITE \r\n\t\t\t\t\t\t\tAND CI1.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\tAND CI1.BSK_OBE IN (1098, 496)\r\n\t\t\t\t\t\t\tAND CI1.BSK_TIP_OBE = 5\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CI2.BSK_COT_ITE_PAI = CI1.BSK_COT_ITE \r\n\t\t\t\t\t\t\tAND CI2.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\tAND CI2.BSK_OBE = 129\r\n\t\t\t\t\t\t\tAND CI2.BSK_TIP_OBE = 5\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tAND CIA.IDT_RGT_ATU = 1\r\n\t\t\t\t\t\t\tAND CIA.BSK_COT_ITE = CI2.BSK_COT_ITE \r\n\t\t\t\t\t\t\tAND CIA.BSK_ATR IN ('333', '723')\r\n\t\t\t\t\t\t\tAND NVL(CIA.VLR_CPO_LST, '-1') <> '-1') ABD\r\n\t\t\t\t\t\tON (ABD.BSK_COT_ITE = C.BSK_COT_ITE)\r\n\t\t\t\t\r\n\t\t\tLEFT JOIN (\tSELECT    SRK_COT_ITE\r\n\t\t\t\t\t\t\t\t, MAX(DSC_MTV_ITP) DSC_MTV_ITP\r\n\t\t\t\t\t\tFROM DWADM.D_COTACAO_INTERRUPCAO \r\n\t\t\t\t\t\tWHERE IDT_RGT_ATU = 1 \r\n\t\t\t\t\t\tGROUP BY SRK_COT_ITE) COI\r\n      \t\t\tON (C.SRK_COT_ITE = COI.SRK_COT_ITE)\r\n      \t\tLEFT JOIN ( SELECT \t  CI2.BSK_COT_ITE_SPR_PAI \r\n      \t\t\t\t\t\t\t, MAX(NVL(CIA2.VLR_CPO_LST,'')) AS VELOCIDADE\r\n\t\t\t\t\t\tFROM DWADM.D_COTACAO_ITEM CI2\r\n\t\t\t\t\t\tLEFT JOIN DWADM.D_COTACAO_ITEM CI3\r\n\t\t\t\t\t\t\tON (CI2.BSK_COT_ITE  = CI3.BSK_COT_ITE_PAI\r\n\t\t\t\t\t\t\t\tAND CI3.BSK_OBE  = 129\r\n\t\t\t\t\t\t\t\tAND CI3.BSK_TIP_OBE = 5\r\n\t\t\t\t\t\t\t\tAND CI3.IDT_RGT_ATU = '1')\r\n\t\t\t\t\t\tLEFT JOIN DWADM.D_COTACAO_ITEM_ATRIBUTO CIA2\r\n\t\t\t\t\t\t\tON (CI3.SRK_COT_ITE = CIA2.SRK_COT_ITE\r\n\t\t\t\t\t\t\t\tAND CIA2.IDT_RGT_ATU = '1'\r\n\t\t\t\t\t\t\t\tAND CIA2.BSK_ATR IN (709, 331))\r\n\t\t\t\t\t\tWHERE 1 = 1\r\n\t\t\t\t\t\t\tAND CI2.BSK_OBE IN (1098, 496)\r\n\t\t\t\t\t\t\tAND CI2.BSK_TIP_OBE = 5\r\n\t\t\t\t\t\t\tAND CI2.IDT_RGT_ATU = '1'\r\n\t\t\t\t\t\tGROUP BY CI2.BSK_COT_ITE_SPR_PAI) C2\r\n\t\t\tON (C.BSK_COT_ITE  = C2.BSK_COT_ITE_SPR_PAI)\r\n    \t\t\tWHERE 1 = 1\r\n    \t\t\t\tAND C.IDT_RGT_ATU = '1'\r\n    \t\t\t\tAND PD.DESCRIPTION <> 'NÃO CLASSIFICADO'\r\n    \t\t\tGROUP BY c.SRK_COT\r\n\t\t\t\t\t\t, CASE WHEN C.BSK_COT_ITE_PAI = 0 THEN C.TIP_OPE ELSE NULL END\r\n\t\t\t\t\t\t, PD.DESCRIPTION\r\n\t\t\t\t\t\t, TEC.VLR_CPO_LST\r\n\t\t\t\t\t\t, ABD.VLR_CPO_LST\r\n    \t\t\t\t) CI\r\n      ON (CO.SRK_COT = CI.SRK_COT)\r\n   WHERE 1 = 1\r\n     AND CO.IDT_RGT_ATU = 1\r\n     AND ((((CO.DAT_FCH || null BETWEEN TO_DATE('20220101', 'YYYYMMDD') \r\n     \t\t\t\t\tAND sysdate) \r\n     \t\t\t\tOR CO.DAT_FCH = TO_DATE('29000101', 'YYYYMMDD'))\r\n        \t \tAND CO.BSK_STA_COT = '3')\r\n     \tOR CO.BSK_STA_COT = '1')\r\n     AND C.GROUP_SEGMENT = 'CORPORATIVO'\r\n     AND CO.DAT_CRI_RGT >=  TO_DATE('20220101', 'YYYYMMDD')\r\n     AND TRUNC(CO.DAT_ETM_FCH_COT, 'MM') = TRUNC(SYSDATE-1, 'MM')","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":9.237055564881302e-14,"y":5.728750807065809e-14},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"tabela_cockpit","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"ghKpjf","type":"table","appId":137,"label":"tabela_cockpit","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":127.99880936217328,"y":-0.9999686674256054},"sourceId":7,"tableName":"tabela_cockpit","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"pnASFO","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"hnuKBj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"PROTOCOLO","columnLength":2,"databaseName":"bucket_137"},{"id":"ZVBFIg","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tabela_cockpit","columnName":"ID_COTACAO","columnLength":2,"databaseName":"bucket_137"},{"id":"GWAtEV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"VFPCtV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"DESCRICAO","columnLength":2,"databaseName":"bucket_137"},{"id":"oKLVPC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"MIX_PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BFrvIo","type":"value","alias":"","andOr":"and","value":["IOT"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"MIX_PRODUTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"oQPPiV","type":"value","andOr":"and","value":["EM ANDAMENTO","EM COTAÇÃO","EM ELABORAÇÃO","INTERROMPIDO"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"SUB_STATUS","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"zhUKfk","type":"value","andOr":"and","value":"80","dataType":"Nullable(Int64)","operator":"=","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"TEMPERATURA","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"svAAKi","type":"value","andOr":"and","value":"SIM","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"COMPROMETIDO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"CrukvS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"PROTOCOLO","columnLength":2,"databaseName":"bucket_137"},{"id":"ZVBFIg","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tabela_cockpit","columnName":"ID_COTACAO","columnLength":2,"databaseName":"bucket_137"},{"id":"GWAtEV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"VFPCtV","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"DESCRICAO","columnLength":2,"databaseName":"bucket_137"},{"id":"oKLVPC","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_cockpit","columnName":"MIX_PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"nsGZBN","type":"sum","alias":"sum_RECEITA_BRUTA_ESPERADA","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_cockpit","columnName":"RECEITA_BRUTA_ESPERADA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"BEST_IOT","content":"SUM(CASE\nWHEN MIX_PRODUTO = 'IOT' THEN RECEITA_BRUTA_ESPERADA\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"BEST_IOT","computedId":"PFVXRu","columnLength":2},{"type":"computed","alias":"BEST_TIC","content":"SUM(CASE\nWHEN MIX_PRODUTO = 'TIC' THEN RECEITA_BRUTA_ESPERADA\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"BEST_TIC","computedId":"KGNprS","columnLength":2},{"type":"computed","alias":"DATA_PREV_FECHAMENTO","content":"MIN(toStartOfMonth(DATA_PREV_FECHAMENTO))","dataType":"Nullable(Date)","columnName":"DATA_PREV_FECHAMENTO","computedId":"nZeicx"},{"type":"computed","alias":"SEGMENTO","content":"'CORPORATIVO'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"PemVjl"}]},"created":false,"optimize":false,"position":{"x":129.00159796129392,"y":98.99768138949526},"sourceId":7,"tableName":"tabela_cockpit","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_forecast_cockpit_validacao","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"lmvTua","type":"table","appId":137,"label":"tmp_aux_forecast_cockpit_validacao","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":279.99968667425617,"y":100.99761872434652},"sourceId":7,"tableName":"tmp_aux_forecast_cockpit_validacao","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"CwVfpT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BFrvIo","type":"value","alias":"","andOr":"and","value":["IOT","TIC"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"MIX_PRODUTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"oQPPiV","type":"value","andOr":"and","value":["EM ANDAMENTO","EM COTAÇÃO","EM ELABORAÇÃO","INTERROMPIDO"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"SUB_STATUS","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"zhUKfk","type":"value","andOr":"and","value":"80","dataType":"Nullable(Int64)","operator":"=","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"TEMPERATURA","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"svAAKi","type":"value","andOr":"and","value":"SIM","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"tabela_cockpit","valueType":"value","columnName":"COMPROMETIDO","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"Jfvxrr","type":"computed","alias":"DATA_PREV_FECHAMENTO","content":"MIN(toStartOfMonth(DATA_PREV_FECHAMENTO))","dataType":"Nullable(Date)","distinct":false,"columnName":"DATA_PREV_FECHAMENTO","computedId":"nZeicx"},{"id":"kDJoxv","type":"computed","alias":"SEGMENTO","content":"'CORPORATIVO'","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"PemVjl"},{"id":"dZNMwA","type":"computed","alias":"BEST_IOT","content":"SUM(CASE\nWHEN MIX_PRODUTO = 'IOT' AND toDayOfMonth(today()) < 29  THEN RECEITA_BRUTA_ESPERADA\nELSE 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"BEST_IOT","computedId":"PFVXRu","columnLength":2},{"id":"qcMAnm","type":"computed","alias":"BEST_TIC","content":"SUM(CASE\nWHEN MIX_PRODUTO = 'TIC' AND toDayOfMonth(today()) < 29 THEN RECEITA_BRUTA_ESPERADA\nELSE 0\nEND)","dataType":"Nullable(Float64)","distinct":false,"columnName":"BEST_TIC","computedId":"KGNprS","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"BEST_IOT","content":"SUM(CASE\nWHEN MIX_PRODUTO = 'IOT' AND toDayOfMonth(today()) < 29  THEN RECEITA_BRUTA_ESPERADA\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"BEST_IOT","computedId":"PFVXRu","columnLength":2},{"type":"computed","alias":"BEST_TIC","content":"SUM(CASE\nWHEN MIX_PRODUTO = 'TIC' AND toDayOfMonth(today()) < 29 THEN RECEITA_BRUTA_ESPERADA\nELSE 0\nEND)","dataType":"Nullable(Float64)","columnName":"BEST_TIC","computedId":"KGNprS","columnLength":2},{"type":"computed","alias":"DATA_PREV_FECHAMENTO","content":"MIN(toStartOfMonth(DATA_PREV_FECHAMENTO))","dataType":"Nullable(Date)","columnName":"DATA_PREV_FECHAMENTO","computedId":"nZeicx"},{"type":"computed","alias":"SEGMENTO","content":"'CORPORATIVO'","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"PemVjl"}]},"created":false,"optimize":false,"position":{"x":248.99783805236729,"y":-0.9999686674256054},"sourceId":7,"tableName":"tabela_cockpit","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_forecast_cockpit","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vYpQvJ","type":"table","appId":137,"label":"tmp_aux_forecast_cockpit","client":"clickhouse","repoId":1,"shared":false,"position":{"x":388.996271423648,"y":-5.684341886080804e-14},"sourceId":7,"tableName":"tmp_aux_forecast_cockpit","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"fSDXud","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_aux_forecast_cockpit","id":"dpQHSu","to":"tmp_forecast_tic_iot","raw":"","list":[{"id":"bAYOiR","andOr":"and","tableBy":"tmp_aux_forecast_cockpit","tableTo":"tmp_forecast_tic_iot","columnBy":"DATA_PREV_FECHAMENTO","columnTo":"DATA_REF","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"JbkkcS","andOr":"and","tableBy":"tmp_aux_forecast_cockpit","tableTo":"tmp_forecast_tic_iot","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"full","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"bdEVpn","type":"value","dataType":"Nullable(Date)","tableName":"tmp_forecast_tic_iot","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"BDKQwc","type":"value","dataType":"Nullable(String)","tableName":"tmp_forecast_tic_iot","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"bdEVpn","type":"value","dataType":"Nullable(Date)","tableName":"tmp_forecast_tic_iot","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"BDKQwc","type":"value","dataType":"Nullable(String)","tableName":"tmp_forecast_tic_iot","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"PisKTh","type":"computed","alias":"IOT","content":"SUM(CASE WHEN BEST_IOT IS NULL THEN 0 ELSE BEST_IOT END)+SUM(CASE WHEN FORECAST_IOT IS NULL THEN 0 ELSE FORECAST_IOT END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"IOT","computedId":"eLlgzp","columnLength":2},{"id":"lRWxrf","type":"computed","alias":"TIC","content":"SUM(CASE WHEN BEST_TIC IS NULL THEN 0 ELSE BEST_TIC END)+SUM(CASE WHEN FORECAST_TIC IS NULL THEN 0 ELSE FORECAST_TIC END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"TIC","computedId":"TeshpB","columnLength":2},{"id":"gjRgez","type":"sum","alias":"REAL_IOT","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_forecast_tic_iot","columnName":"REAL_IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"FRnDwq","type":"sum","alias":"REAL_TIC","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_forecast_tic_iot","columnName":"REAL_TIC","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"IOT","content":"SUM(CASE WHEN BEST_IOT IS NULL THEN 0 ELSE BEST_IOT END)+SUM(CASE WHEN FORECAST_IOT IS NULL THEN 0 ELSE FORECAST_IOT END)","dataType":"Nullable(Float64)","columnName":"IOT","computedId":"eLlgzp","columnLength":2},{"type":"computed","alias":"TIC","content":"SUM(CASE WHEN BEST_TIC IS NULL THEN 0 ELSE BEST_TIC END)+SUM(CASE WHEN FORECAST_TIC IS NULL THEN 0 ELSE FORECAST_TIC END)","dataType":"Nullable(Float64)","columnName":"TIC","computedId":"TeshpB","columnLength":2}]},"created":false,"optimize":false,"position":{"x":496.995707437309,"y":-1.9999373348512688},"sourceId":7,"tableName":"tmp_aux_forecast_cockpit","tableView":false,"temporary":false,"dropTables":[],"sourceType":"bucket","resultTable":"forecast_tic_iot_final","bucketClient":"clickhouse","databaseName":"bucket_137","truncateTables":["validacao_tic_iot_diario"]},{"id":"YluZUf","type":"table","appId":137,"label":"forecast_tic_iot_final","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":582.9958327676065,"y":0.9999686674255476},"sourceId":7,"tableName":"forecast_tic_iot_final","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kFYYuU","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"sCJQMN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_tic_iot_final","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oxPxoA","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"forecast_tic_iot_final","columnName":"REAL_TIC","columnLength":2,"databaseName":"bucket_137"},{"id":"sVnqiz","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"forecast_tic_iot_final","columnName":"TIC","columnLength":2,"databaseName":"bucket_137"},{"id":"naUsSM","type":"computed","alias":"PRODUTO","content":"'TIC'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"fTEQDp"}],"update":[],"computed":[{"type":"computed","alias":"PRODUTO","content":"'TIC'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"fTEQDp"}]},"created":false,"optimize":false,"position":{"x":752.9933261616554,"y":132.0027572665462},"sourceId":7,"tableName":"forecast_tic_iot_final","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"validacao_tic_diario","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"kTSLQC","type":"table","appId":137,"label":"validacao_tic_diario","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":904.9913835420432,"y":132.00275726654615},"sourceId":7,"tableName":"validacao_tic_diario","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"HBzlzf","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"validacao_tic_diario","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"validacao_tic_diario","columnName":"REAL_TIC","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL_IOT"},{"dataType":"Nullable(Float64)","tableName":"validacao_tic_diario","columnName":"TIC","columnLength":2,"databaseName":"bucket_137","targetColumn":"IOT"},{"dataType":"Nullable(String)","tableName":"validacao_tic_diario","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"}]},"shared":false,"created":false,"position":{"x":1037.9899422436213,"y":133.00303925971565},"sourceId":7,"tableName":"validacao_tic_diario","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"validacao_tic_iot_diario","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"oQMYCB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"sCJQMN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_tic_iot_final","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oHFcxW","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"forecast_tic_iot_final","columnName":"REAL_IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"ugfppJ","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"forecast_tic_iot_final","columnName":"IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"pkiLSq","type":"computed","alias":"PRODUTO","content":"'IOT'","dataType":"Nullable(String)","distinct":false,"columnName":"PRODUTO","computedId":"RJWjsY"}],"update":[],"computed":[{"type":"computed","alias":"PRODUTO","content":"'IOT'","dataType":"Nullable(String)","columnName":"PRODUTO","computedId":"RJWjsY"}]},"created":false,"optimize":false,"position":{"x":745.9935454896761,"y":-61.99398414571738},"sourceId":7,"tableName":"forecast_tic_iot_final","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"validacao_iot_diario","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"vcAcls","type":"table","appId":137,"label":"validacao_iot_diario","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":897.9916028700641,"y":-62.99395281314298},"sourceId":7,"tableName":"validacao_iot_diario","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qfHscW","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"validacao_iot_diario","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(Float64)","tableName":"validacao_iot_diario","columnName":"REAL_IOT","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL_IOT"},{"dataType":"Nullable(Float64)","tableName":"validacao_iot_diario","columnName":"IOT","columnLength":2,"databaseName":"bucket_137","targetColumn":"IOT"},{"dataType":"Nullable(String)","tableName":"validacao_iot_diario","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"}]},"shared":false,"created":false,"position":{"x":1042.9900989064936,"y":-61.99273084274185},"sourceId":7,"tableName":"validacao_iot_diario","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"validacao_tic_iot_diario","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"uIrswU","type":"table","appId":137,"label":"validacao_tic_iot_diario","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1191.9876549656913,"y":41.00385390664985},"sourceId":7,"tableName":"validacao_tic_iot_diario","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"KFrGig","type":"table","appId":137,"label":"base_orcado_tic_iot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":749.4985587015784,"y":285.99724273345373},"tableName":"base_orcado_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JgDqNX","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"HchrYu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_tic_iot","columnName":"produto","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HchrYu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_orcado_tic_iot","columnName":"produto","columnLength":null,"databaseName":"bucket_137"},{"id":"weKONH","type":"sum","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_tic_iot","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":900.4966474145405,"y":286.99924801821464},"tableName":"base_orcado_tic_iot","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_orcado_tic_iot_validacao","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"NRcEJD","type":"table","appId":137,"label":"base_orcado_tic_iot_validacao","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1049.4947987926514,"y":286.99924801821464},"tableName":"base_orcado_tic_iot_validacao","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"Jyjcdv","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"validacao_tic_iot_diario","id":"KaHkpk","to":"base_orcado_tic_iot_validacao","raw":"","list":[{"id":"vhOCar","andOr":"and","tableBy":"validacao_tic_iot_diario","tableTo":"base_orcado_tic_iot_validacao","columnBy":"PRODUTO","columnTo":"produto","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"nZhuUW","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"validacao_tic_iot_diario","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"SLEZDU","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"validacao_tic_iot_diario","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"SGylGS","type":"value","dataType":"Nullable(String)","tableName":"validacao_tic_iot_diario","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"JBUiyr","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"validacao_tic_iot_diario","columnName":"REAL_IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"jbBTMz","type":"value","alias":"FORECAST","dataType":"Nullable(Float64)","distinct":false,"tableName":"validacao_tic_iot_diario","columnName":"IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"ptAXpV","type":"value","dataType":"Nullable(String)","tableName":"validacao_tic_iot_diario","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"SGylGS","type":"value","dataType":"Nullable(String)","tableName":"validacao_tic_iot_diario","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"JBUiyr","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"validacao_tic_iot_diario","columnName":"REAL_IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"jbBTMz","type":"value","alias":"FORECAST","dataType":"Nullable(Float64)","distinct":false,"tableName":"validacao_tic_iot_diario","columnName":"IOT","columnLength":2,"databaseName":"bucket_137"},{"id":"ptAXpV","type":"value","dataType":"Nullable(String)","tableName":"validacao_tic_iot_diario","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137"},{"id":"nXWmbT","type":"max","alias":"ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_tic_iot_validacao","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":1281.9876549656913,"y":106.00385390664984},"sourceId":7,"tableName":"validacao_tic_iot_diario","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"BASE_FINAL_VALIDACAO_TIC_IOT","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ukvpam","type":"table","appId":137,"label":"BASE_FINAL_VALIDACAO_TIC_IOT","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1481.9842083825083,"y":105.00388523922418},"sourceId":7,"tableName":"BASE_FINAL_VALIDACAO_TIC_IOT","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"EYRyjT","source":"eHzJER","target":"mPhrmB"},{"id":"hFdAnk","source":"ghKpjf","target":"pnASFO"},{"id":"nBAXku","source":"pnASFO","target":"lmvTua"},{"id":"ACHBUf","type":"manual","label":"","source":"eHzJER","target":"dFgSTJ"},{"id":"VGMisN","type":"manual","label":"","source":"KIIDTe","target":"CwVfpT"},{"id":"tnfdgs","type":"manual","label":"","source":"dFgSTJ","target":"fSDXud"},{"id":"otuBFk","type":"manual","label":"","source":"CwVfpT","target":"fSDXud"},{"id":"KRmYth","source":"vYpQvJ","target":"fSDXud"},{"id":"hiHjwI","source":"NdwrRM","target":"fSDXud"},{"id":"TGUEEh","source":"fSDXud","target":"YluZUf"},{"id":"XJRSoe","source":"vcAcls","target":"qfHscW"},{"id":"lwCstV","source":"kTSLQC","target":"HBzlzf"},{"id":"WIeYjx","source":"YluZUf","target":"kFYYuU"},{"id":"dhXWfm","source":"kFYYuU","target":"kTSLQC"},{"id":"SEjMoV","source":"KFrGig","target":"JgDqNX"},{"id":"cPowuT","source":"JgDqNX","target":"NRcEJD"},{"id":"PpbGJc","source":"YluZUf","target":"oQMYCB"},{"id":"TvPqJY","source":"oQMYCB","target":"vcAcls"},{"id":"splKwY","source":"qfHscW","target":"uIrswU"},{"id":"KqlxAW","source":"HBzlzf","target":"uIrswU"},{"id":"HvojVy","source":"uIrswU","target":"Jyjcdv"},{"id":"AnObTF","source":"NRcEJD","target":"Jyjcdv"},{"id":"vJxnDl","source":"Jyjcdv","target":"ukvpam"},{"id":"orLKVu","source":"KIIDTe","target":"ghKpjf"},{"id":"yLBTBF","source":"dqlUPL","target":"dFgSTJ"},{"id":"zCbqnG","source":"mPhrmB","target":"dFgSTJ"},{"id":"YVnVcn","source":"dFgSTJ","target":"NdwrRM"},{"id":"TeJVgU","source":"DVDkVy","target":"aLToXT"},{"id":"czbHVl","source":"aLToXT","target":"iRwsgF"},{"id":"epEmdX","source":"dqlUPL","target":"CKKgWG"},{"id":"JZFDbU","source":"CKKgWG","target":"pZDFWQ"},{"id":"UVItEt","source":"iRwsgF","target":"fHaBAb"},{"id":"FSUzPD","source":"pZDFWQ","target":"fHaBAb"},{"id":"tsxahn","source":"fHaBAb","target":"SYzQyT"},{"id":"EZylsD","source":"iRwsgF","target":"zXttII"},{"id":"BBDHvo","source":"pZDFWQ","target":"zXttII"},{"id":"oLuBBB","source":"zXttII","target":"GeFgKm"},{"id":"DsSZsE","source":"ghKpjf","target":"CwVfpT"},{"id":"cCSBPK","source":"CwVfpT","target":"vYpQvJ"}]},"cron":null,"options":{"folder":"CARGAS","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"RWMDKeeOkpvKiimYabWJRKcumkqbPrOi","flowDescription":"","locked":null,"created":"2023-06-30 09:24:58","updated":"2023-09-08 09:08:23"},{"flowId":"3302","appId":137,"flowName":"Previsão MPE - v6","workflow":{"nodes":[{"id":"yodaDm","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT DATA, dias_uteis_corridos as dias_uteis_corridos, SUM(qtd) over(PARTITION BY trunc(DATA,'mm') order BY DATA rows between unbounded preceding and current ROW)  AS qtd\r\nFROM (\r\nselect trunc(A.dat_dia, 'dd') data,\r\n       TAB.DIAS_UTEIS_CORRIDOS,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'MM') AS anomes,\r\n             SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0\r\n                      WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                      ELSE 1 \r\n                 END) AS DIAS_UTEIS_CORRIDOS\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n     \tAND trunc(A.dat_dia, 'mm') >= trunc(sysdate-60,'mm')\r\n        \r\n      GROUP BY TRUNC(DAT_DIA,'MM')) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'mm') = tab.anomes\r\nGROUP BY trunc(A.dat_dia, 'dd'),\r\n         TAB.DIAS_UTEIS_CORRIDOS, A.DSC_DIA_SMN_ABV\r\nORDER BY trunc(A.dat_dia, 'dd')\r\n)\r\nGROUP BY DATA, dias_uteis_corridos, qtd","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":22,"y":265},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"dias_uteis_forecast_mpe","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"VheAYM","type":"table","appId":137,"label":"dias_uteis_forecast_mpe","client":"clickhouse","repoId":1,"shared":false,"position":{"x":219,"y":265},"sourceId":7,"tableName":"dias_uteis_forecast_mpe","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"UlRLwe","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\nDIA_UTIL AS (\r\n\r\nselect TAB.DATA,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'DD') AS DATA,\r\n             DSC_DIA_SMN_ABV\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n        and TRUNC(A.dat_dia, 'MM') >= TO_DATE('20230101','YYYYMMDD')\r\n        and TRUNC(A.dat_dia, 'MM') <= SYSDATE\r\n      GROUP BY TRUNC(DAT_DIA,'DD'), DSC_DIA_SMN_ABV) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'DD') = tab.DATA\r\nGROUP BY TAB.DATA\r\nORDER BY TAB.DATA\r\n),\r\n\r\nMENSAL AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'MM') AS DATA\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230430','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'MM')\r\n),\r\n\r\nDIA_UTIL_MENSAL AS (\r\n\r\nselect TRUNC(TAB.DATA,'MM') AS DATA,\r\n       SUM(CASE WHEN A.DSC_DIA_SMN_ABV = 'SAB' THEN 0 \r\n                WHEN A.DSC_DIA_SMN_ABV = 'DOM' THEN 0\r\n                ELSE 1 \r\n           END) AS qtd\r\n  from\r\n      (select TRUNC(DAT_DIA,'DD') AS DATA,\r\n             DSC_DIA_SMN_ABV\r\n      from DWADM.D_PERIODO A\r\n     where 1 = 1\r\n        and TRUNC(A.dat_dia, 'MM') >= TO_DATE('20230101','YYYYMMDD')\r\n        and TRUNC(A.dat_dia, 'MM') <= SYSDATE\r\n      GROUP BY TRUNC(DAT_DIA,'DD'), DSC_DIA_SMN_ABV) tab,\r\n      DWADM.D_PERIODO A\r\nwhere trunc(a.dat_dia,'DD') = tab.DATA\r\nGROUP BY TRUNC(TAB.DATA,'MM')\r\nORDER BY TRUNC(TAB.DATA,'MM')\r\n),\r\n\r\nMENSAL AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'MM') AS DATA\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230430','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'MM')\r\n),\r\n\r\nDIARIO AS (\r\nSELECT    TRUNC(DAT_DIA_MES_REF, 'DD') AS DATA\r\n\t\t, DSC_LNH_NGC AS PRODUTO\r\n\t\t, DSC_REG_ITL AS REGIONAL\r\n\t\t, SUM(VLR_IND) AS VENDA\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n\tAND TIP_MTC = 'VENDAS - NOVA VENDA - COMERCIAL'\r\n\tAND DSC_SGM_CLI = 'EMPRESARIAL'\r\n\tAND TRUNC(DAT_DIA_MES_REF, 'MM') BETWEEN TO_DATE('20230101','YYYYMMDD') AND TO_DATE('20230430','YYYYMMDD')\r\nGROUP BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\nORDER BY TRUNC(DAT_DIA_MES_REF, 'DD'), DSC_LNH_NGC, DSC_REG_ITL\r\n)\r\n\r\nSELECT D.DATA AS DATA\r\n, SUM(DU.QTD) OVER (PARTITION BY EXTRACT(MONTH FROM DU.DATA) order BY DU.DATA rows between unbounded preceding and current ROW) AS DIAS_ATUAL\r\n, sum(D.VENDA) AS VENDA\r\n, DUM.QTD AS DIAS_TOTAIS\r\n, SUM(SUM(D.VENDA)) over(PARTITION BY  EXTRACT(MONTH FROM D.DATA) order BY D.DATA rows between unbounded preceding and current ROW) AS VENDA_ACU\r\n, MAX(M.VENDA) AS FINAL\r\nFROM DIARIO D\r\nINNER JOIN MENSAL M\r\n\tON (TRUNC(D.DATA, 'MM') = M.DATA)\r\nINNER JOIN DIA_UTIL DU \r\n\tON (D.DATA = DU.DATA)\r\nLEFT JOIN DIA_UTIL_MENSAL DUM\r\n\tON (TRUNC(DU.DATA,'MM') = DUM.DATA)\r\nGROUP BY D.DATA, DUM.QTD, DU.QTD, DU.DATA","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":29.99974933940489,"y":35.999906002276816},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"TABELA_TREINO_ML_PREVISAO_MPE_v6","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"xmEShv","type":"table","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE_v6","client":"clickhouse","repoId":1,"shared":false,"position":{"x":219,"y":33},"sourceId":7,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE_v6","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ALsHWo","type":"automl","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE_v6","client":"clickhouse","repoId":1,"created":false,"position":{"x":519,"y":33},"settings":{"seed":7,"maxModels":999,"projectId":"ALsHWo","splitFrame":0.7,"projectName":"project_ALsHWo","reloadSource":true,"removeColumns":["VENDA"],"trainingFrame":"TABELA_TREINO_ML_PREVISAO_MPE_v6","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE_v6","sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZfsPjE","type":"automlReport","appId":137,"label":"TABELA_TREINO_ML_PREVISAO_MPE_v6","client":"clickhouse","repoId":1,"created":false,"position":{"x":830.5,"y":33},"settings":{"seed":7,"maxModels":999,"projectId":"ALsHWo","splitFrame":0.7,"projectName":"project_ALsHWo","reloadSource":true,"removeColumns":["VENDA"],"trainingFrame":"TABELA_TREINO_ML_PREVISAO_MPE_v6","maxRuntimeSecs":30,"responseColumn":"FINAL"},"sourceId":7,"limitRows":100000,"tableName":"TABELA_TREINO_ML_PREVISAO_MPE_v6","sourceType":"bucket","databaseName":"bucket_137"},{"id":"awFTRN","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":219,"y":149},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"RnyLVB","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"VpqCHL","to":"dias_uteis_forecast_mpe","raw":"","list":[{"id":"CSopbP","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"dias_uteis_forecast_mpe","columnBy":"DATA_REF","columnTo":"DATA","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"gtYHNe","type":"value","alias":"DATA","order":"asc","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"SxUKcc","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"jnRRfj","type":"value","dataType":"Nullable(Int64)","tableName":"dias_uteis_forecast_mpe","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"jwqefP","type":"value","andOr":"and","value":"Venda","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"Mqwbeq","type":"value","andOr":"and","value":"EMPRESARIAL","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"SEGMENTO","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"VAUCJw","type":"value","andOr":"and","value":"2023-05-01 00:00:00","dataType":"Nullable(DateTime)","operator":">=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"aKUmbY","type":"value","alias":"DATA","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"cujiXa","type":"value","alias":"DIAS_ATUAIS","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"QTD","columnLength":2,"databaseName":"bucket_137"},{"id":"SxUKcc","type":"value","alias":"DIAS_TOTAIS","dataType":"Nullable(Int64)","distinct":false,"tableName":"dias_uteis_forecast_mpe","columnName":"DIAS_UTEIS_CORRIDOS","columnLength":2,"databaseName":"bucket_137"},{"id":"iXrIZp","type":"sum","alias":"VENDA","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":519,"y":207},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"zMEfsi","type":"table","appId":137,"label":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","client":"clickhouse","repoId":1,"shared":false,"position":{"x":830.5,"y":207},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LUMmUZ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"HgaDfR","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"DATA","columnLength":2,"databaseName":"bucket_137"},{"id":"lxAPYh","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"DIAS_ATUAIS","columnLength":2,"databaseName":"bucket_137"},{"id":"RNFYPv","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"DIAS_TOTAIS","columnLength":2,"databaseName":"bucket_137"},{"id":"uzwEkb","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"VENDA","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"HgaDfR","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"DATA","columnLength":2,"databaseName":"bucket_137"},{"id":"lxAPYh","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"DIAS_ATUAIS","columnLength":2,"databaseName":"bucket_137"},{"id":"RNFYPv","type":"value","dataType":"Nullable(Int64)","tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"DIAS_TOTAIS","columnLength":2,"databaseName":"bucket_137"},{"id":"jpBFhk","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","columnName":"VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"CReiav","type":"computed","alias":"VENDA_ACU","content":"sum(VENDA) OVER\r\n       (PARTITION BY DIAS_TOTAIS ORDER BY DATA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","distinct":false,"columnName":"VENDA_ACU","computedId":"AbaZpS","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"VENDA_ACU","content":"sum(VENDA) OVER\r\n       (PARTITION BY DIAS_TOTAIS ORDER BY DATA ASC Rows BETWEEN 1000 PRECEDING AND CURRENT ROW)","dataType":"Nullable(Float64)","columnName":"VENDA_ACU","computedId":"AbaZpS","columnLength":2}]},"created":false,"optimize":false,"position":{"x":1044,"y":207},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v6_aux","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_modelo_mpe_venda_forecast_v6","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"zRQZJD","type":"table","appId":137,"label":"tmp_teste_modelo_mpe_venda_forecast_v6","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1244.5,"y":207},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v6","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"couTQu","type":"scoring","appId":137,"label":"Score: tmp_teste_modelo_mpe_venda_forecast_v6","client":"clickhouse","repoId":1,"shared":false,"created":false,"modelId":171,"position":{"x":1541.5,"y":207},"sourceId":null,"tableName":"tmp_teste_modelo_mpe_venda_forecast_v6","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"score_tmp_teste_modelo_mpe_venda_forecast_v6","databaseName":"bucket_137"},{"id":"ztlkbw","type":"table","appId":137,"label":"score_tmp_teste_modelo_mpe_venda_forecast_v6","client":"clickhouse","repoId":1,"created":false,"position":{"x":1856.5,"y":207},"tableName":"score_tmp_teste_modelo_mpe_venda_forecast_v6","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"nXaMpT","source":"zRQZJD","target":"couTQu"},{"id":"JaSxZQ","source":"couTQu","target":"ztlkbw"},{"id":"BMaEBn","source":"xmEShv","target":"ALsHWo"},{"id":"teEODa","source":"ALsHWo","target":"ZfsPjE"},{"id":"NRwrgA","source":"zMEfsi","target":"LUMmUZ"},{"id":"wIisTo","source":"LUMmUZ","target":"zRQZJD"},{"id":"WlvbYg","source":"awFTRN","target":"RnyLVB"},{"id":"RuXLSA","source":"VheAYM","target":"RnyLVB"},{"id":"FbaGEI","source":"RnyLVB","target":"zMEfsi"},{"id":"zwJVsW","source":"UlRLwe","target":"xmEShv"},{"id":"KxiLvg","source":"yodaDm","target":"VheAYM"}]},"cron":null,"options":{"reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":99,"flowStart":1,"flowType":"dataPrep","flowKey":"bCJbZONaoUBDvUpxfYlYmvyhLyGosfEx","flowDescription":"","locked":"no","created":"2023-07-03 14:36:45","updated":"2023-09-08 09:08:23"},{"flowId":"3322","appId":137,"flowName":"TRIGGER MSG USO AVULSO","workflow":{"nodes":[{"id":"KqpvhA","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":30.5,"y":33},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"wHiBpT","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"pRLJim","type":"value","dataType":"Nullable(String)","tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"CxiRRN","type":"value","dataType":"Nullable(String)","tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"sMJTnH","type":"value","alias":"","andOr":"and","value":"Carlos Humberto","dataType":"Nullable(String)","distinct":false,"operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"nome","extraValue":"","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"VhlYqB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"AzOqXP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":138,"y":33},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"email_prepara","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"zfFbVL","type":"table","appId":137,"label":"email_prepara","client":"clickhouse","repoId":1,"shared":false,"position":{"x":258.5,"y":33},"sourceId":null,"tableName":"email_prepara","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OoRddn","url":"https://5ylb6d3zd9.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"As cargas no sistema de origem DW estão com atraso estimado de 4 horas, e por conta disso impactaram a publicação de indicadores d-1. Por isso excepcionalmente hoje, a disponibilização de resultados no Portal Analytics será realizada no fim da manhã/início da tarde.\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         }\r\n         \r\n         \r\n         \r\n         \r\n                 \r\n \r\n         \r\n         \r\n         \r\n         \r\n         \r\n        \r\n         \r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"IGQTw40IJm3etD5zfdcUAHFs9L7GcyF58wnYLZy0"}],"options":{},"timeout":0,"position":{"x":374,"y":33},"restType":"rest","tableName":"email_prepara","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_recebeu","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"jfntKk","type":"table","appId":137,"label":"log_recebeu","client":"clickhouse","repoId":1,"created":false,"position":{"x":482.5,"y":33},"tableName":"log_recebeu","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"icIxvX","source":"KqpvhA","target":"wHiBpT"},{"id":"wRbnqI","source":"wHiBpT","target":"zfFbVL"},{"id":"DRqqLo","source":"zfFbVL","target":"OoRddn"},{"id":"DiLRBZ","source":"OoRddn","target":"jfntKk"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"QPReyNGsSniiXDeYEddPlIXJjkrFMdSq","flowDescription":"","locked":"no","created":"2023-07-04 11:55:13","updated":"2023-09-08 09:08:23"},{"flowId":"3323","appId":137,"flowName":"FECHAMENTO FLUXO","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"position":{"x":2499.5,"y":206},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mvskWg","type":"table","appId":137,"label":"app_analy_info","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1407.5038918506118,"y":110.9788518306384},"sourceId":null,"tableName":"app_analy_info","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FMbcyi","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":82,"y":54},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"ustfRF","type":"table","appId":137,"label":"base_orcado_portal_sgm","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":82,"y":170},"sourceId":null,"tableName":"base_orcado_portal_sgm","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"rBtgRI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[{"by":"IND_SAP_PLANEJAMENTO","id":"rVTZKe","to":"base_orcado_portal_sgm","raw":"","list":[{"id":"Tqywwc","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"DATA_REF","columnTo":"mes_ref","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"NaKfBI","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"SEGMENTO","columnTo":"segmento","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"QhJqUi","andOr":"and","tableBy":"IND_SAP_PLANEJAMENTO","tableTo":"base_orcado_portal_sgm","columnBy":"TIP_MTC","columnTo":"tip_mtc","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"VDNaMT","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"flfZhL","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"jpOUjw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"gFehbn","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"BJGcRN","type":"value","alias":"","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","distinct":false,"operator":"in","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"value","columnName":"TIP_MTC","extraValue":[],"columnLength":2,"databaseName":"bucket_137"},{"id":"gymQoD","type":"value","andOr":"and","value":"toStartOfMonth(addDays(today(),-10))","dataType":"Nullable(DateTime)","operator":"=","fieldType":"value","tableName":"IND_SAP_PLANEJAMENTO","valueType":"computed","columnName":"DATA_REF","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ebqPuN","type":"value","alias":"","dataType":"Nullable(DateTime)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"zxtcQs","type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"id":"kIXayp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"WYGlTN","type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Mes_Ref","computedId":"jxOlCh"},{"id":"DlOLdI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"AADvRI","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QhBDxG","type":"max","alias":"max_ORCADO","dataType":"Nullable(Float64)","distinct":false,"tableName":"base_orcado_portal_sgm","columnName":"ORCADO","columnLength":2,"databaseName":"bucket_137"},{"id":"hesRBK","type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","distinct":false,"columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}],"update":[],"computed":[{"type":"computed","alias":"Mes_Ref","content":"case\r\nwhen toMonth(DATA_REF) > 9\r\nthen concat(toString(toYear(DATA_REF)),toString(toMonth(DATA_REF)))\r\nelse concat(toString(toYear(DATA_REF)),'0',toString(toMonth(DATA_REF)))\r\nend","dataType":"Nullable(String)","columnName":"Mes_Ref","computedId":"jxOlCh"},{"type":"computed","alias":"Mes_Ref_Visual","content":"concat(\n\ncase\n    when toMonth(DATA_REF) = 1 then 'Jan'\n    when toMonth(DATA_REF) = 2 then 'Fev'\n    when toMonth(DATA_REF) = 3 then 'Mar'\n    when toMonth(DATA_REF) = 4 then 'Abr'\n    when toMonth(DATA_REF) = 5 then 'Mai'\n    when toMonth(DATA_REF) = 6 then 'Jun'\n    when toMonth(DATA_REF) = 7 then 'Jul'\n    when toMonth(DATA_REF) = 8 then 'Ago'\n    when toMonth(DATA_REF) = 9 then 'Set'\n    when toMonth(DATA_REF) = 10 then 'Out'\n    when toMonth(DATA_REF) = 11 then 'Nov'\n    when toMonth(DATA_REF) = 12 then 'Dez'\n    else ''\nend\n\n,\n'/'\n,\ntoString(toYear(DATA_REF))\n)\n","dataType":"Nullable(String)","columnName":"Mes_Ref_Visual","computedId":"wSrRnN"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Int64)","columnName":"ORCADO_TRATADO","computedId":"jRFkHc"}]},"created":false,"optimize":false,"position":{"x":266,"y":112},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_alerta_aux","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"RlloqT","type":"table","appId":137,"label":"tmp_alerta_aux","client":"clickhouse","repoId":1,"shared":false,"position":{"x":426,"y":112},"sourceId":null,"tableName":"tmp_alerta_aux","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"vNMXcv","type":"table","appId":137,"label":"forecast_insight","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":82,"y":344},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"BbkjnJ","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","parent":"YuYuwK","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"AOLjea","type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","distinct":false,"columnName":"metrica","computedId":"UQwPFw"},{"id":"YkXRWa","type":"value","alias":"sgm","dataType":"Nullable(String)","distinct":false,"tableName":"forecast_insight","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QgrZoa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"forecast_insight","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"metrica","content":"'Venda Mensal'","dataType":"Nullable(String)","columnName":"metrica","computedId":"UQwPFw"}]},"created":false,"optimize":false,"position":{"x":266,"y":344},"sourceId":null,"tableName":"forecast_insight","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_forecast_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"BQRWpp","type":"table","appId":137,"label":"tmp_forecast_alerta","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":426,"y":344},"sourceId":null,"tableName":"tmp_forecast_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"YuYuwK","type":"group","label":"Parallel","created":false,"position":{"x":266,"y":238.5}},{"id":"RRoyis","type":"table","appId":137,"label":"teste_mail","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":430.9725506521311,"y":217.9892816832131},"sourceId":null,"tableName":"teste_mail","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"kSIbMZ","type":"builder","appId":137,"label":"Visão Segmento","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_alerta_aux","id":"thRAEV","to":"tmp_forecast_alerta","raw":"","list":[{"id":"PAjsVb","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"TIP_MTC","columnTo":"metrica","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"lWkUve","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"tmp_forecast_alerta","columnBy":"SEGMENTO","columnTo":"sgm","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"by":"tmp_alerta_aux","id":"iHPXzk","to":"teste_mail","raw":"","list":[{"id":"aqWATR","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"SEGMENTO","columnTo":"visao","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"SHQxUQ","andOr":"and","tableBy":"tmp_alerta_aux","tableTo":"teste_mail","columnBy":"TIP_MTC","columnTo":"indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"uerfTQ","type":"value","order":"asc","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"tTsZhJ","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"qMXQWm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"IPANCG","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"ddkoDI","type":"value","dataType":"Nullable(String)","tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CPlPjP","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Gtaiff","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"wdPKUm","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"SjNjTc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rxeDEX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"GGtaWk","type":"value","andOr":"and","value":"1","dataType":"Nullable(String)","operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"ativo","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"vOFPZS","type":"value","alias":"","andOr":"and","value":"carloshj@algartelecom.com.br","dataType":"Nullable(String)","distinct":false,"operator":"=","fieldType":"value","tableName":"teste_mail","valueType":"value","columnName":"email","extraValue":"","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"MWBkFX","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"qSyrgY","type":"value","alias":"DIA","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref_Visual","columnLength":null,"databaseName":"bucket_137"},{"id":"rCMzcd","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"Mes_Ref","columnLength":null,"databaseName":"bucket_137"},{"id":"CdkxNl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"llTcdN","type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\nEND","dataType":"Nullable(String)","distinct":false,"columnName":"segmento_tratado","computedId":"PBipBh"},{"id":"HHGYbD","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"QBQeIa","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_alerta_aux","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"kFSItW","type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","distinct":false,"columnName":"teste","computedId":"gAYpmL"},{"id":"WObqMW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"QgdcSU","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_forecast_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"tOvMBM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"},{"id":"rmluuw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"teste_mail","columnName":"email","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"DIA","content":"dayofmonth(DATA_REF)","dataType":"Nullable(Int64)","columnName":"DIA","computedId":"KtGlpz"},{"type":"computed","alias":"ORCADO_TRATADO","content":"MAX(CASE\nWHEN ORCADO IS NULL THEN 0\nELSE ORCADO\nEND)","dataType":"Nullable(Float64)","columnName":"ORCADO_TRATADO","computedId":"LShYQN","columnLength":2},{"type":"computed","alias":"mensagem","content":"concat(\n\nconcat(concat(concat('Olá ' ,  max(nome)), ', espero que esteja tudo bem!\\n'),\n\n\n' Segue resumo dos indicadores d-1 dos segmentos')\n,\ntoString(sum(REAL) over (partition by email))\n\n\n)","dataType":"Nullable(String)","columnName":"mensagem","computedId":"CrdTAV"},{"type":"computed","alias":"teste","content":"sum(REAL) over (partition by email)","dataType":"Nullable(String)","columnName":"teste","computedId":"gAYpmL"},{"type":"computed","alias":"segmento_tratado","content":"case\n    when SEGMENTO = 'OPERADORAS'  THEN 'Atacado'\n    when SEGMENTO = 'CORPORATIVO' THEN 'Corporativo'\n    when SEGMENTO = 'EMPRESARIAL' THEN 'MPE'\n    when SEGMENTO = 'RESIDENCIAL' THEN 'Varejo'\nEND","dataType":"Nullable(String)","columnName":"segmento_tratado","computedId":"PBipBh"}]},"created":false,"position":{"x":566.5,"y":180},"sourceId":null,"tableName":"tmp_alerta_aux","sourceType":"bucket","resultTable":"tmp_aux_sgm_alerta","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"SRINxy","url":"https://login.microsoftonline.com/aed466c0-de70-4cf7-9e10-5ea1f9a696f4/oauth2/token","body":"{\"grant_type\": \"{{grant_type}}\",\r\n\"client_id\": \"{{client_id}}\",\r\n\"client_secret\": \"{{client_secret}}\",\r\n\"resource\": \"https://graph.microsoft.com/\"\r\n}","type":"rest","appId":137,"label":"Tarefa","client":"clickhouse","flowId":"3323","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/x-www-form-urlencoded"}],"options":{},"timeout":0,"position":{"x":1392.9935380593618,"y":237.99074767590432},"restType":"rest","tableName":"app_analy_info","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"AnalyToken","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":true},{"id":"aANSCa","type":"table","appId":137,"label":"AnalyToken","client":"clickhouse","repoId":1,"created":false,"position":{"x":1565.4983845148404,"y":243.991188262766},"tableName":"AnalyToken","sourceType":"bucket","databaseName":"bucket_137"},{"id":"ZPFtkr","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":1716.5005874491485,"y":238.9908211070479},"tableName":"AnalyToken","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"token_graph","columnName":"access_token"}]},{"id":"WLTLOw","url":"https://login.microsoftonline.com/botframework.com/oauth2/v2.0/token","body":"{\"grant_type\": \"{{grant_type}}\",\r\n\"client_id\": \"{{client_id}}\",\r\n\"client_secret\": \"{{client_secret}}\",\r\n\"scope\": \"https://api.botframework.com/.default\"\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3323","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/x-www-form-urlencoded"}],"options":{},"timeout":0,"position":{"x":1421.9956675625267,"y":17.991849143058552},"restType":"rest","tableName":"app_analy_info","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"token_bot","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":true},{"id":"GlfBLs","type":"table","appId":137,"label":"token_bot","client":"clickhouse","repoId":1,"created":false,"position":{"x":1556.4977236345478,"y":27.992583454494707},"tableName":"token_bot","sourceType":"bucket","databaseName":"bucket_137"},{"id":"KOhmsS","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":1699.4993391197072,"y":33.993024041356406},"tableName":"token_bot","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"token_bot","columnName":"access_token"}]},{"id":"pJkPzF","type":"delete","appId":137,"label":"Delete","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":true,"engine":"innodb","filter":[{"list":[{"id":"QEMawC","type":"value","andOr":"and","dataType":"Nullable(String)","operator":"isNull","tableName":"tmp_aux_sgm_alerta","valueType":"value","columnName":"DIA","columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"update":[],"computed":[]},"created":false,"position":{"x":1102.4814953518087,"y":-20.022249636515863},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","sourceType":"bucket","bucketClient":"clickhouse","databaseName":"bucket_137","clearMutation":true},{"id":"MybeVZ","type":"table","appId":137,"label":"tmp_event_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1962.5,"y":356},"sourceId":null,"tableName":"tmp_event_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JQyDpi","type":"table","appId":137,"label":"tmp_envio_alerta2","client":"clickhouse","repoId":1,"shared":false,"position":{"x":1386.5023497965958,"y":364.0144659352925},"sourceId":null,"tableName":"tmp_envio_alerta2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EivOtX","type":"table","appId":137,"label":"tmp_aux_sgm_alerta","client":"clickhouse","repoId":1,"shared":false,"position":{"x":742.0023497965957,"y":185.0016889163032},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"PBrISI","type":"table","appId":137,"label":"ResultadoIDTEAMS","client":"clickhouse","repoId":1,"created":false,"position":{"x":2221.5,"y":220},"tableName":"ResultadoIDTEAMS","sourceType":"bucket","databaseName":"bucket_137"},{"id":"bsYYiW","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"MnoewF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"uhZGxj","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"hVJklO","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"GxdMQu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"oOaOFx","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"kxREQG","type":"sum","alias":"ORCADO_TRATADO","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137"},{"id":"oefYrH","type":"sum","alias":"FORECAST_VENDA","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137"},{"id":"oEcCxS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":739.9920694364894,"y":383.0124098632712},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_consolidado","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Notrgp","type":"table","appId":137,"label":"tmp_consolidado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":929.4966221673936,"y":380.0142456418616},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"DYcLht","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"nome","columnLength":2,"databaseName":"bucket_137","targetColumn":"nome"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"email","columnLength":2,"databaseName":"bucket_137","targetColumn":"email"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(Float64)","tableName":"tmp_consolidado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"ORCADO_TRATADO","columnLength":null,"databaseName":"bucket_137","targetColumn":"ORCADO_TRATADO"},{"dataType":"Nullable(Int64)","tableName":"tmp_consolidado","columnName":"FORECAST_VENDA","columnLength":2,"databaseName":"bucket_137","targetColumn":"FORECAST_VENDA"},{"dataType":"Nullable(String)","tableName":"tmp_consolidado","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137","targetColumn":"flag_de_acesso"}]},"shared":false,"created":false,"position":{"x":928.9871495498668,"y":289.0044792997606},"sourceId":null,"tableName":"tmp_consolidado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_aux_sgm_alerta","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"tbILex","type":"builder","appId":137,"label":"DUP -DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[{"id":"fxkzhn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"moralI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"gCNWfH","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"tYkDIL","type":"computed","alias":"id_analy","content":"'1'","dataType":"Nullable(String)","distinct":false,"columnName":"id_analy","computedId":"sxdxbM"},{"id":"xaduop","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"nome","columnLength":2,"databaseName":"bucket_137"},{"id":"VKXQId","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"email","columnLength":2,"databaseName":"bucket_137"},{"id":"XuPLsY","type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_vnd","computedId":"SWihKb"},{"id":"EbDuNz","type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"id":"SrThPF","type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ope_vnd","computedId":"sbovSd"},{"id":"brygbH","type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_vnd","computedId":"uUVxiO"},{"id":"OEpoMi","type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_crp_prd","computedId":"zsMWkr"},{"id":"mlZHKR","type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_emp_prd","computedId":"GwZUwh"},{"id":"WqsERO","type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_ata_prd","computedId":"ynBIlB"},{"id":"byIouZ","type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","distinct":false,"columnName":"msg_res_prd","computedId":"btTuhJ"},{"id":"ylzexC","type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"id":"ZjFMKB","type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","distinct":false,"columnName":"msg_csl_prd","computedId":"MmOWIX"},{"id":"NOJsmA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_aux_sgm_alerta","columnName":"flag_de_acesso","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"msg_crp_vnd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_vnd","computedId":"SWihKb"},{"type":"computed","alias":"msg_emp_vnd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_vnd","computedId":"cBBoWo"},{"type":"computed","alias":"msg_ope_vnd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ope_vnd","computedId":"sbovSd"},{"type":"computed","alias":"msg_res_vnd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Venda Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_vnd","computedId":"uUVxiO"},{"type":"computed","alias":"msg_crp_prd","content":"max(case when SEGMENTO = 'CORPORATIVO' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_crp_prd","computedId":"zsMWkr"},{"type":"computed","alias":"msg_emp_prd","content":"max(case when SEGMENTO = 'EMPRESARIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_emp_prd","computedId":"GwZUwh"},{"type":"computed","alias":"msg_ata_prd","content":"max(case when SEGMENTO = 'OPERADORAS' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_ata_prd","computedId":"ynBIlB"},{"type":"computed","alias":"msg_res_prd","content":"max(case when SEGMENTO = 'RESIDENCIAL' and TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat(segmento_tratado,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\nELSE '' END)","dataType":"Nullable(String)","columnName":"msg_res_prd","computedId":"btTuhJ"},{"type":"computed","alias":"id_analy","content":"'1'","dataType":"Nullable(String)","columnName":"id_analy","computedId":"sxdxbM"},{"type":"computed","alias":"msg_csl_vnd","content":"CASE WHEN flag_de_acesso = '1' then\r\n    max(case when DIA IS NULL AND TIP_MTC = 'Venda Mensal' THEN \r\n    concat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0))\r\n    ,' | ', '% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado) ')\r\n    ELSE '' END)\r\nELSE NULL\r\nend\r\n","dataType":"Nullable(String)","columnName":"msg_csl_vnd","computedId":"hQPuvw"},{"type":"computed","alias":"msg_csl_prd","content":"CASE WHEN flag_de_acesso = '1' then\r\nmax(case when DIA IS NULL AND TIP_MTC = 'Perda de Receita Mensal' THEN \r\nconcat('Algar Telecom' ,' - Real: ',toString(round(REAL/1000,0)),' | ','Orçado: ',toString(round(ORCADO_TRATADO/1000,0)),' | ','% Orçado: ',toString(round((REAL/ORCADO_TRATADO)*100,0)),'% (real x orçado)')\r\nELSE '' END)\r\nelse NULL\r\n\r\nend","dataType":"Nullable(String)","columnName":"msg_csl_prd","computedId":"MmOWIX"}]},"created":false,"optimize":false,"position":{"x":1060.9886181727395,"y":88.99273031678194},"sourceId":null,"tableName":"tmp_aux_sgm_alerta","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_envio_alerta2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eIfxFA","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_envio_alerta2","id":"ByfGWZ","to":"app_analy_info","raw":"","list":[{"id":"jRXLXL","andOr":"and","tableBy":"tmp_envio_alerta2","tableTo":"app_analy_info","columnBy":"id_analy","columnTo":"id","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"GZNcXv","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"id_analy","columnLength":null,"databaseName":"bucket_137"},{"id":"MhlwYJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"app_analy_info","columnName":"id","columnLength":null,"databaseName":"bucket_137"},{"id":"HsZyOf","type":"value","dataType":"Nullable(String)","tableName":"tmp_envio_alerta2","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"qarnEB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"TPKGGh","type":"computed","alias":"get_token","content":"'{{token_graph}}'","dataType":"Nullable(String)","distinct":false,"columnName":"get_token","computedId":"msBDBx"},{"id":"kWAyCy","type":"computed","alias":"token_bot","content":"'{{token_bot}}'","dataType":"Nullable(String)","distinct":false,"columnName":"token_bot","computedId":"elTEhL"},{"id":"mAVSMI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"VXeKwg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"YoyzmU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QmDHRT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QOvgsw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"lBQcWl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"NNfFtk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"KliiCW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"BqCTYu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"BswCGS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"GlbFXi","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"id_analy","columnLength":null,"databaseName":"bucket_137"},{"id":"KhBwtD","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"app_analy_info","columnName":"id","columnLength":null,"databaseName":"bucket_137"},{"id":"ahaMHO","type":"value","dataType":"Nullable(String)","tableName":"tmp_envio_alerta2","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"smcnvp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"JcEers","type":"computed","alias":"get_token","content":"'{{token_graph}}'","dataType":"Nullable(String)","distinct":false,"columnName":"get_token","computedId":"msBDBx"},{"id":"WHHyIb","type":"computed","alias":"token_bot","content":"'{{token_bot}}'","dataType":"Nullable(String)","distinct":false,"columnName":"token_bot","computedId":"elTEhL"},{"id":"mAVSMI","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"VXeKwg","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"YoyzmU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QmDHRT","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"QOvgsw","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"lBQcWl","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"NNfFtk","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"KliiCW","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"BqCTYu","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"BswCGS","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_envio_alerta2","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"get_token","content":"'{{token_graph}}'","dataType":"Nullable(String)","columnName":"get_token","computedId":"msBDBx"},{"type":"computed","alias":"token_bot","content":"'{{token_bot}}'","dataType":"Nullable(String)","columnName":"token_bot","computedId":"elTEhL"}]},"created":false,"position":{"x":1825.5,"y":330},"sourceId":null,"tableName":"tmp_envio_alerta2","sourceType":"bucket","resultTable":"tmp_event_trigger2","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ctrzYv","url":"https://graph.microsoft.com/v1.0/users/{{email}}","body":"{ \"property\": \"{{column_name}}\" }","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"3323","method":"GET","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"Authorization","value":"Bearer {{get_token}}"}],"options":{},"timeout":0,"position":{"x":2091,"y":288},"restType":"rest","tableName":"tmp_event_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"ResultadoIDTEAMS","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":[],"resultTableTruncate":true},{"id":"SSvVPI","type":"builder","appId":137,"label":"DUP -Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tmp_event_trigger2","id":"kVzUvs","to":"ResultadoIDTEAMS","raw":"","list":[{"id":"VtwSTT","andOr":"and","tableBy":"tmp_event_trigger2","tableTo":"ResultadoIDTEAMS","columnBy":"email","columnTo":"mail","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"IgkNfJ","type":"value","alias":"id_final","dataType":"Nullable(String)","distinct":false,"tableName":"ResultadoIDTEAMS","columnName":"id","columnLength":null,"databaseName":"bucket_137"},{"id":"WfcfbN","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"nome","columnLength":null,"databaseName":"bucket_137"},{"id":"uZuhio","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"email","columnLength":null,"databaseName":"bucket_137"},{"id":"LYhNPE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"get_token","columnLength":null,"databaseName":"bucket_137"},{"id":"LSlWJY","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"token_bot","columnLength":null,"databaseName":"bucket_137"},{"id":"QGoCql","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_crp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"EpoDqM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_emp_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"kbwxNG","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_ope_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"CGSaKn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_res_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"hYLupJ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_crp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"uyEJmA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_emp_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"pAUJeB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_ata_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"AZdgAZ","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_res_prd","columnLength":null,"databaseName":"bucket_137"},{"id":"bwFNBF","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_csl_vnd","columnLength":null,"databaseName":"bucket_137"},{"id":"ByYxkn","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_event_trigger2","columnName":"msg_csl_prd","columnLength":null,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"ola","content":"concat('Olá ', nome, ', espero que esteja Tudo bem!')","dataType":"Nullable(String)","columnName":"ola","computedId":"Swrgvm"}]},"created":false,"position":{"x":2360.5,"y":322},"sourceId":null,"tableName":"tmp_event_trigger2","sourceType":"bucket","resultTable":"tmp_get_id_trigger2","bucketClient":"clickhouse","databaseName":"bucket_137"}],"edges":[{"id":"uzICWL","type":"manual","label":"","source":"pJkPzF","target":"WLTLOw"},{"id":"OCgnSX","source":"JQyDpi","target":"eIfxFA"},{"id":"RAvdFO","type":"manual","label":"","source":"eIfxFA","target":"ctrzYv"},{"id":"klqais","type":"manual","label":"","source":"ctrzYv","target":"SSvVPI"},{"id":"qnVCiH","type":"manual","label":"","source":"KOhmsS","target":"eIfxFA"},{"id":"PVasYr","type":"manual","label":"","source":"ZPFtkr","target":"eIfxFA"},{"id":"TPNJZg","source":"eIfxFA","target":"MybeVZ"},{"id":"riXkgj","source":"MybeVZ","target":"ctrzYv"},{"id":"WvGaVP","source":"mvskWg","target":"SRINxy"},{"id":"RdFyBc","source":"WLTLOw","target":"GlfBLs"},{"id":"ZnRWUR","source":"mvskWg","target":"WLTLOw"},{"id":"VlDixP","source":"SRINxy","target":"aANSCa"},{"id":"OIDoSo","source":"ctrzYv","target":"PBrISI"},{"id":"kceSsP","source":"aANSCa","target":"ZPFtkr"},{"id":"WaKVYb","source":"GlfBLs","target":"KOhmsS"},{"id":"uKbXYa","source":"Notrgp","target":"DYcLht"},{"id":"xkpQym","source":"pJkPzF","target":"EivOtX"},{"id":"WrULev","source":"mvskWg","target":"eIfxFA"},{"id":"IZZMsh","source":"vNMXcv","target":"BbkjnJ"},{"id":"HvmKmO","source":"BbkjnJ","target":"BQRWpp"},{"id":"MMERfX","type":"manual","label":"","source":"pJkPzF","target":"SRINxy"},{"id":"DsQbEz","type":"manual","label":"","source":"tbILex","target":"pJkPzF"},{"id":"FUecMR","type":"manual","label":"","source":"kSIbMZ","target":"bsYYiW"},{"id":"dWybmx","type":"manual","label":"","source":"bsYYiW","target":"DYcLht"},{"id":"GxJffX","source":"EivOtX","target":"bsYYiW"},{"id":"ElwYce","source":"bsYYiW","target":"Notrgp"},{"id":"ZUpqGD","source":"DYcLht","target":"EivOtX"},{"id":"WgUIIx","source":"MybeVZ","target":"SSvVPI"},{"id":"KeyQvm","source":"PBrISI","target":"SSvVPI"},{"id":"BcHGme","source":"SSvVPI","target":"FwxqMi"},{"id":"ubhmkk","source":"FMbcyi","target":"rBtgRI"},{"id":"OxSenf","source":"ustfRF","target":"rBtgRI"},{"id":"gnjyMX","source":"rBtgRI","target":"RlloqT"},{"id":"lFlxvY","source":"EivOtX","target":"tbILex"},{"id":"iyWEWA","source":"tbILex","target":"JQyDpi"},{"id":"LkDjkM","source":"RlloqT","target":"kSIbMZ"},{"id":"xrMteo","source":"BQRWpp","target":"kSIbMZ"},{"id":"NnUiHO","source":"RRoyis","target":"kSIbMZ"},{"id":"NYPWGF","source":"kSIbMZ","target":"EivOtX"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS FECHAMENTO","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"IvZlAOqXXPKxVYuhSFBMsVKVOpsqBJVT","flowDescription":"","locked":"no","created":"2023-07-04 13:40:35","updated":"2023-09-08 09:08:23"},{"flowId":"3324","appId":137,"flowName":"TRIGGER MSG - Com Log Fechamento","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OoRddn","url":"https://1qaprwa0u6.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n                   \r\n\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Segue o resumo dos indicadores do fechamento de Jun/23:\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Vendas (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Medium\",\r\n             \"weight\": \"Bolder\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                     \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ope_vnd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                     ]\r\n                 },\r\n                 \r\n \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Perda de Receita (R$ mil)\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"spacing\": \"Medium\"\r\n         },\r\n         \r\n         {\r\n                     \"type\": \"Container\",\r\n                     \"items\": [\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_csl_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_res_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_emp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                         \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_crp_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         },\r\n                      \r\n                         {\r\n                             \"type\": \"TextBlock\",\r\n                             \"text\": \"{{msg_ata_prd}}\",\r\n                             \"visible\": \"${!isNullOrEmpty(items.text)}\",\r\n                             \"wrap\": true\r\n                         }\r\n                         \r\n                         \r\n                     ]\r\n                 },\r\n         \r\n         \r\n         \r\n         \r\n         \r\n         \r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Para mais detalhes sobre esses e outros indicadores estratégicos, acesse o Portal Analytics através do link abaixo:\",\r\n             \"wrap\": true,\r\n             \"size\": \"Default\",\r\n             \"weight\": \"Lighter\"\r\n         },\r\n         {\r\n             \"type\": \"ActionSet\",\r\n             \"actions\": [\r\n                 {\r\n                     \"type\": \"Action.OpenUrl\",\r\n                     \"title\": \"Portal Analytics\",\r\n                     \"url\": \"https://gaio.algartelecom.com.br/dashboard/RJXnUqlnsDhhviiulnwBXfBahT_WKVxSBWXz\"\r\n                 }\r\n             ],\r\n             \"separator\": true,\r\n             \"horizontalAlignment\": \"Center\"\r\n         }\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"OKbxmOgoLP4bWcCcaRbmW8L4YvYbRVGm8CzI5gl4"}],"options":{},"timeout":0,"position":{"x":249.00106530752913,"y":34.99993733485121},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_recebeu","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"jfntKk","type":"table","appId":137,"label":"log_recebeu","client":"clickhouse","repoId":1,"created":false,"position":{"x":403,"y":33},"tableName":"log_recebeu","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"AJupML","source":"FwxqMi","target":"OoRddn"},{"id":"BBLeYq","source":"OoRddn","target":"jfntKk"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"MIhPPDtgnjBYIkTkAI_bXcTTZTmDoPbH","flowDescription":"","locked":"no","created":"2023-07-04 13:47:15","updated":"2023-09-08 09:08:23"},{"flowId":"3387","appId":137,"flowName":"Mensagem Personalizada","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OoRddn","url":"https://1qaprwa0u6.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Em decorrência de instabilidades no DW nesta manhã, houve atraso no processamento das informações D-1, por isso excepcionalmente hoje, a disponibilização de resultados no Portal Analytics será realizada no período da tarde.\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         }\r\n\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"OKbxmOgoLP4bWcCcaRbmW8L4YvYbRVGm8CzI5gl4"}],"options":{},"timeout":0,"position":{"x":249.00106530752913,"y":34.99993733485121},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_recebeu","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"jfntKk","type":"table","appId":137,"label":"log_recebeu","client":"clickhouse","repoId":1,"created":false,"position":{"x":403,"y":33},"tableName":"log_recebeu","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"PaBBwP","source":"FwxqMi","target":"OoRddn"},{"id":"sSaRuv","source":"OoRddn","target":"jfntKk"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"WfdbjIrBsjfbcHbKIjjmPIobYWXTaema","flowDescription":"","locked":"no","created":"2023-07-11 10:35:06","updated":"2023-09-08 09:08:23"},{"flowId":"3408","appId":137,"flowName":"CARGA - Desempenho de Projetos","workflow":{"nodes":[{"id":"xqRbvI","type":"table","appId":137,"label":"base_desempenho_projetos","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":237.9944102514272,"y":-38.996541538928895},"sourceId":7,"tableName":"base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"sneeAm","type":"sourceRaw","appId":137,"label":"SQL","query":"SELECT ISP.TIP_MTC              AS TIP_MTC\r\n      ,TRUNC(ISP.DAT_DIA_MES_REF,'MM')      AS DATA_REF\r\n      ,'NÃO SE APLICA'              AS HRQ_1\r\n      ,'NÃO SE APLICA'              AS HRQ_2\r\n      ,ISP.DSC_RPN_PRJ  AS HRQ_3\r\n      ,CASE \r\n        WHEN ISP.NOM_PRG = 'ALGAR.PORT.ESTRUT'   THEN 'ESTRUTURANTE'\r\n        WHEN ISP.NOM_PRG = 'ALGAR.PORT.B2C'      THEN 'B2C'\r\n        WHEN ISP.NOM_PRG = 'ALGAR.PORT.B2B'      THEN 'B2B'\r\n        WHEN ISP.NOM_PRG = 'ALGAR.PORT.MANUTOP'  THEN 'MANUTENÇÃO DA OPERAÇÃO'\r\n        WHEN ISP.NOM_PRG = 'ALGAR.PORT.INFRACO'  THEN 'INFRACO'\r\n        ELSE ISP.NOM_PRG\r\n          END                  AS NOM_PRG\r\n      ,ISP.NOM_SUB_PRG         AS NOM_SUB_PRG\r\n      ,ISP.NOM_PRJ             AS PROJETO\r\n      ,ISP.DSC_TIT_RSC_PRB     AS DSC_TIT_RSC_PRB \r\n      ,ISP.DSC_DTL_RSC_PRB     AS DSC_DTL_RSC_PRB\r\n      ,ISP.FLG_RSC_PRB         AS FLG_RSC_PRB\r\n      ,ISP.DSC_TIP             AS DSC_TIP\r\n      ,ISP.PCN_ATS             AS PCN_ATS\r\n      ,ISP.STA_ATS             AS STA_ATS\r\n      ,CASE \r\n        WHEN ISP.DAT_FIM_PRJ=TO_DATE('03/01/2900','DD/MM/YYYY') OR  ISP.DAT_FIM_PRJ= TO_DATE('03/01/2900','DD/MM/YYYY') THEN ''\r\n        ELSE TO_CHAR(ISP.DAT_FIM_PRJ,'DD/MM/YYYY') \r\n        END  AS DAT_FIM_PRJ\r\n                 \r\n      \r\n     \r\n FROM THIAGO.IND_SAP_PLANEJAMENTO ISP\r\n INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM THIAGO.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('DESEMPENHO PROJETOS')\r\n          AND DSC_STA_PRJ= 'EM EXECUCAO'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n WHERE 1=1\r\n AND ISP.TIP_MTC IN ('DESEMPENHO PROJETOS')\r\n AND ISP.DSC_STA_PRJ = 'EM EXECUCAO'","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":95.00015666287196,"y":162.00009399772313},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"aux_base_desempenho_projetos","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"BrzBMB","type":"table","appId":137,"label":"aux_base_desempenho_projetos","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":244.00396528175537,"y":163.99992656885638},"sourceId":7,"tableName":"aux_base_desempenho_projetos","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"NOkfRN","source":"sneeAm","target":"BrzBMB"}]},"cron":"20,22,24 8 * * *","options":{"folder":"CARGAS","reload":0,"cronBase":{"every":3,"current":"20,22,24 8 * * *","dayValues":[],"hourValues":[8],"monthValues":[],"minuteValues":[20,22,24],"dayOfMonthValues":[]},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"KteMErEexTOIyZRvtOWpfEiUEKNHpCYr","flowDescription":"","locked":"no","created":"2023-07-12 17:30:49","updated":"2023-09-13 14:46:59"},{"flowId":"3463","appId":137,"flowName":"Dup. Mensagem Personalizada","workflow":{"nodes":[{"id":"FwxqMi","type":"table","appId":137,"label":"tmp_get_id_trigger2","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":58.5,"y":33},"sourceId":null,"tableName":"tmp_get_id_trigger2","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"OoRddn","url":"https://1qaprwa0u6.execute-api.us-east-1.amazonaws.com/analy_dev/teams/privateChat/message/send","body":"{\r\n    \"receivers\": \"{{email}}\",\r\n    \"body\": {\r\n    \"type\": \"message\",\r\n    \"attachments\": [\r\n       {\r\n          \"contentType\": \"application/vnd.microsoft.card.adaptive\",\r\n          \"content\": {\r\n             \"type\": \"AdaptiveCard\",\r\n             \"version\":\"1.0\",\r\n             \"body\": [\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"Olá {{nome}}, Tudo bem?\",\r\n             \"wrap\": true,\r\n             \"weight\": \"Bolder\",\r\n             \"size\": \"Medium\"\r\n         },\r\n         {\r\n             \"type\": \"TextBlock\",\r\n             \"text\": \"O Gaio apresentou instabilidade hoje pela manhã e está em manutenção pelo time de suporte. Com isso, a plataforma ficará inacessível até que o problema seja corrigido.\",\r\n             \"wrap\": true,\r\n             \"spacing\": \"Large\",\r\n             \"separator\": true\r\n         }\r\n\r\n     ]\r\n          }\r\n       }\r\n    ]\r\n }\r\n}","type":"rest","appId":137,"label":"Rest","client":"clickhouse","flowId":"2514","method":"POST","repoId":1,"created":false,"headers":[{"prop":"Content-Type","value":"application/json"},{"prop":"x-api-key","value":"OKbxmOgoLP4bWcCcaRbmW8L4YvYbRVGm8CzI5gl4"}],"options":{},"timeout":0,"position":{"x":249.00106530752913,"y":34.99993733485121},"restType":"rest","tableName":"tmp_get_id_trigger2","resultType":"json","sourceType":"bucket","keepLogDays":2,"resultTable":"log_recebeu","databaseName":"bucket_137","keepLogTable":"","resultDatabase":"bucket_137","createTableType":"dynamic","resultTableProp":"","resultTableFields":[],"tableNameTruncate":false,"resultDataTypeProp":"","transferSourceData":["nome","email"],"resultTableTruncate":true},{"id":"jfntKk","type":"table","appId":137,"label":"log_recebeu","client":"clickhouse","repoId":1,"created":false,"position":{"x":403,"y":33},"tableName":"log_recebeu","sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"VZLljX","source":"FwxqMi","target":"OoRddn"},{"id":"glcCZv","source":"OoRddn","target":"jfntKk"}]},"cron":null,"options":{"folder":"TRIGGER MENSAGENS FECHAMENTO","reload":0,"cronBase":{},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"lSrALSyiqHnrHihNDBqSpGaxVPYwQyWa","flowDescription":"","locked":null,"created":"2023-07-17 09:06:19","updated":"2023-09-08 09:08:23"},{"flowId":"3585","appId":137,"flowName":"update_referencia","workflow":{"nodes":[{"id":"DXNnHD","type":"table","appId":137,"label":"metrica_segmento","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":764.5,"y":33},"tableName":"metrica_segmento","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"XvnvDi","type":"table","appId":137,"label":"inicial","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":7.002913929418185,"y":149.99843337128056},"dropTable":true,"tableName":"inicial","temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"gJDGnH","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"McKMwU","type":"computed","alias":"prm_gh_venda_corporativo","content":"'{{prm_gh_venda_corporativo}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_venda_corporativo","computedId":"fYJnZT"},{"id":"rQbyRm","type":"computed","alias":"prm_gh_venda_corporativo_tic","content":"'{{prm_gh_venda_corporativo_tic}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_venda_corporativo_tic","computedId":"XmGtck"},{"id":"jXHXOa","type":"computed","alias":"prm_gh_venda_corporativo_iot","content":"'{{prm_gh_venda_corporativo_iot}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_venda_corporativo_iot","computedId":"hjADTl"},{"id":"XKdsKF","type":"computed","alias":"prm_gh_venda_empresarial","content":"'{{prm_gh_venda_empresarial}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_venda_empresarial","computedId":"qxxlAU"},{"id":"wSFMPG","type":"computed","alias":"prm_gh_venda_atacado","content":"'{{prm_gh_venda_atacado}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_venda_atacado","computedId":"AuoTkw"},{"id":"CoCeMf","type":"computed","alias":"prm_gh_venda_varejo","content":"'{{prm_gh_venda_varejo}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_venda_varejo","computedId":"nvUQRB"},{"id":"GzKlzV","type":"computed","alias":"prm_gh_perda_corporativo","content":"'{{prm_gh_perda_corporativo}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_perda_corporativo","computedId":"ljzjRl"},{"id":"xcVrBX","type":"computed","alias":"prm_gh_perda_empresarial","content":"'{{prm_gh_perda_empresarial}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_perda_empresarial","computedId":"PRXdMv"},{"id":"HWSBaT","type":"computed","alias":"prm_gh_perda_atacado","content":"'{{prm_gh_perda_atacado}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_perda_atacado","computedId":"oLpelH"},{"id":"RhQxtw","type":"computed","alias":"prm_gh_perda_varejo","content":"'{{prm_gh_perda_varejo}}'","dataType":"Nullable(String)","distinct":false,"columnName":"prm_gh_perda_varejo","computedId":"VVsZrc"}],"update":[],"computed":[{"type":"computed","alias":"prm_gh_venda_corporativo","content":"'{{prm_gh_venda_corporativo}}'","dataType":"Nullable(String)","columnName":"prm_gh_venda_corporativo","computedId":"fYJnZT"},{"type":"computed","alias":"prm_gh_venda_empresarial","content":"'{{prm_gh_venda_empresarial}}'","dataType":"Nullable(String)","columnName":"prm_gh_venda_empresarial","computedId":"qxxlAU"},{"type":"computed","alias":"prm_gh_venda_atacado","content":"'{{prm_gh_venda_atacado}}'","dataType":"Nullable(String)","columnName":"prm_gh_venda_atacado","computedId":"AuoTkw"},{"type":"computed","alias":"prm_gh_venda_varejo","content":"'{{prm_gh_venda_varejo}}'","dataType":"Nullable(String)","columnName":"prm_gh_venda_varejo","computedId":"nvUQRB"},{"type":"computed","alias":"prm_gh_perda_corporativo","content":"'{{prm_gh_perda_corporativo}}'","dataType":"Nullable(String)","columnName":"prm_gh_perda_corporativo","computedId":"ljzjRl"},{"type":"computed","alias":"prm_gh_perda_empresarial","content":"'{{prm_gh_perda_empresarial}}'","dataType":"Nullable(String)","columnName":"prm_gh_perda_empresarial","computedId":"PRXdMv"},{"type":"computed","alias":"prm_gh_perda_atacado","content":"'{{prm_gh_perda_atacado}}'","dataType":"Nullable(String)","columnName":"prm_gh_perda_atacado","computedId":"oLpelH"},{"type":"computed","alias":"prm_gh_perda_varejo","content":"'{{prm_gh_perda_varejo}}'","dataType":"Nullable(String)","columnName":"prm_gh_perda_varejo","computedId":"VVsZrc"},{"type":"computed","alias":"prm_gh_venda_corporativo_tic","content":"'{{prm_gh_venda_corporativo_tic}}'","dataType":"Nullable(String)","columnName":"prm_gh_venda_corporativo_tic","computedId":"XmGtck"},{"type":"computed","alias":"prm_gh_venda_corporativo_iot","content":"'{{prm_gh_venda_corporativo_iot}}'","dataType":"Nullable(String)","columnName":"prm_gh_venda_corporativo_iot","computedId":"hjADTl"}]},"created":false,"optimize":false,"position":{"x":121,"y":149},"tableName":"inicial","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"parametros_gh","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"eCaAVQ","type":"table","appId":137,"label":"parametros_gh","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":243.5,"y":149},"tableName":"parametros_gh","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"hJrwng","type":"unpivot","appId":137,"label":"unpivot","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":361.5,"y":149},"tableName":"parametros_gh","temporary":false,"sourceType":"bucket","resultTable":"unpivot_parameters","databaseName":"bucket_137","extraColumns":[],"resultDatabase":"bucket_137","unpivotColumns":["prm_gh_venda_corporativo","prm_gh_venda_empresarial","prm_gh_venda_atacado","prm_gh_venda_varejo","prm_gh_perda_corporativo","prm_gh_perda_empresarial","prm_gh_perda_atacado","prm_gh_perda_varejo","prm_gh_venda_corporativo_tic","prm_gh_venda_corporativo_iot"]},{"id":"bYMvHE","type":"table","appId":137,"label":"unpivot_parameters","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":492,"y":149},"tableName":"unpivot_parameters","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"mTBJjL","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"KAZbnf","type":"computed","alias":"Indicador","content":"CASE\nWHEN category like '%venda%' then 'Venda Mensal'\nWHEN category like '%perda%' then 'Perda de Receita Mensal'\nelse ' '\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Indicador","computedId":"CLdAcX"},{"id":"PbuFYA","type":"computed","alias":"SEGMENTO","content":"CASE\nWHEN category like '%corporativo%' then 'CORPORATIVO' \nWHEN category like '%empresarial%' then 'EMPRESARIAL' \nWHEN category like '%atacado%' then 'OPERADORAS' \nWHEN category like '%varejo%' then 'RESIDENCIAL' \nELSE ' ' \nEND","dataType":"Nullable(String)","distinct":false,"columnName":"SEGMENTO","computedId":"slbvqh"},{"id":"TtVzqd","type":"computed","alias":"Produto","content":"CASE\nWHEN category like '%tic%' then 'TIC'\nWHEN category like '%iot%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","distinct":false,"columnName":"Produto","computedId":"jYnTAQ"},{"id":"JoEeBw","type":"value","alias":"Valor","dataType":"Nullable(Float64)","distinct":false,"tableName":"unpivot_parameters","columnName":"quantity","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"SEGMENTO","content":"CASE\nWHEN category like '%corporativo%' then 'CORPORATIVO' \nWHEN category like '%empresarial%' then 'EMPRESARIAL' \nWHEN category like '%atacado%' then 'OPERADORAS' \nWHEN category like '%varejo%' then 'RESIDENCIAL' \nELSE ' ' \nEND","dataType":"Nullable(String)","columnName":"SEGMENTO","computedId":"slbvqh"},{"type":"computed","alias":"Indicador","content":"CASE\nWHEN category like '%venda%' then 'Venda Mensal'\nWHEN category like '%perda%' then 'Perda de Receita Mensal'\nelse ' '\nend","dataType":"Nullable(String)","columnName":"Indicador","computedId":"CLdAcX"},{"type":"computed","alias":"Produto","content":"CASE\nWHEN category like '%tic%' then 'TIC'\nWHEN category like '%iot%' then 'IOT'\nelse 'OUTROS'\nend","dataType":"Nullable(String)","columnName":"Produto","computedId":"jYnTAQ"}]},"created":false,"optimize":false,"position":{"x":627,"y":149},"tableName":"unpivot_parameters","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"parametros_tratados","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"wKnxeQ","type":"table","appId":137,"label":"parametros_tratados","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":764.5,"y":149},"tableName":"parametros_tratados","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"plprxf","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"parametros_tratados","id":"gXUkzG","to":"metrica_segmento","raw":"","list":[{"id":"aXdAKu","andOr":"and","tableBy":"parametros_tratados","tableTo":"metrica_segmento","columnBy":"Indicador","columnTo":"TIP_MTC","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"wAoxpX","andOr":"and","tableBy":"parametros_tratados","tableTo":"metrica_segmento","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"VZjGFU","andOr":"and","tableBy":"parametros_tratados","tableTo":"metrica_segmento","columnBy":"Produto","columnTo":"produto","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"sZzHpO","type":"value","dataType":"Nullable(String)","tableName":"parametros_tratados","columnName":"Indicador","columnLength":null,"databaseName":"bucket_137"},{"id":"uwtkdz","type":"value","dataType":"Nullable(String)","tableName":"parametros_tratados","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137"},{"id":"DmvMdY","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"parametros_tratados","columnName":"Produto","columnLength":null,"databaseName":"bucket_137"},{"id":"HTRWDf","type":"computed","alias":"parametros","content":"concat(Indicador, ' + ', SEGMENTO, ' + ', produto)","dataType":"Nullable(String)","distinct":false,"columnName":"parametros","computedId":"IwNGNN"},{"id":"AiHunL","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"parametros_tratados","columnName":"Valor","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[{"type":"computed","alias":"parametros","content":"concat(Indicador, ' + ', SEGMENTO, ' + ', produto)","dataType":"Nullable(String)","columnName":"parametros","computedId":"IwNGNN"}]},"created":false,"optimize":false,"position":{"x":909.9997493394048,"y":92.99993733485124},"tableName":"parametros_tratados","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_referencia","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"dSiqNG","type":"table","appId":137,"label":"tabela_referencia","client":"clickhouse","repoId":1,"shared":false,"position":{"x":1030.5,"y":91},"tableName":"tabela_referencia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EFOCuG","type":"pivot","appId":137,"label":"Pivot","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"select":[],"limitBy":[]},"shared":false,"columns":[{"columnName":"Venda Mensal + CORPORATIVO + OUTROS","parametros":"Venda Mensal + CORPORATIVO + OUTROS","transposeName":"venda_mensal_corporativo"},{"columnName":"Venda Mensal + EMPRESARIAL + OUTROS","parametros":"Venda Mensal + EMPRESARIAL + OUTROS","transposeName":"venda_mensal_empresarial"},{"columnName":"Venda Mensal + OPERADORAS + OUTROS","parametros":"Venda Mensal + OPERADORAS + OUTROS","transposeName":"venda_mensal_operadoras"},{"columnName":"Venda Mensal + RESIDENCIAL + OUTROS","parametros":"Venda Mensal + RESIDENCIAL + OUTROS","transposeName":"venda_mensal_residencial"},{"columnName":"Perda de Receita Mensal + CORPORATIVO + OUTROS","parametros":"Perda de Receita Mensal + CORPORATIVO + OUTROS","transposeName":"perda_de_receita_mensal_corporativo"},{"columnName":"Perda de Receita Mensal + EMPRESARIAL + OUTROS","parametros":"Perda de Receita Mensal + EMPRESARIAL + OUTROS","transposeName":"perda_de_receita_mensal_empresarial"},{"columnName":"Perda de Receita Mensal + OPERADORAS + OUTROS","parametros":"Perda de Receita Mensal + OPERADORAS + OUTROS","transposeName":"perda_de_receita_mensal_operadoras"},{"columnName":"Perda de Receita Mensal + RESIDENCIAL + OUTROS","parametros":"Perda de Receita Mensal + RESIDENCIAL + OUTROS","transposeName":"perda_de_receita_mensal_residencial"},{"columnName":"Venda Mensal + CORPORATIVO + TIC","parametros":"Venda Mensal + CORPORATIVO + TIC","transposeName":"venda_mensal_corporativo_tic"},{"columnName":"Venda Mensal + CORPORATIVO + IOT","parametros":"Venda Mensal + CORPORATIVO + IOT","transposeName":"venda_mensal_corporativo_iot"}],"created":false,"position":{"x":1154,"y":91},"tableName":"tabela_referencia","tableView":false,"temporary":false,"sourceType":"bucket","extraFields":[],"resultTable":"parametros","databaseName":"bucket_137","resultDatabase":"bucket_137","transposeColumn":"parametros","dynamicTranspose":false,"extraFieldsPosition":"start","transposeAggregator":"max","transposeColumnValue":"Valor","dynamicTransposeSnakeCase":false},{"id":"nsutSx","type":"table","appId":137,"label":"parametros","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":1259.5,"y":91},"tableName":"parametros","tableView":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"agVgnk","type":"tableToParam","appId":137,"label":"Tabela para Parâmetros","client":"clickhouse","params":[],"repoId":1,"created":false,"position":{"x":1379.5,"y":91},"tableName":"parametros","sourceType":"bucket","byReference":true,"databaseName":"bucket_137","saveAsDefault":true,"fieldToParamList":[{"paramName":"prm_gh_venda_corporativo","columnName":"venda_mensal_corporativo"},{"paramName":"prm_gh_venda_empresarial","columnName":"venda_mensal_empresarial"},{"paramName":"prm_gh_venda_atacado","columnName":"venda_mensal_operadoras"},{"paramName":"prm_gh_venda_varejo","columnName":"venda_mensal_residencial"},{"paramName":"prm_gh_perda_corporativo","columnName":"perda_de_receita_mensal_corporativo"},{"paramName":"prm_gh_perda_empresarial","columnName":"perda_de_receita_mensal_empresarial"},{"paramName":"prm_gh_perda_atacado","columnName":"perda_de_receita_mensal_operadoras"},{"paramName":"prm_gh_perda_varejo","columnName":"perda_de_receita_mensal_residencial"},{"paramName":"prm_gh_venda_corporativo_tic","columnName":"venda_mensal_corporativo_tic"},{"paramName":"prm_gh_venda_corporativo_iot","columnName":"venda_mensal_corporativo_iot"}]},{"id":"FzYEsx","type":"flow","appId":137,"label":"Criação Fator","client":"clickhouse","flowId":"3586","repoId":1,"created":false,"position":{"x":1491.5,"y":91}},{"id":"trlSFa","type":"flow","appId":137,"label":"Ajuste Base","client":"clickhouse","flowId":"3587","repoId":1,"created":false,"position":{"x":1602.5,"y":91}}],"edges":[{"id":"fBVXSK","source":"bYMvHE","target":"mTBJjL"},{"id":"cJLtSk","source":"hJrwng","target":"bYMvHE"},{"id":"sgPrrp","source":"dSiqNG","target":"EFOCuG"},{"id":"IJBsNT","type":"manual","label":"","source":"FzYEsx","target":"trlSFa"},{"id":"YnhrwA","type":"manual","label":"","source":"agVgnk","target":"FzYEsx"},{"id":"bcnXIN","source":"mTBJjL","target":"wKnxeQ"},{"id":"VZRmlk","source":"eCaAVQ","target":"hJrwng"},{"id":"cYiAyu","source":"EFOCuG","target":"nsutSx"},{"id":"xBgmAl","source":"nsutSx","target":"agVgnk"},{"id":"eXRWbk","source":"XvnvDi","target":"gJDGnH"},{"id":"kWoUHK","source":"gJDGnH","target":"eCaAVQ"},{"id":"ZfdeUY","source":"wKnxeQ","target":"plprxf"},{"id":"geEuxH","source":"DXNnHD","target":"plprxf"},{"id":"hMSvvT","source":"plprxf","target":"dSiqNG"}]},"cron":null,"options":{"folder":"Golden Hammer","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"ZiUcCrmbtPMEMWRKgCDOCQkkmbfBYhQj","flowDescription":"","locked":"no","created":"2023-07-24 13:50:12","updated":"2023-09-08 09:08:23"},{"flowId":"3584","appId":137,"flowName":"carga","workflow":{"nodes":[{"id":"eNjvJD","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH FLUXO AS \r\n(\r\n\r\nSELECT    \t  TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD') AS DATA_TRANSACAO\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT \r\n\t\t\t, SUM(VLR_TXA) AS TAXA\r\n\t\t\t, SUM(VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(VLR_IOF) AS IOF\r\n\t\t\t, SUM(VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'FLUXO'\r\n\t\t\t\t\t\t\t\t  \tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM')\r\n\t\t\t\t\t\t\t\t  )\r\n\t\tAND TIP = 'FLUXO'\r\n\t\tAND NOM_IND = 'REALIZADO'\r\n\t\tAND DAT_TSC >= TO_DATE('20230801', 'YYYYMMDD')\r\n\t\tAND DAT_TSC <= (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\tWHERE TIP = 'FLUXO')\r\n\tGROUP BY  TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT\r\n\tORDER BY  TIP\r\n\t\t\t, TRUNC(F.DAT_TSC,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_TSC, 'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT\r\n),\r\n\r\nSALDO_INICIAL AS (\r\n\tSELECT    TIP\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO+1,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO+1,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO+1, 'MM') AS DATA_TRANSACAO\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT \r\n\t\t\t, SUM(VLR_TXA) AS TAXA\r\n\t\t\t, SUM(VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(VLR_IOF) AS IOF\r\n\t\t\t, SUM(VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'SALDO FINAL'\r\n\t\t\t\t\t\t\t\t  \tAND LAST_DAY(DAT_OCO_FTO) = DAT_OCO_FTO  \r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM'))\r\n\t\tAND TIP = 'SALDO FINAL'\r\n\tGROUP BY  TIP\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO+1,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO+1,'DD')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO+1, 'MM')\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT\r\n),\r\n\r\nRENDIMENTOS AS (\r\nSELECT   \t  TIP\r\n\t\t\t, TRUNC(F.DAT_RTB,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_RTB, 'DD') AS DATA_TRANSACAO\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT \r\n\t\t\t, SUM(VLR_TXA) AS TAXA\r\n\t\t\t, SUM(VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(VLR_IOF) AS IOF\r\n\t\t\t, SUM(VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'RENDIMENTOS'\r\n\t\t\t\t\t\t\t\t  \tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM'))\r\n\t\tAND TIP = 'RENDIMENTOS'\r\n\t\tAND NOM_IND = 'REALIZADO'\r\n\t\tAND DAT_RTB >= TO_DATE('20230801', 'YYYYMMDD')\r\n\t\tAND DAT_RTB <= (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\tWHERE TIP = 'RENDIMENTOS'\r\n\t\t\t\t\t\t\tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t)\r\n\tGROUP BY  TIP\r\n\t\t\t, TRUNC(F.DAT_RTB,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_RTB, 'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT\r\n\r\n),\r\n\r\nRESGATE_APLICACAO AS (\r\nSELECT    TIP\r\n\t\t\t, TRUNC(F.DAT_IVT,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_IVT, 'DD') AS DATA_TRANSACAO\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT \r\n\t\t\t, SUM(VLR_TXA) AS TAXA\r\n\t\t\t, SUM(VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(VLR_IOF) AS IOF\r\n\t\t\t, SUM(VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'RESGATE APLICACAO'\r\n\t\t\t\t\t\t\t\t  \tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM'))\r\n\t\tAND TIP = 'RESGATE APLICACAO'\r\n\t\tAND NOM_IND = 'REALIZADO'\r\n\t\tAND DAT_IVT >= TO_DATE('20230801', 'YYYYMMDD')\r\n\t\tAND DAT_IVT <= (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\tWHERE TIP = 'RESGATE APLICACAO'\r\n\t\t\t\t\t\t\tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t)\r\n\tGROUP BY  TIP\r\n\t\t\t, TRUNC(F.DAT_IVT,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_IVT, 'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT\r\n),\r\n\r\nENTRADA_APLICACAO AS (\r\nSELECT    TIP\r\n\t\t\t, TRUNC(F.DAT_IVT,'MM') AS MES_OCORRENCIA\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD') AS ULTIMA_FOTO\r\n\t\t\t, TRUNC(F.DAT_IVT, 'DD') AS DATA_TRANSACAO\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT \r\n\t\t\t, SUM(VLR_TXA) AS TAXA\r\n\t\t\t, SUM(VLR_IRRF) AS IRRF\r\n\t\t\t, SUM(VLR_IOF) AS IOF\r\n\t\t\t, SUM(VLR) AS VALOR\r\n\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\tWHERE 1 = 1\r\n\t\tAND F.DAT_OCO_FTO IN (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\t\t\t  FROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\t\t\t  WHERE TIP = 'ENTRADA APLICACAO'\r\n\t\t\t\t\t\t\t\t  \tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t\t\t  GROUP BY TRUNC(DAT_OCO_FTO,'MM'))\r\n\t\tAND TIP = 'ENTRADA APLICACAO'\r\n\t\tAND NOM_IND = 'REALIZADO'\r\n\t\tAND DAT_IVT >= TO_DATE('20230801', 'YYYYMMDD')\r\n\t\tAND DAT_IVT <= (SELECT MAX(DAT_OCO_FTO) AS DATA\r\n\t\t\t\t\t\tFROM MARIALAR.F_FLUXO_CAIXA F\r\n\t\t\t\t\t\tWHERE TIP = 'ENTRADA APLICACAO'\r\n\t\t\t\t\t\tAND NOM_IND = 'REALIZADO'\r\n\t\t\t\t\t\t)\r\n\tGROUP BY  TIP\r\n\t\t\t, TRUNC(F.DAT_IVT,'MM')\r\n\t\t\t, TRUNC(F.DAT_OCO_FTO,'DD')\r\n\t\t\t, TRUNC(F.DAT_IVT, 'DD')\r\n\t\t\t, COD_EMP \r\n\t\t\t, COD_BCO_EMP \r\n\t\t\t, IDT_CNT\r\n),\r\n\r\nFLUXO_CAIXA AS (\r\n\r\nSELECT \t  MES_OCORRENCIA\r\n\t\t, DATA_TRANSACAO\r\n\t\t, SALDO_INICIAL\r\n\t\t, FLUXO\r\n\t\t, RENDIMENTOS\r\n\t\t, RESGATE_APLICACAO\r\n\t\t, ENTRADA_APLICACAO\r\n\t\t, TOTAL AS SALDO_FINAL_DIA\r\n\t\t, SUM(FLUXO + SALDO_INICIAL + RENDIMENTOS + RESGATE_APLICACAO - ENTRADA_APLICACAO) OVER(PARTITION BY MES_OCORRENCIA ORDER BY DATA_TRANSACAO rows between unbounded preceding and current row) AS TOTAL_ACU\r\nFROM (\r\n\tSELECT \t  MES_OCORRENCIA\r\n\t\t\t, DATA_TRANSACAO\r\n\t\t\t, SUM(FLUXO) AS FLUXO\r\n\t\t\t, SUM(SALDO_INICIAL) AS SALDO_INICIAL\r\n\t\t\t, SUM(RENDIMENTOS) AS RENDIMENTOS\r\n\t\t\t, SUM(RESGATE_APLICACAO) AS RESGATE_APLICACAO\r\n\t\t\t, SUM(ENTRADA_APLICACAO) AS ENTRADA_APLICACAO\r\n\t\t\t, SUM(FLUXO) + SUM(SALDO_INICIAL) + SUM(RENDIMENTOS) + SUM(RESGATE_APLICACAO) - SUM(ENTRADA_APLICACAO) AS TOTAL\r\n\t\r\n\tFROM (\r\n\t\tSELECT MES_OCORRENCIA, DATA_TRANSACAO, SUM(VALOR) AS FLUXO, 0 AS SALDO_INICIAL, 0 AS RENDIMENTOS, 0 AS RESGATE_APLICACAO, 0 AS ENTRADA_APLICACAO\r\n\t\tFROM FLUXO\r\n\t\tGROUP BY MES_OCORRENCIA, DATA_TRANSACAO\r\n\t\tUNION ALL\r\n\t\tSELECT MES_OCORRENCIA, DATA_TRANSACAO, 0 AS FLUXO, SUM(VALOR) AS SALDO_INICIAL, 0 AS RENDIMENTOS, 0 AS RESGATE_APLICACAO, 0 AS ENTRADA_APLICACAO\r\n\t\tFROM SALDO_INICIAL\r\n\t\tGROUP BY MES_OCORRENCIA, DATA_TRANSACAO\r\n\t\tUNION ALL\r\n\t\tSELECT MES_OCORRENCIA, DATA_TRANSACAO, 0 AS FLUXO, 0 AS SALDO_INICIAL, SUM(VALOR) AS RENDIMENTOS, 0 AS RESGATE_APLICACAO, 0 AS ENTRADA_APLICACAO\r\n\t\tFROM RENDIMENTOS\r\n\t\tGROUP BY MES_OCORRENCIA, DATA_TRANSACAO\r\n\t\tUNION ALL\r\n\t\tSELECT MES_OCORRENCIA, DATA_TRANSACAO, 0 AS FLUXO, 0 AS SALDO_INICIAL, 0 AS RENDIMENTOS, SUM(VALOR) AS RESGATE_APLICACAO, 0 AS ENTRADA_APLICACAO\r\n\t\tFROM RESGATE_APLICACAO\r\n\t\tGROUP BY MES_OCORRENCIA, DATA_TRANSACAO\r\n\t\tUNION ALL\r\n\t\tSELECT MES_OCORRENCIA, DATA_TRANSACAO, 0 AS FLUXO, 0 AS SALDO_INICIAL, 0 AS RENDIMENTOS, 0 AS RESGATE_APLICACAO, SUM(VALOR) AS ENTRADA_APLICACAO\r\n\t\tFROM ENTRADA_APLICACAO\r\n\t\tGROUP BY MES_OCORRENCIA, DATA_TRANSACAO\r\n\t)\r\n\tGROUP BY MES_OCORRENCIA, DATA_TRANSACAO\r\n\tORDER BY MES_OCORRENCIA, DATA_TRANSACAO\r\n)\r\nGROUP BY  MES_OCORRENCIA\r\n\t\t, DATA_TRANSACAO\r\n\t\t, SALDO_INICIAL\r\n\t\t, FLUXO\r\n\t\t, RENDIMENTOS\r\n\t\t, RESGATE_APLICACAO\r\n\t\t, ENTRADA_APLICACAO\r\n\t\t, TOTAL\r\n)\r\n\r\nSELECT \t  DATA_TRANSACAO \t\t\tAS DATA_REF\r\n\t\t, 'Fluxo de Caixa' \t\t\tAS TIP_MTC\r\n\t\t, 'N/A'\t\t\t\t\t\tAS SEGMENTO\r\n\t\t, 'N/A'\t\t\t\t\t\tAS HRQ_1\r\n\t\t, 'N/A'\t\t\t\t\t\tAS HRQ_2\r\n\t\t, 'N/A'\t\t\t\t\t\tAS HRQ_3\r\n\t\t, 'N/A'\t\t\t\t\t\tAS DSC_LNH_NGC\r\n\t\t, SUM(SALDO_FINAL_DIA)  \tAS REAL\r\n\t\t, 0\t\t\t\t\t\t\tAS TAXA_INSTALACAO\r\n\t\t, 'N/A'\t\t\t\t\t\tAS PRODUTOS\r\n\t\t, 'Fluxo de Caixa Mensal' \tAS METRICA_JOIN\r\nFROM FLUXO_CAIXA\r\nGROUP BY  DATA_TRANSACAO\r\n\t\t, 'Fluxo de Caixa'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 0\r\n\t\t, 'N/A'\r\n\t\t, 'Fluxo de Caixa Mensal'\r\nUNION ALL\r\nSELECT \t  MES_OCORRENCIA \t\t\tAS DATA_REF\r\n\t\t, 'Fluxo de Caixa Mensal'\tAS TIP_MTC\r\n\t\t, 'N/A'\t\t\t\t\t\tAS SEGMENTO\r\n\t\t, 'N/A'\t\t\t\t\t\tAS HRQ_1\r\n\t\t, 'N/A'\t\t\t\t\t\tAS HRQ_2\r\n\t\t, 'N/A'\t\t\t\t\t\tAS HRQ_3\r\n\t\t, 'N/A'\t\t\t\t\t\tAS DSC_LNH_NGC\r\n\t\t, SUM(SALDO_FINAL_DIA) \t\tAS REAL\r\n\t\t, 0\t\t\t\t\t\t\tAS TAXA_INSTALACAO\r\n\t\t, 'N/A'\t\t\t\t\t\tAS PRODUTOS\r\n\t\t, 'Fluxo de Caixa Mensal' \tAS METRICA_JOIN\r\nFROM FLUXO_CAIXA\r\nGROUP BY  MES_OCORRENCIA\r\n\t\t, 'Fluxo de Caixa'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 'N/A'\r\n\t\t, 0\r\n\t\t, 'N/A'\r\n\t\t, 'Fluxo de Caixa Mensal'","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":24.00238127565359,"y":323.992981503337},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"fluxo_caixa_teste","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"JsHFWU","type":"table","appId":137,"label":"fluxo_caixa_teste","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":159.00097130980612,"y":323.99501812067217},"sourceId":7,"tableName":"fluxo_caixa_teste","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VMvrQr","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"fluxo_caixa_teste","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"fluxo_caixa_teste","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"fluxo_caixa_teste","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"PRODUTOS","columnLength":2,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"fluxo_caixa_teste","columnName":"METRICA_JOIN","columnLength":2,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":265.0000000000001,"y":327.9943914691844},"sourceId":7,"tableName":"fluxo_caixa_teste","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_mes_atual","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"WVoabp","type":"fileImport","appId":137,"label":"dia_1_manual.csv","append":false,"client":"clickhouse","engine":null,"repoId":1,"columns":[{"id":"ponJHi","index":false,"decimal":"comma","dataType":"Nullable(DateTime)","transform":"bestEffortOrNull","columnName":"data_ref","alternativeName":"data_ref"},{"id":"OlvrPT","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"tip_mtc","alternativeName":"tip_mtc"},{"id":"UjjHSD","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"segmento","alternativeName":"segmento"},{"id":"kgaMOd","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_1","alternativeName":"hrq_1"},{"id":"nfORfr","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_2","alternativeName":"hrq_2"},{"id":"IAMvuI","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"hrq_3","alternativeName":"hrq_3"},{"id":"omorcu","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"dsc_lnh_ngc","alternativeName":"dsc_lnh_ngc"},{"id":"feDYJH","index":false,"decimal":"dot","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"real","columnLength":2,"alternativeName":"real"},{"id":"LOkTJH","index":false,"decimal":"comma","dataType":"Nullable(Float64)","transform":"bestEffortOrNull","columnName":"taxa_instalacao","columnLength":2,"alternativeName":"taxa_instalacao"},{"id":"UaSmSw","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"produto","alternativeName":"produto"},{"id":"xdqAMg","index":false,"decimal":"comma","dataType":"Nullable(String)","transform":"","columnName":"metrica_join","alternativeName":"metrica_join"}],"created":false,"fileName":"dia_1_manual.csv","position":{"x":54.014820307685795,"y":-214.9917282003614},"temporary":false,"withNames":true,"enclosedBy":"doubleQuotes","fixEncoding":true,"resultTable":"dia_um_manual","characterSet":"latin1","databaseName":"bucket_137","ignoreFistRow":true,"resultDatabase":"bucket_137","transformFirst":false,"localPreparation":true,"linesTerminatedBy":"crlfNewLine","fieldsTerminatedBy":"semicolon"},{"id":"DLeLpu","type":"table","appId":137,"label":"dia_um_manual","client":"clickhouse","repoId":1,"created":false,"position":{"x":276.00990109350687,"y":-213.9924801821467},"tableName":"dia_um_manual","sourceType":"bucket","databaseName":"bucket_137"},{"id":"OstbID","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"NcmkJO","type":"value","andOr":"and","value":["Perda de Receita Mensal","Venda Mensal"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"dia_um_manual","valueType":"value","columnName":"tip_mtc","extraValue":[],"columnLength":null,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"nqPRWc","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"dia_um_manual","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137"},{"id":"CYwlKA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"dia_um_manual","columnName":"segmento","columnLength":null,"databaseName":"bucket_137"},{"id":"hTOoVA","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"dia_um_manual","columnName":"produto","columnLength":null,"databaseName":"bucket_137"},{"id":"jYCexB","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"dia_um_manual","columnName":"real","columnLength":2,"databaseName":"bucket_137"},{"id":"tXXnsb","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"dia_um_manual","columnName":"taxa_instalacao","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":544.0043238952655,"y":-211.99050622996023},"tableName":"dia_um_manual","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"dia_1_manual","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ejnvHL","type":"table","appId":137,"label":"dia_1_manual","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":541.0072378246836,"y":-107.9937648176966},"tableName":"dia_1_manual","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"EqSlXq","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(String)","tableName":"dia_1_manual","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"dia_1_manual","columnName":"segmento","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"dia_1_manual","columnName":"produto","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(Float64)","tableName":"dia_1_manual","columnName":"real","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"dia_1_manual","columnName":"taxa_instalacao","columnLength":2,"databaseName":"bucket_137","targetColumn":"TAXA"}]},"shared":false,"created":false,"position":{"x":539.0092431094447,"y":85.00134730069871},"tableName":"dia_1_manual","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"portal_sumarizado","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"CtZdTj","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"dia_um_manual","columnName":"data_ref","columnLength":null,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"tip_mtc","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"segmento","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"hrq_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"hrq_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"hrq_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"dsc_lnh_ngc","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"dia_um_manual","columnName":"real","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Float64)","tableName":"dia_um_manual","columnName":"taxa_instalacao","columnLength":2,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"produto","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"dia_um_manual","columnName":"metrica_join","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"created":false,"position":{"x":273.01215703886294,"y":-98.99680407741232},"tableName":"dia_um_manual","sourceType":"bucket","resultTable":"base_mes_atual","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"OVWsch","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\n\r\nDIARIO AS (\r\n  SELECT    DAT_DIA_MES_REF AS DATA_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL')  THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n          ELSE TIP_MTC\r\n          END AS TIP_MTC\r\n    , DSC_SGM_CLI AS SEGMENTO\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_1\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_2\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_3\r\n    , DSC_LNH_NGC \r\n    , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t    WHEN TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA') THEN VLR_IND*-1\r\n\t\tWHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%IOT%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%IOT%'\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n    \tELSE VLR_IND END) AS REAL\r\n      , SUM(NVL(TXA_ITL,0)*1) AS TAXA_INSTALACAO\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n   AND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'BASE DE CLIENTES', 'DADOS FISICOS - BASE', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE'\r\n            , 'DADOS FISICOS - MIGRAÇÃO SAINTE', 'CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA', 'CHURN RECEITA - COMERCIAL')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('DOWNGRADE', 'CHURN RECEITA') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA'))\r\n     )\r\n  AND DAT_DIA_MES_REF IS NOT NULL\r\n  \r\n  AND TRUNC(DAT_DIA_MES_REF,'MM') >= TO_DATE('20230301','YYYYMMDD')\r\nGROUP BY  DAT_DIA_MES_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n          ELSE TIP_MTC\r\n          END\r\n    , DSC_SGM_CLI\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL_2 AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n          WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t    WHEN TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA') THEN VLR_IND*-1\r\n\t\tWHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%IOT%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%IOT%'\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n    \tELSE VLR_IND END) AS REAL\r\n      , SUM(NVL(TXA_ITL,0)) AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n   WHERE 1 = 1\r\n     AND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'BASE DE CLIENTES', 'DADOS FISICOS - BASE', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE'\r\n            , 'DADOS FISICOS - MIGRAÇÃO SAINTE', 'CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA', 'CHURN RECEITA - COMERCIAL')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('DOWNGRADE', 'CHURN RECEITA') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA'))\r\n     )\r\n\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nONE_PAGE AS (\r\nSELECT O3.IDT_CAD_IND_ONE_PGE,\r\n       O3.NOM_IND,\r\n       O3.DSC_SGM AS SEGMENTO,\r\n       O3.DAT_MES_REF,\r\n       O3.DAT_REF_RGT,\r\n       O3.VLR_RLZ,\r\n       O3.VLR_OCD AS OCD,\r\n       O3.VLR_FCT,\r\n       O3.VLR_OTR,\r\n       O3.DAT_CRG_RGT,\r\n       O3.NOM_JOB_CRG,\r\n       to_date(to_char(O3.MES_REF, 'YYYY')||'-'||to_char(O3.MES_REF, 'MM')||'-1', 'YYYY-MM-DD') as MES_REF\r\nFROM (SELECT *\r\nFROM arthural.IND_ONE_PAGE O\r\nINNER JOIN (SELECT DAT_MES_REF DAT_MES_REF_2,\r\n                   MAX(O2.DAT_REF_RGT) MES_REF\r\n            FROM ARTHURAL.IND_ONE_PAGE O2\r\n            WHERE 1=1\r\n            AND O2.DAT_REF_RGT >= to_date('01/01/2022', 'dd/mm/rrrr')\r\n            GROUP BY DAT_MES_REF) DT ON (O.DAT_REF_RGT = DT.MES_REF)\r\norder by DAT_REF_RGT) O3\r\n\r\n),\r\n\r\nTICKET_MEDIO AS (\r\n\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Ticket Medio' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI <> 'OPERADORAS'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Base de Contratos TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI = 'OPERADORAS'\r\n          AND DSC_LNH_NGC = 'Conectividade'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('DADOS FISICOS - BASE')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n\r\n),\r\n\r\nVENDA_ONE_PAGE AS (\r\nSELECT    MES_REF AS DATA_REF\r\n    , 'Venda Mensal' TIP_MTC\r\n    , SEGMENTO\r\n    , '' HRQ_1\r\n    , '' HRQ_2\r\n    , '' HRQ_3\r\n    , '' DSC_LNH_NGC\r\n    , REAL\r\n    , 0 AS TAXA_INSTALACAO\r\nFROM (\r\n  SELECT     MES_REF\r\n      , 'CORPORATIVO' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (1) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n    AND SEGMENTO in ('Corporativo')\r\n    AND NOM_IND IN ('Valor de Vendas','Receita Vendas Total')\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'EMPRESARIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (106, 117) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'OPERADORAS' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (35) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'RESIDENCIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (139,497) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  \r\n  GROUP BY MES_REF\r\n)\r\nWHERE 1 = 1\r\n    AND MES_REF < TO_DATE('20230301','YYYYMMDD')\r\n)\r\n\r\n\r\nSELECT    DATA_REF\r\n    , TIP_MTC\r\n    , SEGMENTO\r\n    , HRQ_1\r\n    , HRQ_2\r\n    , HRQ_3\r\n    , DSC_LNH_NGC\r\n    , REAL\r\n    , TAXA_INSTALACAO\r\n    , CASE WHEN DSC_LNH_NGC LIKE '%TIC%' AND SEGMENTO = 'CORPORATIVO' AND TIP_MTC LIKE '%Venda%' THEN 'TIC' WHEN DSC_LNH_NGC LIKE '%IOT%' AND SEGMENTO = 'CORPORATIVO' AND TIP_MTC LIKE '%Venda%' THEN 'IOT' ELSE 'OUTROS' END AS PRODUTO\r\n    , CASE WHEN TIP_MTC NOT LIKE '%Mensal%' then concat(TIP_MTC, ' Mensal') else TIP_MTC END metrica_join\r\nFROM (\r\nSELECT *\r\nFROM (\r\n  SELECT *\r\n  FROM DIARIO\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL_2\r\n  UNION ALL\r\n  SELECT *\r\n  FROM TICKET_MEDIO\r\n\r\n\r\n)\r\nWHERE 1 = 1\r\n    AND (ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM') AND TIP_MTC <> 'Venda Mensal')\r\n     OR  (TIP_MTC = 'Venda Mensal' AND TRUNC(DATA_REF, 'MM') >= TO_DATE('20230301','YYYYMMDD'))\r\n) f      \r\n\r\n\r\nWHERE ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM')\r\n   ","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":35,"y":33},"sourceId":7,"autoFetch":false,"bringData":true,"insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"base_mes_atual","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"GDYCco","type":"sourceRaw","appId":137,"label":"SQL","query":"WITH\r\n\r\nDIARIO AS (\r\n  SELECT    DAT_DIA_MES_REF AS DATA_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL')  THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n          ELSE TIP_MTC\r\n          END AS TIP_MTC\r\n    , DSC_SGM_CLI AS SEGMENTO\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_1\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_2\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END AS HRQ_3\r\n    , DSC_LNH_NGC \r\n    , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t    WHEN TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA') THEN VLR_IND*-1\r\n\t\tWHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%IOT%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%IOT%'\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n    \tELSE VLR_IND END) AS REAL\r\n      , SUM(NVL(TXA_ITL,0)) AS TAXA_INSTALACAO\r\nFROM DWADM.IND_SAP_PLANEJAMENTO isp \r\nWHERE 1 = 1\r\n   AND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'BASE DE CLIENTES', 'DADOS FISICOS - BASE', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE'\r\n            , 'DADOS FISICOS - MIGRAÇÃO SAINTE', 'CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA', 'CHURN RECEITA - COMERCIAL')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('DOWNGRADE', 'CHURN RECEITA') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA'))\r\n     )\r\n  AND DAT_DIA_MES_REF IS NOT NULL\r\n  \r\n  AND TRUNC(DAT_DIA_MES_REF,'MM') >= TO_DATE('20230301','YYYYMMDD')\r\nGROUP BY  DAT_DIA_MES_REF\r\n        , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida'\r\n          ELSE TIP_MTC\r\n          END\r\n    , DSC_SGM_CLI\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , CASE \r\n          WHEN TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n          WHEN TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n          WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n          ELSE 'NAO APLICA'\r\n          END\r\n    , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES', 'DADOS FISICOS - BASE')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'Base de Clientes Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'Base de Contratos Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC = 'BASE DE CLIENTES' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - BASE' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nMENSAL_2 AS (\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_1\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_2\r\n      , CASE \r\n          WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE \r\n\t    WHEN VLR_IND IS NULL THEN 0\r\n\t    WHEN TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA') THEN VLR_IND*-1\r\n\t\tWHEN DSC_SGM_CLI = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('CHURN RECEITA', 'DOWNGRADE')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA - COMERCIAL')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%IOT%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%IOT%'\r\n\t    \tAND DSC_LNH_NGC NOT LIKE '%TIC%'\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN (VLR_IND*(1/1))+(NVL(TXA_ITL,0)*(1/1))\r\n\t    WHEN DSC_SGM_CLI = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('VENDAS - NOVA VENDA')\r\n\t    \tAND TO_DATE('20230701','YYYYMMDD') = TRUNC(DAT_DIA_MES_REF, 'MM') THEN VLR_IND*(1/1)\r\n    \tELSE VLR_IND END) AS REAL\r\n      , SUM(NVL(TXA_ITL,0)) AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n   WHERE 1 = 1\r\n     AND (TIP_MTC IN ('VENDAS - NOVA VENDA - COMERCIAL', 'BASE DE CLIENTES', 'DADOS FISICOS - BASE', 'DADOS FISICOS - CANCELAMENTO', 'DADOS FISICOS - MIGRAÇÃO ENTRANTE'\r\n            , 'DADOS FISICOS - MIGRAÇÃO SAINTE', 'CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA', 'CHURN RECEITA - COMERCIAL')\r\n     OR (ISP.TIP_MTC IN ('VENDAS - NOVA VENDA') AND ISP.DSC_SGM_CLI NOT IN ('EMPRESARIAL', 'RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('DOWNGRADE', 'CHURN RECEITA') AND ISP.DSC_SGM_CLI NOT IN ('RESIDENCIAL'))\r\n     OR (ISP.TIP_MTC IN ('CONTABIL - RECEITA BRUTA', 'CONTABIL - RECEITA LIQUIDA'))\r\n     )\r\n\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n          , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'Venda Mensal'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'Perda de Receita Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'Churn Físico Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'Migração Entrante Mensal'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'Migração Sainte Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'Receita Bruta Mensal'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'Receita Líquida Mensal'\r\n            ELSE ISP.TIP_MTC\r\n            END\r\n      , DSC_SGM_CLI\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_DIR\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'DIRETORIA_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN DSC_GER\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN 'NAO APLICA'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN 'NAO APLICA'\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN 'NAO APLICA'\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , CASE \r\n            WHEN ISP.TIP_MTC IN ('VENDAS - NOVA VENDA', 'VENDAS - NOVA VENDA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC IN ('CHURN RECEITA', 'DOWNGRADE','CHURN RECEITA - COMERCIAL') THEN 'COORDENACAO_PENDENTE'\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - CANCELAMENTO' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO ENTRANTE' THEN DSC_REG_ITL\r\n            WHEN ISP.TIP_MTC = 'DADOS FISICOS - MIGRAÇÃO SAINTE' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA BRUTA' THEN DSC_REG_ITL\r\n            WHEN TIP_MTC = 'CONTABIL - RECEITA LIQUIDA' THEN DSC_REG_ITL\r\n            ELSE 'NAO APLICA'\r\n            END\r\n      , DSC_LNH_NGC\r\n),\r\n\r\nONE_PAGE AS (\r\nSELECT O3.IDT_CAD_IND_ONE_PGE,\r\n       O3.NOM_IND,\r\n       O3.DSC_SGM AS SEGMENTO,\r\n       O3.DAT_MES_REF,\r\n       O3.DAT_REF_RGT,\r\n       O3.VLR_RLZ,\r\n       O3.VLR_OCD AS OCD,\r\n       O3.VLR_FCT,\r\n       O3.VLR_OTR,\r\n       O3.DAT_CRG_RGT,\r\n       O3.NOM_JOB_CRG,\r\n       to_date(to_char(O3.MES_REF, 'YYYY')||'-'||to_char(O3.MES_REF, 'MM')||'-1', 'YYYY-MM-DD') as MES_REF\r\nFROM (SELECT *\r\nFROM arthural.IND_ONE_PAGE O\r\nINNER JOIN (SELECT DAT_MES_REF DAT_MES_REF_2,\r\n                   MAX(O2.DAT_REF_RGT) MES_REF\r\n            FROM ARTHURAL.IND_ONE_PAGE O2\r\n            WHERE 1=1\r\n            AND O2.DAT_REF_RGT >= to_date('01/01/2022', 'dd/mm/rrrr')\r\n            GROUP BY DAT_MES_REF) DT ON (O.DAT_REF_RGT = DT.MES_REF)\r\norder by DAT_REF_RGT) O3\r\n\r\n),\r\n\r\nTICKET_MEDIO AS (\r\n\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Ticket Medio' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp \r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('BASE DE CLIENTES')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI <> 'OPERADORAS'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('BASE DE CLIENTES')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Base de Contratos TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  INNER JOIN (SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS MES\r\n            , TIP_MTC\r\n            , MAX(DAT_DIA_MES_REF) AS MAXDATA \r\n        FROM DWADM.IND_SAP_PLANEJAMENTO i\r\n        WHERE TIP_MTC IN ('DADOS FISICOS - BASE')\r\n          AND DAT_DIA_MES_REF IS NOT NULL\r\n          AND DSC_SGM_CLI = 'OPERADORAS'\r\n          AND DSC_LNH_NGC = 'Conectividade'\r\n        GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n            , TIP_MTC) isp2\r\n    ON (ISP.DAT_DIA_MES_REF = ISP2.MAXDATA AND ISP.TIP_MTC = ISP2.TIP_MTC)\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('DADOS FISICOS - BASE')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n    AND DSC_SGM_CLI <> 'OPERADORAS'\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n  UNION ALL\r\n  SELECT    TRUNC(DAT_DIA_MES_REF,'MM') AS DATA_REF\r\n          , 'Faturamento Bruto Mensal TM' AS TIP_MTC\r\n      , DSC_SGM_CLI AS SEGMENTO\r\n      , 'NAO APLICA' AS HRQ_1\r\n      , 'NAO APLICA' AS HRQ_2\r\n      , 'NAO APLICA' AS HRQ_3\r\n      , DSC_LNH_NGC \r\n      , SUM(CASE WHEN VLR_IND IS NULL THEN 0 ELSE VLR_IND END) AS REAL\r\n      , 0 AS TAXA_INSTALACAO\r\n  FROM DWADM.IND_SAP_PLANEJAMENTO isp\r\n  WHERE 1 = 1\r\n    AND ISP.TIP_MTC IN ('FATURAMENTO - FATURAMENTO BRUTO')\r\n    AND ISP.DSC_LNH_NGC = 'Conectividade'\r\n    AND DSC_SGM_CLI = 'OPERADORAS'\r\n    AND DAT_DIA_MES_REF IS NOT NULL\r\n  GROUP BY  TRUNC(DAT_DIA_MES_REF,'MM')\r\n      , DSC_SGM_CLI\r\n      , DSC_LNH_NGC\r\n\r\n),\r\n\r\nVENDA_ONE_PAGE AS (\r\nSELECT    MES_REF AS DATA_REF\r\n    , 'Venda Mensal' TIP_MTC\r\n    , SEGMENTO\r\n    , '' HRQ_1\r\n    , '' HRQ_2\r\n    , '' HRQ_3\r\n    , '' DSC_LNH_NGC\r\n    , REAL\r\n    , 0 AS TAXA_INSTALACAO\r\nFROM (\r\n  SELECT     MES_REF\r\n      , 'CORPORATIVO' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (1) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n    AND SEGMENTO in ('Corporativo')\r\n    AND NOM_IND IN ('Valor de Vendas','Receita Vendas Total')\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'EMPRESARIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE IN (106, 117) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'OPERADORAS' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (35) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  WHERE 1 = 1\r\n  GROUP BY MES_REF\r\n  UNION ALL \r\n  SELECT     MES_REF\r\n      , 'RESIDENCIAL' AS SEGMENTO\r\n      , SUM(CASE WHEN IDT_CAD_IND_ONE_PGE in (139,497) THEN VLR_RLZ ELSE 0 END) REAL\r\n  FROM ONE_PAGE\r\n  \r\n  GROUP BY MES_REF\r\n)\r\nWHERE 1 = 1\r\n    AND MES_REF < TO_DATE('20230301','YYYYMMDD')\r\n)\r\n\r\n\r\nSELECT TIP_MTC, SEGMENTO, PRODUTO, SUM(REAL) AS REAL, SUM(TAXA_INSTALACAO) AS TAXA\r\nFROM (\r\n\r\nSELECT    DATA_REF\r\n    , TIP_MTC\r\n    , SEGMENTO\r\n    , HRQ_1\r\n    , HRQ_2\r\n    , HRQ_3\r\n    , DSC_LNH_NGC\r\n    , CASE WHEN DSC_LNH_NGC LIKE '%TIC%' AND SEGMENTO = 'CORPORATIVO' AND TIP_MTC LIKE '%Venda%' THEN 'TIC' WHEN DSC_LNH_NGC LIKE '%IOT%' AND SEGMENTO = 'CORPORATIVO' AND TIP_MTC LIKE '%Venda%' THEN 'IOT' ELSE 'OUTROS' END AS PRODUTO\r\n    , REAL\r\n    , TAXA_INSTALACAO\r\nFROM (\r\nSELECT *\r\nFROM (\r\n  SELECT *\r\n  FROM DIARIO\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL\r\n  UNION ALL \r\n  SELECT *\r\n  FROM MENSAL_2\r\n  UNION ALL\r\n  SELECT *\r\n  FROM TICKET_MEDIO\r\n\r\n\r\n)\r\nWHERE 1 = 1\r\n    AND (ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM') AND TIP_MTC <> 'Venda Mensal')\r\n     OR  (TIP_MTC = 'Venda Mensal' AND TRUNC(DATA_REF, 'MM') >= TO_DATE('20230301','YYYYMMDD'))\r\n) f      \r\n\r\n\r\nWHERE ADD_MONTHS(SYSDATE, -13) <= TRUNC(DATA_REF, 'MM')\r\n\r\n\r\n)\r\nWHERE 1 = 1\r\n\tAND TRUNC(DATA_REF, 'MM') = TO_DATE('20230901','YYYYMMDD')\r\n\tAND TIP_MTC IN ('Perda de Receita Mensal', 'Venda Mensal')\r\nGROUP BY TIP_MTC, SEGMENTO, PRODUTO\r\nORDER BY TIP_MTC, SEGMENTO, PRODUTO","client":"oracle","repoId":1,"schema":{"join":[],"sort":[],"group":[],"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[],"update":[],"computed":[]},"created":false,"position":{"x":32.000093997723184,"y":161.00325858773647},"sourceId":7,"autoFetch":false,"bringData":true,"tableName":"tabela_fator","insertMode":false,"sourceType":"source","autoColumns":false,"jsForceBulk":false,"resultTable":"portal_sumarizado","bucketClient":"clickhouse","databaseName":"bucket_137","resultDatabase":"bucket_137","schemaInference":true},{"id":"sAxwMG","type":"table","appId":137,"label":"portal_sumarizado","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":171.50009399772318,"y":161.00325858773647},"sourceId":7,"tableName":"portal_sumarizado","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"jrWXJP","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"xiTIGd","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"YWSqfO","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"COSBkl","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"ZmorWs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"RvIGcz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"KvjOhz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"ZmorWs","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"RvIGcz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"KvjOhz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"portal_sumarizado","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"QhzYVJ","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"portal_sumarizado","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":303.0000939977232,"y":161.00325858773647},"sourceId":7,"tableName":"portal_sumarizado","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_portal","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"EUFZbI","type":"table","appId":137,"label":"tabela_portal","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":418.0000939977232,"y":161.00325858773647},"sourceId":7,"tableName":"tabela_portal","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VuhMrR","type":"table","appId":137,"label":"BASE_FLUXO_TESTE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":379.275257801623,"y":362.61470434882045},"sourceId":null,"tableName":"BASE_FLUXO_TESTE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"qqnOnS","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"BASE_FLUXO_TESTE","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"BASE_FLUXO_TESTE","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"BASE_FLUXO_TESTE","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"BASE_FLUXO_TESTE","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":470.275257801623,"y":360.61470434882045},"sourceId":null,"tableName":"BASE_FLUXO_TESTE","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_mes_atual","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"ZhCmcF","type":"table","appId":137,"label":"FC_RECEBIMENTOS_CAIXA","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":374.0254107665766,"y":471.1027407934036},"sourceId":7,"tableName":"FC_RECEBIMENTOS_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"SzthZa","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"FC_RECEBIMENTOS_CAIXA","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":581.8264022678334,"y":476.0706515582905},"sourceId":7,"tableName":"FC_RECEBIMENTOS_CAIXA","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_mes_atual","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"VShGWP","type":"table","appId":137,"label":"FC_FLUXO_CAIXA_FLUXO_LIVRE","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":371.1293909365515,"y":572.394022662564},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"VkEogW","type":"insert","appId":137,"label":"Inserção Tabela","client":"clickhouse","repoId":1,"schema":{"select":[{"dataType":"Nullable(DateTime)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137","targetColumn":"DATA_REF"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"TIP_MTC","columnLength":null,"databaseName":"bucket_137","targetColumn":"TIP_MTC"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"SEGMENTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"SEGMENTO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"HRQ_1","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_1"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"HRQ_2","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_2"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"HRQ_3","columnLength":null,"databaseName":"bucket_137","targetColumn":"HRQ_3"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"DSC_LNH_NGC","columnLength":null,"databaseName":"bucket_137","targetColumn":"DSC_LNH_NGC"},{"dataType":"Nullable(Float64)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"REAL","columnLength":2,"databaseName":"bucket_137","targetColumn":"REAL"},{"dataType":"Nullable(Int64)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"TAXA_INSTALACAO","columnLength":null,"databaseName":"bucket_137","targetColumn":"TAXA_INSTALACAO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"PRODUTO","columnLength":null,"databaseName":"bucket_137","targetColumn":"PRODUTO"},{"dataType":"Nullable(String)","tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","columnName":"METRICA_JOIN","columnLength":null,"databaseName":"bucket_137","targetColumn":"METRICA_JOIN"}]},"shared":false,"created":false,"position":{"x":675.8109773385626,"y":573.6340722376268},"sourceId":7,"tableName":"FC_FLUXO_CAIXA_FLUXO_LIVRE","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"base_mes_atual","databaseName":"bucket_137","resultDatabase":"bucket_137"},{"id":"asuofx","type":"table","appId":137,"label":"base_mes_atual","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":267.49792418032604,"y":36.00022029343086},"sourceId":7,"tableName":"base_mes_atual","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"uhnFcp","source":"ZhCmcF","target":"SzthZa"},{"id":"MAPgZD","source":"WVoabp","target":"DLeLpu"},{"id":"VTZbaT","source":"DLeLpu","target":"OstbID"},{"id":"TreaFf","source":"OstbID","target":"ejnvHL"},{"id":"JrEHTP","source":"ejnvHL","target":"EqSlXq"},{"id":"DKAOYO","source":"EqSlXq","target":"sAxwMG"},{"id":"GZOGpQ","source":"sAxwMG","target":"jrWXJP"},{"id":"ZyLCis","source":"jrWXJP","target":"EUFZbI"},{"id":"XKbMBd","source":"DLeLpu","target":"CtZdTj"},{"id":"Dtczfp","source":"CtZdTj","target":"asuofx"},{"id":"LpliJi","source":"eNjvJD","target":"JsHFWU"},{"id":"ALJHmU","source":"JsHFWU","target":"VMvrQr"},{"id":"MvbqRU","source":"VMvrQr","target":"asuofx"},{"id":"eFAqkD","source":"GDYCco","target":"sAxwMG"},{"id":"DkTaXd","source":"VuhMrR","target":"qqnOnS"},{"id":"UCGGcs","source":"qqnOnS","target":"asuofx"},{"id":"Idgkut","source":"OVWsch","target":"asuofx"},{"id":"GssnXn","source":"SzthZa","target":"asuofx"},{"id":"MHJqgb","source":"VShGWP","target":"VkEogW"},{"id":"XyXHlP","source":"VkEogW","target":"asuofx"}]},"cron":null,"options":{"folder":"Golden Hammer","windowWidth":100},"flowOrder":9999,"flowStart":0,"flowType":"dataPrep","flowKey":null,"flowDescription":null,"locked":"no","created":"2023-07-24 13:50:12","updated":"2023-09-13 08:14:29"},{"flowId":"3588","appId":137,"flowName":"historicoValidacao","workflow":{"nodes":[{"id":"DcGRiK","type":"table","appId":137,"label":"tabela_fator","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":35,"y":33},"sourceId":null,"tableName":"tabela_fator","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"zYuluy","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"yDlJiD","type":"computed","alias":"DataReferencia","content":"today()","dataType":"Nullable(Date)","distinct":false,"columnName":"DataReferencia","computedId":"CWVZjI"},{"id":"sKlHWy","type":"value","dataType":"Nullable(String)","tableName":"tabela_fator","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"frmhWb","type":"value","dataType":"Nullable(String)","tableName":"tabela_fator","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"IUvLOU","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_fator","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"ClYPrE","type":"value","dataType":"Nullable(Float64)","tableName":"tabela_fator","columnName":"PORTAL","columnLength":2,"databaseName":"bucket_137"},{"id":"LmHmPR","type":"value","dataType":"Nullable(Float64)","tableName":"tabela_fator","columnName":"REFERENCIA","columnLength":2,"databaseName":"bucket_137"},{"id":"JwRUwP","type":"value","dataType":"Nullable(Float64)","tableName":"tabela_fator","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"VVtNdb","type":"computed","alias":"DiferencaAbs","content":"REFERENCIA-PORTAL","dataType":"Nullable(Float64)","distinct":false,"columnName":"DiferencaAbs","computedId":"llkaVe","columnLength":2},{"id":"BrIvJc","type":"computed","alias":"DifrerencaPercentual","content":"round(REFERENCIA/case when PORTAL is null then 1 else PORTAL end*100,2)","dataType":"Nullable(Float64)","distinct":false,"columnName":"DifrerencaPercentual","computedId":"eeLEjI","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"DataReferencia","content":"today()","dataType":"Nullable(Date)","columnName":"DataReferencia","computedId":"CWVZjI"},{"type":"computed","alias":"DiferencaAbs","content":"REFERENCIA-PORTAL","dataType":"Nullable(Float64)","columnName":"DiferencaAbs","computedId":"llkaVe","columnLength":2},{"type":"computed","alias":"DifrerencaPercentual","content":"round(REFERENCIA/case when PORTAL is null then 1 else PORTAL end*100,2)","dataType":"Nullable(Float64)","columnName":"DifrerencaPercentual","computedId":"eeLEjI","columnLength":2}]},"created":false,"optimize":false,"position":{"x":147,"y":33},"sourceId":null,"tableName":"tabela_fator","tableView":false,"temporary":false,"insertMode":true,"sourceType":"bucket","resultTable":"historico_validacao","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"ScVKdk","type":"table","appId":137,"label":"historico_validacao","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":280,"y":33},"sourceId":null,"tableName":"historico_validacao","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"qlDQBs","source":"DcGRiK","target":"zYuluy"},{"id":"ClvqdH","source":"zYuluy","target":"ScVKdk"}]},"cron":"0 16 * * 1,2,3,4,5","options":{"folder":"Golden Hammer","reload":0,"cronBase":{"every":4,"current":"0 16 * * 1,2,3,4,5","dayValues":[1,2,3,4,5],"hourValues":[16],"monthValues":[],"minuteValues":[0],"dayOfMonthValues":[]},"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"gAqMPNpCDbirRkRHDXkLJBOWAPCHHFYN","flowDescription":"","locked":"no","created":"2023-07-24 13:50:12","updated":"2023-09-08 09:08:23"},{"flowId":"3587","appId":137,"flowName":"ajuste_base","workflow":{"nodes":[{"id":"wJQcbg","type":"table","appId":137,"label":"tabela_portal","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":718.495172852724,"y":275.9989219956556},"sourceId":null,"tableName":"tabela_portal","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"IrGALQ","type":"table","appId":137,"label":"tabela_fator","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":45.00012533029755,"y":147.0000626651488},"sourceId":null,"tableName":"tabela_fator","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"LyYCKx","type":"table","appId":137,"label":"base_mes_atual","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":49,"y":33},"sourceId":null,"tableName":"base_mes_atual","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"FRrfBr","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"base_mes_atual","id":"KBopRR","to":"tabela_fator","raw":"","list":[{"id":"mqHTgn","andOr":"and","tableBy":"base_mes_atual","tableTo":"tabela_fator","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"BObRnE","andOr":"and","tableBy":"base_mes_atual","tableTo":"tabela_fator","columnBy":"METRICA_JOIN","columnTo":"TIP_MTC","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"uUNavV","andOr":"and","tableBy":"base_mes_atual","tableTo":"tabela_fator","columnBy":"PRODUTO","columnTo":"PRODUTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[{"id":"NxlqVA","type":"value","dataType":"Nullable(DateTime)","tableName":"base_mes_atual","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"wVCCDD","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"GHpTtM","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"VxezAz","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_mes_atual","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"rxvvOY","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"rYtflV","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"sWczEA","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"RjfvcD","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"RrPmDC","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_fator","columnName":"FATOR","columnLength":8,"databaseName":"bucket_137"},{"id":"STZPgd","type":"value","alias":"TAXA_INSTALACAO","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_mes_atual","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"NxlqVA","type":"value","dataType":"Nullable(DateTime)","tableName":"base_mes_atual","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"wVCCDD","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"GHpTtM","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"UbTlkr","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"base_mes_atual","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"rxvvOY","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"rYtflV","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"sWczEA","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"RjfvcD","type":"value","dataType":"Nullable(String)","tableName":"base_mes_atual","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"mKnPBw","type":"value","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_fator","columnName":"FATOR","columnLength":20,"databaseName":"bucket_137"},{"id":"STZPgd","type":"value","alias":"TAXA_INSTALACAO","dataType":"Nullable(Int64)","distinct":false,"tableName":"base_mes_atual","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"},{"id":"LjtnFW","type":"computed","alias":"REAL_AJUSTADO","content":"SUM(CASE \r\n\t    WHEN REAL IS NULL THEN 0\r\n\t\tWHEN SEGMENTO = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN (REAL*(case when FATOR is not null then FATOR else 1 end))+(case when TAXA_INSTALACAO IS NOT NULL THEN TAXA_INSTALACAO ELSE 0 END)\r\n\t    WHEN SEGMENTO = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('Base de Contratos Mensal')\r\n\t    \tAND toDate('2023-07-01') = toStartOfMonth(DATA_REF) THEN REAL*(19355/18581)\r\n    \tELSE REAL END)","dataType":"Nullable(Float64)","distinct":false,"columnName":"REAL_AJUSTADO","computedId":"xobDpW","columnLength":20}],"update":[],"computed":[{"type":"computed","alias":"REAL_AJUSTADO","content":"SUM(CASE \r\n\t    WHEN REAL IS NULL THEN 0\r\n\t\tWHEN SEGMENTO = 'EMPRESARIAL' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'CORPORATIVO' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'OPERADORAS' \r\n\t    \tAND TIP_MTC in ('Perda de Receita Mensal', 'Perda de Receita')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'RESIDENCIAL' \r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'EMPRESARIAL'\r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'CORPORATIVO'\r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN (REAL*(case when FATOR is not null then FATOR else 1 end))+(case when TAXA_INSTALACAO IS NOT NULL THEN TAXA_INSTALACAO ELSE 0 END)\r\n\t    WHEN SEGMENTO = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('Venda Mensal', 'Venda')\r\n\t    \tAND toStartOfMonth(addDays(today(),-1)) = toStartOfMonth(DATA_REF) THEN REAL*(case when FATOR is not null then FATOR else 1 end)\r\n\t    WHEN SEGMENTO = 'OPERADORAS'\r\n\t    \tAND TIP_MTC in ('Base de Contratos Mensal')\r\n\t    \tAND toDate('2023-07-01') = toStartOfMonth(DATA_REF) THEN REAL*(19355/18581)\r\n    \tELSE REAL END)","dataType":"Nullable(Float64)","columnName":"REAL_AJUSTADO","computedId":"xobDpW","columnLength":20}]},"created":false,"optimize":false,"position":{"x":175,"y":91},"sourceId":null,"tableName":"base_mes_atual","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"HEENVG","type":"table","appId":137,"label":"tmp_teste","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":281.5,"y":91},"sourceId":null,"tableName":"tmp_teste","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"nsrNZI","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[{"id":"GBcZWu","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"LPHkSu","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oFxdlN","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"rOeODM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"tyhbqB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"fqadOE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[{"id":"wHfooj","type":"value","andOr":"and","value":["Venda Mensal","Perda de Receita Mensal"],"dataType":"Nullable(String)","operator":"in","fieldType":"value","tableName":"tmp_teste","valueType":"value","columnName":"TIP_MTC","extraValue":"","columnLength":2,"databaseName":"bucket_137"},{"id":"fCMAwm","type":"value","andOr":"and","value":"2023-07-01 00:00:00","dataType":"Nullable(DateTime)","operator":"between","fieldType":"value","tableName":"tmp_teste","valueType":"value","columnName":"DATA_REF","extraValue":"2023-07-31 00:00:00","columnLength":2,"databaseName":"bucket_137"}],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"rOeODM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"tyhbqB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"GjCApo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tmp_teste","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"oBLoTH","type":"sum","alias":"","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_teste","columnName":"REAL_AJUSTADO","columnLength":2,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":388,"y":33},"sourceId":null,"tableName":"tmp_teste","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"aux_teste_final","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"poxMBl","type":"table","appId":137,"label":"aux_teste_final","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":584.5,"y":33},"sourceId":null,"tableName":"aux_teste_final","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"lNmKTG","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"aux_teste_final","id":"XVZIXT","to":"tabela_portal","raw":"","list":[{"id":"xrUHDv","andOr":"and","tableBy":"aux_teste_final","tableTo":"tabela_portal","columnBy":"TIP_MTC","columnTo":"TIP_MTC","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"KnojdI","andOr":"and","tableBy":"aux_teste_final","tableTo":"tabela_portal","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"RqiSww","andOr":"and","tableBy":"aux_teste_final","tableTo":"tabela_portal","columnBy":"PRODUTO","columnTo":"PRODUTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"left","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[{"id":"GBcZWu","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"LPHkSu","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"jIroUo","type":"value","alias":"","order":"asc","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"group":[{"id":"rOeODM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"tyhbqB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"fqadOE","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"}],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"rOeODM","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"tyhbqB","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"GjCApo","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"aux_teste_final","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"yJYPTZ","type":"sum","alias":"REAL_ANTERIOR","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_portal","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"oBLoTH","type":"sum","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"aux_teste_final","columnName":"REAL_AJUSTADO","columnLength":2,"databaseName":"bucket_137"},{"id":"wjsaiz","type":"computed","alias":"diferenca","content":"sum(`aux_teste_final`.`REAL_AJUSTADO`)-sum(`tabela_portal`.`REAL`)","dataType":"Nullable(Float64)","distinct":false,"columnName":"diferenca","computedId":"QMOzNW","columnLength":2}],"update":[],"computed":[{"type":"computed","alias":"diferenca","content":"sum(`aux_teste_final`.`REAL_AJUSTADO`)-sum(`tabela_portal`.`REAL`)","dataType":"Nullable(Float64)","columnName":"diferenca","computedId":"QMOzNW","columnLength":2}]},"created":false,"optimize":false,"position":{"x":781,"y":149},"sourceId":null,"tableName":"aux_teste_final","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tmp_teste_final","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"foLiWU","type":"table","appId":137,"label":"tmp_teste_final","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":903.5,"y":149},"sourceId":null,"tableName":"tmp_teste_final","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"bhoOoU","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"scEzmr","type":"value","dataType":"Nullable(DateTime)","tableName":"tmp_teste","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"id":"dwWrEg","type":"value","dataType":"Nullable(String)","tableName":"tmp_teste","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"WdblAK","type":"value","dataType":"Nullable(String)","tableName":"tmp_teste","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"carrvg","type":"value","dataType":"Nullable(String)","tableName":"tmp_teste","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"id":"SdtFVn","type":"value","dataType":"Nullable(String)","tableName":"tmp_teste","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"id":"VkzyKj","type":"value","dataType":"Nullable(String)","tableName":"tmp_teste","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"id":"ARtlxT","type":"value","dataType":"Nullable(String)","tableName":"tmp_teste","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"id":"sNwEFF","type":"value","alias":"","dataType":"Nullable(Int64)","distinct":false,"tableName":"tmp_teste","columnName":"TAXA_INSTALACAO","columnLength":2,"databaseName":"bucket_137"},{"id":"fWeGbr","type":"value","alias":"REAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tmp_teste","columnName":"REAL_AJUSTADO","columnLength":20,"databaseName":"bucket_137"}],"update":[],"computed":[]},"created":false,"optimize":false,"position":{"x":388,"y":279},"sourceId":null,"tableName":"tmp_teste","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"IND_SAP_PLANEJAMENTO_VALIDACAO","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"OYnCJP","type":"table","appId":137,"label":"IND_SAP_PLANEJAMENTO_VALIDACAO","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":550.7169192280646,"y":275.0001253302976},"sourceId":null,"tableName":"IND_SAP_PLANEJAMENTO_VALIDACAO","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"TVnsDb","source":"HEENVG","target":"nsrNZI"},{"id":"xttuQZ","source":"nsrNZI","target":"poxMBl"},{"id":"VDpDyx","source":"poxMBl","target":"lNmKTG"},{"id":"NxAVxb","source":"wJQcbg","target":"lNmKTG"},{"id":"OpEtGe","source":"lNmKTG","target":"foLiWU"},{"id":"FHycAb","source":"HEENVG","target":"bhoOoU"},{"id":"RfMrLI","source":"bhoOoU","target":"OYnCJP"},{"id":"Haykjy","source":"LyYCKx","target":"FRrfBr"},{"id":"ZbFmkn","source":"IrGALQ","target":"FRrfBr"},{"id":"qYNIMy","source":"FRrfBr","target":"HEENVG"}]},"cron":null,"options":{"folder":"Golden Hammer","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"hmKMNlFrqEoGWYvoojYxfpxpcIDxoNLA","flowDescription":"","locked":"no","created":"2023-07-24 13:50:12","updated":"2023-09-18 15:11:14"},{"flowId":"3586","appId":137,"flowName":"join_fator","workflow":{"nodes":[{"id":"DzTseZ","type":"table","appId":137,"label":"tabela_portal","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":51.5,"y":33},"sourceId":null,"tableName":"tabela_portal","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"JkBGNY","type":"table","appId":137,"label":"tabela_referencia","client":"clickhouse","repoId":1,"shared":false,"created":false,"position":{"x":51.5,"y":149},"sourceId":null,"tableName":"tabela_referencia","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"},{"id":"dCLHZg","type":"builder","appId":137,"label":"Consulta","client":"clickhouse","repoId":1,"schema":{"join":[{"by":"tabela_portal","id":"ASHyTv","to":"tabela_referencia","raw":"","list":[{"id":"eHZNzB","andOr":"and","tableBy":"tabela_portal","tableTo":"tabela_referencia","columnBy":"TIP_MTC","columnTo":"Indicador","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"bheslE","andOr":"and","tableBy":"tabela_portal","tableTo":"tabela_referencia","columnBy":"SEGMENTO","columnTo":"SEGMENTO","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"},{"id":"rblRbj","andOr":"and","tableBy":"tabela_portal","tableTo":"tabela_referencia","columnBy":"PRODUTO","columnTo":"Produto","operator":"=","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"type":"inner","byDatabaseName":"bucket_137","toDatabaseName":"bucket_137"}],"sort":[],"group":[],"limit":null,"delete":false,"engine":"innodb","filter":[{"list":[],"andOr":"and","operator":"="}],"having":[{"list":[],"andOr":"and","operator":"="}],"insert":[],"select":[{"id":"FACMpb","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_portal","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"id":"ikdhMp","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_portal","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"id":"Xtbawt","type":"value","alias":"","dataType":"Nullable(String)","distinct":false,"tableName":"tabela_portal","columnName":"PRODUTO","columnLength":2,"databaseName":"bucket_137"},{"id":"IVEere","type":"value","alias":"PORTAL","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_portal","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"},{"id":"TKIhWv","type":"value","alias":"REFERENCIA","dataType":"Nullable(Float64)","distinct":false,"tableName":"tabela_referencia","columnName":"Valor","columnLength":2,"databaseName":"bucket_137"},{"id":"hmuLUa","type":"computed","alias":"FATOR","content":"toFloat64(tabela_referencia.Valor)/tabela_portal.REAL","dataType":"Nullable(Float64)","distinct":false,"columnName":"FATOR","computedId":"AYekWn","columnLength":20}],"update":[],"computed":[{"type":"computed","alias":"FATOR","content":"toFloat64(tabela_referencia.Valor)/tabela_portal.REAL","dataType":"Nullable(Float64)","columnName":"FATOR","computedId":"AYekWn","columnLength":20}]},"created":false,"optimize":false,"position":{"x":180,"y":91},"sourceId":null,"tableName":"tabela_portal","tableView":false,"temporary":false,"sourceType":"bucket","resultTable":"tabela_fator","bucketClient":"clickhouse","databaseName":"bucket_137"},{"id":"Uxyxbl","type":"table","appId":137,"label":"tabela_fator","client":"clickhouse","repoId":1,"shared":false,"position":{"x":292,"y":91},"sourceId":null,"tableName":"tabela_fator","tableView":false,"temporary":false,"sourceType":"bucket","databaseName":"bucket_137"}],"edges":[{"id":"zrAmKx","source":"DzTseZ","target":"dCLHZg"},{"id":"oNTZdA","source":"JkBGNY","target":"dCLHZg"},{"id":"DUfIJc","source":"dCLHZg","target":"Uxyxbl"}]},"cron":null,"options":{"folder":"Golden Hammer","reload":0,"isWindow":false,"onDestroy":"none","windowWidth":100},"flowOrder":9999,"flowStart":1,"flowType":"dataPrep","flowKey":"VenFxuSZZpYfhyPNgWoJXVrzyhYW_jeO","flowDescription":"","locked":null,"created":"2023-07-24 13:50:12","updated":"2023-09-08 09:08:23"}],"params":[{"tags":[],"folder":"Parâmetros Forecast Corporativo","paramId":"afxHQJ","paramName":"prm_forecast_mes_ref","paramValue":"2023-09-01"},{"tags":[],"folder":"Parâmetros Forecast Corporativo","paramId":"NtRHMW","paramName":"prm_forecast_data","paramValue":"2023-09-08"},{"tags":[],"folder":"Parâmetros Forecast Corporativo","paramId":"qTUaWn","paramName":"prm_forecast_valor","paramValue":"3750000"},{"tags":[],"folder":"Base Sem Segmento","paramId":"BjaZpw","paramName":"prm_indicador_sem_segmento","paramValue":"OPEX"},{"tags":[],"folder":"Base Sem Segmento","paramId":"ajuZbX","paramName":"prm_indicador_pai_sem_segmento","paramValue":"Financeiro"},{"tags":[],"folder":"Base Sem Segmento","paramId":"hMYcHd","paramName":"prm_hrq1_sem_segmento","paramValue":"none"},{"tags":[],"folder":"Base Sem Segmento","paramId":"WxJVzr","paramName":"prm_hrq2_sem_segmento","paramValue":"revert"},{"tags":[],"folder":"Base Sem Segmento","paramId":"uXnfAX","paramName":"prm_hrq3_sem_segmento","paramValue":"revert"},{"tags":[],"folder":"Base Sem Segmento","paramId":"PDXVTR","paramName":"prm_escala_valor_sem_segmento","paramValue":"1000000"},{"tags":[],"folder":"Base Sem Segmento","paramId":"IBtsxk","paramName":"prm_escala_texto_sem_segmento","paramValue":"R$ MM"},{"tags":[],"folder":"Base Sem Segmento","paramId":"UvsMUf","paramName":"prm_escala_decimais_sem_segmento","paramValue":"1"},{"tags":[],"folder":"Base Sem Segmento","paramId":"wMXdaE","paramName":"prm_nome_botao1_sem_segmento","paramValue":"Diretoria"},{"tags":[],"folder":"Base Sem Segmento","paramId":"EFcsjd","paramName":"prm_nome_botao2_sem_segmento","paramValue":"Pacote"},{"tags":[],"folder":"Base Sem Segmento","paramId":"YaNQgJ","paramName":"prm_nivel1_sem_segmento","paramValue":"Pacote"},{"tags":[],"folder":"Base Sem Segmento","paramId":"VThGBN","paramName":"prm_nivel2_sem_segmento","paramValue":"Pacote"},{"tags":[],"folder":"Base Sem Segmento","paramId":"NwPjCz","paramName":"prm_nivel3_sem_segmento","paramValue":"Subpacote"},{"tags":[],"folder":"Base Sem Segmento","paramId":"yvcnIH","paramName":"prm_nome_botao3_sem_segmento","paramValue":"Subpacote"},{"tags":[],"folder":"Base Sem Segmento","paramId":"GJxFGD","paramName":"prm_filtro_mes_base_sem_segmento_mensal","paramValue":"202309"},{"tags":[],"folder":"Base Sem Segmento","paramId":"mWADAy","paramName":"prm_filtro_mes_base_sem_segmento","paramValue":"202309"},{"tags":[],"paramId":"iQTuVz","paramName":"prm_data_max_projeto","paramValue":"202309","paramDescription":"Parâmetro contendo a string de data máxima do projeto"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"zsFbvy","paramName":"prm_mes_diario","paramValue":"202309"},{"tags":[],"paramId":"NKhcUN","paramName":"dia_mes","paramValue":"20"},{"tags":[],"folder":"Parâmetros GH","paramId":"mfFxjD","paramName":"prm_gh_venda_corporativo","paramValue":697026.94},{"tags":[],"folder":"Parâmetros GH","paramId":"TBlcfC","paramName":"prm_gh_venda_empresarial","paramValue":444084},{"tags":[],"folder":"Parâmetros GH","paramId":"kTqhUZ","paramName":"prm_gh_venda_atacado","paramValue":184047.42},{"tags":[],"folder":"Parâmetros GH","paramId":"EvooJM","paramName":"prm_gh_venda_varejo","paramValue":1497814},{"tags":[],"folder":"Parâmetros GH","paramId":"VTHUox","paramName":"prm_gh_perda_corporativo","paramValue":1351195},{"tags":[],"folder":"Parâmetros GH","paramId":"zBUtCR","paramName":"prm_gh_perda_empresarial","paramValue":277949},{"tags":[],"folder":"Parâmetros GH","paramId":"dMAtBE","paramName":"prm_gh_perda_atacado","paramValue":503591.78},{"tags":[],"folder":"Parâmetros GH","paramId":"jULIGz","paramName":"prm_gh_perda_varejo","paramValue":565643.6},{"tags":[],"folder":"Parâmetros GH","paramId":"oLSBDk","paramName":"prm_gh_venda_corporativo_tic","paramValue":379632.34},{"tags":[],"folder":"Parâmetros GH","paramId":"FEtsEW","paramName":"prm_gh_venda_corporativo_iot","paramValue":34747.77},{"tags":[],"paramId":"lnjuMz","paramName":"prm_status_highlight","paramValue":"20/09/2023"},{"tags":[],"folder":"Parâmetros GH","paramId":"JIiAHe","paramName":"prm_gh_view_data_max","paramValue":"2023-09-13"},{"tags":[],"folder":"trigger","paramId":"JFGHhI","paramName":"token_bot","paramValue":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL2FwaS5ib3RmcmFtZXdvcmsuY29tIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvZDZkNDk0MjAtZjM5Yi00ZGY3LWExZGMtZDU5YTkzNTg3MWRiLyIsImlhdCI6MTY5MDk4NjE5MSwibmJmIjoxNjkwOTg2MTkxLCJleHAiOjE2OTEwNzI4OTEsImFpbyI6IkUyRmdZTmlzdUhiZW1vejNlMHIvUGpHNnIzVHlDZ0E9IiwiYXBwaWQiOiIyNmU4Yjg5OC1jMjQwLTQ0Y2EtYmZkYi1iYWFlM2IwM2VjZTciLCJhcHBpZGFjciI6IjEiLCJpZHAiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9kNmQ0OTQyMC1mMzliLTRkZjctYTFkYy1kNTlhOTM1ODcxZGIvIiwicmgiOiIwLkFXNEFJSlRVMXB2ejkwMmgzTldhazFoeDIwSXpMWTBwejFsSmxYY09EcS05RnJ4dUFBQS4iLCJ0aWQiOiJkNmQ0OTQyMC1mMzliLTRkZjctYTFkYy1kNTlhOTM1ODcxZGIiLCJ1dGkiOiJPZnBXemdTS3JVYVZxWlVSbFdJSEFBIiwidmVyIjoiMS4wIn0.T2jfdHPu9R9b61cZPFc7J_tNwEXBW7tf1_T-1VUhWS6K-tzpWTElRfeuek10WrmYGFN9lSMdrIUAY6PGin2YAmgE5I7qXxx7rq2UrtDLG_yQuHtdd-QHq0uQE59RXlBSy1x8zuAR0s2_tjAu3qezwPZ9hwDT_Wr_cDD-glW4iRGRn-JsbMY7yxvacoe7k3ruqqSvSa1_E_QKwME-tlADdXIGl6zU8RagHJ6_0eXQABALOPq00uRt_hcZl8omM2QR-x10iW2VmKMxrzWf-l4GtQleJBm3BafXDgUi56e19B81_n9zXuLayJGt42OdBMGzxoaEkY_36kZKjm2NbOJRhQ"},{"tags":[],"folder":"trigger","paramId":"dlCTVL","paramName":"token_graph","paramValue":"eyJ0eXAiOiJKV1QiLCJub25jZSI6IkppMEpDQUZnR3JveDJqTE95MWxGb2lBYlItMjlGR2RlZHJPeHhlWkstWTAiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvYWVkNDY2YzAtZGU3MC00Y2Y3LTllMTAtNWVhMWY5YTY5NmY0LyIsImlhdCI6MTY5MDk4NjE4OSwibmJmIjoxNjkwOTg2MTg5LCJleHAiOjE2OTA5OTAwODksImFpbyI6IkUyRmdZSGl3MTJKTHFLWHk4WnBnVmJ0Y0RvNGpBQT09IiwiYXBwX2Rpc3BsYXluYW1lIjoiQW5hbHkiLCJhcHBpZCI6IjI2ZThiODk4LWMyNDAtNDRjYS1iZmRiLWJhYWUzYjAzZWNlNyIsImFwcGlkYWNyIjoiMSIsImlkcCI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0L2FlZDQ2NmMwLWRlNzAtNGNmNy05ZTEwLTVlYTFmOWE2OTZmNC8iLCJpZHR5cCI6ImFwcCIsIm9pZCI6ImI4YmIxYjc4LTFhOTYtNDBjZi05NDM2LWNiNWNhMmI2NWEwYiIsInJoIjoiMC5BUW9Bd0diVXJuRGU5MHllRUY2aC1hYVc5QU1BQUFBQUFBQUF3QUFBQUFBQUFBQUtBQUEuIiwicm9sZXMiOlsiR3JvdXAuUmVhZFdyaXRlLkFsbCIsIlVzZXIuUmVhZC5BbGwiLCJUZWFtc0FwcEluc3RhbGxhdGlvbi5SZWFkV3JpdGVGb3JVc2VyLkFsbCIsIkdyb3VwTWVtYmVyLlJlYWQuQWxsIiwiVGVhbXNBcHBJbnN0YWxsYXRpb24uUmVhZFdyaXRlRm9yVGVhbS5BbGwiLCJNYWlsLlNlbmQiLCJDaGF0LlJlYWRXcml0ZS5BbGwiLCJDaGF0LlJlYWRCYXNpYy5BbGwiLCJUZWFtc0FwcEluc3RhbGxhdGlvbi5SZWFkV3JpdGVGb3JDaGF0LkFsbCJdLCJzdWIiOiJiOGJiMWI3OC0xYTk2LTQwY2YtOTQzNi1jYjVjYTJiNjVhMGIiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiU0EiLCJ0aWQiOiJhZWQ0NjZjMC1kZTcwLTRjZjctOWUxMC01ZWExZjlhNjk2ZjQiLCJ1dGkiOiJqU3VEYU1OVUFrYXVqSUhHNlQtTUFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyIwOTk3YTFkMC0wZDFkLTRhY2ItYjQwOC1kNWNhNzMxMjFlOTAiXSwieG1zX3RjZHQiOjEzODIwMzMxMjN9.gnziTGyYhzep_1m92j54GhyjANpdiYNZLlgtrZzu040Jgh5rZoTX-IQuLG8B8wzCADi5Xl7Sexpq7UAieP_0y42kYjAQx0aiuZ8LGRrI_j72DFM3vuhgEQRoh6HI5b06e6kX1LVYLuwsqsxIPqcMHGU4cvVcjoVSSSKV4AyaJfGJNGZcEjHIC_JDpug9I6kBA2MyQ7N5fsrjF4R9nfxcTA0TCXSrdicm_59oXxwZTJ_r6WFSAh4YykQtVDKhZ9JsHs5TEYpk_MOa2r2brzpwEL_Jsgf7FISVtsZjgzxL4rg2ROytolqbKR3-WsgAwb0ZsToR4s2yCGmyZrTEybDvbg"},{"tags":[],"folder":"Parâmetros GH","paramId":"SiSfBQ","paramName":"prm_gh_data_max_hist","paramValue":"2023-07-25"},{"tags":[],"paramId":"DeJQTZ","paramName":"nome_projeto","paramValue":"all_"},{"tags":[],"paramId":"CLezKe","paramName":"data","paramValue":"all_"},{"tags":[],"paramId":"YqMgZO","paramName":"nova_tabela","paramValue":""},{"tags":[],"paramId":"lWQyMl","paramName":"novos_dados","paramValue":""},{"tags":[],"paramId":"EGrqev","paramName":"coluna","paramValue":""},{"tags":[],"paramId":"YGpYgd","paramName":"valor","paramValue":""},{"tags":[],"paramId":"MSEvCo","paramName":"row_id","paramValue":""},{"tags":[],"paramId":"LscQjI","paramName":"gerencia","paramValue":"all_"},{"tags":[],"paramId":"fonMDq","paramName":"nome_ordem","paramValue":"all_"},{"tags":[],"paramId":"FEKXXC","paramName":"teste_sql_insert","paramValue":"INSERT INTO bucket_118.teste_sql VALUES (1,'SETIP','ALGAR TAMBÉM'), (2,'TESTE LOUCO','NUNCA PARA'), (3,'AGUARDAR CLIENTE','15  HORAS SETIP DENOVO')"},{"tags":[],"paramId":"zIIbMo","paramName":"flag"},{"tags":[],"paramId":"BpzhVZ","paramName":"prm_pessoa","paramValue":"all_"},{"tags":[],"paramId":"VlPmKh","paramName":"prm_segmento","paramValue":"all_"},{"tags":[],"paramId":"Vpnamy","paramName":"Mes_Ref","paramValue":"all_"},{"tags":[],"paramId":"uevjGZ","paramName":"Mes_Ref2","paramValue":"all_"},{"tags":[],"paramId":"hDZrpK","paramName":"ProdutoBaseContrato","paramValue":"all_"},{"tags":[],"paramId":"rAosEk","paramName":"tipo_logica","paramValue":"avg"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"ZVCEGU","paramName":"PRM_TIP_MTC","paramValue":"all_"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"moHciR","paramName":"prm_indicador","paramValue":"Migração Entrante"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"OeUxMa","paramName":"prm_indicador_pai","paramValue":"Negócio"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"peyIRG","paramName":"prm_hrq1","paramValue":"none"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"xovfHz","paramName":"prm_hrq2","paramValue":"none"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"aCkNMd","paramName":"prm_hrq3","paramValue":"revert"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"YaphMF","paramName":"prm_visao_diaria","paramValue":"inline-block"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"tiGWUq","paramName":"prm_escala_valor","paramValue":"1000"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"vYZVfG","paramName":"prm_escala_texto","paramValue":"# mil"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"GUnMyG","paramName":"prm_escala_decimais","paramValue":"0"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"yQPhDH","paramName":"prm_escala_sufixo","paramValue":""},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"scFhbt","paramName":"prm_escala_prefixo","paramValue":""},{"tags":[],"paramId":"WUavmM","paramName":"coluna_insight","paramValue":"SEGMENTO"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"QXvhjv","paramName":"prm_visao_hierarquia","paramValue":"revert"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"wtyyqR","paramName":"insight","paramValue":"all_"},{"tags":[],"folder":"Parâmetros Base Inicial","paramId":"qBxMaq","paramName":"PRM_LNH_NGC","paramValue":"all_"},{"tags":[],"folder":"DATA INPUT","paramId":"FODpEc","paramName":"valor_input"},{"tags":[],"folder":"DATA INPUT","paramId":"NlLqhO","paramName":"row_id_input"},{"tags":[],"folder":"DATA INPUT","paramId":"vcQWNo","paramName":"novos_dados_input"},{"tags":[],"folder":"DATA INPUT","paramId":"Evuhgo","paramName":"nova_tabela_input"},{"tags":[],"folder":"DATA INPUT","paramId":"kgNBde","paramName":"max_row_id_input"},{"tags":[],"folder":"DATA INPUT","paramId":"LzTyov","paramName":"coluna_input"},{"tags":[],"folder":"NLP","paramId":"tKzUWo","paramName":"prm_query","paramValue":["SELECT SUM(REAL) FROM bucket_137.BASE_GPT WHERE INDICADOR = 'Venda Mensal' AND SEGMENTO = 'CORPORATIVO' AND ANO_MES LIKE '2023%'"]},{"tags":[],"folder":"INPUT FORECAST","paramId":"JmYupi","paramName":"forecast_data","paramValue":""},{"tags":[],"folder":"INPUT FORECAST","paramId":"abGYVw","paramName":"forecast_segmento"},{"tags":[],"folder":"INPUT FORECAST","paramId":"gShwXV","paramName":"forecast_indicador"},{"tags":[],"folder":"INPUT FORECAST","paramId":"dMFHBq","paramName":"forecast_orcado"},{"tags":[],"folder":"NLP","paramId":"YaFOKy","paramName":"prm_pergunta_nlp","paramValue":["vendas corporativo 2023"]},{"tags":[],"folder":"NLP","paramId":"sBEeKX","paramName":"prm_resposta","paramValue":""},{"tags":[],"folder":"FORECAST INLINE","paramId":"yDVfdI","paramName":"forecastinline"},{"tags":[],"folder":"FORECAST INLINE","paramId":"IcZioh","paramName":"id_inline"},{"tags":[],"folder":"FORECAST INLINE","paramId":"awUwEw","paramName":"user_ident"},{"tags":[],"folder":"FORECAST INLINE","paramId":"RZWCdM","paramName":"nome_cliente_inline"},{"tags":[],"folder":"NLP","paramId":"gcsrIq","paramName":"prm_query_string"},{"tags":[],"folder":"Parâmetros GH","paramId":"EwEOws","paramName":"prm_gh_view_segmento","paramValue":"EMPRESARIAL"},{"tags":[],"folder":"Parâmetros GH","paramId":"AncDtL","paramName":"prm_gh_view_indicador","paramValue":"Venda Mensal"},{"tags":[],"folder":"Parâmetros GH","paramId":"AHnuCp","paramName":"prm_gh_view_data","paramValue":"all_"},{"tags":[],"folder":"Parâmetros GH","paramId":"apuAlB","paramName":"prm_gh_view_produto","paramValue":"OUTROS"},{"tags":[],"paramId":"fPYNoQ","paramName":"prm_filtro_tic_iot","paramValue":"all_"},{"tags":[],"folder":"Filtros","paramId":"kEkRdt","paramName":"prm_filtro_regional","paramValue":"all_"},{"tags":[],"folder":"RECEBIMENTOS_CAIXA","paramId":"FGIvKd","paramName":"CAIXA_DIA_REAL"},{"tags":[],"folder":"RECEBIMENTOS_CAIXA","paramId":"nHaXBu","paramName":"CAIXA_MES_REAL"},{"tags":[],"folder":"RECEBIMENTOS_CAIXA","paramId":"Zuggjr","paramName":"CAIXA_ANO_REAL"},{"tags":[],"folder":"RECEBIMENTOS_CAIXA","paramId":"YCnMLV","paramName":"CAIXA_DIA_PREVISTO"},{"tags":[],"folder":"RECEBIMENTOS_CAIXA","paramId":"UPlyhs","paramName":"CAIXA_MES_PREVISTO"},{"tags":[],"folder":"RECEBIMENTOS_CAIXA","paramId":"bxyjhP","paramName":"CAIXA_ANO_PREVISTO"},{"tags":[],"folder":"Base Sem Segmento","paramId":"ckjSYS","paramName":"prm_tip_mtc_sem_segmento","paramValue":"CAPEX,CAPEX Mensal"}],"forms":[{"formId":"EQPaGv","formName":"Filtros","formType":"loadFlow","fieldSize":"small","formFields":[{"all":true,"grid":{"h":12,"i":"HHuros","w":12,"x":0,"y":1},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Produto","moved":false,"value":[],"source":"bucket","fieldId":"HHuros","loading":false,"multiple":true,"required":false,"paramName":"ProdutoBaseContrato","selectBox":false,"bucketTable":"tmp_base_inicial","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"PRODUTO","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"PRODUTO"},{"all":true,"grid":{"h":12,"i":"oMxXCE","w":12,"x":0,"y":2},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Marcação TIC/IoT (Em Validação)","moved":false,"value":[],"source":"bucket","fieldId":"oMxXCE","loading":false,"multiple":true,"required":false,"paramName":"prm_filtro_tic_iot","selectBox":false,"bucketTable":"tmp_base_inicial","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"marcacao_tic_iot","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"marcacao_tic_iot"}],"formFlowId":"2002","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"formId":"QylXyg","formName":"Segmento","formType":"loadFlow","fieldSize":"small","formFields":[{"all":true,"grid":{"h":12,"w":12,"x":0,"y":0},"list":[],"type":"select","label":"","moved":false,"value":"","source":"bucket","fieldId":"gcuzNN","loading":false,"multiple":false,"required":false,"paramName":"prm_segmento","selectBox":false,"bucketTable":"IND_FILTRO_SEGMENTO","description":"","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"SEGMENTO_VISUAL","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"SEGMENTO"}],"formFlowId":"1808","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"folder":"","formId":"XYsRMO","formName":"Mês Diário","formType":"loadFlow","fieldSize":"small","formFields":[{"all":false,"grid":{"h":12,"w":12,"x":0,"y":0},"list":[],"type":"select","label":"Mês Referência","moved":false,"value":"","source":"bucket","fieldId":"dXelbQ","loading":false,"multiple":false,"required":false,"paramName":"prm_mes_diario","selectBox":false,"bucketTable":"base_geral_dia","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"Mes_Ref_Visual","bucketFieldLimit":1000,"bucketFieldOrder":"desc","bucketFieldValue":"Mes_Ref"}],"formFlowId":"2003","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"formId":"uOlPDr","formName":"FiltroDesempenhoProjetos","formType":"loadFlow","fieldSize":"small","formFields":[{"all":false,"grid":{"h":12,"w":12,"x":0,"y":0},"list":[],"type":"select","label":"Mês de Referência","moved":false,"value":"","source":"bucket","fieldId":"HKHNzo","loading":false,"multiple":false,"required":false,"paramName":"prm_data_max_projeto","selectBox":false,"bucketTable":"base_desempenho_projetos","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"MesVisual","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"MesRef"}],"formFlowId":"3400","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"formId":"UyXiiA","formName":"Filtros Validação Diária","formType":"loadFlow","fieldSize":"small","formFields":[{"all":false,"grid":{"h":12,"w":12,"x":0,"y":0},"list":[],"type":"select","label":"Data","moved":false,"value":"","source":"bucket","fieldId":"mrtJHl","loading":false,"multiple":false,"required":false,"paramName":"prm_gh_view_data","selectBox":false,"bucketTable":"historico_validacao","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"DataReferencia","bucketFieldLimit":1000,"bucketFieldOrder":"desc","bucketFieldValue":"DataReferencia"},{"all":false,"grid":{"h":12,"i":"EgUOjc","w":12,"x":0,"y":1},"list":[],"type":"select","label":"Indicador","moved":false,"value":"","source":"bucket","fieldId":"EgUOjc","loading":false,"multiple":false,"required":false,"paramName":"prm_gh_view_indicador","selectBox":false,"bucketTable":"historico_validacao","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"TIP_MTC","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"TIP_MTC"},{"all":false,"grid":{"h":12,"i":"bWXFwT","w":12,"x":0,"y":2},"list":[],"type":"select","label":"Segmento","moved":false,"value":"","source":"bucket","fieldId":"bWXFwT","loading":false,"multiple":false,"required":false,"paramName":"prm_gh_view_segmento","selectBox":false,"bucketTable":"historico_validacao","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"SEGMENTO","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"SEGMENTO"},{"all":false,"grid":{"h":12,"i":"QzjhfK","w":12,"x":0,"y":3},"list":[],"type":"select","label":"Produto","moved":false,"value":"","source":"bucket","fieldId":"QzjhfK","loading":false,"multiple":false,"required":false,"paramName":"prm_gh_view_produto","selectBox":false,"bucketTable":"historico_validacao","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"PRODUTO","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"PRODUTO"}],"formFlowId":"3601","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"formId":"aDpFvH","formName":"Filtros TIC + IoT","formType":"loadFlow","fieldSize":"small","formFields":[{"all":true,"grid":{"h":12,"i":"oMxXCE","w":12,"x":0,"y":2},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Marcação TIC/IoT","moved":false,"value":[],"source":"bucket","fieldId":"oMxXCE","loading":false,"multiple":true,"required":false,"paramName":"prm_filtro_tic_iot","selectBox":false,"bucketTable":"tmp_base_inicial","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"marcacao_tic_iot","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"marcacao_tic_iot"}],"formFlowId":"2002","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"formId":"AIXSHK","formName":"Filtros Financeiro","formType":"loadFlow","fieldSize":"small","formFields":[{"all":false,"grid":{"h":12,"i":"HHuros","w":12,"x":0,"y":1},"list":[],"type":"select","label":"Produto","moved":false,"value":"","source":"bucket","fieldId":"HHuros","loading":false,"multiple":false,"required":false,"paramName":"ProdutoBaseContrato","selectBox":false,"bucketTable":"tmp_base_inicial","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"PRODUTO","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"PRODUTO"},{"all":true,"grid":{"h":12,"i":"oMxXCE","w":12,"x":0,"y":2},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Marcação TIC/IoT (Em Validação)","moved":false,"value":[],"source":"bucket","fieldId":"oMxXCE","loading":false,"multiple":true,"required":false,"paramName":"prm_filtro_tic_iot","selectBox":false,"bucketTable":"tmp_base_inicial","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"marcacao_tic_iot","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"marcacao_tic_iot"},{"all":true,"grid":{"h":12,"i":"tVlMTX","w":12,"x":0,"y":0},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Regional","moved":false,"value":[],"source":"bucket","fieldId":"tVlMTX","loading":false,"multiple":true,"required":false,"paramName":"prm_filtro_regional","selectBox":false,"bucketTable":"tmp_base_inicial","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"HRQ_3","bucketFieldLimit":1000,"bucketFieldOrder":"asc","bucketFieldValue":"HRQ_3"}],"formFlowId":"2002","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"folder":"","formId":"EeQqCE","formName":"Filtros Mês Diario","formType":"loadFlow","fieldSize":"small","formFields":[{"all":true,"grid":{"h":12,"w":12,"x":0,"y":0},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Mês Referência","moved":false,"value":[],"source":"bucket","fieldId":"dXelbQ","loading":false,"multiple":true,"required":false,"paramName":"prm_filtro_mes_base_sem_segmento","selectBox":false,"bucketTable":"aux_base_bases_sem_segmento","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"Mes_Ref_Visual","bucketFieldLimit":1000,"bucketFieldOrder":"desc","bucketFieldValue":"Mes_Ref"}],"formFlowId":"3888","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""},{"folder":"","formId":"sECwEu","formName":"Filtros Mês Diário","formType":"loadFlow","fieldSize":"small","formFields":[{"all":true,"grid":{"h":12,"w":12,"x":0,"y":0},"list":[{"label":"Todos ","value":"all_","default":true}],"type":"select","label":"Mês Referência","moved":false,"value":"","source":"bucket","fieldId":"dXelbQ","loading":false,"multiple":true,"required":false,"paramName":"prm_filtro_mes_base_sem_segmento_mensal","selectBox":false,"bucketTable":"aux_base_bases_sem_segmento","description":"Descrição","placeholder":"","bucketDatabase":"bucket_137","bucketFieldLabel":"Mes_Ref_Visual","bucketFieldLimit":1000,"bucketFieldOrder":"desc","bucketFieldValue":"Mes_Ref"}],"formFlowId":"3888","formReload":true,"formConfirm":false,"formOnError":"","formOnSuccess":"","formDescription":"","formResetParams":false,"formClearOnStart":false,"formConfirmTitle":"c","formConfirmDescription":""}],"survey":[],"powerSearch":[{"contextId":"87","tableName":"IND_SAP_PLANEJAMENTO","databaseName":"bucket_137","options":{},"fields":[{"dataType":"Nullable(DateTime)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"DATA_REF","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"TIP_MTC","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"SEGMENTO","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"HRQ_1","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"HRQ_2","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"HRQ_3","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(String)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"DSC_LNH_NGC","columnLength":2,"databaseName":"bucket_137"},{"dataType":"Nullable(Float64)","tableName":"IND_SAP_PLANEJAMENTO","columnName":"REAL","columnLength":2,"databaseName":"bucket_137"}],"appId":137,"refId":1,"sourceType":"bucket","description":"undefined","label":"undefined","status":"active","userFilter":null,"hits":2,"updated":"2023-06-22 13:22:12","created":"2023-06-22 13:22:12"}],"metadata":{"repoId":1,"appId":137,"template":[{"templateId":7,"templateName":null,"templateFile":"nav.html","appId":137,"style":"","script":"","html":"<nav class=\"navbar-default navbar-static-side\" role=\"navigation\" style=\"position: fixed\">\r\n         <div class=\"sidebar-collapse\">\r\n            <ul class=\"nav metismenu\" id=\"side-menu\">\r\n               <li class=\"nav-header\">\r\n                  <div class=\"logo-element\">\r\n                     <img id=\"logo_analytics\" src=\"/api/content/read/22/analytics.png\" width=\"112px\">\r\n                  </div>\r\n               </li>\r\n               <li id=\"side-bar-portal\" style=\"margin-top:-100px; \">\r\n                  <h2 class=\"nav-label\" style=\"text-align:center;color:#EEEEEE;\r\n                     font-family: Verdana, Helvetica, sans-serif;\r\n                     margin-top:55px;\r\n                     \">\r\n                     <strong>Menu Portal Analytics</strong>\r\n                  </h2>\r\n               </li>\r\n               <li id=\"side-bar-menu\">\r\n                  <a>\r\n                  <i class=\"fa fa-laptop\"></i>\r\n                  <span class=\"nav-label\">Home</span>\r\n                  </a>\r\n               </li>\r\n               <li id=\"side-bar-negocios\"  class=\"active\">\r\n                  <a>\r\n                  <i class=\"fa fa-institution\"></i>\r\n                  <span class=\"nav-label\">Negócios </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-negocios-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-negocios-base\">\r\n                        <a>Base</a>\r\n                        <ul id=\"side-bar-negocios-base-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_base_cliente\">\r\n                              <a>\r\n                              Base de Clientes\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_base_contrato\">\r\n                              <a>\r\n                              Base de Contratos\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_venda\">\r\n                        <a>Venda</a>\r\n                        <ul id=\"side-bar-negocios-venda-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_venda_consolidada\">\r\n                              <a>\r\n                              Consolidado\r\n                              </a>\r\n                           </li>\r\n                           <li><!--\r\n                              <a  target=\"_blank\" href=\"http://spotfirehom.algartelecom.com.br/spotfire/wp/OpenAnalysis?file=200d4235-9a88-4887-8a6d-e69fb53583ff\" id=\"item_menu_venda_digital\">\r\n                              Digital\r\n                              </a>-->\r\n                              <a>Digital (WIP)</a>\r\n                           </li>\r\n                           <li id=\"item_menu_gestao_pipe\">\r\n                              <a>\r\n                              Gestão de Pipe (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_faturamento\">\r\n                        <a>Ticket Médio</a>\r\n                     </li>\r\n                     <li id=\"side-bar-negocios-churn\">\r\n                        <a>Churn</a>\r\n                        <ul id=\"side-bar-negocios-churn-ul\" class=\"nav\r\n                           nav-third-level collapse\">\r\n                           <li id=\"item_menu_churn_fisico_desativar\">\r\n                              <a>\r\n                              Churn Físico (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_perda_receita\">\r\n                              <a>\r\n                              Perda de Receita\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_entregas\">\r\n                        <a>Entregas (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_penetracao_mercado\">\r\n                        <a>Penetração de Mercado (WIP)</a>\r\n                     </li>\r\n                     \r\n                     <li id=\"side-bar-negocios-migracoes\">\r\n                        <a>Migrações (WIP)</a>\r\n                        <ul id=\"side-bar-negocios-migracoes-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_migracoes_entrantes_desativar\">\r\n                              <a>\r\n                              Migrações Entrantes (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_migracoes_saintes_desativar\">\r\n                              <a>\r\n                              Migrações Saintes (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     \r\n                     <li id=\"item_menu_nps\">\r\n                        <a>NPS (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-financeiro\">\r\n                  <a>\r\n                  <i class=\"fa fa-money\"></i>\r\n                  <span class=\"nav-label\">\r\n                  Financeiro (WIP)\r\n                  </span>\r\n                  </a>\r\n                  <ul id=\"side-bar-financeiro-ul\" class=\"nav\r\n                     nav-second-level collapse\">\r\n                     <li id=\"side-bar-financeiro-receita\">\r\n                        <a>Receita (WIP)</a>\r\n                        <ul id=\"side-bar-financeiro-receita-ul\" class=\"nav nav-third-level collapse\">\r\n                           <li id=\"item_menu_receita-bruta\">\r\n                              <a>\r\n                              Receita Bruta (WIP)\r\n                              </a>\r\n                           </li>\r\n                           <li id=\"item_menu_receita-liquida\">\r\n                              <a>\r\n                              Receita Líquida (WIP)\r\n                              </a>\r\n                           </li>\r\n                        </ul>\r\n                     </li>\r\n                     <li id=\"item_menu_recebimento\">\r\n                        <a>Recebimentos (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_opex\">\r\n                        <a>Opex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_capex\">\r\n                        <a>Capex (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_caixa\">\r\n                        <a>Caixa (WIP)</a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               <li id=\"side-bar-th\">\r\n                  <a>\r\n                  <i class=\"fa fa-user-circle-o\"></i>\r\n                  <span class=\"nav-label\">TH (WIP)</span>\r\n                  </a>\r\n                  <ul id=\"side-bar-th-ul\" class=\"nav nav-second-level\r\n                     collapse\">\r\n                     <li id=\"item_menu_e_nps\">\r\n                        <a>E-NPS (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_pulse_check\">\r\n                        <a>Pulse Check (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_turnover\">\r\n                        <a>Turnover (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_horas_extras\">\r\n                        <a>\r\n                        Horas Extras (WIP)\r\n                        </a>\r\n                     </li>\r\n                     <li id=\"item_menu_agilidade\">\r\n                        <a>% Agilidade (WIP)</a>\r\n                     </li>\r\n                     <li id=\"item_menu_diversidade\">\r\n                        <a>\r\n                        % Diversidade (WIP)\r\n                        </a>\r\n                     </li>\r\n                  </ul>\r\n               </li>\r\n               \r\n\r\n               <li id=\"side-bar-ed\">\r\n                <a>\r\n                <i class=\"fa fa-cloud-download\"></i>\r\n                <span class=\"nav-label\">Tecnologia</span>\r\n                </a>\r\n                <ul id=\"side-bar-ed-ul\" class=\"nav nav-second-level\r\n                   collapse\">\r\n                <li id=\"item_menu_evolucao_digital\">\r\n                    <a>Evolução Digital</a>\r\n                        <ul id=\"side-bar-evolucao-digital-ul\" class=\"nav nav-third-level collapse\">\r\n                \r\n                            <li id=\"item_menu_atendimento_digital\">\r\n                                <a   href=\"http://10.51.130.226/portal/a136TCvaoOKElYSKCMilIYghSdIJmCme\">Atendimento Digital</a>\r\n                            </li>\r\n                            <li id=\"item_menu_pulse_check\">\r\n                                <a>Data Driven (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Operações automatizadas (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Novos negócios digitais (WIP)</a>\r\n                            </li>\r\n                            <li id=\"item_menu_turnover\">\r\n                                <a>Mindset Digital (WIP)</a>\r\n                            </li>\r\n                        </ul>\r\n                </ul>\r\n            </li>\r\n             </li>\r\n\r\n\r\n            </ul>\r\n            <div class=\"fixed-bottom\" style=\"color:#EEEEEE;\"><strong>\r\n               &nbsp;Powered by Tribo Analytics</strong>\r\n            </div>\r\n         </div>\r\n      </nav>","type":"child"}],"content":[]}}